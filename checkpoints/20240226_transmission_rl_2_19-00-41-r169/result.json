{"custom_metrics": {"reward_total_mean": -50.78125, "reward_total_min": -61, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103271484375, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.25, "reward_score_mean": 0.103271484375, "reward_score_min": 0.0234375, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9924390320976575, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.718665246168772, "policy_loss": -0.01491805495073398, "vf_loss": 9.005194290479023, "vf_explained_var": -0.011123127738634745, "kl": 0.0, "entropy": 96.45387585957845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -61.0, "episode_reward_mean": -50.78125, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.78125, "reward_total_min": -61, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103271484375, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.25, "reward_score_mean": 0.103271484375, "reward_score_min": 0.0234375, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -49.0, -51.0, -60.0, -56.0, -47.0, -59.0, -32.0, -51.0, -56.0, -49.0, -50.0, -40.0, -48.0, -52.0, -54.0, -45.0, -58.0, -44.0, -56.0, -59.0, -49.0, -53.0, -39.0, -44.0, -59.0, -44.0, -40.0, -44.0, -57.0, -61.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2902883525945057, "mean_inference_ms": 9.749595184772335, "mean_action_processing_ms": 0.4748145506860684, "mean_env_wait_ms": 0.3007229773389433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2861537039279938, "StateBufferConnector_ms": 0.006017088890075684, "ViewRequirementAgentConnector_ms": 0.17231255769729614}}, "episode_reward_max": -32.0, "episode_reward_min": -61.0, "episode_reward_mean": -50.78125, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -49.0, -51.0, -60.0, -56.0, -47.0, -59.0, -32.0, -51.0, -56.0, -49.0, -50.0, -40.0, -48.0, -52.0, -54.0, -45.0, -58.0, -44.0, -56.0, -59.0, -49.0, -53.0, -39.0, -44.0, -59.0, -44.0, -40.0, -44.0, -57.0, -61.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2902883525945057, "mean_inference_ms": 9.749595184772335, "mean_action_processing_ms": 0.4748145506860684, "mean_env_wait_ms": 0.3007229773389433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2861537039279938, "StateBufferConnector_ms": 0.006017088890075684, "ViewRequirementAgentConnector_ms": 0.17231255769729614}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.107345809757492, "num_agent_steps_trained_throughput_per_sec": 7.107345809757492, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 72038.07, "sample_time_ms": 6085.036, "load_time_ms": 0.921, "load_throughput": 556054.803, "learn_time_ms": 65951.071, "learn_throughput": 7.763, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "f4e01_00169", "date": "2024-02-27_00-03-38", "timestamp": 1708988618, "time_this_iter_s": 72.04039072990417, "time_total_s": 72.04039072990417, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 72.04039072990417, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.14271844660195, "ram_util_percent": 21.189320388349522}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"reward_total_mean": -50.84375, "reward_total_min": -61, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102783203125, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.102783203125, "reward_score_min": 0.0234375, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.3780327320098875, "policy_loss": -0.055416051670908927, "vf_loss": 8.533801480134327, "vf_explained_var": -0.08679311176141104, "kl": 0.0, "entropy": 94.84993025461833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -61.0, "episode_reward_mean": -50.84375, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.84375, "reward_total_min": -61, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102783203125, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.102783203125, "reward_score_min": 0.0234375, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -49.0, -51.0, -60.0, -56.0, -47.0, -59.0, -32.0, -51.0, -56.0, -49.0, -50.0, -40.0, -48.0, -52.0, -54.0, -45.0, -58.0, -44.0, -56.0, -59.0, -49.0, -53.0, -39.0, -44.0, -59.0, -44.0, -40.0, -44.0, -57.0, -61.0, -58.0, -48.0, -31.0, -52.0, -51.0, -48.0, -60.0, -39.0, -56.0, -55.0, -37.0, -43.0, -48.0, -43.0, -50.0, -54.0, -56.0, -58.0, -61.0, -57.0, -56.0, -54.0, -45.0, -58.0, -56.0, -51.0, -60.0, -56.0, -36.0, -57.0, -46.0, -51.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3003308759551582, "mean_inference_ms": 9.772888303840235, "mean_action_processing_ms": 0.4744591926284882, "mean_env_wait_ms": 0.3007823288630573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27853697538375854, "StateBufferConnector_ms": 0.005586445331573486, "ViewRequirementAgentConnector_ms": 0.18343962728977203}}, "episode_reward_max": -31.0, "episode_reward_min": -61.0, "episode_reward_mean": -50.84375, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -49.0, -51.0, -60.0, -56.0, -47.0, -59.0, -32.0, -51.0, -56.0, -49.0, -50.0, -40.0, -48.0, -52.0, -54.0, -45.0, -58.0, -44.0, -56.0, -59.0, -49.0, -53.0, -39.0, -44.0, -59.0, -44.0, -40.0, -44.0, -57.0, -61.0, -58.0, -48.0, -31.0, -52.0, -51.0, -48.0, -60.0, -39.0, -56.0, -55.0, -37.0, -43.0, -48.0, -43.0, -50.0, -54.0, -56.0, -58.0, -61.0, -57.0, -56.0, -54.0, -45.0, -58.0, -56.0, -51.0, -60.0, -56.0, -36.0, -57.0, -46.0, -51.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3003308759551582, "mean_inference_ms": 9.772888303840235, "mean_action_processing_ms": 0.4744591926284882, "mean_env_wait_ms": 0.3007823288630573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27853697538375854, "StateBufferConnector_ms": 0.005586445331573486, "ViewRequirementAgentConnector_ms": 0.18343962728977203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.02740852214414, "num_agent_steps_trained_throughput_per_sec": 7.02740852214414, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 72447.803, "sample_time_ms": 6114.009, "load_time_ms": 0.638, "load_throughput": 802347.711, "learn_time_ms": 66332.319, "learn_throughput": 7.719, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 64, "training_iteration": 2, "trial_id": "f4e01_00169", "date": "2024-02-27_00-04-55", "timestamp": 1708988695, "time_this_iter_s": 72.86140251159668, "time_total_s": 144.90179324150085, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 144.90179324150085, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.84259259259258, "ram_util_percent": 21.37777777777778}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.041666666666664, "reward_total_min": -62, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10123697916666667, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.10123697916666667, "reward_score_min": 0.015625, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.448148699601491, "policy_loss": -0.05023942207917571, "vf_loss": 8.635795632998148, "vf_explained_var": -0.2038892408212026, "kl": 0.0, "entropy": 94.95422274271647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -62.0, "episode_reward_mean": -51.041666666666664, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.041666666666664, "reward_total_min": -62, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10123697916666667, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.10123697916666667, "reward_score_min": 0.015625, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -49.0, -51.0, -60.0, -56.0, -47.0, -59.0, -32.0, -51.0, -56.0, -49.0, -50.0, -40.0, -48.0, -52.0, -54.0, -45.0, -58.0, -44.0, -56.0, -59.0, -49.0, -53.0, -39.0, -44.0, -59.0, -44.0, -40.0, -44.0, -57.0, -61.0, -58.0, -48.0, -31.0, -52.0, -51.0, -48.0, -60.0, -39.0, -56.0, -55.0, -37.0, -43.0, -48.0, -43.0, -50.0, -54.0, -56.0, -58.0, -61.0, -57.0, -56.0, -54.0, -45.0, -58.0, -56.0, -51.0, -60.0, -56.0, -36.0, -57.0, -46.0, -51.0, -56.0, -49.0, -50.0, -62.0, -47.0, -52.0, -49.0, -53.0, -49.0, -51.0, -54.0, -54.0, -35.0, -41.0, -44.0, -47.0, -40.0, -56.0, -61.0, -58.0, -37.0, -61.0, -54.0, -44.0, -54.0, -61.0, -55.0, -46.0, -54.0, -51.0, -60.0, -58.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.309983758992989, "mean_inference_ms": 9.80880812622274, "mean_action_processing_ms": 0.47461890879882745, "mean_env_wait_ms": 0.30178145467238643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27907689412434894, "StateBufferConnector_ms": 0.0053177277247111005, "ViewRequirementAgentConnector_ms": 0.19347320000330606}}, "episode_reward_max": -31.0, "episode_reward_min": -62.0, "episode_reward_mean": -51.041666666666664, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -49.0, -51.0, -60.0, -56.0, -47.0, -59.0, -32.0, -51.0, -56.0, -49.0, -50.0, -40.0, -48.0, -52.0, -54.0, -45.0, -58.0, -44.0, -56.0, -59.0, -49.0, -53.0, -39.0, -44.0, -59.0, -44.0, -40.0, -44.0, -57.0, -61.0, -58.0, -48.0, -31.0, -52.0, -51.0, -48.0, -60.0, -39.0, -56.0, -55.0, -37.0, -43.0, -48.0, -43.0, -50.0, -54.0, -56.0, -58.0, -61.0, -57.0, -56.0, -54.0, -45.0, -58.0, -56.0, -51.0, -60.0, -56.0, -36.0, -57.0, -46.0, -51.0, -56.0, -49.0, -50.0, -62.0, -47.0, -52.0, -49.0, -53.0, -49.0, -51.0, -54.0, -54.0, -35.0, -41.0, -44.0, -47.0, -40.0, -56.0, -61.0, -58.0, -37.0, -61.0, -54.0, -44.0, -54.0, -61.0, -55.0, -46.0, -54.0, -51.0, -60.0, -58.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.309983758992989, "mean_inference_ms": 9.80880812622274, "mean_action_processing_ms": 0.47461890879882745, "mean_env_wait_ms": 0.30178145467238643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27907689412434894, "StateBufferConnector_ms": 0.0053177277247111005, "ViewRequirementAgentConnector_ms": 0.19347320000330606}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.066482161249763, "num_agent_steps_trained_throughput_per_sec": 7.066482161249763, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 72450.093, "sample_time_ms": 6167.269, "load_time_ms": 0.527, "load_throughput": 972005.272, "learn_time_ms": 66281.514, "learn_throughput": 7.725, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "f4e01_00169", "date": "2024-02-27_00-06-07", "timestamp": 1708988767, "time_this_iter_s": 72.45996737480164, "time_total_s": 217.3617606163025, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 217.3617606163025, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.20679611650485, "ram_util_percent": 21.27087378640778}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.63, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.096640625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.096640625, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.190903369585673, "policy_loss": -0.05245389668270946, "vf_loss": 8.235242855548858, "vf_explained_var": -0.3207634935776393, "kl": 0.0, "entropy": 95.34104951222737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.63, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.63, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.096640625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.096640625, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -57.0, -61.0, -58.0, -48.0, -31.0, -52.0, -51.0, -48.0, -60.0, -39.0, -56.0, -55.0, -37.0, -43.0, -48.0, -43.0, -50.0, -54.0, -56.0, -58.0, -61.0, -57.0, -56.0, -54.0, -45.0, -58.0, -56.0, -51.0, -60.0, -56.0, -36.0, -57.0, -46.0, -51.0, -56.0, -49.0, -50.0, -62.0, -47.0, -52.0, -49.0, -53.0, -49.0, -51.0, -54.0, -54.0, -35.0, -41.0, -44.0, -47.0, -40.0, -56.0, -61.0, -58.0, -37.0, -61.0, -54.0, -44.0, -54.0, -61.0, -55.0, -46.0, -54.0, -51.0, -60.0, -58.0, -59.0, -53.0, -47.0, -40.0, -60.0, -55.0, -53.0, -58.0, -57.0, -30.0, -54.0, -41.0, -60.0, -43.0, -62.0, -63.0, -46.0, -54.0, -42.0, -57.0, -60.0, -62.0, -53.0, -44.0, -49.0, -57.0, -57.0, -59.0, -57.0, -52.0, -43.0, -59.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187167339800794, "mean_inference_ms": 9.82777742391026, "mean_action_processing_ms": 0.4732360753117428, "mean_env_wait_ms": 0.30177322149563685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2782003879547119, "StateBufferConnector_ms": 0.004820823669433594, "ViewRequirementAgentConnector_ms": 0.1994009017944336}}, "episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.63, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -57.0, -61.0, -58.0, -48.0, -31.0, -52.0, -51.0, -48.0, -60.0, -39.0, -56.0, -55.0, -37.0, -43.0, -48.0, -43.0, -50.0, -54.0, -56.0, -58.0, -61.0, -57.0, -56.0, -54.0, -45.0, -58.0, -56.0, -51.0, -60.0, -56.0, -36.0, -57.0, -46.0, -51.0, -56.0, -49.0, -50.0, -62.0, -47.0, -52.0, -49.0, -53.0, -49.0, -51.0, -54.0, -54.0, -35.0, -41.0, -44.0, -47.0, -40.0, -56.0, -61.0, -58.0, -37.0, -61.0, -54.0, -44.0, -54.0, -61.0, -55.0, -46.0, -54.0, -51.0, -60.0, -58.0, -59.0, -53.0, -47.0, -40.0, -60.0, -55.0, -53.0, -58.0, -57.0, -30.0, -54.0, -41.0, -60.0, -43.0, -62.0, -63.0, -46.0, -54.0, -42.0, -57.0, -60.0, -62.0, -53.0, -44.0, -49.0, -57.0, -57.0, -59.0, -57.0, -52.0, -43.0, -59.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187167339800794, "mean_inference_ms": 9.82777742391026, "mean_action_processing_ms": 0.4732360753117428, "mean_env_wait_ms": 0.30177322149563685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2782003879547119, "StateBufferConnector_ms": 0.004820823669433594, "ViewRequirementAgentConnector_ms": 0.1994009017944336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1125745841096935, "num_agent_steps_trained_throughput_per_sec": 7.1125745841096935, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 72333.856, "sample_time_ms": 6124.45, "load_time_ms": 0.461, "load_throughput": 1109810.671, "learn_time_ms": 66208.241, "learn_throughput": 7.733, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "f4e01_00169", "date": "2024-02-27_00-07-19", "timestamp": 1708988839, "time_this_iter_s": 71.99036478996277, "time_total_s": 289.35212540626526, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 289.35212540626526, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.40000000000001, "ram_util_percent": 21.29607843137256}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.43, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098203125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.098203125, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.283547500769298, "policy_loss": -0.044239664046714706, "vf_loss": 8.367849000295003, "vf_explained_var": -0.5260241587956747, "kl": 0.0, "entropy": 95.21271444956461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.43, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098203125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.098203125, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -46.0, -51.0, -56.0, -49.0, -50.0, -62.0, -47.0, -52.0, -49.0, -53.0, -49.0, -51.0, -54.0, -54.0, -35.0, -41.0, -44.0, -47.0, -40.0, -56.0, -61.0, -58.0, -37.0, -61.0, -54.0, -44.0, -54.0, -61.0, -55.0, -46.0, -54.0, -51.0, -60.0, -58.0, -59.0, -53.0, -47.0, -40.0, -60.0, -55.0, -53.0, -58.0, -57.0, -30.0, -54.0, -41.0, -60.0, -43.0, -62.0, -63.0, -46.0, -54.0, -42.0, -57.0, -60.0, -62.0, -53.0, -44.0, -49.0, -57.0, -57.0, -59.0, -57.0, -52.0, -43.0, -59.0, -41.0, -56.0, -44.0, -54.0, -45.0, -59.0, -58.0, -50.0, -38.0, -61.0, -39.0, -58.0, -45.0, -42.0, -41.0, -55.0, -40.0, -47.0, -52.0, -42.0, -60.0, -58.0, -60.0, -58.0, -60.0, -36.0, -56.0, -45.0, -49.0, -37.0, -54.0, -58.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321314299437348, "mean_inference_ms": 9.832905180173743, "mean_action_processing_ms": 0.4714116050739128, "mean_env_wait_ms": 0.301113048436663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2761044502258301, "StateBufferConnector_ms": 0.004598140716552734, "ViewRequirementAgentConnector_ms": 0.19996285438537598}}, "episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -46.0, -51.0, -56.0, -49.0, -50.0, -62.0, -47.0, -52.0, -49.0, -53.0, -49.0, -51.0, -54.0, -54.0, -35.0, -41.0, -44.0, -47.0, -40.0, -56.0, -61.0, -58.0, -37.0, -61.0, -54.0, -44.0, -54.0, -61.0, -55.0, -46.0, -54.0, -51.0, -60.0, -58.0, -59.0, -53.0, -47.0, -40.0, -60.0, -55.0, -53.0, -58.0, -57.0, -30.0, -54.0, -41.0, -60.0, -43.0, -62.0, -63.0, -46.0, -54.0, -42.0, -57.0, -60.0, -62.0, -53.0, -44.0, -49.0, -57.0, -57.0, -59.0, -57.0, -52.0, -43.0, -59.0, -41.0, -56.0, -44.0, -54.0, -45.0, -59.0, -58.0, -50.0, -38.0, -61.0, -39.0, -58.0, -45.0, -42.0, -41.0, -55.0, -40.0, -47.0, -52.0, -42.0, -60.0, -58.0, -60.0, -58.0, -60.0, -36.0, -56.0, -45.0, -49.0, -37.0, -54.0, -58.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321314299437348, "mean_inference_ms": 9.832905180173743, "mean_action_processing_ms": 0.4714116050739128, "mean_env_wait_ms": 0.301113048436663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2761044502258301, "StateBufferConnector_ms": 0.004598140716552734, "ViewRequirementAgentConnector_ms": 0.19996285438537598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.082961027309012, "num_agent_steps_trained_throughput_per_sec": 7.082961027309012, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 72324.309, "sample_time_ms": 6114.972, "load_time_ms": 0.491, "load_throughput": 1042974.088, "learn_time_ms": 66208.104, "learn_throughput": 7.733, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 160, "training_iteration": 5, "trial_id": "f4e01_00169", "date": "2024-02-27_00-08-32", "timestamp": 1708988912, "time_this_iter_s": 72.29138374328613, "time_total_s": 361.6435091495514, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 361.6435091495514, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.63333333333334, "ram_util_percent": 21.372549019607842}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.34, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09109375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.09109375, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.640670192241669, "policy_loss": -0.03236318867032727, "vf_loss": 8.910094396273296, "vf_explained_var": -0.6654464960098266, "kl": 0.0, "entropy": 95.18122774759928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -52.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.34, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09109375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.09109375, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-51.0, -60.0, -58.0, -59.0, -53.0, -47.0, -40.0, -60.0, -55.0, -53.0, -58.0, -57.0, -30.0, -54.0, -41.0, -60.0, -43.0, -62.0, -63.0, -46.0, -54.0, -42.0, -57.0, -60.0, -62.0, -53.0, -44.0, -49.0, -57.0, -57.0, -59.0, -57.0, -52.0, -43.0, -59.0, -41.0, -56.0, -44.0, -54.0, -45.0, -59.0, -58.0, -50.0, -38.0, -61.0, -39.0, -58.0, -45.0, -42.0, -41.0, -55.0, -40.0, -47.0, -52.0, -42.0, -60.0, -58.0, -60.0, -58.0, -60.0, -36.0, -56.0, -45.0, -49.0, -37.0, -54.0, -58.0, -62.0, -40.0, -49.0, -55.0, -57.0, -49.0, -51.0, -42.0, -58.0, -62.0, -45.0, -59.0, -58.0, -57.0, -61.0, -56.0, -52.0, -54.0, -56.0, -52.0, -52.0, -59.0, -52.0, -56.0, -53.0, -46.0, -58.0, -56.0, -49.0, -56.0, -49.0, -59.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3194611960956717, "mean_inference_ms": 9.822048482267993, "mean_action_processing_ms": 0.4695839899501834, "mean_env_wait_ms": 0.2998744128021165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2752673625946045, "StateBufferConnector_ms": 0.0045850276947021484, "ViewRequirementAgentConnector_ms": 0.19715332984924316}}, "episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -52.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.0, -60.0, -58.0, -59.0, -53.0, -47.0, -40.0, -60.0, -55.0, -53.0, -58.0, -57.0, -30.0, -54.0, -41.0, -60.0, -43.0, -62.0, -63.0, -46.0, -54.0, -42.0, -57.0, -60.0, -62.0, -53.0, -44.0, -49.0, -57.0, -57.0, -59.0, -57.0, -52.0, -43.0, -59.0, -41.0, -56.0, -44.0, -54.0, -45.0, -59.0, -58.0, -50.0, -38.0, -61.0, -39.0, -58.0, -45.0, -42.0, -41.0, -55.0, -40.0, -47.0, -52.0, -42.0, -60.0, -58.0, -60.0, -58.0, -60.0, -36.0, -56.0, -45.0, -49.0, -37.0, -54.0, -58.0, -62.0, -40.0, -49.0, -55.0, -57.0, -49.0, -51.0, -42.0, -58.0, -62.0, -45.0, -59.0, -58.0, -57.0, -61.0, -56.0, -52.0, -54.0, -56.0, -52.0, -52.0, -59.0, -52.0, -56.0, -53.0, -46.0, -58.0, -56.0, -49.0, -56.0, -49.0, -59.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3194611960956717, "mean_inference_ms": 9.822048482267993, "mean_action_processing_ms": 0.4695839899501834, "mean_env_wait_ms": 0.2998744128021165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2752673625946045, "StateBufferConnector_ms": 0.0045850276947021484, "ViewRequirementAgentConnector_ms": 0.19715332984924316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.103751589743224, "num_agent_steps_trained_throughput_per_sec": 7.103751589743224, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 72282.682, "sample_time_ms": 6133.375, "load_time_ms": 0.461, "load_throughput": 1111725.788, "learn_time_ms": 66148.127, "learn_throughput": 7.74, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 192, "training_iteration": 6, "trial_id": "f4e01_00169", "date": "2024-02-27_00-09-44", "timestamp": 1708988984, "time_this_iter_s": 72.0802264213562, "time_total_s": 433.7237355709076, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 433.7237355709076, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.893137254901966, "ram_util_percent": 21.47843137254902}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.26, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09953125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.09953125, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9820291998485724, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.112292500336965, "policy_loss": -0.03065049505482117, "vf_loss": 9.648136766751607, "vf_explained_var": -0.5045146097739538, "kl": 0.0, "entropy": 95.46737785339356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -51.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.26, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09953125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.09953125, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -43.0, -59.0, -41.0, -56.0, -44.0, -54.0, -45.0, -59.0, -58.0, -50.0, -38.0, -61.0, -39.0, -58.0, -45.0, -42.0, -41.0, -55.0, -40.0, -47.0, -52.0, -42.0, -60.0, -58.0, -60.0, -58.0, -60.0, -36.0, -56.0, -45.0, -49.0, -37.0, -54.0, -58.0, -62.0, -40.0, -49.0, -55.0, -57.0, -49.0, -51.0, -42.0, -58.0, -62.0, -45.0, -59.0, -58.0, -57.0, -61.0, -56.0, -52.0, -54.0, -56.0, -52.0, -52.0, -59.0, -52.0, -56.0, -53.0, -46.0, -58.0, -56.0, -49.0, -56.0, -49.0, -59.0, -61.0, -46.0, -46.0, -60.0, -38.0, -38.0, -50.0, -37.0, -48.0, -62.0, -43.0, -53.0, -45.0, -44.0, -32.0, -48.0, -57.0, -50.0, -45.0, -55.0, -58.0, -44.0, -56.0, -54.0, -41.0, -55.0, -57.0, -58.0, -59.0, -44.0, -57.0, -56.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3189500615144851, "mean_inference_ms": 9.82067097023231, "mean_action_processing_ms": 0.46844667342386387, "mean_env_wait_ms": 0.2990982429156989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2741575241088867, "StateBufferConnector_ms": 0.004599094390869141, "ViewRequirementAgentConnector_ms": 0.1983959674835205}}, "episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -51.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -43.0, -59.0, -41.0, -56.0, -44.0, -54.0, -45.0, -59.0, -58.0, -50.0, -38.0, -61.0, -39.0, -58.0, -45.0, -42.0, -41.0, -55.0, -40.0, -47.0, -52.0, -42.0, -60.0, -58.0, -60.0, -58.0, -60.0, -36.0, -56.0, -45.0, -49.0, -37.0, -54.0, -58.0, -62.0, -40.0, -49.0, -55.0, -57.0, -49.0, -51.0, -42.0, -58.0, -62.0, -45.0, -59.0, -58.0, -57.0, -61.0, -56.0, -52.0, -54.0, -56.0, -52.0, -52.0, -59.0, -52.0, -56.0, -53.0, -46.0, -58.0, -56.0, -49.0, -56.0, -49.0, -59.0, -61.0, -46.0, -46.0, -60.0, -38.0, -38.0, -50.0, -37.0, -48.0, -62.0, -43.0, -53.0, -45.0, -44.0, -32.0, -48.0, -57.0, -50.0, -45.0, -55.0, -58.0, -44.0, -56.0, -54.0, -41.0, -55.0, -57.0, -58.0, -59.0, -44.0, -57.0, -56.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3189500615144851, "mean_inference_ms": 9.82067097023231, "mean_action_processing_ms": 0.46844667342386387, "mean_env_wait_ms": 0.2990982429156989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2741575241088867, "StateBufferConnector_ms": 0.004599094390869141, "ViewRequirementAgentConnector_ms": 0.1983959674835205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.011992603494705, "num_agent_steps_trained_throughput_per_sec": 7.011992603494705, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 72387.688, "sample_time_ms": 6122.705, "load_time_ms": 0.439, "load_throughput": 1166386.215, "learn_time_ms": 66263.853, "learn_throughput": 7.727, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 224, "training_iteration": 7, "trial_id": "f4e01_00169", "date": "2024-02-27_00-10-57", "timestamp": 1708989057, "time_this_iter_s": 73.02308511734009, "time_total_s": 506.7468206882477, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 506.7468206882477, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.095192307692315, "ram_util_percent": 21.19903846153846}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.41, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098359375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.098359375, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.497945209344228, "policy_loss": -0.029342424031347035, "vf_loss": 8.681185328960419, "vf_explained_var": -0.543787290652593, "kl": 0.0, "entropy": 95.29570916493734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.41, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.41, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098359375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.098359375, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-37.0, -54.0, -58.0, -62.0, -40.0, -49.0, -55.0, -57.0, -49.0, -51.0, -42.0, -58.0, -62.0, -45.0, -59.0, -58.0, -57.0, -61.0, -56.0, -52.0, -54.0, -56.0, -52.0, -52.0, -59.0, -52.0, -56.0, -53.0, -46.0, -58.0, -56.0, -49.0, -56.0, -49.0, -59.0, -61.0, -46.0, -46.0, -60.0, -38.0, -38.0, -50.0, -37.0, -48.0, -62.0, -43.0, -53.0, -45.0, -44.0, -32.0, -48.0, -57.0, -50.0, -45.0, -55.0, -58.0, -44.0, -56.0, -54.0, -41.0, -55.0, -57.0, -58.0, -59.0, -44.0, -57.0, -56.0, -57.0, -55.0, -58.0, -48.0, -62.0, -47.0, -54.0, -52.0, -50.0, -49.0, -53.0, -45.0, -57.0, -55.0, -44.0, -44.0, -58.0, -45.0, -56.0, -55.0, -45.0, -63.0, -42.0, -46.0, -43.0, -41.0, -45.0, -62.0, -55.0, -43.0, -48.0, -55.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3216019331416677, "mean_inference_ms": 9.835268761807365, "mean_action_processing_ms": 0.4686304461759066, "mean_env_wait_ms": 0.29927983632461547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779209613800049, "StateBufferConnector_ms": 0.0046749114990234375, "ViewRequirementAgentConnector_ms": 0.2034463882446289}}, "episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.41, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.0, -54.0, -58.0, -62.0, -40.0, -49.0, -55.0, -57.0, -49.0, -51.0, -42.0, -58.0, -62.0, -45.0, -59.0, -58.0, -57.0, -61.0, -56.0, -52.0, -54.0, -56.0, -52.0, -52.0, -59.0, -52.0, -56.0, -53.0, -46.0, -58.0, -56.0, -49.0, -56.0, -49.0, -59.0, -61.0, -46.0, -46.0, -60.0, -38.0, -38.0, -50.0, -37.0, -48.0, -62.0, -43.0, -53.0, -45.0, -44.0, -32.0, -48.0, -57.0, -50.0, -45.0, -55.0, -58.0, -44.0, -56.0, -54.0, -41.0, -55.0, -57.0, -58.0, -59.0, -44.0, -57.0, -56.0, -57.0, -55.0, -58.0, -48.0, -62.0, -47.0, -54.0, -52.0, -50.0, -49.0, -53.0, -45.0, -57.0, -55.0, -44.0, -44.0, -58.0, -45.0, -56.0, -55.0, -45.0, -63.0, -42.0, -46.0, -43.0, -41.0, -45.0, -62.0, -55.0, -43.0, -48.0, -55.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3216019331416677, "mean_inference_ms": 9.835268761807365, "mean_action_processing_ms": 0.4686304461759066, "mean_env_wait_ms": 0.29927983632461547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779209613800049, "StateBufferConnector_ms": 0.0046749114990234375, "ViewRequirementAgentConnector_ms": 0.2034463882446289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.085441316567176, "num_agent_steps_trained_throughput_per_sec": 7.085441316567176, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 72371.83, "sample_time_ms": 6143.562, "load_time_ms": 0.417, "load_throughput": 1228537.556, "learn_time_ms": 66227.194, "learn_throughput": 7.731, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 256, "training_iteration": 8, "trial_id": "f4e01_00169", "date": "2024-02-27_00-12-09", "timestamp": 1708989129, "time_this_iter_s": 72.26580858230591, "time_total_s": 579.0126292705536, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 579.0126292705536, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.96372549019606, "ram_util_percent": 20.885294117647064}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.15, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.100390625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.100390625, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.195980950196584, "policy_loss": -0.04479963428651293, "vf_loss": 8.231195990244547, "vf_explained_var": -0.311249190568924, "kl": 0.0, "entropy": 95.2675366083781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.15, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.100390625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.100390625, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-56.0, -49.0, -59.0, -61.0, -46.0, -46.0, -60.0, -38.0, -38.0, -50.0, -37.0, -48.0, -62.0, -43.0, -53.0, -45.0, -44.0, -32.0, -48.0, -57.0, -50.0, -45.0, -55.0, -58.0, -44.0, -56.0, -54.0, -41.0, -55.0, -57.0, -58.0, -59.0, -44.0, -57.0, -56.0, -57.0, -55.0, -58.0, -48.0, -62.0, -47.0, -54.0, -52.0, -50.0, -49.0, -53.0, -45.0, -57.0, -55.0, -44.0, -44.0, -58.0, -45.0, -56.0, -55.0, -45.0, -63.0, -42.0, -46.0, -43.0, -41.0, -45.0, -62.0, -55.0, -43.0, -48.0, -55.0, -43.0, -58.0, -47.0, -50.0, -48.0, -33.0, -49.0, -55.0, -62.0, -53.0, -57.0, -62.0, -56.0, -57.0, -54.0, -41.0, -46.0, -50.0, -44.0, -44.0, -63.0, -59.0, -43.0, -61.0, -50.0, -45.0, -58.0, -50.0, -62.0, -59.0, -62.0, -61.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3230852656948506, "mean_inference_ms": 9.842021767613153, "mean_action_processing_ms": 0.4686302453587362, "mean_env_wait_ms": 0.29924598445886186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.277878999710083, "StateBufferConnector_ms": 0.004650592803955078, "ViewRequirementAgentConnector_ms": 0.20261478424072266}}, "episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -49.0, -59.0, -61.0, -46.0, -46.0, -60.0, -38.0, -38.0, -50.0, -37.0, -48.0, -62.0, -43.0, -53.0, -45.0, -44.0, -32.0, -48.0, -57.0, -50.0, -45.0, -55.0, -58.0, -44.0, -56.0, -54.0, -41.0, -55.0, -57.0, -58.0, -59.0, -44.0, -57.0, -56.0, -57.0, -55.0, -58.0, -48.0, -62.0, -47.0, -54.0, -52.0, -50.0, -49.0, -53.0, -45.0, -57.0, -55.0, -44.0, -44.0, -58.0, -45.0, -56.0, -55.0, -45.0, -63.0, -42.0, -46.0, -43.0, -41.0, -45.0, -62.0, -55.0, -43.0, -48.0, -55.0, -43.0, -58.0, -47.0, -50.0, -48.0, -33.0, -49.0, -55.0, -62.0, -53.0, -57.0, -62.0, -56.0, -57.0, -54.0, -41.0, -46.0, -50.0, -44.0, -44.0, -63.0, -59.0, -43.0, -61.0, -50.0, -45.0, -58.0, -50.0, -62.0, -59.0, -62.0, -61.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3230852656948506, "mean_inference_ms": 9.842021767613153, "mean_action_processing_ms": 0.4686302453587362, "mean_env_wait_ms": 0.29924598445886186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.277878999710083, "StateBufferConnector_ms": 0.004650592803955078, "ViewRequirementAgentConnector_ms": 0.20261478424072266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.030053164334828, "num_agent_steps_trained_throughput_per_sec": 7.030053164334828, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 72422.754, "sample_time_ms": 6143.446, "load_time_ms": 0.406, "load_throughput": 1261329.559, "learn_time_ms": 66278.256, "learn_throughput": 7.725, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 288, "training_iteration": 9, "trial_id": "f4e01_00169", "date": "2024-02-27_00-13-22", "timestamp": 1708989202, "time_this_iter_s": 72.83552169799805, "time_total_s": 651.8481509685516, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 651.8481509685516, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 52.64038461538462, "ram_util_percent": 20.68653846153846}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.9, "reward_total_min": -63, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10234375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.10234375, "reward_score_min": 0.0078125, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.4868402997652685, "policy_loss": -0.03696792358532548, "vf_loss": 8.67572067975998, "vf_explained_var": -0.39536781907081603, "kl": 0.0, "entropy": 95.43834654490153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": -33.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.9, "reward_total_min": -63, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10234375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.10234375, "reward_score_min": 0.0078125, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -57.0, -56.0, -57.0, -55.0, -58.0, -48.0, -62.0, -47.0, -54.0, -52.0, -50.0, -49.0, -53.0, -45.0, -57.0, -55.0, -44.0, -44.0, -58.0, -45.0, -56.0, -55.0, -45.0, -63.0, -42.0, -46.0, -43.0, -41.0, -45.0, -62.0, -55.0, -43.0, -48.0, -55.0, -43.0, -58.0, -47.0, -50.0, -48.0, -33.0, -49.0, -55.0, -62.0, -53.0, -57.0, -62.0, -56.0, -57.0, -54.0, -41.0, -46.0, -50.0, -44.0, -44.0, -63.0, -59.0, -43.0, -61.0, -50.0, -45.0, -58.0, -50.0, -62.0, -59.0, -62.0, -61.0, -40.0, -43.0, -48.0, -48.0, -41.0, -60.0, -50.0, -55.0, -38.0, -34.0, -41.0, -55.0, -60.0, -40.0, -55.0, -33.0, -52.0, -47.0, -62.0, -37.0, -53.0, -53.0, -52.0, -52.0, -45.0, -57.0, -51.0, -59.0, -51.0, -60.0, -56.0, -54.0, -37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324261131100435, "mean_inference_ms": 9.849330070662047, "mean_action_processing_ms": 0.46867122412514417, "mean_env_wait_ms": 0.2992777841764275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2782723903656006, "StateBufferConnector_ms": 0.004604339599609375, "ViewRequirementAgentConnector_ms": 0.20302319526672363}}, "episode_reward_max": -33.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -57.0, -56.0, -57.0, -55.0, -58.0, -48.0, -62.0, -47.0, -54.0, -52.0, -50.0, -49.0, -53.0, -45.0, -57.0, -55.0, -44.0, -44.0, -58.0, -45.0, -56.0, -55.0, -45.0, -63.0, -42.0, -46.0, -43.0, -41.0, -45.0, -62.0, -55.0, -43.0, -48.0, -55.0, -43.0, -58.0, -47.0, -50.0, -48.0, -33.0, -49.0, -55.0, -62.0, -53.0, -57.0, -62.0, -56.0, -57.0, -54.0, -41.0, -46.0, -50.0, -44.0, -44.0, -63.0, -59.0, -43.0, -61.0, -50.0, -45.0, -58.0, -50.0, -62.0, -59.0, -62.0, -61.0, -40.0, -43.0, -48.0, -48.0, -41.0, -60.0, -50.0, -55.0, -38.0, -34.0, -41.0, -55.0, -60.0, -40.0, -55.0, -33.0, -52.0, -47.0, -62.0, -37.0, -53.0, -53.0, -52.0, -52.0, -45.0, -57.0, -51.0, -59.0, -51.0, -60.0, -56.0, -54.0, -37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324261131100435, "mean_inference_ms": 9.849330070662047, "mean_action_processing_ms": 0.46867122412514417, "mean_env_wait_ms": 0.2992777841764275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2782723903656006, "StateBufferConnector_ms": 0.004604339599609375, "ViewRequirementAgentConnector_ms": 0.20302319526672363}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.105803839103628, "num_agent_steps_trained_throughput_per_sec": 7.105803839103628, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 72385.853, "sample_time_ms": 6137.304, "load_time_ms": 0.397, "load_throughput": 1288773.719, "learn_time_ms": 66247.517, "learn_throughput": 7.729, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 320, "training_iteration": 10, "trial_id": "f4e01_00169", "date": "2024-02-27_00-14-34", "timestamp": 1708989274, "time_this_iter_s": 72.0589017868042, "time_total_s": 723.9070527553558, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 723.9070527553558, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.42718446601942, "ram_util_percent": 20.92621359223301}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.07, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108828125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.108828125, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.422224557399749, "policy_loss": -0.041185704867045085, "vf_loss": 8.580859347184498, "vf_explained_var": -0.3006673951943715, "kl": 0.0, "entropy": 94.947513961792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.07, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.07, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108828125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.108828125, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -48.0, -55.0, -43.0, -58.0, -47.0, -50.0, -48.0, -33.0, -49.0, -55.0, -62.0, -53.0, -57.0, -62.0, -56.0, -57.0, -54.0, -41.0, -46.0, -50.0, -44.0, -44.0, -63.0, -59.0, -43.0, -61.0, -50.0, -45.0, -58.0, -50.0, -62.0, -59.0, -62.0, -61.0, -40.0, -43.0, -48.0, -48.0, -41.0, -60.0, -50.0, -55.0, -38.0, -34.0, -41.0, -55.0, -60.0, -40.0, -55.0, -33.0, -52.0, -47.0, -62.0, -37.0, -53.0, -53.0, -52.0, -52.0, -45.0, -57.0, -51.0, -59.0, -51.0, -60.0, -56.0, -54.0, -37.0, -51.0, -62.0, -53.0, -47.0, -51.0, -53.0, -42.0, -58.0, -35.0, -62.0, -50.0, -33.0, -37.0, -30.0, -60.0, -36.0, -49.0, -52.0, -35.0, -50.0, -55.0, -57.0, -62.0, -49.0, -50.0, -42.0, -49.0, -53.0, -45.0, -51.0, -51.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3222601267750929, "mean_inference_ms": 9.839982615555925, "mean_action_processing_ms": 0.46761337867535674, "mean_env_wait_ms": 0.29874348715852256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2717273235321045, "StateBufferConnector_ms": 0.00445556640625, "ViewRequirementAgentConnector_ms": 0.1941361427307129}}, "episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.07, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -48.0, -55.0, -43.0, -58.0, -47.0, -50.0, -48.0, -33.0, -49.0, -55.0, -62.0, -53.0, -57.0, -62.0, -56.0, -57.0, -54.0, -41.0, -46.0, -50.0, -44.0, -44.0, -63.0, -59.0, -43.0, -61.0, -50.0, -45.0, -58.0, -50.0, -62.0, -59.0, -62.0, -61.0, -40.0, -43.0, -48.0, -48.0, -41.0, -60.0, -50.0, -55.0, -38.0, -34.0, -41.0, -55.0, -60.0, -40.0, -55.0, -33.0, -52.0, -47.0, -62.0, -37.0, -53.0, -53.0, -52.0, -52.0, -45.0, -57.0, -51.0, -59.0, -51.0, -60.0, -56.0, -54.0, -37.0, -51.0, -62.0, -53.0, -47.0, -51.0, -53.0, -42.0, -58.0, -35.0, -62.0, -50.0, -33.0, -37.0, -30.0, -60.0, -36.0, -49.0, -52.0, -35.0, -50.0, -55.0, -57.0, -62.0, -49.0, -50.0, -42.0, -49.0, -53.0, -45.0, -51.0, -51.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3222601267750929, "mean_inference_ms": 9.839982615555925, "mean_action_processing_ms": 0.46761337867535674, "mean_env_wait_ms": 0.29874348715852256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2717273235321045, "StateBufferConnector_ms": 0.00445556640625, "ViewRequirementAgentConnector_ms": 0.1941361427307129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.121289732129263, "num_agent_steps_trained_throughput_per_sec": 7.121289732129263, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 72371.751, "sample_time_ms": 6123.085, "load_time_ms": 0.339, "load_throughput": 1511886.545, "learn_time_ms": 66247.716, "learn_throughput": 7.729, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 352, "training_iteration": 11, "trial_id": "f4e01_00169", "date": "2024-02-27_00-15-46", "timestamp": 1708989346, "time_this_iter_s": 71.90589022636414, "time_total_s": 795.81294298172, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 795.81294298172, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 53.16274509803922, "ram_util_percent": 20.944117647058825}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.6, "reward_total_min": -62, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.28125, "reward_score_mean": 0.1125, "reward_score_min": 0.015625, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.147668409347534, "policy_loss": -0.03606772006799777, "vf_loss": 8.141601637999218, "vf_explained_var": -0.2956782281398773, "kl": 0.0, "entropy": 94.98632253011068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.6, "reward_total_min": -62, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.28125, "reward_score_mean": 0.1125, "reward_score_min": 0.015625, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -62.0, -61.0, -40.0, -43.0, -48.0, -48.0, -41.0, -60.0, -50.0, -55.0, -38.0, -34.0, -41.0, -55.0, -60.0, -40.0, -55.0, -33.0, -52.0, -47.0, -62.0, -37.0, -53.0, -53.0, -52.0, -52.0, -45.0, -57.0, -51.0, -59.0, -51.0, -60.0, -56.0, -54.0, -37.0, -51.0, -62.0, -53.0, -47.0, -51.0, -53.0, -42.0, -58.0, -35.0, -62.0, -50.0, -33.0, -37.0, -30.0, -60.0, -36.0, -49.0, -52.0, -35.0, -50.0, -55.0, -57.0, -62.0, -49.0, -50.0, -42.0, -49.0, -53.0, -45.0, -51.0, -51.0, -50.0, -56.0, -28.0, -57.0, -53.0, -55.0, -42.0, -53.0, -50.0, -57.0, -50.0, -58.0, -53.0, -54.0, -45.0, -42.0, -50.0, -52.0, -47.0, -37.0, -46.0, -48.0, -35.0, -60.0, -56.0, -50.0, -46.0, -54.0, -52.0, -52.0, -51.0, -59.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3204502971527972, "mean_inference_ms": 9.830150183169017, "mean_action_processing_ms": 0.4664725960588315, "mean_env_wait_ms": 0.2982542638616467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2718062400817871, "StateBufferConnector_ms": 0.004438161849975586, "ViewRequirementAgentConnector_ms": 0.19672441482543945}}, "episode_reward_max": -28.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -62.0, -61.0, -40.0, -43.0, -48.0, -48.0, -41.0, -60.0, -50.0, -55.0, -38.0, -34.0, -41.0, -55.0, -60.0, -40.0, -55.0, -33.0, -52.0, -47.0, -62.0, -37.0, -53.0, -53.0, -52.0, -52.0, -45.0, -57.0, -51.0, -59.0, -51.0, -60.0, -56.0, -54.0, -37.0, -51.0, -62.0, -53.0, -47.0, -51.0, -53.0, -42.0, -58.0, -35.0, -62.0, -50.0, -33.0, -37.0, -30.0, -60.0, -36.0, -49.0, -52.0, -35.0, -50.0, -55.0, -57.0, -62.0, -49.0, -50.0, -42.0, -49.0, -53.0, -45.0, -51.0, -51.0, -50.0, -56.0, -28.0, -57.0, -53.0, -55.0, -42.0, -53.0, -50.0, -57.0, -50.0, -58.0, -53.0, -54.0, -45.0, -42.0, -50.0, -52.0, -47.0, -37.0, -46.0, -48.0, -35.0, -60.0, -56.0, -50.0, -46.0, -54.0, -52.0, -52.0, -51.0, -59.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3204502971527972, "mean_inference_ms": 9.830150183169017, "mean_action_processing_ms": 0.4664725960588315, "mean_env_wait_ms": 0.2982542638616467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2718062400817871, "StateBufferConnector_ms": 0.004438161849975586, "ViewRequirementAgentConnector_ms": 0.19672441482543945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.053054193601424, "num_agent_steps_trained_throughput_per_sec": 7.053054193601424, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 72345.26, "sample_time_ms": 6123.193, "load_time_ms": 0.329, "load_throughput": 1557840.876, "learn_time_ms": 66221.148, "learn_throughput": 7.732, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "f4e01_00169", "date": "2024-02-27_00-16-59", "timestamp": 1708989419, "time_this_iter_s": 72.59778881072998, "time_total_s": 868.41073179245, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 868.41073179245, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 52.31067961165048, "ram_util_percent": 21.036893203883487}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.19, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107890625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.107890625, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.140697220961253, "policy_loss": -0.0395949000492692, "vf_loss": 8.136192472775777, "vf_explained_var": 0.3510094851255417, "kl": 0.0, "entropy": 94.70366096496582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.19, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.19, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107890625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.107890625, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -56.0, -54.0, -37.0, -51.0, -62.0, -53.0, -47.0, -51.0, -53.0, -42.0, -58.0, -35.0, -62.0, -50.0, -33.0, -37.0, -30.0, -60.0, -36.0, -49.0, -52.0, -35.0, -50.0, -55.0, -57.0, -62.0, -49.0, -50.0, -42.0, -49.0, -53.0, -45.0, -51.0, -51.0, -50.0, -56.0, -28.0, -57.0, -53.0, -55.0, -42.0, -53.0, -50.0, -57.0, -50.0, -58.0, -53.0, -54.0, -45.0, -42.0, -50.0, -52.0, -47.0, -37.0, -46.0, -48.0, -35.0, -60.0, -56.0, -50.0, -46.0, -54.0, -52.0, -52.0, -51.0, -59.0, -51.0, -54.0, -60.0, -60.0, -40.0, -63.0, -55.0, -63.0, -62.0, -44.0, -61.0, -55.0, -50.0, -37.0, -55.0, -44.0, -44.0, -52.0, -56.0, -45.0, -62.0, -39.0, -56.0, -58.0, -46.0, -33.0, -55.0, -62.0, -46.0, -51.0, -51.0, -48.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3185042132096643, "mean_inference_ms": 9.818909456062556, "mean_action_processing_ms": 0.4654473010195075, "mean_env_wait_ms": 0.2976356228452622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27152514457702637, "StateBufferConnector_ms": 0.004547119140625, "ViewRequirementAgentConnector_ms": 0.19657063484191895}}, "episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.19, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -56.0, -54.0, -37.0, -51.0, -62.0, -53.0, -47.0, -51.0, -53.0, -42.0, -58.0, -35.0, -62.0, -50.0, -33.0, -37.0, -30.0, -60.0, -36.0, -49.0, -52.0, -35.0, -50.0, -55.0, -57.0, -62.0, -49.0, -50.0, -42.0, -49.0, -53.0, -45.0, -51.0, -51.0, -50.0, -56.0, -28.0, -57.0, -53.0, -55.0, -42.0, -53.0, -50.0, -57.0, -50.0, -58.0, -53.0, -54.0, -45.0, -42.0, -50.0, -52.0, -47.0, -37.0, -46.0, -48.0, -35.0, -60.0, -56.0, -50.0, -46.0, -54.0, -52.0, -52.0, -51.0, -59.0, -51.0, -54.0, -60.0, -60.0, -40.0, -63.0, -55.0, -63.0, -62.0, -44.0, -61.0, -55.0, -50.0, -37.0, -55.0, -44.0, -44.0, -52.0, -56.0, -45.0, -62.0, -39.0, -56.0, -58.0, -46.0, -33.0, -55.0, -62.0, -46.0, -51.0, -51.0, -48.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3185042132096643, "mean_inference_ms": 9.818909456062556, "mean_action_processing_ms": 0.4654473010195075, "mean_env_wait_ms": 0.2976356228452622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27152514457702637, "StateBufferConnector_ms": 0.004547119140625, "ViewRequirementAgentConnector_ms": 0.19657063484191895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0829161502433875, "num_agent_steps_trained_throughput_per_sec": 7.0829161502433875, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 72328.451, "sample_time_ms": 6097.539, "load_time_ms": 0.349, "load_throughput": 1467461.834, "learn_time_ms": 66229.968, "learn_throughput": 7.731, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 416, "training_iteration": 13, "trial_id": "f4e01_00169", "date": "2024-02-27_00-18-11", "timestamp": 1708989491, "time_this_iter_s": 72.29187488555908, "time_total_s": 940.702606678009, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 940.702606678009, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 52.77254901960785, "ram_util_percent": 20.793137254901957}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.27, "reward_total_min": -64, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.28125, "reward_score_mean": 0.099453125, "reward_score_min": 0.0, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.029421494404475, "policy_loss": -0.04100369882459442, "vf_loss": 7.9636349042256676, "vf_explained_var": 0.5359532589713732, "kl": 0.0, "entropy": 95.05830643971761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.27, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.27, "reward_total_min": -64, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.28125, "reward_score_mean": 0.099453125, "reward_score_min": 0.0, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -51.0, -51.0, -50.0, -56.0, -28.0, -57.0, -53.0, -55.0, -42.0, -53.0, -50.0, -57.0, -50.0, -58.0, -53.0, -54.0, -45.0, -42.0, -50.0, -52.0, -47.0, -37.0, -46.0, -48.0, -35.0, -60.0, -56.0, -50.0, -46.0, -54.0, -52.0, -52.0, -51.0, -59.0, -51.0, -54.0, -60.0, -60.0, -40.0, -63.0, -55.0, -63.0, -62.0, -44.0, -61.0, -55.0, -50.0, -37.0, -55.0, -44.0, -44.0, -52.0, -56.0, -45.0, -62.0, -39.0, -56.0, -58.0, -46.0, -33.0, -55.0, -62.0, -46.0, -51.0, -51.0, -48.0, -46.0, -42.0, -64.0, -50.0, -52.0, -61.0, -42.0, -43.0, -61.0, -44.0, -60.0, -46.0, -60.0, -46.0, -46.0, -49.0, -52.0, -55.0, -61.0, -43.0, -50.0, -63.0, -49.0, -54.0, -55.0, -54.0, -53.0, -56.0, -52.0, -44.0, -54.0, -62.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3180568474045145, "mean_inference_ms": 9.813170484685822, "mean_action_processing_ms": 0.4649220702593806, "mean_env_wait_ms": 0.29724958093144793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2732279300689697, "StateBufferConnector_ms": 0.004553079605102539, "ViewRequirementAgentConnector_ms": 0.19784975051879883}}, "episode_reward_max": -28.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.27, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -51.0, -51.0, -50.0, -56.0, -28.0, -57.0, -53.0, -55.0, -42.0, -53.0, -50.0, -57.0, -50.0, -58.0, -53.0, -54.0, -45.0, -42.0, -50.0, -52.0, -47.0, -37.0, -46.0, -48.0, -35.0, -60.0, -56.0, -50.0, -46.0, -54.0, -52.0, -52.0, -51.0, -59.0, -51.0, -54.0, -60.0, -60.0, -40.0, -63.0, -55.0, -63.0, -62.0, -44.0, -61.0, -55.0, -50.0, -37.0, -55.0, -44.0, -44.0, -52.0, -56.0, -45.0, -62.0, -39.0, -56.0, -58.0, -46.0, -33.0, -55.0, -62.0, -46.0, -51.0, -51.0, -48.0, -46.0, -42.0, -64.0, -50.0, -52.0, -61.0, -42.0, -43.0, -61.0, -44.0, -60.0, -46.0, -60.0, -46.0, -46.0, -49.0, -52.0, -55.0, -61.0, -43.0, -50.0, -63.0, -49.0, -54.0, -55.0, -54.0, -53.0, -56.0, -52.0, -44.0, -54.0, -62.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3180568474045145, "mean_inference_ms": 9.813170484685822, "mean_action_processing_ms": 0.4649220702593806, "mean_env_wait_ms": 0.29724958093144793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2732279300689697, "StateBufferConnector_ms": 0.004553079605102539, "ViewRequirementAgentConnector_ms": 0.19784975051879883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.15615929155383, "num_agent_steps_trained_throughput_per_sec": 7.15615929155383, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 72284.609, "sample_time_ms": 6104.351, "load_time_ms": 0.355, "load_throughput": 1442135.282, "learn_time_ms": 66179.305, "learn_throughput": 7.737, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 448, "training_iteration": 14, "trial_id": "f4e01_00169", "date": "2024-02-27_00-19-23", "timestamp": 1708989563, "time_this_iter_s": 71.55188250541687, "time_total_s": 1012.2544891834259, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1012.2544891834259, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.299019607843135, "ram_util_percent": 20.786274509803935}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.89, "reward_total_min": -64, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.094609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.094609375, "reward_score_min": 0.0, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.022806272904078, "policy_loss": -0.028630792256444694, "vf_loss": 7.933812153339386, "vf_explained_var": 0.6793423886100451, "kl": 0.0, "entropy": 95.32059383392334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": -33.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.89, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.89, "reward_total_min": -64, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.094609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.094609375, "reward_score_min": 0.0, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -51.0, -59.0, -51.0, -54.0, -60.0, -60.0, -40.0, -63.0, -55.0, -63.0, -62.0, -44.0, -61.0, -55.0, -50.0, -37.0, -55.0, -44.0, -44.0, -52.0, -56.0, -45.0, -62.0, -39.0, -56.0, -58.0, -46.0, -33.0, -55.0, -62.0, -46.0, -51.0, -51.0, -48.0, -46.0, -42.0, -64.0, -50.0, -52.0, -61.0, -42.0, -43.0, -61.0, -44.0, -60.0, -46.0, -60.0, -46.0, -46.0, -49.0, -52.0, -55.0, -61.0, -43.0, -50.0, -63.0, -49.0, -54.0, -55.0, -54.0, -53.0, -56.0, -52.0, -44.0, -54.0, -62.0, -55.0, -34.0, -49.0, -45.0, -47.0, -59.0, -52.0, -56.0, -49.0, -57.0, -46.0, -51.0, -56.0, -61.0, -57.0, -64.0, -50.0, -53.0, -55.0, -55.0, -53.0, -50.0, -59.0, -44.0, -46.0, -53.0, -43.0, -48.0, -62.0, -43.0, -56.0, -53.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3180449693579277, "mean_inference_ms": 9.80929218331987, "mean_action_processing_ms": 0.4647715765317887, "mean_env_wait_ms": 0.2969869983673258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2741270065307617, "StateBufferConnector_ms": 0.004584789276123047, "ViewRequirementAgentConnector_ms": 0.1997072696685791}}, "episode_reward_max": -33.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.89, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -51.0, -59.0, -51.0, -54.0, -60.0, -60.0, -40.0, -63.0, -55.0, -63.0, -62.0, -44.0, -61.0, -55.0, -50.0, -37.0, -55.0, -44.0, -44.0, -52.0, -56.0, -45.0, -62.0, -39.0, -56.0, -58.0, -46.0, -33.0, -55.0, -62.0, -46.0, -51.0, -51.0, -48.0, -46.0, -42.0, -64.0, -50.0, -52.0, -61.0, -42.0, -43.0, -61.0, -44.0, -60.0, -46.0, -60.0, -46.0, -46.0, -49.0, -52.0, -55.0, -61.0, -43.0, -50.0, -63.0, -49.0, -54.0, -55.0, -54.0, -53.0, -56.0, -52.0, -44.0, -54.0, -62.0, -55.0, -34.0, -49.0, -45.0, -47.0, -59.0, -52.0, -56.0, -49.0, -57.0, -46.0, -51.0, -56.0, -61.0, -57.0, -64.0, -50.0, -53.0, -55.0, -55.0, -53.0, -50.0, -59.0, -44.0, -46.0, -53.0, -43.0, -48.0, -62.0, -43.0, -56.0, -53.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3180449693579277, "mean_inference_ms": 9.80929218331987, "mean_action_processing_ms": 0.4647715765317887, "mean_env_wait_ms": 0.2969869983673258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2741270065307617, "StateBufferConnector_ms": 0.004584789276123047, "ViewRequirementAgentConnector_ms": 0.1997072696685791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.119140591887767, "num_agent_steps_trained_throughput_per_sec": 7.119140591887767, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 72247.873, "sample_time_ms": 6113.889, "load_time_ms": 0.323, "load_throughput": 1583222.978, "learn_time_ms": 66133.106, "learn_throughput": 7.742, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 480, "training_iteration": 15, "trial_id": "f4e01_00169", "date": "2024-02-27_00-20-35", "timestamp": 1708989635, "time_this_iter_s": 71.92410039901733, "time_total_s": 1084.1785895824432, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1084.1785895824432, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 53.38921568627451, "ram_util_percent": 20.594117647058823}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.45, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.105859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.105859375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.525596465667089, "policy_loss": -0.0316769481326143, "vf_loss": 7.157676235834757, "vf_explained_var": 0.9051947355270386, "kl": 0.0, "entropy": 94.86101703643799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.45, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.45, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.105859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.105859375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-51.0, -51.0, -48.0, -46.0, -42.0, -64.0, -50.0, -52.0, -61.0, -42.0, -43.0, -61.0, -44.0, -60.0, -46.0, -60.0, -46.0, -46.0, -49.0, -52.0, -55.0, -61.0, -43.0, -50.0, -63.0, -49.0, -54.0, -55.0, -54.0, -53.0, -56.0, -52.0, -44.0, -54.0, -62.0, -55.0, -34.0, -49.0, -45.0, -47.0, -59.0, -52.0, -56.0, -49.0, -57.0, -46.0, -51.0, -56.0, -61.0, -57.0, -64.0, -50.0, -53.0, -55.0, -55.0, -53.0, -50.0, -59.0, -44.0, -46.0, -53.0, -43.0, -48.0, -62.0, -43.0, -56.0, -53.0, -39.0, -46.0, -59.0, -49.0, -51.0, -59.0, -53.0, -51.0, -37.0, -37.0, -61.0, -30.0, -46.0, -46.0, -53.0, -37.0, -46.0, -36.0, -54.0, -51.0, -26.0, -29.0, -63.0, -45.0, -61.0, -54.0, -47.0, -34.0, -46.0, -59.0, -53.0, -56.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3172244874309007, "mean_inference_ms": 9.801477644207882, "mean_action_processing_ms": 0.4643138599772847, "mean_env_wait_ms": 0.296515713577703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27183008193969727, "StateBufferConnector_ms": 0.00455474853515625, "ViewRequirementAgentConnector_ms": 0.1950547695159912}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.45, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.0, -51.0, -48.0, -46.0, -42.0, -64.0, -50.0, -52.0, -61.0, -42.0, -43.0, -61.0, -44.0, -60.0, -46.0, -60.0, -46.0, -46.0, -49.0, -52.0, -55.0, -61.0, -43.0, -50.0, -63.0, -49.0, -54.0, -55.0, -54.0, -53.0, -56.0, -52.0, -44.0, -54.0, -62.0, -55.0, -34.0, -49.0, -45.0, -47.0, -59.0, -52.0, -56.0, -49.0, -57.0, -46.0, -51.0, -56.0, -61.0, -57.0, -64.0, -50.0, -53.0, -55.0, -55.0, -53.0, -50.0, -59.0, -44.0, -46.0, -53.0, -43.0, -48.0, -62.0, -43.0, -56.0, -53.0, -39.0, -46.0, -59.0, -49.0, -51.0, -59.0, -53.0, -51.0, -37.0, -37.0, -61.0, -30.0, -46.0, -46.0, -53.0, -37.0, -46.0, -36.0, -54.0, -51.0, -26.0, -29.0, -63.0, -45.0, -61.0, -54.0, -47.0, -34.0, -46.0, -59.0, -53.0, -56.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3172244874309007, "mean_inference_ms": 9.801477644207882, "mean_action_processing_ms": 0.4643138599772847, "mean_env_wait_ms": 0.296515713577703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27183008193969727, "StateBufferConnector_ms": 0.00455474853515625, "ViewRequirementAgentConnector_ms": 0.1950547695159912}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.072731731643648, "num_agent_steps_trained_throughput_per_sec": 7.072731731643648, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 72279.485, "sample_time_ms": 6078.429, "load_time_ms": 0.322, "load_throughput": 1591435.933, "learn_time_ms": 66200.187, "learn_throughput": 7.734, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 512, "training_iteration": 16, "trial_id": "f4e01_00169", "date": "2024-02-27_00-21-47", "timestamp": 1708989707, "time_this_iter_s": 72.39604139328003, "time_total_s": 1156.5746309757233, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1156.5746309757233, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 53.156862745098046, "ram_util_percent": 20.73529411764707}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.19, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.107890625, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.427949331204096, "policy_loss": -0.049171802463630836, "vf_loss": 7.031788607438405, "vf_explained_var": 0.9135742709040642, "kl": 0.0, "entropy": 94.8829277674357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.19, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.19, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.107890625, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -54.0, -62.0, -55.0, -34.0, -49.0, -45.0, -47.0, -59.0, -52.0, -56.0, -49.0, -57.0, -46.0, -51.0, -56.0, -61.0, -57.0, -64.0, -50.0, -53.0, -55.0, -55.0, -53.0, -50.0, -59.0, -44.0, -46.0, -53.0, -43.0, -48.0, -62.0, -43.0, -56.0, -53.0, -39.0, -46.0, -59.0, -49.0, -51.0, -59.0, -53.0, -51.0, -37.0, -37.0, -61.0, -30.0, -46.0, -46.0, -53.0, -37.0, -46.0, -36.0, -54.0, -51.0, -26.0, -29.0, -63.0, -45.0, -61.0, -54.0, -47.0, -34.0, -46.0, -59.0, -53.0, -56.0, -51.0, -53.0, -45.0, -57.0, -55.0, -56.0, -55.0, -45.0, -57.0, -43.0, -62.0, -59.0, -62.0, -59.0, -41.0, -62.0, -48.0, -53.0, -46.0, -54.0, -33.0, -52.0, -39.0, -45.0, -41.0, -63.0, -43.0, -35.0, -58.0, -64.0, -48.0, -39.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3166295850224432, "mean_inference_ms": 9.794386103379432, "mean_action_processing_ms": 0.4638961305496878, "mean_env_wait_ms": 0.29618280543654485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2735450267791748, "StateBufferConnector_ms": 0.00451350212097168, "ViewRequirementAgentConnector_ms": 0.19936490058898926}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.19, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -54.0, -62.0, -55.0, -34.0, -49.0, -45.0, -47.0, -59.0, -52.0, -56.0, -49.0, -57.0, -46.0, -51.0, -56.0, -61.0, -57.0, -64.0, -50.0, -53.0, -55.0, -55.0, -53.0, -50.0, -59.0, -44.0, -46.0, -53.0, -43.0, -48.0, -62.0, -43.0, -56.0, -53.0, -39.0, -46.0, -59.0, -49.0, -51.0, -59.0, -53.0, -51.0, -37.0, -37.0, -61.0, -30.0, -46.0, -46.0, -53.0, -37.0, -46.0, -36.0, -54.0, -51.0, -26.0, -29.0, -63.0, -45.0, -61.0, -54.0, -47.0, -34.0, -46.0, -59.0, -53.0, -56.0, -51.0, -53.0, -45.0, -57.0, -55.0, -56.0, -55.0, -45.0, -57.0, -43.0, -62.0, -59.0, -62.0, -59.0, -41.0, -62.0, -48.0, -53.0, -46.0, -54.0, -33.0, -52.0, -39.0, -45.0, -41.0, -63.0, -43.0, -35.0, -58.0, -64.0, -48.0, -39.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3166295850224432, "mean_inference_ms": 9.794386103379432, "mean_action_processing_ms": 0.4638961305496878, "mean_env_wait_ms": 0.29618280543654485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2735450267791748, "StateBufferConnector_ms": 0.00451350212097168, "ViewRequirementAgentConnector_ms": 0.19936490058898926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.120253067690313, "num_agent_steps_trained_throughput_per_sec": 7.120253067690313, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 72168.464, "sample_time_ms": 6078.557, "load_time_ms": 0.318, "load_throughput": 1611136.355, "learn_time_ms": 66089.038, "learn_throughput": 7.747, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 544, "training_iteration": 17, "trial_id": "f4e01_00169", "date": "2024-02-27_00-22-59", "timestamp": 1708989779, "time_this_iter_s": 71.91293263435364, "time_total_s": 1228.487563610077, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1228.487563610077, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 52.52745098039214, "ram_util_percent": 20.848039215686285}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.65, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.112109375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.437688903013865, "policy_loss": -0.055626268746952215, "vf_loss": 7.057223037878672, "vf_explained_var": 0.9436657110850016, "kl": 0.0, "entropy": 94.99640204111735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.65, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.65, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.112109375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -56.0, -53.0, -39.0, -46.0, -59.0, -49.0, -51.0, -59.0, -53.0, -51.0, -37.0, -37.0, -61.0, -30.0, -46.0, -46.0, -53.0, -37.0, -46.0, -36.0, -54.0, -51.0, -26.0, -29.0, -63.0, -45.0, -61.0, -54.0, -47.0, -34.0, -46.0, -59.0, -53.0, -56.0, -51.0, -53.0, -45.0, -57.0, -55.0, -56.0, -55.0, -45.0, -57.0, -43.0, -62.0, -59.0, -62.0, -59.0, -41.0, -62.0, -48.0, -53.0, -46.0, -54.0, -33.0, -52.0, -39.0, -45.0, -41.0, -63.0, -43.0, -35.0, -58.0, -64.0, -48.0, -39.0, -61.0, -59.0, -63.0, -58.0, -42.0, -36.0, -51.0, -41.0, -52.0, -51.0, -43.0, -39.0, -62.0, -57.0, -53.0, -46.0, -51.0, -56.0, -49.0, -47.0, -55.0, -55.0, -34.0, -57.0, -54.0, -54.0, -49.0, -43.0, -47.0, -52.0, -51.0, -62.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3144334701636655, "mean_inference_ms": 9.78019530181039, "mean_action_processing_ms": 0.4628879796994126, "mean_env_wait_ms": 0.29551578301788384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26859331130981445, "StateBufferConnector_ms": 0.004427909851074219, "ViewRequirementAgentConnector_ms": 0.18883705139160156}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.65, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -56.0, -53.0, -39.0, -46.0, -59.0, -49.0, -51.0, -59.0, -53.0, -51.0, -37.0, -37.0, -61.0, -30.0, -46.0, -46.0, -53.0, -37.0, -46.0, -36.0, -54.0, -51.0, -26.0, -29.0, -63.0, -45.0, -61.0, -54.0, -47.0, -34.0, -46.0, -59.0, -53.0, -56.0, -51.0, -53.0, -45.0, -57.0, -55.0, -56.0, -55.0, -45.0, -57.0, -43.0, -62.0, -59.0, -62.0, -59.0, -41.0, -62.0, -48.0, -53.0, -46.0, -54.0, -33.0, -52.0, -39.0, -45.0, -41.0, -63.0, -43.0, -35.0, -58.0, -64.0, -48.0, -39.0, -61.0, -59.0, -63.0, -58.0, -42.0, -36.0, -51.0, -41.0, -52.0, -51.0, -43.0, -39.0, -62.0, -57.0, -53.0, -46.0, -51.0, -56.0, -49.0, -47.0, -55.0, -55.0, -34.0, -57.0, -54.0, -54.0, -49.0, -43.0, -47.0, -52.0, -51.0, -62.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3144334701636655, "mean_inference_ms": 9.78019530181039, "mean_action_processing_ms": 0.4628879796994126, "mean_env_wait_ms": 0.29551578301788384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26859331130981445, "StateBufferConnector_ms": 0.004427909851074219, "ViewRequirementAgentConnector_ms": 0.18883705139160156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.116880195521591, "num_agent_steps_trained_throughput_per_sec": 7.116880195521591, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 72136.542, "sample_time_ms": 6037.077, "load_time_ms": 0.322, "load_throughput": 1591553.878, "learn_time_ms": 66098.587, "learn_throughput": 7.746, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "episodes_total": 576, "training_iteration": 18, "trial_id": "f4e01_00169", "date": "2024-02-27_00-24-11", "timestamp": 1708989851, "time_this_iter_s": 71.94698452949524, "time_total_s": 1300.4345481395721, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1300.4345481395721, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.653921568627446, "ram_util_percent": 20.878431372549027}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.77, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.103359375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.7475869735081995, "policy_loss": -0.045320625665287176, "vf_loss": 7.527764368057251, "vf_explained_var": 0.955443478624026, "kl": 0.0, "entropy": 95.3963612238566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.77, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.77, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.103359375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -53.0, -56.0, -51.0, -53.0, -45.0, -57.0, -55.0, -56.0, -55.0, -45.0, -57.0, -43.0, -62.0, -59.0, -62.0, -59.0, -41.0, -62.0, -48.0, -53.0, -46.0, -54.0, -33.0, -52.0, -39.0, -45.0, -41.0, -63.0, -43.0, -35.0, -58.0, -64.0, -48.0, -39.0, -61.0, -59.0, -63.0, -58.0, -42.0, -36.0, -51.0, -41.0, -52.0, -51.0, -43.0, -39.0, -62.0, -57.0, -53.0, -46.0, -51.0, -56.0, -49.0, -47.0, -55.0, -55.0, -34.0, -57.0, -54.0, -54.0, -49.0, -43.0, -47.0, -52.0, -51.0, -62.0, -46.0, -49.0, -61.0, -48.0, -57.0, -59.0, -61.0, -61.0, -41.0, -40.0, -44.0, -41.0, -41.0, -46.0, -54.0, -45.0, -62.0, -59.0, -41.0, -46.0, -62.0, -32.0, -62.0, -57.0, -34.0, -61.0, -57.0, -54.0, -46.0, -43.0, -60.0, -34.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.31274334668946, "mean_inference_ms": 9.769989103339869, "mean_action_processing_ms": 0.46203079900756167, "mean_env_wait_ms": 0.2950593532726082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2754209041595459, "StateBufferConnector_ms": 0.004644632339477539, "ViewRequirementAgentConnector_ms": 0.18719148635864258}}, "episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.77, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -53.0, -56.0, -51.0, -53.0, -45.0, -57.0, -55.0, -56.0, -55.0, -45.0, -57.0, -43.0, -62.0, -59.0, -62.0, -59.0, -41.0, -62.0, -48.0, -53.0, -46.0, -54.0, -33.0, -52.0, -39.0, -45.0, -41.0, -63.0, -43.0, -35.0, -58.0, -64.0, -48.0, -39.0, -61.0, -59.0, -63.0, -58.0, -42.0, -36.0, -51.0, -41.0, -52.0, -51.0, -43.0, -39.0, -62.0, -57.0, -53.0, -46.0, -51.0, -56.0, -49.0, -47.0, -55.0, -55.0, -34.0, -57.0, -54.0, -54.0, -49.0, -43.0, -47.0, -52.0, -51.0, -62.0, -46.0, -49.0, -61.0, -48.0, -57.0, -59.0, -61.0, -61.0, -41.0, -40.0, -44.0, -41.0, -41.0, -46.0, -54.0, -45.0, -62.0, -59.0, -41.0, -46.0, -62.0, -32.0, -62.0, -57.0, -34.0, -61.0, -57.0, -54.0, -46.0, -43.0, -60.0, -34.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.31274334668946, "mean_inference_ms": 9.769989103339869, "mean_action_processing_ms": 0.46203079900756167, "mean_env_wait_ms": 0.2950593532726082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2754209041595459, "StateBufferConnector_ms": 0.004644632339477539, "ViewRequirementAgentConnector_ms": 0.18719148635864258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.073997336006199, "num_agent_steps_trained_throughput_per_sec": 7.073997336006199, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 72091.297, "sample_time_ms": 6021.861, "load_time_ms": 0.324, "load_throughput": 1580775.597, "learn_time_ms": 66068.548, "learn_throughput": 7.75, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "done": false, "episodes_total": 608, "training_iteration": 19, "trial_id": "f4e01_00169", "date": "2024-02-27_00-25-24", "timestamp": 1708989924, "time_this_iter_s": 72.3830578327179, "time_total_s": 1372.81760597229, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1372.81760597229, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 53.435922330097085, "ram_util_percent": 20.878640776699037}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.63, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.104453125, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.511382472515106, "policy_loss": -0.048105769138783214, "vf_loss": 7.161154782772064, "vf_explained_var": 0.9555381998419762, "kl": 0.0, "entropy": 94.54769077301026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.63, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.63, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.104453125, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -48.0, -39.0, -61.0, -59.0, -63.0, -58.0, -42.0, -36.0, -51.0, -41.0, -52.0, -51.0, -43.0, -39.0, -62.0, -57.0, -53.0, -46.0, -51.0, -56.0, -49.0, -47.0, -55.0, -55.0, -34.0, -57.0, -54.0, -54.0, -49.0, -43.0, -47.0, -52.0, -51.0, -62.0, -46.0, -49.0, -61.0, -48.0, -57.0, -59.0, -61.0, -61.0, -41.0, -40.0, -44.0, -41.0, -41.0, -46.0, -54.0, -45.0, -62.0, -59.0, -41.0, -46.0, -62.0, -32.0, -62.0, -57.0, -34.0, -61.0, -57.0, -54.0, -46.0, -43.0, -60.0, -34.0, -52.0, -55.0, -62.0, -53.0, -54.0, -56.0, -46.0, -37.0, -40.0, -55.0, -43.0, -44.0, -55.0, -54.0, -61.0, -33.0, -48.0, -58.0, -62.0, -53.0, -27.0, -55.0, -50.0, -57.0, -58.0, -53.0, -56.0, -49.0, -39.0, -35.0, -61.0, -57.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3107614016329185, "mean_inference_ms": 9.76255240791442, "mean_action_processing_ms": 0.4609236434366694, "mean_env_wait_ms": 0.29445174699012633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2727336883544922, "StateBufferConnector_ms": 0.004602909088134766, "ViewRequirementAgentConnector_ms": 0.18106412887573242}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.63, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -48.0, -39.0, -61.0, -59.0, -63.0, -58.0, -42.0, -36.0, -51.0, -41.0, -52.0, -51.0, -43.0, -39.0, -62.0, -57.0, -53.0, -46.0, -51.0, -56.0, -49.0, -47.0, -55.0, -55.0, -34.0, -57.0, -54.0, -54.0, -49.0, -43.0, -47.0, -52.0, -51.0, -62.0, -46.0, -49.0, -61.0, -48.0, -57.0, -59.0, -61.0, -61.0, -41.0, -40.0, -44.0, -41.0, -41.0, -46.0, -54.0, -45.0, -62.0, -59.0, -41.0, -46.0, -62.0, -32.0, -62.0, -57.0, -34.0, -61.0, -57.0, -54.0, -46.0, -43.0, -60.0, -34.0, -52.0, -55.0, -62.0, -53.0, -54.0, -56.0, -46.0, -37.0, -40.0, -55.0, -43.0, -44.0, -55.0, -54.0, -61.0, -33.0, -48.0, -58.0, -62.0, -53.0, -27.0, -55.0, -50.0, -57.0, -58.0, -53.0, -56.0, -49.0, -39.0, -35.0, -61.0, -57.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3107614016329185, "mean_inference_ms": 9.76255240791442, "mean_action_processing_ms": 0.4609236434366694, "mean_env_wait_ms": 0.29445174699012633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2727336883544922, "StateBufferConnector_ms": 0.004602909088134766, "ViewRequirementAgentConnector_ms": 0.18106412887573242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.077227935321586, "num_agent_steps_trained_throughput_per_sec": 7.077227935321586, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 72120.391, "sample_time_ms": 6020.403, "load_time_ms": 0.322, "load_throughput": 1588258.005, "learn_time_ms": 66099.1, "learn_throughput": 7.746, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 640, "training_iteration": 20, "trial_id": "f4e01_00169", "date": "2024-02-27_00-26-36", "timestamp": 1708989996, "time_this_iter_s": 72.34997248649597, "time_total_s": 1445.167578458786, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1445.167578458786, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 52.804901960784306, "ram_util_percent": 20.717647058823523}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.4, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.10625, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.001103683312734, "policy_loss": -0.046215776819735765, "vf_loss": 6.356740013758341, "vf_explained_var": 0.9748466442028682, "kl": 0.0, "entropy": 94.77981249491374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.4, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.10625, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -51.0, -62.0, -46.0, -49.0, -61.0, -48.0, -57.0, -59.0, -61.0, -61.0, -41.0, -40.0, -44.0, -41.0, -41.0, -46.0, -54.0, -45.0, -62.0, -59.0, -41.0, -46.0, -62.0, -32.0, -62.0, -57.0, -34.0, -61.0, -57.0, -54.0, -46.0, -43.0, -60.0, -34.0, -52.0, -55.0, -62.0, -53.0, -54.0, -56.0, -46.0, -37.0, -40.0, -55.0, -43.0, -44.0, -55.0, -54.0, -61.0, -33.0, -48.0, -58.0, -62.0, -53.0, -27.0, -55.0, -50.0, -57.0, -58.0, -53.0, -56.0, -49.0, -39.0, -35.0, -61.0, -57.0, -60.0, -59.0, -57.0, -57.0, -60.0, -55.0, -64.0, -43.0, -32.0, -34.0, -55.0, -48.0, -46.0, -53.0, -64.0, -55.0, -53.0, -48.0, -63.0, -51.0, -47.0, -35.0, -50.0, -51.0, -28.0, -51.0, -50.0, -53.0, -52.0, -52.0, -50.0, -54.0, -23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3103213978683186, "mean_inference_ms": 9.76352720029234, "mean_action_processing_ms": 0.4604564875075614, "mean_env_wait_ms": 0.2942307921206797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27758121490478516, "StateBufferConnector_ms": 0.0046923160552978516, "ViewRequirementAgentConnector_ms": 0.18804073333740234}}, "episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -51.0, -62.0, -46.0, -49.0, -61.0, -48.0, -57.0, -59.0, -61.0, -61.0, -41.0, -40.0, -44.0, -41.0, -41.0, -46.0, -54.0, -45.0, -62.0, -59.0, -41.0, -46.0, -62.0, -32.0, -62.0, -57.0, -34.0, -61.0, -57.0, -54.0, -46.0, -43.0, -60.0, -34.0, -52.0, -55.0, -62.0, -53.0, -54.0, -56.0, -46.0, -37.0, -40.0, -55.0, -43.0, -44.0, -55.0, -54.0, -61.0, -33.0, -48.0, -58.0, -62.0, -53.0, -27.0, -55.0, -50.0, -57.0, -58.0, -53.0, -56.0, -49.0, -39.0, -35.0, -61.0, -57.0, -60.0, -59.0, -57.0, -57.0, -60.0, -55.0, -64.0, -43.0, -32.0, -34.0, -55.0, -48.0, -46.0, -53.0, -64.0, -55.0, -53.0, -48.0, -63.0, -51.0, -47.0, -35.0, -50.0, -51.0, -28.0, -51.0, -50.0, -53.0, -52.0, -52.0, -50.0, -54.0, -23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3103213978683186, "mean_inference_ms": 9.76352720029234, "mean_action_processing_ms": 0.4604564875075614, "mean_env_wait_ms": 0.2942307921206797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27758121490478516, "StateBufferConnector_ms": 0.0046923160552978516, "ViewRequirementAgentConnector_ms": 0.18804073333740234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.032024315068576, "num_agent_steps_trained_throughput_per_sec": 7.032024315068576, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 72211.656, "sample_time_ms": 6047.981, "load_time_ms": 0.315, "load_throughput": 1624174.594, "learn_time_ms": 66162.815, "learn_throughput": 7.738, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 672, "training_iteration": 21, "trial_id": "f4e01_00169", "date": "2024-02-27_00-27-49", "timestamp": 1708990069, "time_this_iter_s": 72.8150680065155, "time_total_s": 1517.9826464653015, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1517.9826464653015, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 52.87475728155339, "ram_util_percent": 20.703883495145636}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.32, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.106875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.106875, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.350283179680506, "policy_loss": -0.04459331224982937, "vf_loss": 6.902614820003509, "vf_explained_var": 0.9748161708315214, "kl": 0.0, "entropy": 95.09567464192709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.32, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.106875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.106875, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -60.0, -34.0, -52.0, -55.0, -62.0, -53.0, -54.0, -56.0, -46.0, -37.0, -40.0, -55.0, -43.0, -44.0, -55.0, -54.0, -61.0, -33.0, -48.0, -58.0, -62.0, -53.0, -27.0, -55.0, -50.0, -57.0, -58.0, -53.0, -56.0, -49.0, -39.0, -35.0, -61.0, -57.0, -60.0, -59.0, -57.0, -57.0, -60.0, -55.0, -64.0, -43.0, -32.0, -34.0, -55.0, -48.0, -46.0, -53.0, -64.0, -55.0, -53.0, -48.0, -63.0, -51.0, -47.0, -35.0, -50.0, -51.0, -28.0, -51.0, -50.0, -53.0, -52.0, -52.0, -50.0, -54.0, -23.0, -30.0, -46.0, -52.0, -48.0, -62.0, -53.0, -41.0, -39.0, -51.0, -61.0, -64.0, -55.0, -50.0, -43.0, -64.0, -30.0, -64.0, -46.0, -49.0, -54.0, -63.0, -44.0, -34.0, -64.0, -54.0, -50.0, -61.0, -31.0, -63.0, -36.0, -62.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3099192017930326, "mean_inference_ms": 9.76407252236572, "mean_action_processing_ms": 0.4600537522033315, "mean_env_wait_ms": 0.2940180257053444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2716383934020996, "StateBufferConnector_ms": 0.004468679428100586, "ViewRequirementAgentConnector_ms": 0.18996620178222656}}, "episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -60.0, -34.0, -52.0, -55.0, -62.0, -53.0, -54.0, -56.0, -46.0, -37.0, -40.0, -55.0, -43.0, -44.0, -55.0, -54.0, -61.0, -33.0, -48.0, -58.0, -62.0, -53.0, -27.0, -55.0, -50.0, -57.0, -58.0, -53.0, -56.0, -49.0, -39.0, -35.0, -61.0, -57.0, -60.0, -59.0, -57.0, -57.0, -60.0, -55.0, -64.0, -43.0, -32.0, -34.0, -55.0, -48.0, -46.0, -53.0, -64.0, -55.0, -53.0, -48.0, -63.0, -51.0, -47.0, -35.0, -50.0, -51.0, -28.0, -51.0, -50.0, -53.0, -52.0, -52.0, -50.0, -54.0, -23.0, -30.0, -46.0, -52.0, -48.0, -62.0, -53.0, -41.0, -39.0, -51.0, -61.0, -64.0, -55.0, -50.0, -43.0, -64.0, -30.0, -64.0, -46.0, -49.0, -54.0, -63.0, -44.0, -34.0, -64.0, -54.0, -50.0, -61.0, -31.0, -63.0, -36.0, -62.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3099192017930326, "mean_inference_ms": 9.76407252236572, "mean_action_processing_ms": 0.4600537522033315, "mean_env_wait_ms": 0.2940180257053444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2716383934020996, "StateBufferConnector_ms": 0.004468679428100586, "ViewRequirementAgentConnector_ms": 0.18996620178222656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.115768537565624, "num_agent_steps_trained_throughput_per_sec": 7.115768537565624, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 72147.677, "sample_time_ms": 6028.149, "load_time_ms": 0.32, "load_throughput": 1598424.747, "learn_time_ms": 66118.639, "learn_throughput": 7.744, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "episodes_total": 704, "training_iteration": 22, "trial_id": "f4e01_00169", "date": "2024-02-27_00-29-01", "timestamp": 1708990141, "time_this_iter_s": 71.95807957649231, "time_total_s": 1589.9407260417938, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1589.9407260417938, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 53.30679611650485, "ram_util_percent": 20.745631067961174}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.51, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.113203125, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.622965031862259, "policy_loss": -0.04937734439348181, "vf_loss": 5.767799095312754, "vf_explained_var": 0.9861026431123415, "kl": 0.0, "entropy": 94.82768955230713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.51, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.113203125, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-35.0, -61.0, -57.0, -60.0, -59.0, -57.0, -57.0, -60.0, -55.0, -64.0, -43.0, -32.0, -34.0, -55.0, -48.0, -46.0, -53.0, -64.0, -55.0, -53.0, -48.0, -63.0, -51.0, -47.0, -35.0, -50.0, -51.0, -28.0, -51.0, -50.0, -53.0, -52.0, -52.0, -50.0, -54.0, -23.0, -30.0, -46.0, -52.0, -48.0, -62.0, -53.0, -41.0, -39.0, -51.0, -61.0, -64.0, -55.0, -50.0, -43.0, -64.0, -30.0, -64.0, -46.0, -49.0, -54.0, -63.0, -44.0, -34.0, -64.0, -54.0, -50.0, -61.0, -31.0, -63.0, -36.0, -62.0, -60.0, -40.0, -56.0, -46.0, -50.0, -38.0, -63.0, -49.0, -61.0, -47.0, -54.0, -38.0, -37.0, -52.0, -40.0, -50.0, -59.0, -49.0, -56.0, -35.0, -56.0, -44.0, -50.0, -47.0, -42.0, -43.0, -56.0, -39.0, -50.0, -43.0, -31.0, -42.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3100459304579581, "mean_inference_ms": 9.765110199066783, "mean_action_processing_ms": 0.4601460976386835, "mean_env_wait_ms": 0.2940297485750287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2750735282897949, "StateBufferConnector_ms": 0.0044710636138916016, "ViewRequirementAgentConnector_ms": 0.1959214210510254}}, "episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35.0, -61.0, -57.0, -60.0, -59.0, -57.0, -57.0, -60.0, -55.0, -64.0, -43.0, -32.0, -34.0, -55.0, -48.0, -46.0, -53.0, -64.0, -55.0, -53.0, -48.0, -63.0, -51.0, -47.0, -35.0, -50.0, -51.0, -28.0, -51.0, -50.0, -53.0, -52.0, -52.0, -50.0, -54.0, -23.0, -30.0, -46.0, -52.0, -48.0, -62.0, -53.0, -41.0, -39.0, -51.0, -61.0, -64.0, -55.0, -50.0, -43.0, -64.0, -30.0, -64.0, -46.0, -49.0, -54.0, -63.0, -44.0, -34.0, -64.0, -54.0, -50.0, -61.0, -31.0, -63.0, -36.0, -62.0, -60.0, -40.0, -56.0, -46.0, -50.0, -38.0, -63.0, -49.0, -61.0, -47.0, -54.0, -38.0, -37.0, -52.0, -40.0, -50.0, -59.0, -49.0, -56.0, -35.0, -56.0, -44.0, -50.0, -47.0, -42.0, -43.0, -56.0, -39.0, -50.0, -43.0, -31.0, -42.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3100459304579581, "mean_inference_ms": 9.765110199066783, "mean_action_processing_ms": 0.4601460976386835, "mean_env_wait_ms": 0.2940297485750287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2750735282897949, "StateBufferConnector_ms": 0.0044710636138916016, "ViewRequirementAgentConnector_ms": 0.1959214210510254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.037569357945222, "num_agent_steps_trained_throughput_per_sec": 7.037569357945222, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 72194.255, "sample_time_ms": 6038.275, "load_time_ms": 0.299, "load_throughput": 1711960.816, "learn_time_ms": 66155.138, "learn_throughput": 7.739, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "done": false, "episodes_total": 736, "training_iteration": 23, "trial_id": "f4e01_00169", "date": "2024-02-27_00-30-14", "timestamp": 1708990214, "time_this_iter_s": 72.75762414932251, "time_total_s": 1662.6983501911163, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1662.6983501911163, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.90291262135921, "ram_util_percent": 20.516504854368936}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.67, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.119765625, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.96159681280454, "policy_loss": -0.03393755853176117, "vf_loss": 6.27540606657664, "vf_explained_var": 0.9883950382471085, "kl": 0.0, "entropy": 94.51255340576172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.67, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.67, "reward_total_min": -64, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.119765625, "reward_score_min": 0.0, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -50.0, -54.0, -23.0, -30.0, -46.0, -52.0, -48.0, -62.0, -53.0, -41.0, -39.0, -51.0, -61.0, -64.0, -55.0, -50.0, -43.0, -64.0, -30.0, -64.0, -46.0, -49.0, -54.0, -63.0, -44.0, -34.0, -64.0, -54.0, -50.0, -61.0, -31.0, -63.0, -36.0, -62.0, -60.0, -40.0, -56.0, -46.0, -50.0, -38.0, -63.0, -49.0, -61.0, -47.0, -54.0, -38.0, -37.0, -52.0, -40.0, -50.0, -59.0, -49.0, -56.0, -35.0, -56.0, -44.0, -50.0, -47.0, -42.0, -43.0, -56.0, -39.0, -50.0, -43.0, -31.0, -42.0, -58.0, -31.0, -56.0, -58.0, -48.0, -35.0, -63.0, -56.0, -59.0, -50.0, -40.0, -54.0, -55.0, -49.0, -42.0, -53.0, -63.0, -49.0, -34.0, -39.0, -42.0, -36.0, -40.0, -52.0, -64.0, -49.0, -62.0, -26.0, -42.0, -58.0, -31.0, -49.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3095078729972596, "mean_inference_ms": 9.762902831786596, "mean_action_processing_ms": 0.4601309391724847, "mean_env_wait_ms": 0.2938805126714522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27173948287963867, "StateBufferConnector_ms": 0.0044231414794921875, "ViewRequirementAgentConnector_ms": 0.19353532791137695}}, "episode_reward_max": -23.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.67, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -50.0, -54.0, -23.0, -30.0, -46.0, -52.0, -48.0, -62.0, -53.0, -41.0, -39.0, -51.0, -61.0, -64.0, -55.0, -50.0, -43.0, -64.0, -30.0, -64.0, -46.0, -49.0, -54.0, -63.0, -44.0, -34.0, -64.0, -54.0, -50.0, -61.0, -31.0, -63.0, -36.0, -62.0, -60.0, -40.0, -56.0, -46.0, -50.0, -38.0, -63.0, -49.0, -61.0, -47.0, -54.0, -38.0, -37.0, -52.0, -40.0, -50.0, -59.0, -49.0, -56.0, -35.0, -56.0, -44.0, -50.0, -47.0, -42.0, -43.0, -56.0, -39.0, -50.0, -43.0, -31.0, -42.0, -58.0, -31.0, -56.0, -58.0, -48.0, -35.0, -63.0, -56.0, -59.0, -50.0, -40.0, -54.0, -55.0, -49.0, -42.0, -53.0, -63.0, -49.0, -34.0, -39.0, -42.0, -36.0, -40.0, -52.0, -64.0, -49.0, -62.0, -26.0, -42.0, -58.0, -31.0, -49.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3095078729972596, "mean_inference_ms": 9.762902831786596, "mean_action_processing_ms": 0.4601309391724847, "mean_env_wait_ms": 0.2938805126714522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27173948287963867, "StateBufferConnector_ms": 0.0044231414794921875, "ViewRequirementAgentConnector_ms": 0.19353532791137695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.035970165057614, "num_agent_steps_trained_throughput_per_sec": 7.035970165057614, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 72316.47, "sample_time_ms": 6037.645, "load_time_ms": 0.297, "load_throughput": 1725440.823, "learn_time_ms": 66277.974, "learn_throughput": 7.725, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 768, "training_iteration": 24, "trial_id": "f4e01_00169", "date": "2024-02-27_00-31-27", "timestamp": 1708990287, "time_this_iter_s": 72.77429676055908, "time_total_s": 1735.4726469516754, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1735.4726469516754, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.02233009708737, "ram_util_percent": 20.461165048543684}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.0, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.1171875, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.073670760790507, "policy_loss": -0.05821754531934857, "vf_loss": 6.489564224084218, "vf_explained_var": 0.9881757711370786, "kl": 0.0, "entropy": 95.02526149749755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.0, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.1171875, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -36.0, -62.0, -60.0, -40.0, -56.0, -46.0, -50.0, -38.0, -63.0, -49.0, -61.0, -47.0, -54.0, -38.0, -37.0, -52.0, -40.0, -50.0, -59.0, -49.0, -56.0, -35.0, -56.0, -44.0, -50.0, -47.0, -42.0, -43.0, -56.0, -39.0, -50.0, -43.0, -31.0, -42.0, -58.0, -31.0, -56.0, -58.0, -48.0, -35.0, -63.0, -56.0, -59.0, -50.0, -40.0, -54.0, -55.0, -49.0, -42.0, -53.0, -63.0, -49.0, -34.0, -39.0, -42.0, -36.0, -40.0, -52.0, -64.0, -49.0, -62.0, -26.0, -42.0, -58.0, -31.0, -49.0, -58.0, -44.0, -53.0, -36.0, -61.0, -49.0, -48.0, -64.0, -62.0, -50.0, -52.0, -53.0, -60.0, -39.0, -61.0, -39.0, -61.0, -51.0, -53.0, -48.0, -60.0, -58.0, -42.0, -36.0, -51.0, -62.0, -33.0, -43.0, -62.0, -52.0, -49.0, -55.0, -28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.310306404138742, "mean_inference_ms": 9.766024568186161, "mean_action_processing_ms": 0.46041610080298845, "mean_env_wait_ms": 0.2939734539854978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2790508270263672, "StateBufferConnector_ms": 0.004556894302368164, "ViewRequirementAgentConnector_ms": 0.20087552070617676}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -36.0, -62.0, -60.0, -40.0, -56.0, -46.0, -50.0, -38.0, -63.0, -49.0, -61.0, -47.0, -54.0, -38.0, -37.0, -52.0, -40.0, -50.0, -59.0, -49.0, -56.0, -35.0, -56.0, -44.0, -50.0, -47.0, -42.0, -43.0, -56.0, -39.0, -50.0, -43.0, -31.0, -42.0, -58.0, -31.0, -56.0, -58.0, -48.0, -35.0, -63.0, -56.0, -59.0, -50.0, -40.0, -54.0, -55.0, -49.0, -42.0, -53.0, -63.0, -49.0, -34.0, -39.0, -42.0, -36.0, -40.0, -52.0, -64.0, -49.0, -62.0, -26.0, -42.0, -58.0, -31.0, -49.0, -58.0, -44.0, -53.0, -36.0, -61.0, -49.0, -48.0, -64.0, -62.0, -50.0, -52.0, -53.0, -60.0, -39.0, -61.0, -39.0, -61.0, -51.0, -53.0, -48.0, -60.0, -58.0, -42.0, -36.0, -51.0, -62.0, -33.0, -43.0, -62.0, -52.0, -49.0, -55.0, -28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.310306404138742, "mean_inference_ms": 9.766024568186161, "mean_action_processing_ms": 0.46041610080298845, "mean_env_wait_ms": 0.2939734539854978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2790508270263672, "StateBufferConnector_ms": 0.004556894302368164, "ViewRequirementAgentConnector_ms": 0.20087552070617676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0556404022168175, "num_agent_steps_trained_throughput_per_sec": 7.0556404022168175, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 72381.194, "sample_time_ms": 6045.723, "load_time_ms": 0.298, "load_throughput": 1715379.541, "learn_time_ms": 66334.6, "learn_throughput": 7.718, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 800, "training_iteration": 25, "trial_id": "f4e01_00169", "date": "2024-02-27_00-32-39", "timestamp": 1708990359, "time_this_iter_s": 72.57153081893921, "time_total_s": 1808.0441777706146, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1808.0441777706146, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 53.03009708737864, "ram_util_percent": 20.553398058252423}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.34, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.12234375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.163992899656296, "policy_loss": -0.0500031969199578, "vf_loss": 6.618523112932841, "vf_explained_var": 0.9843110377589862, "kl": 0.0, "entropy": 94.57424418131511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.34, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.12234375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -31.0, -42.0, -58.0, -31.0, -56.0, -58.0, -48.0, -35.0, -63.0, -56.0, -59.0, -50.0, -40.0, -54.0, -55.0, -49.0, -42.0, -53.0, -63.0, -49.0, -34.0, -39.0, -42.0, -36.0, -40.0, -52.0, -64.0, -49.0, -62.0, -26.0, -42.0, -58.0, -31.0, -49.0, -58.0, -44.0, -53.0, -36.0, -61.0, -49.0, -48.0, -64.0, -62.0, -50.0, -52.0, -53.0, -60.0, -39.0, -61.0, -39.0, -61.0, -51.0, -53.0, -48.0, -60.0, -58.0, -42.0, -36.0, -51.0, -62.0, -33.0, -43.0, -62.0, -52.0, -49.0, -55.0, -28.0, -35.0, -63.0, -51.0, -32.0, -56.0, -46.0, -52.0, -55.0, -57.0, -55.0, -52.0, -53.0, -57.0, -38.0, -33.0, -43.0, -47.0, -54.0, -58.0, -50.0, -30.0, -29.0, -43.0, -48.0, -45.0, -52.0, -54.0, -35.0, -45.0, -45.0, -32.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3109304816169756, "mean_inference_ms": 9.767808199869279, "mean_action_processing_ms": 0.46057673062223814, "mean_env_wait_ms": 0.29400515866570187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27741193771362305, "StateBufferConnector_ms": 0.004519462585449219, "ViewRequirementAgentConnector_ms": 0.19869112968444824}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -31.0, -42.0, -58.0, -31.0, -56.0, -58.0, -48.0, -35.0, -63.0, -56.0, -59.0, -50.0, -40.0, -54.0, -55.0, -49.0, -42.0, -53.0, -63.0, -49.0, -34.0, -39.0, -42.0, -36.0, -40.0, -52.0, -64.0, -49.0, -62.0, -26.0, -42.0, -58.0, -31.0, -49.0, -58.0, -44.0, -53.0, -36.0, -61.0, -49.0, -48.0, -64.0, -62.0, -50.0, -52.0, -53.0, -60.0, -39.0, -61.0, -39.0, -61.0, -51.0, -53.0, -48.0, -60.0, -58.0, -42.0, -36.0, -51.0, -62.0, -33.0, -43.0, -62.0, -52.0, -49.0, -55.0, -28.0, -35.0, -63.0, -51.0, -32.0, -56.0, -46.0, -52.0, -55.0, -57.0, -55.0, -52.0, -53.0, -57.0, -38.0, -33.0, -43.0, -47.0, -54.0, -58.0, -50.0, -30.0, -29.0, -43.0, -48.0, -45.0, -52.0, -54.0, -35.0, -45.0, -45.0, -32.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3109304816169756, "mean_inference_ms": 9.767808199869279, "mean_action_processing_ms": 0.46057673062223814, "mean_env_wait_ms": 0.29400515866570187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27741193771362305, "StateBufferConnector_ms": 0.004519462585449219, "ViewRequirementAgentConnector_ms": 0.19869112968444824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.042344812060193, "num_agent_steps_trained_throughput_per_sec": 7.042344812060193, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 72412.428, "sample_time_ms": 6062.069, "load_time_ms": 0.302, "load_throughput": 1696676.66, "learn_time_ms": 66349.459, "learn_throughput": 7.717, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "episodes_total": 832, "training_iteration": 26, "trial_id": "f4e01_00169", "date": "2024-02-27_00-33-52", "timestamp": 1708990432, "time_this_iter_s": 72.70866417884827, "time_total_s": 1880.752841949463, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1880.752841949463, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 52.95048543689321, "ram_util_percent": 20.76407766990292}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.99, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.109453125, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.3689794222513836, "policy_loss": -0.04871470642586549, "vf_loss": 5.3678473174571995, "vf_explained_var": 0.9911927004655202, "kl": 0.0, "entropy": 94.71076488494873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.99, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.109453125, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -31.0, -49.0, -58.0, -44.0, -53.0, -36.0, -61.0, -49.0, -48.0, -64.0, -62.0, -50.0, -52.0, -53.0, -60.0, -39.0, -61.0, -39.0, -61.0, -51.0, -53.0, -48.0, -60.0, -58.0, -42.0, -36.0, -51.0, -62.0, -33.0, -43.0, -62.0, -52.0, -49.0, -55.0, -28.0, -35.0, -63.0, -51.0, -32.0, -56.0, -46.0, -52.0, -55.0, -57.0, -55.0, -52.0, -53.0, -57.0, -38.0, -33.0, -43.0, -47.0, -54.0, -58.0, -50.0, -30.0, -29.0, -43.0, -48.0, -45.0, -52.0, -54.0, -35.0, -45.0, -45.0, -32.0, -57.0, -46.0, -61.0, -63.0, -63.0, -44.0, -26.0, -31.0, -46.0, -56.0, -58.0, -62.0, -58.0, -41.0, -58.0, -49.0, -51.0, -63.0, -49.0, -54.0, -63.0, -61.0, -51.0, -63.0, -50.0, -59.0, -52.0, -50.0, -45.0, -48.0, -64.0, -55.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3110787516524889, "mean_inference_ms": 9.76654827363178, "mean_action_processing_ms": 0.4603382547281224, "mean_env_wait_ms": 0.293842414880692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2744123935699463, "StateBufferConnector_ms": 0.0044460296630859375, "ViewRequirementAgentConnector_ms": 0.19311237335205078}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -31.0, -49.0, -58.0, -44.0, -53.0, -36.0, -61.0, -49.0, -48.0, -64.0, -62.0, -50.0, -52.0, -53.0, -60.0, -39.0, -61.0, -39.0, -61.0, -51.0, -53.0, -48.0, -60.0, -58.0, -42.0, -36.0, -51.0, -62.0, -33.0, -43.0, -62.0, -52.0, -49.0, -55.0, -28.0, -35.0, -63.0, -51.0, -32.0, -56.0, -46.0, -52.0, -55.0, -57.0, -55.0, -52.0, -53.0, -57.0, -38.0, -33.0, -43.0, -47.0, -54.0, -58.0, -50.0, -30.0, -29.0, -43.0, -48.0, -45.0, -52.0, -54.0, -35.0, -45.0, -45.0, -32.0, -57.0, -46.0, -61.0, -63.0, -63.0, -44.0, -26.0, -31.0, -46.0, -56.0, -58.0, -62.0, -58.0, -41.0, -58.0, -49.0, -51.0, -63.0, -49.0, -54.0, -63.0, -61.0, -51.0, -63.0, -50.0, -59.0, -52.0, -50.0, -45.0, -48.0, -64.0, -55.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3110787516524889, "mean_inference_ms": 9.76654827363178, "mean_action_processing_ms": 0.4603382547281224, "mean_env_wait_ms": 0.293842414880692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2744123935699463, "StateBufferConnector_ms": 0.0044460296630859375, "ViewRequirementAgentConnector_ms": 0.19311237335205078}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.060760962431889, "num_agent_steps_trained_throughput_per_sec": 7.060760962431889, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 72473.015, "sample_time_ms": 6044.906, "load_time_ms": 0.305, "load_throughput": 1678377.216, "learn_time_ms": 66427.191, "learn_throughput": 7.708, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "done": false, "episodes_total": 864, "training_iteration": 27, "trial_id": "f4e01_00169", "date": "2024-02-27_00-35-05", "timestamp": 1708990505, "time_this_iter_s": 72.51912784576416, "time_total_s": 1953.271969795227, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1953.271969795227, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 52.77864077669903, "ram_util_percent": 20.91553398058253}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.19, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.115703125, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.756730314095815, "policy_loss": -0.04643344609066844, "vf_loss": 5.97326781352361, "vf_explained_var": 0.9947791347901026, "kl": 0.0, "entropy": 94.32446161905925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.19, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.19, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.115703125, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -49.0, -55.0, -28.0, -35.0, -63.0, -51.0, -32.0, -56.0, -46.0, -52.0, -55.0, -57.0, -55.0, -52.0, -53.0, -57.0, -38.0, -33.0, -43.0, -47.0, -54.0, -58.0, -50.0, -30.0, -29.0, -43.0, -48.0, -45.0, -52.0, -54.0, -35.0, -45.0, -45.0, -32.0, -57.0, -46.0, -61.0, -63.0, -63.0, -44.0, -26.0, -31.0, -46.0, -56.0, -58.0, -62.0, -58.0, -41.0, -58.0, -49.0, -51.0, -63.0, -49.0, -54.0, -63.0, -61.0, -51.0, -63.0, -50.0, -59.0, -52.0, -50.0, -45.0, -48.0, -64.0, -55.0, -46.0, -60.0, -60.0, -34.0, -45.0, -35.0, -53.0, -32.0, -63.0, -61.0, -38.0, -34.0, -63.0, -35.0, -55.0, -64.0, -63.0, -31.0, -61.0, -56.0, -58.0, -50.0, -27.0, -51.0, -28.0, -63.0, -44.0, -57.0, -50.0, -43.0, -55.0, -53.0, -25.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3092589986321945, "mean_inference_ms": 9.757334353925067, "mean_action_processing_ms": 0.45951877082625264, "mean_env_wait_ms": 0.29317560258707887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2605745792388916, "StateBufferConnector_ms": 0.004237651824951172, "ViewRequirementAgentConnector_ms": 0.17842435836791992}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.19, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -49.0, -55.0, -28.0, -35.0, -63.0, -51.0, -32.0, -56.0, -46.0, -52.0, -55.0, -57.0, -55.0, -52.0, -53.0, -57.0, -38.0, -33.0, -43.0, -47.0, -54.0, -58.0, -50.0, -30.0, -29.0, -43.0, -48.0, -45.0, -52.0, -54.0, -35.0, -45.0, -45.0, -32.0, -57.0, -46.0, -61.0, -63.0, -63.0, -44.0, -26.0, -31.0, -46.0, -56.0, -58.0, -62.0, -58.0, -41.0, -58.0, -49.0, -51.0, -63.0, -49.0, -54.0, -63.0, -61.0, -51.0, -63.0, -50.0, -59.0, -52.0, -50.0, -45.0, -48.0, -64.0, -55.0, -46.0, -60.0, -60.0, -34.0, -45.0, -35.0, -53.0, -32.0, -63.0, -61.0, -38.0, -34.0, -63.0, -35.0, -55.0, -64.0, -63.0, -31.0, -61.0, -56.0, -58.0, -50.0, -27.0, -51.0, -28.0, -63.0, -44.0, -57.0, -50.0, -43.0, -55.0, -53.0, -25.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3092589986321945, "mean_inference_ms": 9.757334353925067, "mean_action_processing_ms": 0.45951877082625264, "mean_env_wait_ms": 0.29317560258707887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2605745792388916, "StateBufferConnector_ms": 0.004237651824951172, "ViewRequirementAgentConnector_ms": 0.17842435836791992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.087680379703741, "num_agent_steps_trained_throughput_per_sec": 7.087680379703741, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 72502.651, "sample_time_ms": 6032.014, "load_time_ms": 0.305, "load_throughput": 1680873.237, "learn_time_ms": 66469.709, "learn_throughput": 7.703, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "episodes_total": 896, "training_iteration": 28, "trial_id": "f4e01_00169", "date": "2024-02-27_00-36-17", "timestamp": 1708990577, "time_this_iter_s": 72.24328351020813, "time_total_s": 2025.5152533054352, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2025.5152533054352, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 53.83039215686274, "ram_util_percent": 20.737254901960775}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.74, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.10359375, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.4017169773578644, "policy_loss": -0.05437263908485571, "vf_loss": 5.42815150419871, "vf_explained_var": 0.9869791756073634, "kl": 0.0, "entropy": 94.4708662033081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.74, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.10359375, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -45.0, -32.0, -57.0, -46.0, -61.0, -63.0, -63.0, -44.0, -26.0, -31.0, -46.0, -56.0, -58.0, -62.0, -58.0, -41.0, -58.0, -49.0, -51.0, -63.0, -49.0, -54.0, -63.0, -61.0, -51.0, -63.0, -50.0, -59.0, -52.0, -50.0, -45.0, -48.0, -64.0, -55.0, -46.0, -60.0, -60.0, -34.0, -45.0, -35.0, -53.0, -32.0, -63.0, -61.0, -38.0, -34.0, -63.0, -35.0, -55.0, -64.0, -63.0, -31.0, -61.0, -56.0, -58.0, -50.0, -27.0, -51.0, -28.0, -63.0, -44.0, -57.0, -50.0, -43.0, -55.0, -53.0, -25.0, -56.0, -45.0, -26.0, -47.0, -53.0, -45.0, -55.0, -50.0, -51.0, -57.0, -54.0, -59.0, -63.0, -47.0, -53.0, -54.0, -63.0, -48.0, -49.0, -62.0, -50.0, -59.0, -50.0, -59.0, -58.0, -46.0, -62.0, -62.0, -50.0, -46.0, -27.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3076205281237352, "mean_inference_ms": 9.749279746858711, "mean_action_processing_ms": 0.4588103079600897, "mean_env_wait_ms": 0.29256176851437343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2614161968231201, "StateBufferConnector_ms": 0.004247903823852539, "ViewRequirementAgentConnector_ms": 0.18189644813537598}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -45.0, -32.0, -57.0, -46.0, -61.0, -63.0, -63.0, -44.0, -26.0, -31.0, -46.0, -56.0, -58.0, -62.0, -58.0, -41.0, -58.0, -49.0, -51.0, -63.0, -49.0, -54.0, -63.0, -61.0, -51.0, -63.0, -50.0, -59.0, -52.0, -50.0, -45.0, -48.0, -64.0, -55.0, -46.0, -60.0, -60.0, -34.0, -45.0, -35.0, -53.0, -32.0, -63.0, -61.0, -38.0, -34.0, -63.0, -35.0, -55.0, -64.0, -63.0, -31.0, -61.0, -56.0, -58.0, -50.0, -27.0, -51.0, -28.0, -63.0, -44.0, -57.0, -50.0, -43.0, -55.0, -53.0, -25.0, -56.0, -45.0, -26.0, -47.0, -53.0, -45.0, -55.0, -50.0, -51.0, -57.0, -54.0, -59.0, -63.0, -47.0, -53.0, -54.0, -63.0, -48.0, -49.0, -62.0, -50.0, -59.0, -50.0, -59.0, -58.0, -46.0, -62.0, -62.0, -50.0, -46.0, -27.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3076205281237352, "mean_inference_ms": 9.749279746858711, "mean_action_processing_ms": 0.4588103079600897, "mean_env_wait_ms": 0.29256176851437343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2614161968231201, "StateBufferConnector_ms": 0.004247903823852539, "ViewRequirementAgentConnector_ms": 0.18189644813537598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1381071782106895, "num_agent_steps_trained_throughput_per_sec": 7.1381071782106895, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 72437.647, "sample_time_ms": 6044.032, "load_time_ms": 0.302, "load_throughput": 1696408.601, "learn_time_ms": 66392.697, "learn_throughput": 7.712, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "done": false, "episodes_total": 928, "training_iteration": 29, "trial_id": "f4e01_00169", "date": "2024-02-27_00-37-29", "timestamp": 1708990649, "time_this_iter_s": 71.73298501968384, "time_total_s": 2097.248238325119, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2097.248238325119, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 53.17647058823528, "ram_util_percent": 20.682352941176465}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.81, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.103046875, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.87687663435936, "policy_loss": -0.053021235205233094, "vf_loss": 6.172317107518514, "vf_explained_var": 0.9947263856728872, "kl": 0.0, "entropy": 94.49067974090576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.81, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.103046875, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -64.0, -55.0, -46.0, -60.0, -60.0, -34.0, -45.0, -35.0, -53.0, -32.0, -63.0, -61.0, -38.0, -34.0, -63.0, -35.0, -55.0, -64.0, -63.0, -31.0, -61.0, -56.0, -58.0, -50.0, -27.0, -51.0, -28.0, -63.0, -44.0, -57.0, -50.0, -43.0, -55.0, -53.0, -25.0, -56.0, -45.0, -26.0, -47.0, -53.0, -45.0, -55.0, -50.0, -51.0, -57.0, -54.0, -59.0, -63.0, -47.0, -53.0, -54.0, -63.0, -48.0, -49.0, -62.0, -50.0, -59.0, -50.0, -59.0, -58.0, -46.0, -62.0, -62.0, -50.0, -46.0, -27.0, -56.0, -56.0, -61.0, -45.0, -49.0, -33.0, -45.0, -51.0, -59.0, -63.0, -52.0, -53.0, -62.0, -33.0, -51.0, -54.0, -49.0, -38.0, -61.0, -64.0, -47.0, -64.0, -61.0, -46.0, -45.0, -63.0, -52.0, -63.0, -51.0, -63.0, -40.0, -33.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3064972297654116, "mean_inference_ms": 9.74477912876216, "mean_action_processing_ms": 0.45841407992814714, "mean_env_wait_ms": 0.29221052261358577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26491785049438477, "StateBufferConnector_ms": 0.004313468933105469, "ViewRequirementAgentConnector_ms": 0.186539888381958}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -64.0, -55.0, -46.0, -60.0, -60.0, -34.0, -45.0, -35.0, -53.0, -32.0, -63.0, -61.0, -38.0, -34.0, -63.0, -35.0, -55.0, -64.0, -63.0, -31.0, -61.0, -56.0, -58.0, -50.0, -27.0, -51.0, -28.0, -63.0, -44.0, -57.0, -50.0, -43.0, -55.0, -53.0, -25.0, -56.0, -45.0, -26.0, -47.0, -53.0, -45.0, -55.0, -50.0, -51.0, -57.0, -54.0, -59.0, -63.0, -47.0, -53.0, -54.0, -63.0, -48.0, -49.0, -62.0, -50.0, -59.0, -50.0, -59.0, -58.0, -46.0, -62.0, -62.0, -50.0, -46.0, -27.0, -56.0, -56.0, -61.0, -45.0, -49.0, -33.0, -45.0, -51.0, -59.0, -63.0, -52.0, -53.0, -62.0, -33.0, -51.0, -54.0, -49.0, -38.0, -61.0, -64.0, -47.0, -64.0, -61.0, -46.0, -45.0, -63.0, -52.0, -63.0, -51.0, -63.0, -40.0, -33.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3064972297654116, "mean_inference_ms": 9.74477912876216, "mean_action_processing_ms": 0.45841407992814714, "mean_env_wait_ms": 0.29221052261358577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26491785049438477, "StateBufferConnector_ms": 0.004313468933105469, "ViewRequirementAgentConnector_ms": 0.186539888381958}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.059863621792517, "num_agent_steps_trained_throughput_per_sec": 7.059863621792517, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 72455.439, "sample_time_ms": 6046.696, "load_time_ms": 0.303, "load_throughput": 1688804.379, "learn_time_ms": 66407.818, "learn_throughput": 7.71, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 960, "training_iteration": 30, "trial_id": "f4e01_00169", "date": "2024-02-27_00-38-41", "timestamp": 1708990721, "time_this_iter_s": 72.52793526649475, "time_total_s": 2169.7761735916138, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2169.7761735916138, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 52.619607843137246, "ram_util_percent": 20.636274509803922}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.01, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.093671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.093671875, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9368489178518454, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.975290856758753, "policy_loss": 0.09722117458780606, "vf_loss": 9.232125433286031, "vf_explained_var": 0.9628489236036937, "kl": 0.0, "entropy": 95.40460611979167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.01, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.01, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.093671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.093671875, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -55.0, -53.0, -25.0, -56.0, -45.0, -26.0, -47.0, -53.0, -45.0, -55.0, -50.0, -51.0, -57.0, -54.0, -59.0, -63.0, -47.0, -53.0, -54.0, -63.0, -48.0, -49.0, -62.0, -50.0, -59.0, -50.0, -59.0, -58.0, -46.0, -62.0, -62.0, -50.0, -46.0, -27.0, -56.0, -56.0, -61.0, -45.0, -49.0, -33.0, -45.0, -51.0, -59.0, -63.0, -52.0, -53.0, -62.0, -33.0, -51.0, -54.0, -49.0, -38.0, -61.0, -64.0, -47.0, -64.0, -61.0, -46.0, -45.0, -63.0, -52.0, -63.0, -51.0, -63.0, -40.0, -33.0, -52.0, -39.0, -38.0, -43.0, -58.0, -46.0, -54.0, -63.0, -57.0, -60.0, -51.0, -42.0, -62.0, -52.0, -53.0, -43.0, -52.0, -50.0, -56.0, -59.0, -56.0, -62.0, -39.0, -63.0, -56.0, -52.0, -60.0, -64.0, -61.0, -56.0, -63.0, -49.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3060061369116698, "mean_inference_ms": 9.744106131767142, "mean_action_processing_ms": 0.458309387991128, "mean_env_wait_ms": 0.29220259761706335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703514099121094, "StateBufferConnector_ms": 0.004411458969116211, "ViewRequirementAgentConnector_ms": 0.19240307807922363}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.01, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -55.0, -53.0, -25.0, -56.0, -45.0, -26.0, -47.0, -53.0, -45.0, -55.0, -50.0, -51.0, -57.0, -54.0, -59.0, -63.0, -47.0, -53.0, -54.0, -63.0, -48.0, -49.0, -62.0, -50.0, -59.0, -50.0, -59.0, -58.0, -46.0, -62.0, -62.0, -50.0, -46.0, -27.0, -56.0, -56.0, -61.0, -45.0, -49.0, -33.0, -45.0, -51.0, -59.0, -63.0, -52.0, -53.0, -62.0, -33.0, -51.0, -54.0, -49.0, -38.0, -61.0, -64.0, -47.0, -64.0, -61.0, -46.0, -45.0, -63.0, -52.0, -63.0, -51.0, -63.0, -40.0, -33.0, -52.0, -39.0, -38.0, -43.0, -58.0, -46.0, -54.0, -63.0, -57.0, -60.0, -51.0, -42.0, -62.0, -52.0, -53.0, -43.0, -52.0, -50.0, -56.0, -59.0, -56.0, -62.0, -39.0, -63.0, -56.0, -52.0, -60.0, -64.0, -61.0, -56.0, -63.0, -49.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3060061369116698, "mean_inference_ms": 9.744106131767142, "mean_action_processing_ms": 0.458309387991128, "mean_env_wait_ms": 0.29220259761706335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703514099121094, "StateBufferConnector_ms": 0.004411458969116211, "ViewRequirementAgentConnector_ms": 0.19240307807922363}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.108132703780893, "num_agent_steps_trained_throughput_per_sec": 7.108132703780893, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 72377.482, "sample_time_ms": 6022.111, "load_time_ms": 0.304, "load_throughput": 1685887.618, "learn_time_ms": 66354.457, "learn_throughput": 7.716, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "done": false, "episodes_total": 992, "training_iteration": 31, "trial_id": "f4e01_00169", "date": "2024-02-27_00-39-53", "timestamp": 1708990793, "time_this_iter_s": 72.03525376319885, "time_total_s": 2241.8114273548126, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2241.8114273548126, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 52.5990291262136, "ram_util_percent": 20.666990291262124}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.7, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.09609375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.136069136857986, "policy_loss": 0.10444822609424591, "vf_loss": 6.332083777586619, "vf_explained_var": 0.9846267784635226, "kl": 0.0, "entropy": 95.61907679239908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.7, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.09609375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -46.0, -27.0, -56.0, -56.0, -61.0, -45.0, -49.0, -33.0, -45.0, -51.0, -59.0, -63.0, -52.0, -53.0, -62.0, -33.0, -51.0, -54.0, -49.0, -38.0, -61.0, -64.0, -47.0, -64.0, -61.0, -46.0, -45.0, -63.0, -52.0, -63.0, -51.0, -63.0, -40.0, -33.0, -52.0, -39.0, -38.0, -43.0, -58.0, -46.0, -54.0, -63.0, -57.0, -60.0, -51.0, -42.0, -62.0, -52.0, -53.0, -43.0, -52.0, -50.0, -56.0, -59.0, -56.0, -62.0, -39.0, -63.0, -56.0, -52.0, -60.0, -64.0, -61.0, -56.0, -63.0, -49.0, -45.0, -59.0, -60.0, -55.0, -64.0, -61.0, -45.0, -46.0, -54.0, -50.0, -63.0, -48.0, -62.0, -39.0, -51.0, -45.0, -44.0, -48.0, -50.0, -55.0, -61.0, -40.0, -46.0, -46.0, -62.0, -53.0, -54.0, -41.0, -50.0, -49.0, -39.0, -40.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3062966108726226, "mean_inference_ms": 9.746308037089358, "mean_action_processing_ms": 0.4584377066294066, "mean_env_wait_ms": 0.29232499180937827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.274890661239624, "StateBufferConnector_ms": 0.004460811614990234, "ViewRequirementAgentConnector_ms": 0.19788217544555664}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -46.0, -27.0, -56.0, -56.0, -61.0, -45.0, -49.0, -33.0, -45.0, -51.0, -59.0, -63.0, -52.0, -53.0, -62.0, -33.0, -51.0, -54.0, -49.0, -38.0, -61.0, -64.0, -47.0, -64.0, -61.0, -46.0, -45.0, -63.0, -52.0, -63.0, -51.0, -63.0, -40.0, -33.0, -52.0, -39.0, -38.0, -43.0, -58.0, -46.0, -54.0, -63.0, -57.0, -60.0, -51.0, -42.0, -62.0, -52.0, -53.0, -43.0, -52.0, -50.0, -56.0, -59.0, -56.0, -62.0, -39.0, -63.0, -56.0, -52.0, -60.0, -64.0, -61.0, -56.0, -63.0, -49.0, -45.0, -59.0, -60.0, -55.0, -64.0, -61.0, -45.0, -46.0, -54.0, -50.0, -63.0, -48.0, -62.0, -39.0, -51.0, -45.0, -44.0, -48.0, -50.0, -55.0, -61.0, -40.0, -46.0, -46.0, -62.0, -53.0, -54.0, -41.0, -50.0, -49.0, -39.0, -40.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3062966108726226, "mean_inference_ms": 9.746308037089358, "mean_action_processing_ms": 0.4584377066294066, "mean_env_wait_ms": 0.29232499180937827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.274890661239624, "StateBufferConnector_ms": 0.004460811614990234, "ViewRequirementAgentConnector_ms": 0.19788217544555664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.044496772287052, "num_agent_steps_trained_throughput_per_sec": 7.044496772287052, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 72450.279, "sample_time_ms": 6054.383, "load_time_ms": 0.304, "load_throughput": 1684961.67, "learn_time_ms": 66395.002, "learn_throughput": 7.711, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 1024, "training_iteration": 32, "trial_id": "f4e01_00169", "date": "2024-02-27_00-41-10", "timestamp": 1708990870, "time_this_iter_s": 72.68594098091125, "time_total_s": 2314.497368335724, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2314.497368335724, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 53.920183486238535, "ram_util_percent": 20.73761467889909}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.81, "reward_total_min": -64, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.095234375, "reward_score_min": 0.0, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.0616555114587145, "policy_loss": -0.051969772949814794, "vf_loss": 6.460880243778229, "vf_explained_var": 0.9908167257905006, "kl": 0.0, "entropy": 94.34409077962239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "sampler_results": {"episode_reward_max": -33.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.81, "reward_total_min": -64, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.095234375, "reward_score_min": 0.0, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -40.0, -33.0, -52.0, -39.0, -38.0, -43.0, -58.0, -46.0, -54.0, -63.0, -57.0, -60.0, -51.0, -42.0, -62.0, -52.0, -53.0, -43.0, -52.0, -50.0, -56.0, -59.0, -56.0, -62.0, -39.0, -63.0, -56.0, -52.0, -60.0, -64.0, -61.0, -56.0, -63.0, -49.0, -45.0, -59.0, -60.0, -55.0, -64.0, -61.0, -45.0, -46.0, -54.0, -50.0, -63.0, -48.0, -62.0, -39.0, -51.0, -45.0, -44.0, -48.0, -50.0, -55.0, -61.0, -40.0, -46.0, -46.0, -62.0, -53.0, -54.0, -41.0, -50.0, -49.0, -39.0, -40.0, -48.0, -47.0, -62.0, -48.0, -43.0, -42.0, -54.0, -54.0, -56.0, -51.0, -54.0, -52.0, -60.0, -62.0, -48.0, -61.0, -44.0, -51.0, -52.0, -59.0, -45.0, -62.0, -52.0, -63.0, -47.0, -51.0, -64.0, -42.0, -54.0, -41.0, -53.0, -37.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3067902438876056, "mean_inference_ms": 9.74834784903145, "mean_action_processing_ms": 0.4585531978798409, "mean_env_wait_ms": 0.29242300126154647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2757742404937744, "StateBufferConnector_ms": 0.004477262496948242, "ViewRequirementAgentConnector_ms": 0.20139479637145996}}, "episode_reward_max": -33.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -40.0, -33.0, -52.0, -39.0, -38.0, -43.0, -58.0, -46.0, -54.0, -63.0, -57.0, -60.0, -51.0, -42.0, -62.0, -52.0, -53.0, -43.0, -52.0, -50.0, -56.0, -59.0, -56.0, -62.0, -39.0, -63.0, -56.0, -52.0, -60.0, -64.0, -61.0, -56.0, -63.0, -49.0, -45.0, -59.0, -60.0, -55.0, -64.0, -61.0, -45.0, -46.0, -54.0, -50.0, -63.0, -48.0, -62.0, -39.0, -51.0, -45.0, -44.0, -48.0, -50.0, -55.0, -61.0, -40.0, -46.0, -46.0, -62.0, -53.0, -54.0, -41.0, -50.0, -49.0, -39.0, -40.0, -48.0, -47.0, -62.0, -48.0, -43.0, -42.0, -54.0, -54.0, -56.0, -51.0, -54.0, -52.0, -60.0, -62.0, -48.0, -61.0, -44.0, -51.0, -52.0, -59.0, -45.0, -62.0, -52.0, -63.0, -47.0, -51.0, -64.0, -42.0, -54.0, -41.0, -53.0, -37.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3067902438876056, "mean_inference_ms": 9.74834784903145, "mean_action_processing_ms": 0.4585531978798409, "mean_env_wait_ms": 0.29242300126154647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2757742404937744, "StateBufferConnector_ms": 0.004477262496948242, "ViewRequirementAgentConnector_ms": 0.20139479637145996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.094658188824204, "num_agent_steps_trained_throughput_per_sec": 7.094658188824204, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 72391.737, "sample_time_ms": 6052.874, "load_time_ms": 0.302, "load_throughput": 1694935.792, "learn_time_ms": 66337.964, "learn_throughput": 7.718, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "done": false, "episodes_total": 1056, "training_iteration": 33, "trial_id": "f4e01_00169", "date": "2024-02-27_00-42-23", "timestamp": 1708990943, "time_this_iter_s": 72.17242336273193, "time_total_s": 2386.669791698456, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2386.669791698456, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 53.07450980392157, "ram_util_percent": 20.71176470588235}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.74, "reward_total_min": -64, "reward_total_max": -35, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2265625, "reward_score_mean": 0.10359375, "reward_score_min": 0.0, "reward_score_max": 0.2265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.7572085241476696, "policy_loss": -0.049322162630657355, "vf_loss": 5.978555921713511, "vf_explained_var": 0.9913100262482961, "kl": 0.0, "entropy": 94.50551478068034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "sampler_results": {"episode_reward_max": -35.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.74, "reward_total_min": -64, "reward_total_max": -35, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2265625, "reward_score_mean": 0.10359375, "reward_score_min": 0.0, "reward_score_max": 0.2265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-56.0, -63.0, -49.0, -45.0, -59.0, -60.0, -55.0, -64.0, -61.0, -45.0, -46.0, -54.0, -50.0, -63.0, -48.0, -62.0, -39.0, -51.0, -45.0, -44.0, -48.0, -50.0, -55.0, -61.0, -40.0, -46.0, -46.0, -62.0, -53.0, -54.0, -41.0, -50.0, -49.0, -39.0, -40.0, -48.0, -47.0, -62.0, -48.0, -43.0, -42.0, -54.0, -54.0, -56.0, -51.0, -54.0, -52.0, -60.0, -62.0, -48.0, -61.0, -44.0, -51.0, -52.0, -59.0, -45.0, -62.0, -52.0, -63.0, -47.0, -51.0, -64.0, -42.0, -54.0, -41.0, -53.0, -37.0, -50.0, -56.0, -36.0, -51.0, -44.0, -64.0, -42.0, -46.0, -35.0, -64.0, -59.0, -46.0, -46.0, -47.0, -44.0, -61.0, -63.0, -43.0, -45.0, -61.0, -61.0, -53.0, -37.0, -46.0, -41.0, -41.0, -49.0, -42.0, -40.0, -38.0, -48.0, -63.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3073333411567432, "mean_inference_ms": 9.749923660835364, "mean_action_processing_ms": 0.45865958423263825, "mean_env_wait_ms": 0.2924679925546322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27520751953125, "StateBufferConnector_ms": 0.004463911056518555, "ViewRequirementAgentConnector_ms": 0.20274710655212402}}, "episode_reward_max": -35.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -63.0, -49.0, -45.0, -59.0, -60.0, -55.0, -64.0, -61.0, -45.0, -46.0, -54.0, -50.0, -63.0, -48.0, -62.0, -39.0, -51.0, -45.0, -44.0, -48.0, -50.0, -55.0, -61.0, -40.0, -46.0, -46.0, -62.0, -53.0, -54.0, -41.0, -50.0, -49.0, -39.0, -40.0, -48.0, -47.0, -62.0, -48.0, -43.0, -42.0, -54.0, -54.0, -56.0, -51.0, -54.0, -52.0, -60.0, -62.0, -48.0, -61.0, -44.0, -51.0, -52.0, -59.0, -45.0, -62.0, -52.0, -63.0, -47.0, -51.0, -64.0, -42.0, -54.0, -41.0, -53.0, -37.0, -50.0, -56.0, -36.0, -51.0, -44.0, -64.0, -42.0, -46.0, -35.0, -64.0, -59.0, -46.0, -46.0, -47.0, -44.0, -61.0, -63.0, -43.0, -45.0, -61.0, -61.0, -53.0, -37.0, -46.0, -41.0, -41.0, -49.0, -42.0, -40.0, -38.0, -48.0, -63.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3073333411567432, "mean_inference_ms": 9.749923660835364, "mean_action_processing_ms": 0.45865958423263825, "mean_env_wait_ms": 0.2924679925546322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27520751953125, "StateBufferConnector_ms": 0.004463911056518555, "ViewRequirementAgentConnector_ms": 0.20274710655212402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.156905082592413, "num_agent_steps_trained_throughput_per_sec": 7.156905082592413, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 72268.777, "sample_time_ms": 6042.976, "load_time_ms": 0.297, "load_throughput": 1723363.813, "learn_time_ms": 66224.928, "learn_throughput": 7.731, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "episodes_total": 1088, "training_iteration": 34, "trial_id": "f4e01_00169", "date": "2024-02-27_00-43-34", "timestamp": 1708991014, "time_this_iter_s": 71.54434633255005, "time_total_s": 2458.214138031006, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2458.214138031006, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 53.091089108910886, "ram_util_percent": 20.791089108910896}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.55, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.112890625, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9961792672673861, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.5020065625508625, "policy_loss": 0.038113001423577465, "vf_loss": 8.581618309020996, "vf_explained_var": 0.9872445488969485, "kl": 0.0, "entropy": 94.47528444925943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.55, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.55, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.112890625, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -39.0, -40.0, -48.0, -47.0, -62.0, -48.0, -43.0, -42.0, -54.0, -54.0, -56.0, -51.0, -54.0, -52.0, -60.0, -62.0, -48.0, -61.0, -44.0, -51.0, -52.0, -59.0, -45.0, -62.0, -52.0, -63.0, -47.0, -51.0, -64.0, -42.0, -54.0, -41.0, -53.0, -37.0, -50.0, -56.0, -36.0, -51.0, -44.0, -64.0, -42.0, -46.0, -35.0, -64.0, -59.0, -46.0, -46.0, -47.0, -44.0, -61.0, -63.0, -43.0, -45.0, -61.0, -61.0, -53.0, -37.0, -46.0, -41.0, -41.0, -49.0, -42.0, -40.0, -38.0, -48.0, -63.0, -60.0, -45.0, -62.0, -36.0, -34.0, -49.0, -62.0, -32.0, -63.0, -41.0, -39.0, -39.0, -38.0, -45.0, -51.0, -52.0, -63.0, -56.0, -61.0, -44.0, -48.0, -42.0, -51.0, -49.0, -52.0, -62.0, -49.0, -52.0, -43.0, -50.0, -47.0, -25.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3070272546502042, "mean_inference_ms": 9.747739038213517, "mean_action_processing_ms": 0.45846575315459004, "mean_env_wait_ms": 0.2923403239297664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26886677742004395, "StateBufferConnector_ms": 0.004382133483886719, "ViewRequirementAgentConnector_ms": 0.1925048828125}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.55, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -39.0, -40.0, -48.0, -47.0, -62.0, -48.0, -43.0, -42.0, -54.0, -54.0, -56.0, -51.0, -54.0, -52.0, -60.0, -62.0, -48.0, -61.0, -44.0, -51.0, -52.0, -59.0, -45.0, -62.0, -52.0, -63.0, -47.0, -51.0, -64.0, -42.0, -54.0, -41.0, -53.0, -37.0, -50.0, -56.0, -36.0, -51.0, -44.0, -64.0, -42.0, -46.0, -35.0, -64.0, -59.0, -46.0, -46.0, -47.0, -44.0, -61.0, -63.0, -43.0, -45.0, -61.0, -61.0, -53.0, -37.0, -46.0, -41.0, -41.0, -49.0, -42.0, -40.0, -38.0, -48.0, -63.0, -60.0, -45.0, -62.0, -36.0, -34.0, -49.0, -62.0, -32.0, -63.0, -41.0, -39.0, -39.0, -38.0, -45.0, -51.0, -52.0, -63.0, -56.0, -61.0, -44.0, -48.0, -42.0, -51.0, -49.0, -52.0, -62.0, -49.0, -52.0, -43.0, -50.0, -47.0, -25.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3070272546502042, "mean_inference_ms": 9.747739038213517, "mean_action_processing_ms": 0.45846575315459004, "mean_env_wait_ms": 0.2923403239297664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26886677742004395, "StateBufferConnector_ms": 0.004382133483886719, "ViewRequirementAgentConnector_ms": 0.1925048828125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.192066002013566, "num_agent_steps_trained_throughput_per_sec": 7.192066002013566, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 72131.129, "sample_time_ms": 6013.931, "load_time_ms": 0.295, "load_throughput": 1734639.457, "learn_time_ms": 66116.346, "learn_throughput": 7.744, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 1120, "training_iteration": 35, "trial_id": "f4e01_00169", "date": "2024-02-27_00-44-45", "timestamp": 1708991085, "time_this_iter_s": 71.19471621513367, "time_total_s": 2529.4088542461395, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2529.4088542461395, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 52.65841584158416, "ram_util_percent": 20.689108910891083}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.79, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.118828125, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.2213252315918606, "policy_loss": 0.22485738899558783, "vf_loss": 4.7062671681245165, "vf_explained_var": 0.9966532294948895, "kl": 0.0, "entropy": 93.21210333506266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.79, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.79, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.118828125, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -53.0, -37.0, -50.0, -56.0, -36.0, -51.0, -44.0, -64.0, -42.0, -46.0, -35.0, -64.0, -59.0, -46.0, -46.0, -47.0, -44.0, -61.0, -63.0, -43.0, -45.0, -61.0, -61.0, -53.0, -37.0, -46.0, -41.0, -41.0, -49.0, -42.0, -40.0, -38.0, -48.0, -63.0, -60.0, -45.0, -62.0, -36.0, -34.0, -49.0, -62.0, -32.0, -63.0, -41.0, -39.0, -39.0, -38.0, -45.0, -51.0, -52.0, -63.0, -56.0, -61.0, -44.0, -48.0, -42.0, -51.0, -49.0, -52.0, -62.0, -49.0, -52.0, -43.0, -50.0, -47.0, -25.0, -64.0, -63.0, -63.0, -51.0, -42.0, -46.0, -53.0, -62.0, -51.0, -51.0, -58.0, -41.0, -53.0, -61.0, -51.0, -44.0, -39.0, -62.0, -36.0, -42.0, -44.0, -46.0, -46.0, -38.0, -62.0, -62.0, -44.0, -44.0, -27.0, -44.0, -64.0, -40.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30617404750104, "mean_inference_ms": 9.743023817026607, "mean_action_processing_ms": 0.4581261007444606, "mean_env_wait_ms": 0.2920934919120647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26479077339172363, "StateBufferConnector_ms": 0.004326343536376953, "ViewRequirementAgentConnector_ms": 0.18517136573791504}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.79, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -53.0, -37.0, -50.0, -56.0, -36.0, -51.0, -44.0, -64.0, -42.0, -46.0, -35.0, -64.0, -59.0, -46.0, -46.0, -47.0, -44.0, -61.0, -63.0, -43.0, -45.0, -61.0, -61.0, -53.0, -37.0, -46.0, -41.0, -41.0, -49.0, -42.0, -40.0, -38.0, -48.0, -63.0, -60.0, -45.0, -62.0, -36.0, -34.0, -49.0, -62.0, -32.0, -63.0, -41.0, -39.0, -39.0, -38.0, -45.0, -51.0, -52.0, -63.0, -56.0, -61.0, -44.0, -48.0, -42.0, -51.0, -49.0, -52.0, -62.0, -49.0, -52.0, -43.0, -50.0, -47.0, -25.0, -64.0, -63.0, -63.0, -51.0, -42.0, -46.0, -53.0, -62.0, -51.0, -51.0, -58.0, -41.0, -53.0, -61.0, -51.0, -44.0, -39.0, -62.0, -36.0, -42.0, -44.0, -46.0, -46.0, -38.0, -62.0, -62.0, -44.0, -44.0, -27.0, -44.0, -64.0, -40.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30617404750104, "mean_inference_ms": 9.743023817026607, "mean_action_processing_ms": 0.4581261007444606, "mean_env_wait_ms": 0.2920934919120647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26479077339172363, "StateBufferConnector_ms": 0.004326343536376953, "ViewRequirementAgentConnector_ms": 0.18517136573791504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.214277370231925, "num_agent_steps_trained_throughput_per_sec": 7.214277370231925, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 71957.862, "sample_time_ms": 6003.556, "load_time_ms": 0.292, "load_throughput": 1753190.994, "learn_time_ms": 65953.483, "learn_throughput": 7.763, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "episodes_total": 1152, "training_iteration": 36, "trial_id": "f4e01_00169", "date": "2024-02-27_00-45-56", "timestamp": 1708991156, "time_this_iter_s": 70.97558426856995, "time_total_s": 2600.3844385147095, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2600.3844385147095, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 53.862376237623764, "ram_util_percent": 20.7}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.98, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.10953125, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9705759777377049, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.942336225509644, "policy_loss": 0.024528452071050803, "vf_loss": 9.294538231690725, "vf_explained_var": 0.9800822948416074, "kl": 0.0, "entropy": 92.28988081614176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.98, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.10953125, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -48.0, -63.0, -60.0, -45.0, -62.0, -36.0, -34.0, -49.0, -62.0, -32.0, -63.0, -41.0, -39.0, -39.0, -38.0, -45.0, -51.0, -52.0, -63.0, -56.0, -61.0, -44.0, -48.0, -42.0, -51.0, -49.0, -52.0, -62.0, -49.0, -52.0, -43.0, -50.0, -47.0, -25.0, -64.0, -63.0, -63.0, -51.0, -42.0, -46.0, -53.0, -62.0, -51.0, -51.0, -58.0, -41.0, -53.0, -61.0, -51.0, -44.0, -39.0, -62.0, -36.0, -42.0, -44.0, -46.0, -46.0, -38.0, -62.0, -62.0, -44.0, -44.0, -27.0, -44.0, -64.0, -40.0, -50.0, -61.0, -53.0, -63.0, -53.0, -52.0, -50.0, -64.0, -52.0, -47.0, -57.0, -61.0, -47.0, -39.0, -63.0, -52.0, -52.0, -64.0, -60.0, -62.0, -32.0, -49.0, -44.0, -46.0, -51.0, -50.0, -53.0, -53.0, -43.0, -43.0, -46.0, -50.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3055147294020661, "mean_inference_ms": 9.739215468859356, "mean_action_processing_ms": 0.4578802346213206, "mean_env_wait_ms": 0.29188455982400563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2665596008300781, "StateBufferConnector_ms": 0.004372358322143555, "ViewRequirementAgentConnector_ms": 0.1862046718597412}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -48.0, -63.0, -60.0, -45.0, -62.0, -36.0, -34.0, -49.0, -62.0, -32.0, -63.0, -41.0, -39.0, -39.0, -38.0, -45.0, -51.0, -52.0, -63.0, -56.0, -61.0, -44.0, -48.0, -42.0, -51.0, -49.0, -52.0, -62.0, -49.0, -52.0, -43.0, -50.0, -47.0, -25.0, -64.0, -63.0, -63.0, -51.0, -42.0, -46.0, -53.0, -62.0, -51.0, -51.0, -58.0, -41.0, -53.0, -61.0, -51.0, -44.0, -39.0, -62.0, -36.0, -42.0, -44.0, -46.0, -46.0, -38.0, -62.0, -62.0, -44.0, -44.0, -27.0, -44.0, -64.0, -40.0, -50.0, -61.0, -53.0, -63.0, -53.0, -52.0, -50.0, -64.0, -52.0, -47.0, -57.0, -61.0, -47.0, -39.0, -63.0, -52.0, -52.0, -64.0, -60.0, -62.0, -32.0, -49.0, -44.0, -46.0, -51.0, -50.0, -53.0, -53.0, -43.0, -43.0, -46.0, -50.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3055147294020661, "mean_inference_ms": 9.739215468859356, "mean_action_processing_ms": 0.4578802346213206, "mean_env_wait_ms": 0.29188455982400563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2665596008300781, "StateBufferConnector_ms": 0.004372358322143555, "ViewRequirementAgentConnector_ms": 0.1862046718597412}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.191635309279343, "num_agent_steps_trained_throughput_per_sec": 7.191635309279343, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 71825.902, "sample_time_ms": 6018.122, "load_time_ms": 0.294, "load_throughput": 1744361.667, "learn_time_ms": 65806.954, "learn_throughput": 7.78, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "done": false, "episodes_total": 1184, "training_iteration": 37, "trial_id": "f4e01_00169", "date": "2024-02-27_00-47-08", "timestamp": 1708991228, "time_this_iter_s": 71.19914722442627, "time_total_s": 2671.5835857391357, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2671.5835857391357, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 53.14950495049505, "ram_util_percent": 20.666336633663363}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.97, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.117421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.117421875, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.8669610341389973, "policy_loss": 0.02921663096640259, "vf_loss": 6.027580360571544, "vf_explained_var": 0.9929560874899228, "kl": 0.0, "entropy": 92.07984422047933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.97, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.97, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.117421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.117421875, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -47.0, -25.0, -64.0, -63.0, -63.0, -51.0, -42.0, -46.0, -53.0, -62.0, -51.0, -51.0, -58.0, -41.0, -53.0, -61.0, -51.0, -44.0, -39.0, -62.0, -36.0, -42.0, -44.0, -46.0, -46.0, -38.0, -62.0, -62.0, -44.0, -44.0, -27.0, -44.0, -64.0, -40.0, -50.0, -61.0, -53.0, -63.0, -53.0, -52.0, -50.0, -64.0, -52.0, -47.0, -57.0, -61.0, -47.0, -39.0, -63.0, -52.0, -52.0, -64.0, -60.0, -62.0, -32.0, -49.0, -44.0, -46.0, -51.0, -50.0, -53.0, -53.0, -43.0, -43.0, -46.0, -50.0, -51.0, -63.0, -43.0, -39.0, -34.0, -42.0, -64.0, -44.0, -41.0, -34.0, -49.0, -38.0, -33.0, -44.0, -52.0, -41.0, -63.0, -55.0, -38.0, -64.0, -39.0, -43.0, -40.0, -47.0, -53.0, -41.0, -39.0, -35.0, -47.0, -61.0, -39.0, -40.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3052627209736993, "mean_inference_ms": 9.736281687296524, "mean_action_processing_ms": 0.4576878399019267, "mean_env_wait_ms": 0.29175399298787236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26882266998291016, "StateBufferConnector_ms": 0.004403829574584961, "ViewRequirementAgentConnector_ms": 0.18988656997680664}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.97, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -47.0, -25.0, -64.0, -63.0, -63.0, -51.0, -42.0, -46.0, -53.0, -62.0, -51.0, -51.0, -58.0, -41.0, -53.0, -61.0, -51.0, -44.0, -39.0, -62.0, -36.0, -42.0, -44.0, -46.0, -46.0, -38.0, -62.0, -62.0, -44.0, -44.0, -27.0, -44.0, -64.0, -40.0, -50.0, -61.0, -53.0, -63.0, -53.0, -52.0, -50.0, -64.0, -52.0, -47.0, -57.0, -61.0, -47.0, -39.0, -63.0, -52.0, -52.0, -64.0, -60.0, -62.0, -32.0, -49.0, -44.0, -46.0, -51.0, -50.0, -53.0, -53.0, -43.0, -43.0, -46.0, -50.0, -51.0, -63.0, -43.0, -39.0, -34.0, -42.0, -64.0, -44.0, -41.0, -34.0, -49.0, -38.0, -33.0, -44.0, -52.0, -41.0, -63.0, -55.0, -38.0, -64.0, -39.0, -43.0, -40.0, -47.0, -53.0, -41.0, -39.0, -35.0, -47.0, -61.0, -39.0, -40.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3052627209736993, "mean_inference_ms": 9.736281687296524, "mean_action_processing_ms": 0.4576878399019267, "mean_env_wait_ms": 0.29175399298787236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26882266998291016, "StateBufferConnector_ms": 0.004403829574584961, "ViewRequirementAgentConnector_ms": 0.18988656997680664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.242815984991975, "num_agent_steps_trained_throughput_per_sec": 7.242815984991975, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 71671.173, "sample_time_ms": 6046.67, "load_time_ms": 0.292, "load_throughput": 1755484.058, "learn_time_ms": 65623.68, "learn_throughput": 7.802, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "episodes_total": 1216, "training_iteration": 38, "trial_id": "f4e01_00169", "date": "2024-02-27_00-48-18", "timestamp": 1708991298, "time_this_iter_s": 70.69609832763672, "time_total_s": 2742.2796840667725, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2742.2796840667725, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 52.69, "ram_util_percent": 20.741000000000003}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.29, "reward_total_min": -64, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.122734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.265625, "reward_score_mean": 0.122734375, "reward_score_min": 0.0, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.965010001262029, "policy_loss": -0.05006646662950516, "vf_loss": 6.30609904328982, "vf_explained_var": 0.9866756995519003, "kl": 0.0, "entropy": 92.35366910298666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.29, "reward_total_min": -64, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.122734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.265625, "reward_score_mean": 0.122734375, "reward_score_min": 0.0, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -64.0, -40.0, -50.0, -61.0, -53.0, -63.0, -53.0, -52.0, -50.0, -64.0, -52.0, -47.0, -57.0, -61.0, -47.0, -39.0, -63.0, -52.0, -52.0, -64.0, -60.0, -62.0, -32.0, -49.0, -44.0, -46.0, -51.0, -50.0, -53.0, -53.0, -43.0, -43.0, -46.0, -50.0, -51.0, -63.0, -43.0, -39.0, -34.0, -42.0, -64.0, -44.0, -41.0, -34.0, -49.0, -38.0, -33.0, -44.0, -52.0, -41.0, -63.0, -55.0, -38.0, -64.0, -39.0, -43.0, -40.0, -47.0, -53.0, -41.0, -39.0, -35.0, -47.0, -61.0, -39.0, -40.0, -63.0, -63.0, -62.0, -62.0, -56.0, -39.0, -43.0, -47.0, -54.0, -30.0, -44.0, -52.0, -62.0, -40.0, -32.0, -35.0, -42.0, -43.0, -33.0, -46.0, -35.0, -54.0, -59.0, -49.0, -53.0, -51.0, -44.0, -42.0, -62.0, -41.0, -45.0, -40.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3050495972465912, "mean_inference_ms": 9.733609870789882, "mean_action_processing_ms": 0.457517670232525, "mean_env_wait_ms": 0.2916454466569771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2705652713775635, "StateBufferConnector_ms": 0.004395961761474609, "ViewRequirementAgentConnector_ms": 0.19164299964904785}}, "episode_reward_max": -30.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -64.0, -40.0, -50.0, -61.0, -53.0, -63.0, -53.0, -52.0, -50.0, -64.0, -52.0, -47.0, -57.0, -61.0, -47.0, -39.0, -63.0, -52.0, -52.0, -64.0, -60.0, -62.0, -32.0, -49.0, -44.0, -46.0, -51.0, -50.0, -53.0, -53.0, -43.0, -43.0, -46.0, -50.0, -51.0, -63.0, -43.0, -39.0, -34.0, -42.0, -64.0, -44.0, -41.0, -34.0, -49.0, -38.0, -33.0, -44.0, -52.0, -41.0, -63.0, -55.0, -38.0, -64.0, -39.0, -43.0, -40.0, -47.0, -53.0, -41.0, -39.0, -35.0, -47.0, -61.0, -39.0, -40.0, -63.0, -63.0, -62.0, -62.0, -56.0, -39.0, -43.0, -47.0, -54.0, -30.0, -44.0, -52.0, -62.0, -40.0, -32.0, -35.0, -42.0, -43.0, -33.0, -46.0, -35.0, -54.0, -59.0, -49.0, -53.0, -51.0, -44.0, -42.0, -62.0, -41.0, -45.0, -40.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3050495972465912, "mean_inference_ms": 9.733609870789882, "mean_action_processing_ms": 0.457517670232525, "mean_env_wait_ms": 0.2916454466569771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2705652713775635, "StateBufferConnector_ms": 0.004395961761474609, "ViewRequirementAgentConnector_ms": 0.19164299964904785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.223214100868031, "num_agent_steps_trained_throughput_per_sec": 7.223214100868031, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 71586.661, "sample_time_ms": 6029.579, "load_time_ms": 0.292, "load_throughput": 1754766.831, "learn_time_ms": 65556.266, "learn_throughput": 7.81, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 1248, "training_iteration": 39, "trial_id": "f4e01_00169", "date": "2024-02-27_00-49-29", "timestamp": 1708991369, "time_this_iter_s": 70.88792324066162, "time_total_s": 2813.167607307434, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2813.167607307434, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 52.679207920792074, "ram_util_percent": 20.75049504950495}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.15, "reward_total_min": -64, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.139453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.28125, "reward_score_mean": 0.139453125, "reward_score_min": 0.0, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9935475846131643, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.2911016047000885, "policy_loss": -0.02442194673543175, "vf_loss": 8.348587572574615, "vf_explained_var": 0.971066485842069, "kl": 0.0, "entropy": 92.43590151468912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.15, "reward_total_min": -64, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.139453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.28125, "reward_score_mean": 0.139453125, "reward_score_min": 0.0, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -46.0, -50.0, -51.0, -63.0, -43.0, -39.0, -34.0, -42.0, -64.0, -44.0, -41.0, -34.0, -49.0, -38.0, -33.0, -44.0, -52.0, -41.0, -63.0, -55.0, -38.0, -64.0, -39.0, -43.0, -40.0, -47.0, -53.0, -41.0, -39.0, -35.0, -47.0, -61.0, -39.0, -40.0, -63.0, -63.0, -62.0, -62.0, -56.0, -39.0, -43.0, -47.0, -54.0, -30.0, -44.0, -52.0, -62.0, -40.0, -32.0, -35.0, -42.0, -43.0, -33.0, -46.0, -35.0, -54.0, -59.0, -49.0, -53.0, -51.0, -44.0, -42.0, -62.0, -41.0, -45.0, -40.0, -40.0, -46.0, -46.0, -49.0, -53.0, -47.0, -49.0, -30.0, -51.0, -54.0, -43.0, -61.0, -36.0, -30.0, -30.0, -46.0, -51.0, -41.0, -36.0, -54.0, -43.0, -37.0, -51.0, -58.0, -43.0, -28.0, -62.0, -37.0, -62.0, -55.0, -50.0, -36.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3046465108088163, "mean_inference_ms": 9.730154574643306, "mean_action_processing_ms": 0.4573134326847936, "mean_env_wait_ms": 0.291522439505308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26896166801452637, "StateBufferConnector_ms": 0.0043659210205078125, "ViewRequirementAgentConnector_ms": 0.19116568565368652}}, "episode_reward_max": -28.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -46.0, -50.0, -51.0, -63.0, -43.0, -39.0, -34.0, -42.0, -64.0, -44.0, -41.0, -34.0, -49.0, -38.0, -33.0, -44.0, -52.0, -41.0, -63.0, -55.0, -38.0, -64.0, -39.0, -43.0, -40.0, -47.0, -53.0, -41.0, -39.0, -35.0, -47.0, -61.0, -39.0, -40.0, -63.0, -63.0, -62.0, -62.0, -56.0, -39.0, -43.0, -47.0, -54.0, -30.0, -44.0, -52.0, -62.0, -40.0, -32.0, -35.0, -42.0, -43.0, -33.0, -46.0, -35.0, -54.0, -59.0, -49.0, -53.0, -51.0, -44.0, -42.0, -62.0, -41.0, -45.0, -40.0, -40.0, -46.0, -46.0, -49.0, -53.0, -47.0, -49.0, -30.0, -51.0, -54.0, -43.0, -61.0, -36.0, -30.0, -30.0, -46.0, -51.0, -41.0, -36.0, -54.0, -43.0, -37.0, -51.0, -58.0, -43.0, -28.0, -62.0, -37.0, -62.0, -55.0, -50.0, -36.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3046465108088163, "mean_inference_ms": 9.730154574643306, "mean_action_processing_ms": 0.4573134326847936, "mean_env_wait_ms": 0.291522439505308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26896166801452637, "StateBufferConnector_ms": 0.0043659210205078125, "ViewRequirementAgentConnector_ms": 0.19116568565368652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.218920890344614, "num_agent_steps_trained_throughput_per_sec": 7.218920890344614, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 71426.871, "sample_time_ms": 6014.632, "load_time_ms": 0.285, "load_throughput": 1795254.68, "learn_time_ms": 65411.447, "learn_throughput": 7.827, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 1280, "training_iteration": 40, "trial_id": "f4e01_00169", "date": "2024-02-27_00-50-40", "timestamp": 1708991440, "time_this_iter_s": 70.92981123924255, "time_total_s": 2884.0974185466766, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2884.0974185466766, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.11683168316831, "ram_util_percent": 20.734653465346536}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.39, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.137578125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.137578125, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.722349232435226, "policy_loss": 0.03245082926005125, "vf_loss": 7.3659777522087095, "vf_explained_var": 0.9805594419439634, "kl": 0.0, "entropy": 91.72124137878419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -46.39, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.39, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.137578125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.137578125, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -39.0, -40.0, -63.0, -63.0, -62.0, -62.0, -56.0, -39.0, -43.0, -47.0, -54.0, -30.0, -44.0, -52.0, -62.0, -40.0, -32.0, -35.0, -42.0, -43.0, -33.0, -46.0, -35.0, -54.0, -59.0, -49.0, -53.0, -51.0, -44.0, -42.0, -62.0, -41.0, -45.0, -40.0, -40.0, -46.0, -46.0, -49.0, -53.0, -47.0, -49.0, -30.0, -51.0, -54.0, -43.0, -61.0, -36.0, -30.0, -30.0, -46.0, -51.0, -41.0, -36.0, -54.0, -43.0, -37.0, -51.0, -58.0, -43.0, -28.0, -62.0, -37.0, -62.0, -55.0, -50.0, -36.0, -42.0, -60.0, -46.0, -62.0, -36.0, -33.0, -36.0, -51.0, -63.0, -26.0, -52.0, -51.0, -40.0, -44.0, -63.0, -42.0, -61.0, -48.0, -26.0, -41.0, -30.0, -41.0, -61.0, -63.0, -37.0, -28.0, -45.0, -56.0, -48.0, -38.0, -40.0, -62.0, -49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3040578592369487, "mean_inference_ms": 9.733306452597871, "mean_action_processing_ms": 0.457141112867634, "mean_env_wait_ms": 0.2913765510293198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26770567893981934, "StateBufferConnector_ms": 0.004372358322143555, "ViewRequirementAgentConnector_ms": 0.18875336647033691}}, "episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -46.39, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -39.0, -40.0, -63.0, -63.0, -62.0, -62.0, -56.0, -39.0, -43.0, -47.0, -54.0, -30.0, -44.0, -52.0, -62.0, -40.0, -32.0, -35.0, -42.0, -43.0, -33.0, -46.0, -35.0, -54.0, -59.0, -49.0, -53.0, -51.0, -44.0, -42.0, -62.0, -41.0, -45.0, -40.0, -40.0, -46.0, -46.0, -49.0, -53.0, -47.0, -49.0, -30.0, -51.0, -54.0, -43.0, -61.0, -36.0, -30.0, -30.0, -46.0, -51.0, -41.0, -36.0, -54.0, -43.0, -37.0, -51.0, -58.0, -43.0, -28.0, -62.0, -37.0, -62.0, -55.0, -50.0, -36.0, -42.0, -60.0, -46.0, -62.0, -36.0, -33.0, -36.0, -51.0, -63.0, -26.0, -52.0, -51.0, -40.0, -44.0, -63.0, -42.0, -61.0, -48.0, -26.0, -41.0, -30.0, -41.0, -61.0, -63.0, -37.0, -28.0, -45.0, -56.0, -48.0, -38.0, -40.0, -62.0, -49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3040578592369487, "mean_inference_ms": 9.733306452597871, "mean_action_processing_ms": 0.457141112867634, "mean_env_wait_ms": 0.2913765510293198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26770567893981934, "StateBufferConnector_ms": 0.004372358322143555, "ViewRequirementAgentConnector_ms": 0.18875336647033691}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.180594510739939, "num_agent_steps_trained_throughput_per_sec": 7.180594510739939, "timesteps_total": 20992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 71354.183, "sample_time_ms": 6061.829, "load_time_ms": 0.286, "load_throughput": 1787633.104, "learn_time_ms": 65291.567, "learn_throughput": 7.842, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "done": false, "episodes_total": 1312, "training_iteration": 41, "trial_id": "f4e01_00169", "date": "2024-02-27_00-51-52", "timestamp": 1708991512, "time_this_iter_s": 71.30835318565369, "time_total_s": 2955.4057717323303, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2955.4057717323303, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 52.950495049504944, "ram_util_percent": 20.778217821782185}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.61, "reward_total_min": -64, "reward_total_max": -12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.143671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.40625, "reward_score_mean": 0.143671875, "reward_score_min": 0.0, "reward_score_max": 0.40625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.1967094739278155, "policy_loss": -0.02428847209860881, "vf_loss": 6.629520285129547, "vf_explained_var": 0.9693038697044055, "kl": 0.0, "entropy": 90.9501574198405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.61, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.61, "reward_total_min": -64, "reward_total_max": -12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.143671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.40625, "reward_score_mean": 0.143671875, "reward_score_min": 0.0, "reward_score_max": 0.40625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -45.0, -40.0, -40.0, -46.0, -46.0, -49.0, -53.0, -47.0, -49.0, -30.0, -51.0, -54.0, -43.0, -61.0, -36.0, -30.0, -30.0, -46.0, -51.0, -41.0, -36.0, -54.0, -43.0, -37.0, -51.0, -58.0, -43.0, -28.0, -62.0, -37.0, -62.0, -55.0, -50.0, -36.0, -42.0, -60.0, -46.0, -62.0, -36.0, -33.0, -36.0, -51.0, -63.0, -26.0, -52.0, -51.0, -40.0, -44.0, -63.0, -42.0, -61.0, -48.0, -26.0, -41.0, -30.0, -41.0, -61.0, -63.0, -37.0, -28.0, -45.0, -56.0, -48.0, -38.0, -40.0, -62.0, -49.0, -62.0, -48.0, -63.0, -24.0, -41.0, -28.0, -34.0, -63.0, -61.0, -46.0, -49.0, -51.0, -31.0, -12.0, -50.0, -46.0, -47.0, -24.0, -35.0, -48.0, -64.0, -38.0, -42.0, -48.0, -32.0, -43.0, -52.0, -54.0, -62.0, -49.0, -50.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3032124079712046, "mean_inference_ms": 9.735281797548533, "mean_action_processing_ms": 0.4569099841328112, "mean_env_wait_ms": 0.29117497101690737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26507067680358887, "StateBufferConnector_ms": 0.004425048828125, "ViewRequirementAgentConnector_ms": 0.18567609786987305}}, "episode_reward_max": -12.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.61, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -45.0, -40.0, -40.0, -46.0, -46.0, -49.0, -53.0, -47.0, -49.0, -30.0, -51.0, -54.0, -43.0, -61.0, -36.0, -30.0, -30.0, -46.0, -51.0, -41.0, -36.0, -54.0, -43.0, -37.0, -51.0, -58.0, -43.0, -28.0, -62.0, -37.0, -62.0, -55.0, -50.0, -36.0, -42.0, -60.0, -46.0, -62.0, -36.0, -33.0, -36.0, -51.0, -63.0, -26.0, -52.0, -51.0, -40.0, -44.0, -63.0, -42.0, -61.0, -48.0, -26.0, -41.0, -30.0, -41.0, -61.0, -63.0, -37.0, -28.0, -45.0, -56.0, -48.0, -38.0, -40.0, -62.0, -49.0, -62.0, -48.0, -63.0, -24.0, -41.0, -28.0, -34.0, -63.0, -61.0, -46.0, -49.0, -51.0, -31.0, -12.0, -50.0, -46.0, -47.0, -24.0, -35.0, -48.0, -64.0, -38.0, -42.0, -48.0, -32.0, -43.0, -52.0, -54.0, -62.0, -49.0, -50.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3032124079712046, "mean_inference_ms": 9.735281797548533, "mean_action_processing_ms": 0.4569099841328112, "mean_env_wait_ms": 0.29117497101690737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26507067680358887, "StateBufferConnector_ms": 0.004425048828125, "ViewRequirementAgentConnector_ms": 0.18567609786987305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.251701653030803, "num_agent_steps_trained_throughput_per_sec": 7.251701653030803, "timesteps_total": 21504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 71146.51, "sample_time_ms": 6019.043, "load_time_ms": 0.282, "load_throughput": 1816822.037, "learn_time_ms": 65126.692, "learn_throughput": 7.862, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 1344, "training_iteration": 42, "trial_id": "f4e01_00169", "date": "2024-02-27_00-53-02", "timestamp": 1708991582, "time_this_iter_s": 70.60916423797607, "time_total_s": 3026.0149359703064, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3026.0149359703064, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 52.758, "ram_util_percent": 20.758000000000003}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.77, "reward_total_min": -64, "reward_total_max": -12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.150234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.40625, "reward_score_mean": 0.150234375, "reward_score_min": 0.0, "reward_score_max": 0.40625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.206112958987554, "policy_loss": -0.05088074446345369, "vf_loss": 6.686055374145508, "vf_explained_var": 0.9801328659057618, "kl": 0.0, "entropy": 90.87840525309245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.77, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.77, "reward_total_min": -64, "reward_total_max": -12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.150234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.40625, "reward_score_mean": 0.150234375, "reward_score_min": 0.0, "reward_score_max": 0.40625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-55.0, -50.0, -36.0, -42.0, -60.0, -46.0, -62.0, -36.0, -33.0, -36.0, -51.0, -63.0, -26.0, -52.0, -51.0, -40.0, -44.0, -63.0, -42.0, -61.0, -48.0, -26.0, -41.0, -30.0, -41.0, -61.0, -63.0, -37.0, -28.0, -45.0, -56.0, -48.0, -38.0, -40.0, -62.0, -49.0, -62.0, -48.0, -63.0, -24.0, -41.0, -28.0, -34.0, -63.0, -61.0, -46.0, -49.0, -51.0, -31.0, -12.0, -50.0, -46.0, -47.0, -24.0, -35.0, -48.0, -64.0, -38.0, -42.0, -48.0, -32.0, -43.0, -52.0, -54.0, -62.0, -49.0, -50.0, -62.0, -26.0, -64.0, -51.0, -46.0, -33.0, -28.0, -46.0, -20.0, -64.0, -33.0, -30.0, -47.0, -64.0, -53.0, -63.0, -27.0, -31.0, -48.0, -64.0, -21.0, -48.0, -44.0, -13.0, -42.0, -46.0, -51.0, -42.0, -46.0, -63.0, -12.0, -38.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302451590299401, "mean_inference_ms": 9.737242527580067, "mean_action_processing_ms": 0.4566946974725316, "mean_env_wait_ms": 0.2909867977935537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26636362075805664, "StateBufferConnector_ms": 0.0044324398040771484, "ViewRequirementAgentConnector_ms": 0.18663334846496582}}, "episode_reward_max": -12.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.77, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.0, -50.0, -36.0, -42.0, -60.0, -46.0, -62.0, -36.0, -33.0, -36.0, -51.0, -63.0, -26.0, -52.0, -51.0, -40.0, -44.0, -63.0, -42.0, -61.0, -48.0, -26.0, -41.0, -30.0, -41.0, -61.0, -63.0, -37.0, -28.0, -45.0, -56.0, -48.0, -38.0, -40.0, -62.0, -49.0, -62.0, -48.0, -63.0, -24.0, -41.0, -28.0, -34.0, -63.0, -61.0, -46.0, -49.0, -51.0, -31.0, -12.0, -50.0, -46.0, -47.0, -24.0, -35.0, -48.0, -64.0, -38.0, -42.0, -48.0, -32.0, -43.0, -52.0, -54.0, -62.0, -49.0, -50.0, -62.0, -26.0, -64.0, -51.0, -46.0, -33.0, -28.0, -46.0, -20.0, -64.0, -33.0, -30.0, -47.0, -64.0, -53.0, -63.0, -27.0, -31.0, -48.0, -64.0, -21.0, -48.0, -44.0, -13.0, -42.0, -46.0, -51.0, -42.0, -46.0, -63.0, -12.0, -38.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302451590299401, "mean_inference_ms": 9.737242527580067, "mean_action_processing_ms": 0.4566946974725316, "mean_env_wait_ms": 0.2909867977935537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26636362075805664, "StateBufferConnector_ms": 0.0044324398040771484, "ViewRequirementAgentConnector_ms": 0.18663334846496582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2196181463617854, "num_agent_steps_trained_throughput_per_sec": 7.2196181463617854, "timesteps_total": 22016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 71021.601, "sample_time_ms": 6003.057, "load_time_ms": 0.281, "load_throughput": 1822527.071, "learn_time_ms": 65017.78, "learn_throughput": 7.875, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "done": false, "episodes_total": 1376, "training_iteration": 43, "trial_id": "f4e01_00169", "date": "2024-02-27_00-54-13", "timestamp": 1708991653, "time_this_iter_s": 70.92306184768677, "time_total_s": 3096.937997817993, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3096.937997817993, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 52.82772277227722, "ram_util_percent": 20.763366336633663}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.43, "reward_total_min": -64, "reward_total_max": -10, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.152890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.421875, "reward_score_mean": 0.152890625, "reward_score_min": 0.0, "reward_score_max": 0.421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.3796170135339105, "policy_loss": -0.05250973979321619, "vf_loss": 6.9611202875773115, "vf_explained_var": 0.9781258086363475, "kl": 0.0, "entropy": 91.29558080037435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.43, "reward_total_min": -64, "reward_total_max": -10, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.152890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.421875, "reward_score_mean": 0.152890625, "reward_score_min": 0.0, "reward_score_max": 0.421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -40.0, -62.0, -49.0, -62.0, -48.0, -63.0, -24.0, -41.0, -28.0, -34.0, -63.0, -61.0, -46.0, -49.0, -51.0, -31.0, -12.0, -50.0, -46.0, -47.0, -24.0, -35.0, -48.0, -64.0, -38.0, -42.0, -48.0, -32.0, -43.0, -52.0, -54.0, -62.0, -49.0, -50.0, -62.0, -26.0, -64.0, -51.0, -46.0, -33.0, -28.0, -46.0, -20.0, -64.0, -33.0, -30.0, -47.0, -64.0, -53.0, -63.0, -27.0, -31.0, -48.0, -64.0, -21.0, -48.0, -44.0, -13.0, -42.0, -46.0, -51.0, -42.0, -46.0, -63.0, -12.0, -38.0, -52.0, -64.0, -61.0, -54.0, -43.0, -64.0, -44.0, -19.0, -50.0, -10.0, -36.0, -62.0, -48.0, -36.0, -47.0, -42.0, -64.0, -48.0, -39.0, -21.0, -63.0, -62.0, -52.0, -26.0, -64.0, -24.0, -35.0, -37.0, -50.0, -19.0, -46.0, -63.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3019051767906726, "mean_inference_ms": 9.734459127966613, "mean_action_processing_ms": 0.45652365121506283, "mean_env_wait_ms": 0.29088839700598174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26840949058532715, "StateBufferConnector_ms": 0.004454374313354492, "ViewRequirementAgentConnector_ms": 0.18738794326782227}}, "episode_reward_max": -10.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -40.0, -62.0, -49.0, -62.0, -48.0, -63.0, -24.0, -41.0, -28.0, -34.0, -63.0, -61.0, -46.0, -49.0, -51.0, -31.0, -12.0, -50.0, -46.0, -47.0, -24.0, -35.0, -48.0, -64.0, -38.0, -42.0, -48.0, -32.0, -43.0, -52.0, -54.0, -62.0, -49.0, -50.0, -62.0, -26.0, -64.0, -51.0, -46.0, -33.0, -28.0, -46.0, -20.0, -64.0, -33.0, -30.0, -47.0, -64.0, -53.0, -63.0, -27.0, -31.0, -48.0, -64.0, -21.0, -48.0, -44.0, -13.0, -42.0, -46.0, -51.0, -42.0, -46.0, -63.0, -12.0, -38.0, -52.0, -64.0, -61.0, -54.0, -43.0, -64.0, -44.0, -19.0, -50.0, -10.0, -36.0, -62.0, -48.0, -36.0, -47.0, -42.0, -64.0, -48.0, -39.0, -21.0, -63.0, -62.0, -52.0, -26.0, -64.0, -24.0, -35.0, -37.0, -50.0, -19.0, -46.0, -63.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3019051767906726, "mean_inference_ms": 9.734459127966613, "mean_action_processing_ms": 0.45652365121506283, "mean_env_wait_ms": 0.29088839700598174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26840949058532715, "StateBufferConnector_ms": 0.004454374313354492, "ViewRequirementAgentConnector_ms": 0.18738794326782227}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.174925131299624, "num_agent_steps_trained_throughput_per_sec": 7.174925131299624, "timesteps_total": 22528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 71003.629, "sample_time_ms": 6016.949, "load_time_ms": 0.286, "load_throughput": 1791510.51, "learn_time_ms": 64985.913, "learn_throughput": 7.879, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "episodes_total": 1408, "training_iteration": 44, "trial_id": "f4e01_00169", "date": "2024-02-27_00-55-25", "timestamp": 1708991725, "time_this_iter_s": 71.36478114128113, "time_total_s": 3168.3027789592743, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3168.3027789592743, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 53.24158415841584, "ram_util_percent": 20.819801980198026}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.47, "reward_total_min": -64, "reward_total_max": -10, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.152578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.421875, "reward_score_mean": 0.152578125, "reward_score_min": 0.0, "reward_score_max": 0.421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.86564262509346, "policy_loss": -0.056646635942161086, "vf_loss": 6.160367000102997, "vf_explained_var": 0.9931936989227931, "kl": 0.0, "entropy": 90.32866446177165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.47, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.47, "reward_total_min": -64, "reward_total_max": -10, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.152578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.421875, "reward_score_mean": 0.152578125, "reward_score_min": 0.0, "reward_score_max": 0.421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -49.0, -50.0, -62.0, -26.0, -64.0, -51.0, -46.0, -33.0, -28.0, -46.0, -20.0, -64.0, -33.0, -30.0, -47.0, -64.0, -53.0, -63.0, -27.0, -31.0, -48.0, -64.0, -21.0, -48.0, -44.0, -13.0, -42.0, -46.0, -51.0, -42.0, -46.0, -63.0, -12.0, -38.0, -52.0, -64.0, -61.0, -54.0, -43.0, -64.0, -44.0, -19.0, -50.0, -10.0, -36.0, -62.0, -48.0, -36.0, -47.0, -42.0, -64.0, -48.0, -39.0, -21.0, -63.0, -62.0, -52.0, -26.0, -64.0, -24.0, -35.0, -37.0, -50.0, -19.0, -46.0, -63.0, -46.0, -39.0, -47.0, -46.0, -63.0, -33.0, -47.0, -62.0, -30.0, -41.0, -63.0, -64.0, -22.0, -64.0, -24.0, -46.0, -64.0, -63.0, -36.0, -38.0, -39.0, -32.0, -31.0, -40.0, -50.0, -25.0, -31.0, -64.0, -62.0, -37.0, -47.0, -36.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013990773716904, "mean_inference_ms": 9.73154783914028, "mean_action_processing_ms": 0.4563648081866269, "mean_env_wait_ms": 0.2908223114061272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2662394046783447, "StateBufferConnector_ms": 0.004404783248901367, "ViewRequirementAgentConnector_ms": 0.18486237525939941}}, "episode_reward_max": -10.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.47, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -49.0, -50.0, -62.0, -26.0, -64.0, -51.0, -46.0, -33.0, -28.0, -46.0, -20.0, -64.0, -33.0, -30.0, -47.0, -64.0, -53.0, -63.0, -27.0, -31.0, -48.0, -64.0, -21.0, -48.0, -44.0, -13.0, -42.0, -46.0, -51.0, -42.0, -46.0, -63.0, -12.0, -38.0, -52.0, -64.0, -61.0, -54.0, -43.0, -64.0, -44.0, -19.0, -50.0, -10.0, -36.0, -62.0, -48.0, -36.0, -47.0, -42.0, -64.0, -48.0, -39.0, -21.0, -63.0, -62.0, -52.0, -26.0, -64.0, -24.0, -35.0, -37.0, -50.0, -19.0, -46.0, -63.0, -46.0, -39.0, -47.0, -46.0, -63.0, -33.0, -47.0, -62.0, -30.0, -41.0, -63.0, -64.0, -22.0, -64.0, -24.0, -46.0, -64.0, -63.0, -36.0, -38.0, -39.0, -32.0, -31.0, -40.0, -50.0, -25.0, -31.0, -64.0, -62.0, -37.0, -47.0, -36.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013990773716904, "mean_inference_ms": 9.73154783914028, "mean_action_processing_ms": 0.4563648081866269, "mean_env_wait_ms": 0.2908223114061272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2662394046783447, "StateBufferConnector_ms": 0.004404783248901367, "ViewRequirementAgentConnector_ms": 0.18486237525939941}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.285535988038209, "num_agent_steps_trained_throughput_per_sec": 7.285535988038209, "timesteps_total": 23040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 70912.297, "sample_time_ms": 6010.489, "load_time_ms": 0.284, "load_throughput": 1802790.168, "learn_time_ms": 64901.043, "learn_throughput": 7.889, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 1440, "training_iteration": 45, "trial_id": "f4e01_00169", "date": "2024-02-27_00-56-35", "timestamp": 1708991795, "time_this_iter_s": 70.28120398521423, "time_total_s": 3238.5839829444885, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3238.5839829444885, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 52.72400000000002, "ram_util_percent": 20.908000000000005}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.02, "reward_total_min": -64, "reward_total_max": -3, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4765625, "reward_score_mean": 0.14828125, "reward_score_min": 0.0, "reward_score_max": 0.4765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.7810284117857615, "policy_loss": -0.03983538458123803, "vf_loss": 6.001067634423574, "vf_explained_var": 0.9678435742855072, "kl": 0.0, "entropy": 90.6799472808838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "sampler_results": {"episode_reward_max": -3.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.02, "reward_total_min": -64, "reward_total_max": -3, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4765625, "reward_score_mean": 0.14828125, "reward_score_min": 0.0, "reward_score_max": 0.4765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -12.0, -38.0, -52.0, -64.0, -61.0, -54.0, -43.0, -64.0, -44.0, -19.0, -50.0, -10.0, -36.0, -62.0, -48.0, -36.0, -47.0, -42.0, -64.0, -48.0, -39.0, -21.0, -63.0, -62.0, -52.0, -26.0, -64.0, -24.0, -35.0, -37.0, -50.0, -19.0, -46.0, -63.0, -46.0, -39.0, -47.0, -46.0, -63.0, -33.0, -47.0, -62.0, -30.0, -41.0, -63.0, -64.0, -22.0, -64.0, -24.0, -46.0, -64.0, -63.0, -36.0, -38.0, -39.0, -32.0, -31.0, -40.0, -50.0, -25.0, -31.0, -64.0, -62.0, -37.0, -47.0, -36.0, -43.0, -43.0, -49.0, -43.0, -50.0, -44.0, -47.0, -44.0, -47.0, -61.0, -28.0, -43.0, -64.0, -51.0, -49.0, -53.0, -12.0, -3.0, -64.0, -41.0, -63.0, -37.0, -45.0, -44.0, -64.0, -53.0, -43.0, -45.0, -64.0, -49.0, -31.0, -49.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300942258810898, "mean_inference_ms": 9.73073341264229, "mean_action_processing_ms": 0.4562333518543403, "mean_env_wait_ms": 0.29078951045413876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2676961421966553, "StateBufferConnector_ms": 0.004466056823730469, "ViewRequirementAgentConnector_ms": 0.18577837944030762}}, "episode_reward_max": -3.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -12.0, -38.0, -52.0, -64.0, -61.0, -54.0, -43.0, -64.0, -44.0, -19.0, -50.0, -10.0, -36.0, -62.0, -48.0, -36.0, -47.0, -42.0, -64.0, -48.0, -39.0, -21.0, -63.0, -62.0, -52.0, -26.0, -64.0, -24.0, -35.0, -37.0, -50.0, -19.0, -46.0, -63.0, -46.0, -39.0, -47.0, -46.0, -63.0, -33.0, -47.0, -62.0, -30.0, -41.0, -63.0, -64.0, -22.0, -64.0, -24.0, -46.0, -64.0, -63.0, -36.0, -38.0, -39.0, -32.0, -31.0, -40.0, -50.0, -25.0, -31.0, -64.0, -62.0, -37.0, -47.0, -36.0, -43.0, -43.0, -49.0, -43.0, -50.0, -44.0, -47.0, -44.0, -47.0, -61.0, -28.0, -43.0, -64.0, -51.0, -49.0, -53.0, -12.0, -3.0, -64.0, -41.0, -63.0, -37.0, -45.0, -44.0, -64.0, -53.0, -43.0, -45.0, -64.0, -49.0, -31.0, -49.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300942258810898, "mean_inference_ms": 9.73073341264229, "mean_action_processing_ms": 0.4562333518543403, "mean_env_wait_ms": 0.29078951045413876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2676961421966553, "StateBufferConnector_ms": 0.004466056823730469, "ViewRequirementAgentConnector_ms": 0.18577837944030762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.201354907265778, "num_agent_steps_trained_throughput_per_sec": 7.201354907265778, "timesteps_total": 23552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 70925.032, "sample_time_ms": 6025.22, "load_time_ms": 0.281, "load_throughput": 1820055.639, "learn_time_ms": 64899.064, "learn_throughput": 7.889, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "episodes_total": 1472, "training_iteration": 46, "trial_id": "f4e01_00169", "date": "2024-02-27_00-57-46", "timestamp": 1708991866, "time_this_iter_s": 71.10267400741577, "time_total_s": 3309.6866569519043, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3309.6866569519043, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 52.588118811881195, "ram_util_percent": 20.916831683168326}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -43.95, "reward_total_min": -64, "reward_total_max": -3, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.156640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4765625, "reward_score_mean": 0.156640625, "reward_score_min": 0.0, "reward_score_max": 0.4765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.308882675568262, "policy_loss": -0.03014531728501121, "vf_loss": 6.814898876349131, "vf_explained_var": 0.9887411301334699, "kl": 0.0, "entropy": 90.18043696085611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "sampler_results": {"episode_reward_max": -3.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.95, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -43.95, "reward_total_min": -64, "reward_total_max": -3, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.156640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4765625, "reward_score_mean": 0.156640625, "reward_score_min": 0.0, "reward_score_max": 0.4765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-19.0, -46.0, -63.0, -46.0, -39.0, -47.0, -46.0, -63.0, -33.0, -47.0, -62.0, -30.0, -41.0, -63.0, -64.0, -22.0, -64.0, -24.0, -46.0, -64.0, -63.0, -36.0, -38.0, -39.0, -32.0, -31.0, -40.0, -50.0, -25.0, -31.0, -64.0, -62.0, -37.0, -47.0, -36.0, -43.0, -43.0, -49.0, -43.0, -50.0, -44.0, -47.0, -44.0, -47.0, -61.0, -28.0, -43.0, -64.0, -51.0, -49.0, -53.0, -12.0, -3.0, -64.0, -41.0, -63.0, -37.0, -45.0, -44.0, -64.0, -53.0, -43.0, -45.0, -64.0, -49.0, -31.0, -49.0, -46.0, -46.0, -44.0, -34.0, -64.0, -47.0, -63.0, -61.0, -39.0, -62.0, -45.0, -44.0, -45.0, -47.0, -27.0, -43.0, -28.0, -56.0, -34.0, -43.0, -64.0, -43.0, -32.0, -28.0, -29.0, -34.0, -48.0, -35.0, -15.0, -9.0, -21.0, -45.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3001713780199609, "mean_inference_ms": 9.728659548662986, "mean_action_processing_ms": 0.4560235094380751, "mean_env_wait_ms": 0.29067449808724516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2666594982147217, "StateBufferConnector_ms": 0.0044078826904296875, "ViewRequirementAgentConnector_ms": 0.1827559471130371}}, "episode_reward_max": -3.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.95, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.0, -46.0, -63.0, -46.0, -39.0, -47.0, -46.0, -63.0, -33.0, -47.0, -62.0, -30.0, -41.0, -63.0, -64.0, -22.0, -64.0, -24.0, -46.0, -64.0, -63.0, -36.0, -38.0, -39.0, -32.0, -31.0, -40.0, -50.0, -25.0, -31.0, -64.0, -62.0, -37.0, -47.0, -36.0, -43.0, -43.0, -49.0, -43.0, -50.0, -44.0, -47.0, -44.0, -47.0, -61.0, -28.0, -43.0, -64.0, -51.0, -49.0, -53.0, -12.0, -3.0, -64.0, -41.0, -63.0, -37.0, -45.0, -44.0, -64.0, -53.0, -43.0, -45.0, -64.0, -49.0, -31.0, -49.0, -46.0, -46.0, -44.0, -34.0, -64.0, -47.0, -63.0, -61.0, -39.0, -62.0, -45.0, -44.0, -45.0, -47.0, -27.0, -43.0, -28.0, -56.0, -34.0, -43.0, -64.0, -43.0, -32.0, -28.0, -29.0, -34.0, -48.0, -35.0, -15.0, -9.0, -21.0, -45.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3001713780199609, "mean_inference_ms": 9.728659548662986, "mean_action_processing_ms": 0.4560235094380751, "mean_env_wait_ms": 0.29067449808724516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2666594982147217, "StateBufferConnector_ms": 0.0044078826904296875, "ViewRequirementAgentConnector_ms": 0.1827559471130371}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2085824535738325, "num_agent_steps_trained_throughput_per_sec": 7.2085824535738325, "timesteps_total": 24064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 70908.297, "sample_time_ms": 6016.356, "load_time_ms": 0.276, "load_throughput": 1855758.424, "learn_time_ms": 64891.227, "learn_throughput": 7.89, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "done": false, "episodes_total": 1504, "training_iteration": 47, "trial_id": "f4e01_00169", "date": "2024-02-27_00-58-57", "timestamp": 1708991937, "time_this_iter_s": 71.03164386749268, "time_total_s": 3380.718300819397, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3380.718300819397, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 52.813, "ram_util_percent": 20.924000000000007}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.76, "reward_total_min": -64, "reward_total_max": -3, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1659375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4765625, "reward_score_mean": 0.1659375, "reward_score_min": 0.0, "reward_score_max": 0.4765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.11223428050677, "policy_loss": -0.022827984943675498, "vf_loss": 6.494549262523651, "vf_explained_var": 0.9846607213219006, "kl": 0.0, "entropy": 90.01594314575195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": -3.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.76, "reward_total_min": -64, "reward_total_max": -3, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1659375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4765625, "reward_score_mean": 0.1659375, "reward_score_min": 0.0, "reward_score_max": 0.4765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-37.0, -47.0, -36.0, -43.0, -43.0, -49.0, -43.0, -50.0, -44.0, -47.0, -44.0, -47.0, -61.0, -28.0, -43.0, -64.0, -51.0, -49.0, -53.0, -12.0, -3.0, -64.0, -41.0, -63.0, -37.0, -45.0, -44.0, -64.0, -53.0, -43.0, -45.0, -64.0, -49.0, -31.0, -49.0, -46.0, -46.0, -44.0, -34.0, -64.0, -47.0, -63.0, -61.0, -39.0, -62.0, -45.0, -44.0, -45.0, -47.0, -27.0, -43.0, -28.0, -56.0, -34.0, -43.0, -64.0, -43.0, -32.0, -28.0, -29.0, -34.0, -48.0, -35.0, -15.0, -9.0, -21.0, -45.0, -48.0, -63.0, -51.0, -64.0, -27.0, -25.0, -46.0, -32.0, -62.0, -43.0, -50.0, -42.0, -37.0, -62.0, -37.0, -64.0, -36.0, -33.0, -49.0, -34.0, -22.0, -38.0, -35.0, -37.0, -49.0, -36.0, -42.0, -16.0, -46.0, -41.0, -17.0, -44.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299740716502011, "mean_inference_ms": 9.728131506089474, "mean_action_processing_ms": 0.4559594110200724, "mean_env_wait_ms": 0.29062977399736356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27107834815979004, "StateBufferConnector_ms": 0.004462718963623047, "ViewRequirementAgentConnector_ms": 0.18935608863830566}}, "episode_reward_max": -3.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.0, -47.0, -36.0, -43.0, -43.0, -49.0, -43.0, -50.0, -44.0, -47.0, -44.0, -47.0, -61.0, -28.0, -43.0, -64.0, -51.0, -49.0, -53.0, -12.0, -3.0, -64.0, -41.0, -63.0, -37.0, -45.0, -44.0, -64.0, -53.0, -43.0, -45.0, -64.0, -49.0, -31.0, -49.0, -46.0, -46.0, -44.0, -34.0, -64.0, -47.0, -63.0, -61.0, -39.0, -62.0, -45.0, -44.0, -45.0, -47.0, -27.0, -43.0, -28.0, -56.0, -34.0, -43.0, -64.0, -43.0, -32.0, -28.0, -29.0, -34.0, -48.0, -35.0, -15.0, -9.0, -21.0, -45.0, -48.0, -63.0, -51.0, -64.0, -27.0, -25.0, -46.0, -32.0, -62.0, -43.0, -50.0, -42.0, -37.0, -62.0, -37.0, -64.0, -36.0, -33.0, -49.0, -34.0, -22.0, -38.0, -35.0, -37.0, -49.0, -36.0, -42.0, -16.0, -46.0, -41.0, -17.0, -44.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299740716502011, "mean_inference_ms": 9.728131506089474, "mean_action_processing_ms": 0.4559594110200724, "mean_env_wait_ms": 0.29062977399736356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27107834815979004, "StateBufferConnector_ms": 0.004462718963623047, "ViewRequirementAgentConnector_ms": 0.18935608863830566}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.208779135937774, "num_agent_steps_trained_throughput_per_sec": 7.208779135937774, "timesteps_total": 24576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 70941.676, "sample_time_ms": 6020.551, "load_time_ms": 0.28, "load_throughput": 1829514.098, "learn_time_ms": 64920.42, "learn_throughput": 7.887, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 1536, "training_iteration": 48, "trial_id": "f4e01_00169", "date": "2024-02-27_01-00-08", "timestamp": 1708992008, "time_this_iter_s": 71.02970790863037, "time_total_s": 3451.7480087280273, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3451.7480087280273, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 52.92772277227723, "ram_util_percent": 20.882178217821785}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.52, "reward_total_min": -64, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1678125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.1678125, "reward_score_min": 0.0, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.964031339685122, "policy_loss": -0.055470521189272405, "vf_loss": 6.313049511114756, "vf_explained_var": 0.9948637555042903, "kl": 0.0, "entropy": 90.66218566894531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "sampler_results": {"episode_reward_max": -9.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.52, "reward_total_min": -64, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1678125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.1678125, "reward_score_min": 0.0, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -31.0, -49.0, -46.0, -46.0, -44.0, -34.0, -64.0, -47.0, -63.0, -61.0, -39.0, -62.0, -45.0, -44.0, -45.0, -47.0, -27.0, -43.0, -28.0, -56.0, -34.0, -43.0, -64.0, -43.0, -32.0, -28.0, -29.0, -34.0, -48.0, -35.0, -15.0, -9.0, -21.0, -45.0, -48.0, -63.0, -51.0, -64.0, -27.0, -25.0, -46.0, -32.0, -62.0, -43.0, -50.0, -42.0, -37.0, -62.0, -37.0, -64.0, -36.0, -33.0, -49.0, -34.0, -22.0, -38.0, -35.0, -37.0, -49.0, -36.0, -42.0, -16.0, -46.0, -41.0, -17.0, -44.0, -41.0, -23.0, -42.0, -25.0, -43.0, -63.0, -46.0, -35.0, -36.0, -24.0, -36.0, -27.0, -31.0, -63.0, -46.0, -47.0, -51.0, -19.0, -52.0, -62.0, -43.0, -28.0, -63.0, -64.0, -49.0, -62.0, -63.0, -60.0, -41.0, -48.0, -40.0, -37.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991588916010008, "mean_inference_ms": 9.725437485859993, "mean_action_processing_ms": 0.45580890575409094, "mean_env_wait_ms": 0.2905014389184821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2709977626800537, "StateBufferConnector_ms": 0.004400968551635742, "ViewRequirementAgentConnector_ms": 0.18482208251953125}}, "episode_reward_max": -9.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -31.0, -49.0, -46.0, -46.0, -44.0, -34.0, -64.0, -47.0, -63.0, -61.0, -39.0, -62.0, -45.0, -44.0, -45.0, -47.0, -27.0, -43.0, -28.0, -56.0, -34.0, -43.0, -64.0, -43.0, -32.0, -28.0, -29.0, -34.0, -48.0, -35.0, -15.0, -9.0, -21.0, -45.0, -48.0, -63.0, -51.0, -64.0, -27.0, -25.0, -46.0, -32.0, -62.0, -43.0, -50.0, -42.0, -37.0, -62.0, -37.0, -64.0, -36.0, -33.0, -49.0, -34.0, -22.0, -38.0, -35.0, -37.0, -49.0, -36.0, -42.0, -16.0, -46.0, -41.0, -17.0, -44.0, -41.0, -23.0, -42.0, -25.0, -43.0, -63.0, -46.0, -35.0, -36.0, -24.0, -36.0, -27.0, -31.0, -63.0, -46.0, -47.0, -51.0, -19.0, -52.0, -62.0, -43.0, -28.0, -63.0, -64.0, -49.0, -62.0, -63.0, -60.0, -41.0, -48.0, -40.0, -37.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991588916010008, "mean_inference_ms": 9.725437485859993, "mean_action_processing_ms": 0.45580890575409094, "mean_env_wait_ms": 0.2905014389184821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2709977626800537, "StateBufferConnector_ms": 0.004400968551635742, "ViewRequirementAgentConnector_ms": 0.18482208251953125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.244077340632171, "num_agent_steps_trained_throughput_per_sec": 7.244077340632171, "timesteps_total": 25088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 70921.262, "sample_time_ms": 6012.471, "load_time_ms": 0.273, "load_throughput": 1877499.255, "learn_time_ms": 64908.103, "learn_throughput": 7.888, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "done": false, "episodes_total": 1568, "training_iteration": 49, "trial_id": "f4e01_00169", "date": "2024-02-27_01-01-19", "timestamp": 1708992079, "time_this_iter_s": 70.6836245059967, "time_total_s": 3522.431633234024, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3522.431633234024, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 53.840594059405944, "ram_util_percent": 20.52277227722772}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.42, "reward_total_min": -64, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.16859375, "reward_score_min": 0.0, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.374240879217784, "policy_loss": -0.055570204726730785, "vf_loss": 5.386878291765849, "vf_explained_var": 0.995334670941035, "kl": 0.0, "entropy": 90.08965187072754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": -9.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.42, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.42, "reward_total_min": -64, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.16859375, "reward_score_min": 0.0, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-9.0, -21.0, -45.0, -48.0, -63.0, -51.0, -64.0, -27.0, -25.0, -46.0, -32.0, -62.0, -43.0, -50.0, -42.0, -37.0, -62.0, -37.0, -64.0, -36.0, -33.0, -49.0, -34.0, -22.0, -38.0, -35.0, -37.0, -49.0, -36.0, -42.0, -16.0, -46.0, -41.0, -17.0, -44.0, -41.0, -23.0, -42.0, -25.0, -43.0, -63.0, -46.0, -35.0, -36.0, -24.0, -36.0, -27.0, -31.0, -63.0, -46.0, -47.0, -51.0, -19.0, -52.0, -62.0, -43.0, -28.0, -63.0, -64.0, -49.0, -62.0, -63.0, -60.0, -41.0, -48.0, -40.0, -37.0, -64.0, -15.0, -48.0, -64.0, -62.0, -30.0, -48.0, -36.0, -43.0, -46.0, -64.0, -20.0, -39.0, -62.0, -26.0, -48.0, -42.0, -46.0, -63.0, -64.0, -43.0, -50.0, -44.0, -62.0, -27.0, -62.0, -36.0, -19.0, -33.0, -38.0, -24.0, -40.0, -21.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2986609190601675, "mean_inference_ms": 9.72234153182327, "mean_action_processing_ms": 0.4556447664007581, "mean_env_wait_ms": 0.2903751004651454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2711615562438965, "StateBufferConnector_ms": 0.0044248104095458984, "ViewRequirementAgentConnector_ms": 0.18850398063659668}}, "episode_reward_max": -9.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.42, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.0, -21.0, -45.0, -48.0, -63.0, -51.0, -64.0, -27.0, -25.0, -46.0, -32.0, -62.0, -43.0, -50.0, -42.0, -37.0, -62.0, -37.0, -64.0, -36.0, -33.0, -49.0, -34.0, -22.0, -38.0, -35.0, -37.0, -49.0, -36.0, -42.0, -16.0, -46.0, -41.0, -17.0, -44.0, -41.0, -23.0, -42.0, -25.0, -43.0, -63.0, -46.0, -35.0, -36.0, -24.0, -36.0, -27.0, -31.0, -63.0, -46.0, -47.0, -51.0, -19.0, -52.0, -62.0, -43.0, -28.0, -63.0, -64.0, -49.0, -62.0, -63.0, -60.0, -41.0, -48.0, -40.0, -37.0, -64.0, -15.0, -48.0, -64.0, -62.0, -30.0, -48.0, -36.0, -43.0, -46.0, -64.0, -20.0, -39.0, -62.0, -26.0, -48.0, -42.0, -46.0, -63.0, -64.0, -43.0, -50.0, -44.0, -62.0, -27.0, -62.0, -36.0, -19.0, -33.0, -38.0, -24.0, -40.0, -21.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2986609190601675, "mean_inference_ms": 9.72234153182327, "mean_action_processing_ms": 0.4556447664007581, "mean_env_wait_ms": 0.2903751004651454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2711615562438965, "StateBufferConnector_ms": 0.0044248104095458984, "ViewRequirementAgentConnector_ms": 0.18850398063659668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.23604932810774, "num_agent_steps_trained_throughput_per_sec": 7.23604932810774, "timesteps_total": 25600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 70904.474, "sample_time_ms": 6010.528, "load_time_ms": 0.278, "load_throughput": 1843333.603, "learn_time_ms": 64893.25, "learn_throughput": 7.89, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 1600, "training_iteration": 50, "trial_id": "f4e01_00169", "date": "2024-02-27_01-02-30", "timestamp": 1708992150, "time_this_iter_s": 70.76188683509827, "time_total_s": 3593.1935200691223, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3593.1935200691223, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 52.94800000000001, "ram_util_percent": 20.522999999999996}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.2, "reward_total_min": -64, "reward_total_max": -2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.178125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.484375, "reward_score_mean": 0.178125, "reward_score_min": 0.0, "reward_score_max": 0.484375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.911859083175659, "policy_loss": -0.05543739361067613, "vf_loss": 6.231055476268133, "vf_explained_var": 0.9888683383663496, "kl": 0.0, "entropy": 89.56788285573323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.2, "reward_total_min": -64, "reward_total_max": -2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.178125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.484375, "reward_score_mean": 0.178125, "reward_score_min": 0.0, "reward_score_max": 0.484375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -17.0, -44.0, -41.0, -23.0, -42.0, -25.0, -43.0, -63.0, -46.0, -35.0, -36.0, -24.0, -36.0, -27.0, -31.0, -63.0, -46.0, -47.0, -51.0, -19.0, -52.0, -62.0, -43.0, -28.0, -63.0, -64.0, -49.0, -62.0, -63.0, -60.0, -41.0, -48.0, -40.0, -37.0, -64.0, -15.0, -48.0, -64.0, -62.0, -30.0, -48.0, -36.0, -43.0, -46.0, -64.0, -20.0, -39.0, -62.0, -26.0, -48.0, -42.0, -46.0, -63.0, -64.0, -43.0, -50.0, -44.0, -62.0, -27.0, -62.0, -36.0, -19.0, -33.0, -38.0, -24.0, -40.0, -21.0, -36.0, -40.0, -31.0, -40.0, -25.0, -37.0, -50.0, -39.0, -48.0, -42.0, -43.0, -40.0, -38.0, -50.0, -30.0, -41.0, -41.0, -61.0, -38.0, -41.0, -20.0, -33.0, -64.0, -2.0, -44.0, -41.0, -30.0, -7.0, -26.0, -22.0, -43.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2977738810797184, "mean_inference_ms": 9.717067056059323, "mean_action_processing_ms": 0.4552928646754593, "mean_env_wait_ms": 0.29012818916183536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2651331424713135, "StateBufferConnector_ms": 0.004303932189941406, "ViewRequirementAgentConnector_ms": 0.1811530590057373}}, "episode_reward_max": -2.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -17.0, -44.0, -41.0, -23.0, -42.0, -25.0, -43.0, -63.0, -46.0, -35.0, -36.0, -24.0, -36.0, -27.0, -31.0, -63.0, -46.0, -47.0, -51.0, -19.0, -52.0, -62.0, -43.0, -28.0, -63.0, -64.0, -49.0, -62.0, -63.0, -60.0, -41.0, -48.0, -40.0, -37.0, -64.0, -15.0, -48.0, -64.0, -62.0, -30.0, -48.0, -36.0, -43.0, -46.0, -64.0, -20.0, -39.0, -62.0, -26.0, -48.0, -42.0, -46.0, -63.0, -64.0, -43.0, -50.0, -44.0, -62.0, -27.0, -62.0, -36.0, -19.0, -33.0, -38.0, -24.0, -40.0, -21.0, -36.0, -40.0, -31.0, -40.0, -25.0, -37.0, -50.0, -39.0, -48.0, -42.0, -43.0, -40.0, -38.0, -50.0, -30.0, -41.0, -41.0, -61.0, -38.0, -41.0, -20.0, -33.0, -64.0, -2.0, -44.0, -41.0, -30.0, -7.0, -26.0, -22.0, -43.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2977738810797184, "mean_inference_ms": 9.717067056059323, "mean_action_processing_ms": 0.4552928646754593, "mean_env_wait_ms": 0.29012818916183536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2651331424713135, "StateBufferConnector_ms": 0.004303932189941406, "ViewRequirementAgentConnector_ms": 0.1811530590057373}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.317247242552323, "num_agent_steps_trained_throughput_per_sec": 7.317247242552323, "timesteps_total": 26112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26112, "timers": {"training_iteration_time_ms": 70771.312, "sample_time_ms": 5947.446, "load_time_ms": 0.276, "load_throughput": 1853516.009, "learn_time_ms": 64823.175, "learn_throughput": 7.898, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "done": false, "episodes_total": 1632, "training_iteration": 51, "trial_id": "f4e01_00169", "date": "2024-02-27_01-03-40", "timestamp": 1708992220, "time_this_iter_s": 69.97682547569275, "time_total_s": 3663.170345544815, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3663.170345544815, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 52.683, "ram_util_percent": 20.34700000000001}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.35, "reward_total_min": -64, "reward_total_max": -2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.184765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.484375, "reward_score_mean": 0.184765625, "reward_score_min": 0.0, "reward_score_max": 0.484375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.7568537493546805, "policy_loss": -0.036882696424921355, "vf_loss": 5.958461223045985, "vf_explained_var": 0.9929445137580236, "kl": 0.0, "entropy": 90.14756088256836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.35, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.35, "reward_total_min": -64, "reward_total_max": -2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.184765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.484375, "reward_score_mean": 0.184765625, "reward_score_min": 0.0, "reward_score_max": 0.484375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -40.0, -37.0, -64.0, -15.0, -48.0, -64.0, -62.0, -30.0, -48.0, -36.0, -43.0, -46.0, -64.0, -20.0, -39.0, -62.0, -26.0, -48.0, -42.0, -46.0, -63.0, -64.0, -43.0, -50.0, -44.0, -62.0, -27.0, -62.0, -36.0, -19.0, -33.0, -38.0, -24.0, -40.0, -21.0, -36.0, -40.0, -31.0, -40.0, -25.0, -37.0, -50.0, -39.0, -48.0, -42.0, -43.0, -40.0, -38.0, -50.0, -30.0, -41.0, -41.0, -61.0, -38.0, -41.0, -20.0, -33.0, -64.0, -2.0, -44.0, -41.0, -30.0, -7.0, -26.0, -22.0, -43.0, -36.0, -47.0, -39.0, -31.0, -62.0, -44.0, -5.0, -41.0, -46.0, -32.0, -63.0, -64.0, -63.0, -50.0, -39.0, -47.0, -46.0, -45.0, -64.0, -25.0, -36.0, -35.0, -38.0, -44.0, -40.0, -27.0, -46.0, -26.0, -64.0, -21.0, -33.0, -11.0, -28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2972438452681165, "mean_inference_ms": 9.713869657439243, "mean_action_processing_ms": 0.45511069673176124, "mean_env_wait_ms": 0.2900034706208579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2665088176727295, "StateBufferConnector_ms": 0.0043528079986572266, "ViewRequirementAgentConnector_ms": 0.18805789947509766}}, "episode_reward_max": -2.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.35, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -40.0, -37.0, -64.0, -15.0, -48.0, -64.0, -62.0, -30.0, -48.0, -36.0, -43.0, -46.0, -64.0, -20.0, -39.0, -62.0, -26.0, -48.0, -42.0, -46.0, -63.0, -64.0, -43.0, -50.0, -44.0, -62.0, -27.0, -62.0, -36.0, -19.0, -33.0, -38.0, -24.0, -40.0, -21.0, -36.0, -40.0, -31.0, -40.0, -25.0, -37.0, -50.0, -39.0, -48.0, -42.0, -43.0, -40.0, -38.0, -50.0, -30.0, -41.0, -41.0, -61.0, -38.0, -41.0, -20.0, -33.0, -64.0, -2.0, -44.0, -41.0, -30.0, -7.0, -26.0, -22.0, -43.0, -36.0, -47.0, -39.0, -31.0, -62.0, -44.0, -5.0, -41.0, -46.0, -32.0, -63.0, -64.0, -63.0, -50.0, -39.0, -47.0, -46.0, -45.0, -64.0, -25.0, -36.0, -35.0, -38.0, -44.0, -40.0, -27.0, -46.0, -26.0, -64.0, -21.0, -33.0, -11.0, -28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2972438452681165, "mean_inference_ms": 9.713869657439243, "mean_action_processing_ms": 0.45511069673176124, "mean_env_wait_ms": 0.2900034706208579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2665088176727295, "StateBufferConnector_ms": 0.0043528079986572266, "ViewRequirementAgentConnector_ms": 0.18805789947509766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.21599689183226, "num_agent_steps_trained_throughput_per_sec": 7.21599689183226, "timesteps_total": 26624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 70806.247, "sample_time_ms": 5972.603, "load_time_ms": 0.277, "load_throughput": 1847774.607, "learn_time_ms": 64832.952, "learn_throughput": 7.897, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "episodes_total": 1664, "training_iteration": 52, "trial_id": "f4e01_00169", "date": "2024-02-27_01-04-51", "timestamp": 1708992291, "time_this_iter_s": 70.95867204666138, "time_total_s": 3734.1290175914764, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3734.1290175914764, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 52.518, "ram_util_percent": 20.62}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.76, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.205, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.205, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.365516338745753, "policy_loss": -0.054018959403038025, "vf_loss": 6.941344018777212, "vf_explained_var": 0.9882101739446322, "kl": 0.0, "entropy": 90.10127709706624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.76, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.205, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.205, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -24.0, -40.0, -21.0, -36.0, -40.0, -31.0, -40.0, -25.0, -37.0, -50.0, -39.0, -48.0, -42.0, -43.0, -40.0, -38.0, -50.0, -30.0, -41.0, -41.0, -61.0, -38.0, -41.0, -20.0, -33.0, -64.0, -2.0, -44.0, -41.0, -30.0, -7.0, -26.0, -22.0, -43.0, -36.0, -47.0, -39.0, -31.0, -62.0, -44.0, -5.0, -41.0, -46.0, -32.0, -63.0, -64.0, -63.0, -50.0, -39.0, -47.0, -46.0, -45.0, -64.0, -25.0, -36.0, -35.0, -38.0, -44.0, -40.0, -27.0, -46.0, -26.0, -64.0, -21.0, -33.0, -11.0, -28.0, -24.0, -17.0, -48.0, -1.0, -53.0, -54.0, -24.0, -33.0, -38.0, -26.0, -63.0, -36.0, -14.0, -63.0, -42.0, -44.0, -31.0, -51.0, -14.0, -14.0, -39.0, -44.0, -46.0, -36.0, -24.0, -53.0, -5.0, -38.0, -54.0, -16.0, -64.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2967473761230164, "mean_inference_ms": 9.711049045322573, "mean_action_processing_ms": 0.4549714964214426, "mean_env_wait_ms": 0.2898841551048633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2681403160095215, "StateBufferConnector_ms": 0.004420280456542969, "ViewRequirementAgentConnector_ms": 0.18819141387939453}}, "episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -24.0, -40.0, -21.0, -36.0, -40.0, -31.0, -40.0, -25.0, -37.0, -50.0, -39.0, -48.0, -42.0, -43.0, -40.0, -38.0, -50.0, -30.0, -41.0, -41.0, -61.0, -38.0, -41.0, -20.0, -33.0, -64.0, -2.0, -44.0, -41.0, -30.0, -7.0, -26.0, -22.0, -43.0, -36.0, -47.0, -39.0, -31.0, -62.0, -44.0, -5.0, -41.0, -46.0, -32.0, -63.0, -64.0, -63.0, -50.0, -39.0, -47.0, -46.0, -45.0, -64.0, -25.0, -36.0, -35.0, -38.0, -44.0, -40.0, -27.0, -46.0, -26.0, -64.0, -21.0, -33.0, -11.0, -28.0, -24.0, -17.0, -48.0, -1.0, -53.0, -54.0, -24.0, -33.0, -38.0, -26.0, -63.0, -36.0, -14.0, -63.0, -42.0, -44.0, -31.0, -51.0, -14.0, -14.0, -39.0, -44.0, -46.0, -36.0, -24.0, -53.0, -5.0, -38.0, -54.0, -16.0, -64.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2967473761230164, "mean_inference_ms": 9.711049045322573, "mean_action_processing_ms": 0.4549714964214426, "mean_env_wait_ms": 0.2898841551048633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2681403160095215, "StateBufferConnector_ms": 0.004420280456542969, "ViewRequirementAgentConnector_ms": 0.18819141387939453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.210457470395189, "num_agent_steps_trained_throughput_per_sec": 7.210457470395189, "timesteps_total": 27136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27136, "timers": {"training_iteration_time_ms": 70815.255, "sample_time_ms": 5972.255, "load_time_ms": 0.277, "load_throughput": 1850640.855, "learn_time_ms": 64842.305, "learn_throughput": 7.896, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "done": false, "episodes_total": 1696, "training_iteration": 53, "trial_id": "f4e01_00169", "date": "2024-02-27_01-06-02", "timestamp": 1708992362, "time_this_iter_s": 71.01317691802979, "time_total_s": 3805.142194509506, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3805.142194509506, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 52.898019801980205, "ram_util_percent": 20.81584158415842}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.76, "reward_total_min": -64, "reward_total_max": 16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.205, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.205, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.171901285648346, "policy_loss": -0.03131685230570535, "vf_loss": 6.601595203081767, "vf_explained_var": 0.9879705344637235, "kl": 0.0, "entropy": 90.3215488433838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.76, "reward_total_min": -64, "reward_total_max": 16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.205, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.205, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-26.0, -22.0, -43.0, -36.0, -47.0, -39.0, -31.0, -62.0, -44.0, -5.0, -41.0, -46.0, -32.0, -63.0, -64.0, -63.0, -50.0, -39.0, -47.0, -46.0, -45.0, -64.0, -25.0, -36.0, -35.0, -38.0, -44.0, -40.0, -27.0, -46.0, -26.0, -64.0, -21.0, -33.0, -11.0, -28.0, -24.0, -17.0, -48.0, -1.0, -53.0, -54.0, -24.0, -33.0, -38.0, -26.0, -63.0, -36.0, -14.0, -63.0, -42.0, -44.0, -31.0, -51.0, -14.0, -14.0, -39.0, -44.0, -46.0, -36.0, -24.0, -53.0, -5.0, -38.0, -54.0, -16.0, -64.0, -63.0, -39.0, -49.0, -21.0, -64.0, -39.0, -41.0, -39.0, -3.0, -37.0, -18.0, -30.0, -36.0, -42.0, -39.0, -51.0, 16.0, -29.0, -63.0, -8.0, -18.0, -64.0, -41.0, -11.0, -41.0, -46.0, -63.0, -62.0, -17.0, -9.0, -62.0, -64.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2965003302446467, "mean_inference_ms": 9.709923785416889, "mean_action_processing_ms": 0.4549391061093698, "mean_env_wait_ms": 0.28985648091582933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703578472137451, "StateBufferConnector_ms": 0.004455089569091797, "ViewRequirementAgentConnector_ms": 0.1911942958831787}}, "episode_reward_max": 16.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.0, -22.0, -43.0, -36.0, -47.0, -39.0, -31.0, -62.0, -44.0, -5.0, -41.0, -46.0, -32.0, -63.0, -64.0, -63.0, -50.0, -39.0, -47.0, -46.0, -45.0, -64.0, -25.0, -36.0, -35.0, -38.0, -44.0, -40.0, -27.0, -46.0, -26.0, -64.0, -21.0, -33.0, -11.0, -28.0, -24.0, -17.0, -48.0, -1.0, -53.0, -54.0, -24.0, -33.0, -38.0, -26.0, -63.0, -36.0, -14.0, -63.0, -42.0, -44.0, -31.0, -51.0, -14.0, -14.0, -39.0, -44.0, -46.0, -36.0, -24.0, -53.0, -5.0, -38.0, -54.0, -16.0, -64.0, -63.0, -39.0, -49.0, -21.0, -64.0, -39.0, -41.0, -39.0, -3.0, -37.0, -18.0, -30.0, -36.0, -42.0, -39.0, -51.0, 16.0, -29.0, -63.0, -8.0, -18.0, -64.0, -41.0, -11.0, -41.0, -46.0, -63.0, -62.0, -17.0, -9.0, -62.0, -64.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2965003302446467, "mean_inference_ms": 9.709923785416889, "mean_action_processing_ms": 0.4549391061093698, "mean_env_wait_ms": 0.28985648091582933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703578472137451, "StateBufferConnector_ms": 0.004455089569091797, "ViewRequirementAgentConnector_ms": 0.1911942958831787}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2536704198023045, "num_agent_steps_trained_throughput_per_sec": 7.2536704198023045, "timesteps_total": 27648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 70737.793, "sample_time_ms": 5962.065, "load_time_ms": 0.277, "load_throughput": 1846186.08, "learn_time_ms": 64775.026, "learn_throughput": 7.904, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "episodes_total": 1728, "training_iteration": 54, "trial_id": "f4e01_00169", "date": "2024-02-27_01-07-12", "timestamp": 1708992432, "time_this_iter_s": 70.589998960495, "time_total_s": 3875.732193470001, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3875.732193470001, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 53.336999999999996, "ram_util_percent": 20.584999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.02, "reward_total_min": -64, "reward_total_max": 16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21078125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.21078125, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9542868591845035, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.105602717399597, "policy_loss": 0.05807001703263571, "vf_loss": 9.498284804821015, "vf_explained_var": 0.9780090560515722, "kl": 0.0, "entropy": 90.23294359842936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.02, "reward_total_min": -64, "reward_total_max": 16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21078125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.21078125, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-21.0, -33.0, -11.0, -28.0, -24.0, -17.0, -48.0, -1.0, -53.0, -54.0, -24.0, -33.0, -38.0, -26.0, -63.0, -36.0, -14.0, -63.0, -42.0, -44.0, -31.0, -51.0, -14.0, -14.0, -39.0, -44.0, -46.0, -36.0, -24.0, -53.0, -5.0, -38.0, -54.0, -16.0, -64.0, -63.0, -39.0, -49.0, -21.0, -64.0, -39.0, -41.0, -39.0, -3.0, -37.0, -18.0, -30.0, -36.0, -42.0, -39.0, -51.0, 16.0, -29.0, -63.0, -8.0, -18.0, -64.0, -41.0, -11.0, -41.0, -46.0, -63.0, -62.0, -17.0, -9.0, -62.0, -64.0, -45.0, -38.0, -49.0, -50.0, -51.0, -64.0, -31.0, -45.0, -39.0, -32.0, -63.0, -52.0, -64.0, -18.0, -49.0, -39.0, -11.0, -63.0, -22.0, -51.0, -28.0, -30.0, -57.0, -21.0, -17.0, -24.0, -8.0, -38.0, -48.0, -1.0, -51.0, -44.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2962162928805996, "mean_inference_ms": 9.70845501813589, "mean_action_processing_ms": 0.4548728047372077, "mean_env_wait_ms": 0.28981894930846586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2690737247467041, "StateBufferConnector_ms": 0.004430055618286133, "ViewRequirementAgentConnector_ms": 0.18973565101623535}}, "episode_reward_max": 16.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.0, -33.0, -11.0, -28.0, -24.0, -17.0, -48.0, -1.0, -53.0, -54.0, -24.0, -33.0, -38.0, -26.0, -63.0, -36.0, -14.0, -63.0, -42.0, -44.0, -31.0, -51.0, -14.0, -14.0, -39.0, -44.0, -46.0, -36.0, -24.0, -53.0, -5.0, -38.0, -54.0, -16.0, -64.0, -63.0, -39.0, -49.0, -21.0, -64.0, -39.0, -41.0, -39.0, -3.0, -37.0, -18.0, -30.0, -36.0, -42.0, -39.0, -51.0, 16.0, -29.0, -63.0, -8.0, -18.0, -64.0, -41.0, -11.0, -41.0, -46.0, -63.0, -62.0, -17.0, -9.0, -62.0, -64.0, -45.0, -38.0, -49.0, -50.0, -51.0, -64.0, -31.0, -45.0, -39.0, -32.0, -63.0, -52.0, -64.0, -18.0, -49.0, -39.0, -11.0, -63.0, -22.0, -51.0, -28.0, -30.0, -57.0, -21.0, -17.0, -24.0, -8.0, -38.0, -48.0, -1.0, -51.0, -44.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2962162928805996, "mean_inference_ms": 9.70845501813589, "mean_action_processing_ms": 0.4548728047372077, "mean_env_wait_ms": 0.28981894930846586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2690737247467041, "StateBufferConnector_ms": 0.004430055618286133, "ViewRequirementAgentConnector_ms": 0.18973565101623535}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.249561731539761, "num_agent_steps_trained_throughput_per_sec": 7.249561731539761, "timesteps_total": 28160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 70772.665, "sample_time_ms": 5973.992, "load_time_ms": 0.277, "load_throughput": 1848569.896, "learn_time_ms": 64797.975, "learn_throughput": 7.901, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 1760, "training_iteration": 55, "trial_id": "f4e01_00169", "date": "2024-02-27_01-08-23", "timestamp": 1708992503, "time_this_iter_s": 70.63009285926819, "time_total_s": 3946.3622863292694, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3946.3622863292694, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 53.00891089108911, "ram_util_percent": 20.571287128712868}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -38.55, "reward_total_min": -64, "reward_total_max": 16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.198828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.198828125, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.15500009059906, "policy_loss": 0.27933608650540315, "vf_loss": 6.087137107054392, "vf_explained_var": 0.9946356559793155, "kl": 0.0, "entropy": 92.37057215372721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -64.0, "episode_reward_mean": -38.55, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -38.55, "reward_total_min": -64, "reward_total_max": 16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.198828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.625, "reward_score_mean": 0.198828125, "reward_score_min": 0.0, "reward_score_max": 0.625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-54.0, -16.0, -64.0, -63.0, -39.0, -49.0, -21.0, -64.0, -39.0, -41.0, -39.0, -3.0, -37.0, -18.0, -30.0, -36.0, -42.0, -39.0, -51.0, 16.0, -29.0, -63.0, -8.0, -18.0, -64.0, -41.0, -11.0, -41.0, -46.0, -63.0, -62.0, -17.0, -9.0, -62.0, -64.0, -45.0, -38.0, -49.0, -50.0, -51.0, -64.0, -31.0, -45.0, -39.0, -32.0, -63.0, -52.0, -64.0, -18.0, -49.0, -39.0, -11.0, -63.0, -22.0, -51.0, -28.0, -30.0, -57.0, -21.0, -17.0, -24.0, -8.0, -38.0, -48.0, -1.0, -51.0, -44.0, -64.0, -64.0, -25.0, -36.0, -35.0, -19.0, -9.0, -50.0, -63.0, -30.0, -46.0, -5.0, -50.0, -45.0, -48.0, -12.0, -44.0, -50.0, -30.0, -64.0, -32.0, -63.0, -46.0, -9.0, -5.0, -8.0, -63.0, -36.0, -63.0, -52.0, -63.0, -14.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2959833653222208, "mean_inference_ms": 9.707270378051716, "mean_action_processing_ms": 0.45483642952708336, "mean_env_wait_ms": 0.2897963015002185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26897382736206055, "StateBufferConnector_ms": 0.004386186599731445, "ViewRequirementAgentConnector_ms": 0.19056940078735352}}, "episode_reward_max": 16.0, "episode_reward_min": -64.0, "episode_reward_mean": -38.55, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.0, -16.0, -64.0, -63.0, -39.0, -49.0, -21.0, -64.0, -39.0, -41.0, -39.0, -3.0, -37.0, -18.0, -30.0, -36.0, -42.0, -39.0, -51.0, 16.0, -29.0, -63.0, -8.0, -18.0, -64.0, -41.0, -11.0, -41.0, -46.0, -63.0, -62.0, -17.0, -9.0, -62.0, -64.0, -45.0, -38.0, -49.0, -50.0, -51.0, -64.0, -31.0, -45.0, -39.0, -32.0, -63.0, -52.0, -64.0, -18.0, -49.0, -39.0, -11.0, -63.0, -22.0, -51.0, -28.0, -30.0, -57.0, -21.0, -17.0, -24.0, -8.0, -38.0, -48.0, -1.0, -51.0, -44.0, -64.0, -64.0, -25.0, -36.0, -35.0, -19.0, -9.0, -50.0, -63.0, -30.0, -46.0, -5.0, -50.0, -45.0, -48.0, -12.0, -44.0, -50.0, -30.0, -64.0, -32.0, -63.0, -46.0, -9.0, -5.0, -8.0, -63.0, -36.0, -63.0, -52.0, -63.0, -14.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2959833653222208, "mean_inference_ms": 9.707270378051716, "mean_action_processing_ms": 0.45483642952708336, "mean_env_wait_ms": 0.2897963015002185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26897382736206055, "StateBufferConnector_ms": 0.004386186599731445, "ViewRequirementAgentConnector_ms": 0.19056940078735352}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.266826047620099, "num_agent_steps_trained_throughput_per_sec": 7.266826047620099, "timesteps_total": 28672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 70708.609, "sample_time_ms": 5964.885, "load_time_ms": 0.281, "load_throughput": 1823145.978, "learn_time_ms": 64743.015, "learn_throughput": 7.908, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 1792, "training_iteration": 56, "trial_id": "f4e01_00169", "date": "2024-02-27_01-09-34", "timestamp": 1708992574, "time_this_iter_s": 70.46222043037415, "time_total_s": 4016.8245067596436, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4016.8245067596436, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 52.426000000000016, "ram_util_percent": 20.671999999999997}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.13, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209921875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.209921875, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9421013666937749, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.655697482824325, "policy_loss": 0.054852282985424, "vf_loss": 8.796715201934179, "vf_explained_var": 0.9617754047115644, "kl": 0.0, "entropy": 93.6396582921346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "sampler_results": {"episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.13, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209921875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.209921875, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-9.0, -62.0, -64.0, -45.0, -38.0, -49.0, -50.0, -51.0, -64.0, -31.0, -45.0, -39.0, -32.0, -63.0, -52.0, -64.0, -18.0, -49.0, -39.0, -11.0, -63.0, -22.0, -51.0, -28.0, -30.0, -57.0, -21.0, -17.0, -24.0, -8.0, -38.0, -48.0, -1.0, -51.0, -44.0, -64.0, -64.0, -25.0, -36.0, -35.0, -19.0, -9.0, -50.0, -63.0, -30.0, -46.0, -5.0, -50.0, -45.0, -48.0, -12.0, -44.0, -50.0, -30.0, -64.0, -32.0, -63.0, -46.0, -9.0, -5.0, -8.0, -63.0, -36.0, -63.0, -52.0, -63.0, -14.0, -42.0, -40.0, -63.0, -40.0, -35.0, -39.0, -30.0, -24.0, -40.0, -37.0, 4.0, -64.0, -63.0, -46.0, -64.0, -29.0, -16.0, -6.0, -44.0, 6.0, 4.0, -41.0, -12.0, -45.0, -8.0, -15.0, -30.0, -26.0, -36.0, -1.0, -64.0, -43.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2955182470701545, "mean_inference_ms": 9.704838000923024, "mean_action_processing_ms": 0.4546870631970016, "mean_env_wait_ms": 0.28970171231525543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26746582984924316, "StateBufferConnector_ms": 0.0043485164642333984, "ViewRequirementAgentConnector_ms": 0.18664026260375977}}, "episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.0, -62.0, -64.0, -45.0, -38.0, -49.0, -50.0, -51.0, -64.0, -31.0, -45.0, -39.0, -32.0, -63.0, -52.0, -64.0, -18.0, -49.0, -39.0, -11.0, -63.0, -22.0, -51.0, -28.0, -30.0, -57.0, -21.0, -17.0, -24.0, -8.0, -38.0, -48.0, -1.0, -51.0, -44.0, -64.0, -64.0, -25.0, -36.0, -35.0, -19.0, -9.0, -50.0, -63.0, -30.0, -46.0, -5.0, -50.0, -45.0, -48.0, -12.0, -44.0, -50.0, -30.0, -64.0, -32.0, -63.0, -46.0, -9.0, -5.0, -8.0, -63.0, -36.0, -63.0, -52.0, -63.0, -14.0, -42.0, -40.0, -63.0, -40.0, -35.0, -39.0, -30.0, -24.0, -40.0, -37.0, 4.0, -64.0, -63.0, -46.0, -64.0, -29.0, -16.0, -6.0, -44.0, 6.0, 4.0, -41.0, -12.0, -45.0, -8.0, -15.0, -30.0, -26.0, -36.0, -1.0, -64.0, -43.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2955182470701545, "mean_inference_ms": 9.704838000923024, "mean_action_processing_ms": 0.4546870631970016, "mean_env_wait_ms": 0.28970171231525543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26746582984924316, "StateBufferConnector_ms": 0.0043485164642333984, "ViewRequirementAgentConnector_ms": 0.18664026260375977}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.167558497410232, "num_agent_steps_trained_throughput_per_sec": 7.167558497410232, "timesteps_total": 29184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29184, "timers": {"training_iteration_time_ms": 70749.262, "sample_time_ms": 5953.237, "load_time_ms": 0.279, "load_throughput": 1832793.077, "learn_time_ms": 64795.316, "learn_throughput": 7.902, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "done": false, "episodes_total": 1824, "training_iteration": 57, "trial_id": "f4e01_00169", "date": "2024-02-27_01-10-45", "timestamp": 1708992645, "time_this_iter_s": 71.43813681602478, "time_total_s": 4088.2626435756683, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4088.2626435756683, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 52.822772277227735, "ram_util_percent": 20.694059405940585}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -32.77, "reward_total_min": -64, "reward_total_max": 37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.243984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7890625, "reward_score_mean": 0.243984375, "reward_score_min": 0.0, "reward_score_max": 0.7890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.367838440338771, "policy_loss": 0.07929638015727201, "vf_loss": 8.30621043841044, "vf_explained_var": 0.9819087584813436, "kl": 0.0, "entropy": 94.30215307871501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "sampler_results": {"episode_reward_max": 37.0, "episode_reward_min": -64.0, "episode_reward_mean": -32.77, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -32.77, "reward_total_min": -64, "reward_total_max": 37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.243984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7890625, "reward_score_mean": 0.243984375, "reward_score_min": 0.0, "reward_score_max": 0.7890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-1.0, -51.0, -44.0, -64.0, -64.0, -25.0, -36.0, -35.0, -19.0, -9.0, -50.0, -63.0, -30.0, -46.0, -5.0, -50.0, -45.0, -48.0, -12.0, -44.0, -50.0, -30.0, -64.0, -32.0, -63.0, -46.0, -9.0, -5.0, -8.0, -63.0, -36.0, -63.0, -52.0, -63.0, -14.0, -42.0, -40.0, -63.0, -40.0, -35.0, -39.0, -30.0, -24.0, -40.0, -37.0, 4.0, -64.0, -63.0, -46.0, -64.0, -29.0, -16.0, -6.0, -44.0, 6.0, 4.0, -41.0, -12.0, -45.0, -8.0, -15.0, -30.0, -26.0, -36.0, -1.0, -64.0, -43.0, -63.0, -64.0, -39.0, -39.0, 11.0, -10.0, 0.0, -45.0, 37.0, -2.0, 9.0, -63.0, -53.0, -50.0, -20.0, -18.0, -54.0, -64.0, 2.0, 11.0, 8.0, 32.0, 1.0, -64.0, -64.0, -44.0, -39.0, -64.0, -33.0, -3.0, -64.0, -37.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2947706637247796, "mean_inference_ms": 9.70111369901875, "mean_action_processing_ms": 0.45441071829430585, "mean_env_wait_ms": 0.28950677619439674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26214122772216797, "StateBufferConnector_ms": 0.004267454147338867, "ViewRequirementAgentConnector_ms": 0.18085885047912598}}, "episode_reward_max": 37.0, "episode_reward_min": -64.0, "episode_reward_mean": -32.77, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -51.0, -44.0, -64.0, -64.0, -25.0, -36.0, -35.0, -19.0, -9.0, -50.0, -63.0, -30.0, -46.0, -5.0, -50.0, -45.0, -48.0, -12.0, -44.0, -50.0, -30.0, -64.0, -32.0, -63.0, -46.0, -9.0, -5.0, -8.0, -63.0, -36.0, -63.0, -52.0, -63.0, -14.0, -42.0, -40.0, -63.0, -40.0, -35.0, -39.0, -30.0, -24.0, -40.0, -37.0, 4.0, -64.0, -63.0, -46.0, -64.0, -29.0, -16.0, -6.0, -44.0, 6.0, 4.0, -41.0, -12.0, -45.0, -8.0, -15.0, -30.0, -26.0, -36.0, -1.0, -64.0, -43.0, -63.0, -64.0, -39.0, -39.0, 11.0, -10.0, 0.0, -45.0, 37.0, -2.0, 9.0, -63.0, -53.0, -50.0, -20.0, -18.0, -54.0, -64.0, 2.0, 11.0, 8.0, 32.0, 1.0, -64.0, -64.0, -44.0, -39.0, -64.0, -33.0, -3.0, -64.0, -37.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2947706637247796, "mean_inference_ms": 9.70111369901875, "mean_action_processing_ms": 0.45441071829430585, "mean_env_wait_ms": 0.28950677619439674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26214122772216797, "StateBufferConnector_ms": 0.004267454147338867, "ViewRequirementAgentConnector_ms": 0.18085885047912598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.235957213268826, "num_agent_steps_trained_throughput_per_sec": 7.235957213268826, "timesteps_total": 29696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 70722.585, "sample_time_ms": 5929.811, "load_time_ms": 0.273, "load_throughput": 1877335.124, "learn_time_ms": 64792.065, "learn_throughput": 7.902, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "episodes_total": 1856, "training_iteration": 58, "trial_id": "f4e01_00169", "date": "2024-02-27_01-11-56", "timestamp": 1708992716, "time_this_iter_s": 70.76316785812378, "time_total_s": 4159.025811433792, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4159.025811433792, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 53.61881188118811, "ram_util_percent": 20.595049504950488}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -29.98, "reward_total_min": -64, "reward_total_max": 37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.26578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7890625, "reward_score_mean": 0.26578125, "reward_score_min": 0.0, "reward_score_max": 0.7890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9739191160847743, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.943044912815094, "policy_loss": 0.024272615369409323, "vf_loss": 9.296053127447765, "vf_explained_var": 0.9540407314896584, "kl": 0.0, "entropy": 94.94192047119141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "sampler_results": {"episode_reward_max": 37.0, "episode_reward_min": -64.0, "episode_reward_mean": -29.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -29.98, "reward_total_min": -64, "reward_total_max": 37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.26578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7890625, "reward_score_mean": 0.26578125, "reward_score_min": 0.0, "reward_score_max": 0.7890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -63.0, -14.0, -42.0, -40.0, -63.0, -40.0, -35.0, -39.0, -30.0, -24.0, -40.0, -37.0, 4.0, -64.0, -63.0, -46.0, -64.0, -29.0, -16.0, -6.0, -44.0, 6.0, 4.0, -41.0, -12.0, -45.0, -8.0, -15.0, -30.0, -26.0, -36.0, -1.0, -64.0, -43.0, -63.0, -64.0, -39.0, -39.0, 11.0, -10.0, 0.0, -45.0, 37.0, -2.0, 9.0, -63.0, -53.0, -50.0, -20.0, -18.0, -54.0, -64.0, 2.0, 11.0, 8.0, 32.0, 1.0, -64.0, -64.0, -44.0, -39.0, -64.0, -33.0, -3.0, -64.0, -37.0, -24.0, -1.0, 2.0, -35.0, -48.0, -64.0, -36.0, -64.0, -64.0, -63.0, -45.0, -64.0, -62.0, 21.0, -63.0, -43.0, 27.0, -64.0, -40.0, -6.0, -39.0, -40.0, 5.0, -50.0, -64.0, -64.0, -46.0, -6.0, 17.0, 34.0, 0.0, 21.0, 13.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2939886553539777, "mean_inference_ms": 9.698334272730825, "mean_action_processing_ms": 0.454110059405793, "mean_env_wait_ms": 0.2893022534507331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26190972328186035, "StateBufferConnector_ms": 0.004267692565917969, "ViewRequirementAgentConnector_ms": 0.18148255348205566}}, "episode_reward_max": 37.0, "episode_reward_min": -64.0, "episode_reward_mean": -29.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -63.0, -14.0, -42.0, -40.0, -63.0, -40.0, -35.0, -39.0, -30.0, -24.0, -40.0, -37.0, 4.0, -64.0, -63.0, -46.0, -64.0, -29.0, -16.0, -6.0, -44.0, 6.0, 4.0, -41.0, -12.0, -45.0, -8.0, -15.0, -30.0, -26.0, -36.0, -1.0, -64.0, -43.0, -63.0, -64.0, -39.0, -39.0, 11.0, -10.0, 0.0, -45.0, 37.0, -2.0, 9.0, -63.0, -53.0, -50.0, -20.0, -18.0, -54.0, -64.0, 2.0, 11.0, 8.0, 32.0, 1.0, -64.0, -64.0, -44.0, -39.0, -64.0, -33.0, -3.0, -64.0, -37.0, -24.0, -1.0, 2.0, -35.0, -48.0, -64.0, -36.0, -64.0, -64.0, -63.0, -45.0, -64.0, -62.0, 21.0, -63.0, -43.0, 27.0, -64.0, -40.0, -6.0, -39.0, -40.0, 5.0, -50.0, -64.0, -64.0, -46.0, -6.0, 17.0, 34.0, 0.0, 21.0, 13.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2939886553539777, "mean_inference_ms": 9.698334272730825, "mean_action_processing_ms": 0.454110059405793, "mean_env_wait_ms": 0.2893022534507331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26190972328186035, "StateBufferConnector_ms": 0.004267692565917969, "ViewRequirementAgentConnector_ms": 0.18148255348205566}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.22402212360586, "num_agent_steps_trained_throughput_per_sec": 7.22402212360586, "timesteps_total": 30208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30208, "timers": {"training_iteration_time_ms": 70742.206, "sample_time_ms": 5950.132, "load_time_ms": 0.275, "load_throughput": 1862841.471, "learn_time_ms": 64791.365, "learn_throughput": 7.902, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "done": false, "episodes_total": 1888, "training_iteration": 59, "trial_id": "f4e01_00169", "date": "2024-02-27_01-13-07", "timestamp": 1708992787, "time_this_iter_s": 70.87974333763123, "time_total_s": 4229.905554771423, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4229.905554771423, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 52.62800000000002, "ram_util_percent": 20.587}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -24.85, "reward_total_min": -64, "reward_total_max": 49, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.305859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8828125, "reward_score_mean": 0.305859375, "reward_score_min": 0.0, "reward_score_max": 0.8828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.693778679768244, "policy_loss": 0.06881649789089958, "vf_loss": 8.834593518575032, "vf_explained_var": 0.9426922713716824, "kl": 0.0, "entropy": 93.39728558858236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": -64.0, "episode_reward_mean": -24.85, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -24.85, "reward_total_min": -64, "reward_total_max": 49, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.305859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8828125, "reward_score_mean": 0.305859375, "reward_score_min": 0.0, "reward_score_max": 0.8828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-1.0, -64.0, -43.0, -63.0, -64.0, -39.0, -39.0, 11.0, -10.0, 0.0, -45.0, 37.0, -2.0, 9.0, -63.0, -53.0, -50.0, -20.0, -18.0, -54.0, -64.0, 2.0, 11.0, 8.0, 32.0, 1.0, -64.0, -64.0, -44.0, -39.0, -64.0, -33.0, -3.0, -64.0, -37.0, -24.0, -1.0, 2.0, -35.0, -48.0, -64.0, -36.0, -64.0, -64.0, -63.0, -45.0, -64.0, -62.0, 21.0, -63.0, -43.0, 27.0, -64.0, -40.0, -6.0, -39.0, -40.0, 5.0, -50.0, -64.0, -64.0, -46.0, -6.0, 17.0, 34.0, 0.0, 21.0, 13.0, -51.0, -48.0, 43.0, -51.0, 22.0, -48.0, 29.0, -64.0, -51.0, 24.0, -64.0, -52.0, 23.0, 8.0, 1.0, -50.0, -63.0, 29.0, 9.0, 28.0, -64.0, 43.0, 38.0, -55.0, -46.0, -64.0, -45.0, -64.0, 22.0, -53.0, 28.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2934545506220652, "mean_inference_ms": 9.69659840426491, "mean_action_processing_ms": 0.45391676928143526, "mean_env_wait_ms": 0.289156064476195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26348280906677246, "StateBufferConnector_ms": 0.004312276840209961, "ViewRequirementAgentConnector_ms": 0.18354105949401855}}, "episode_reward_max": 49.0, "episode_reward_min": -64.0, "episode_reward_mean": -24.85, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -64.0, -43.0, -63.0, -64.0, -39.0, -39.0, 11.0, -10.0, 0.0, -45.0, 37.0, -2.0, 9.0, -63.0, -53.0, -50.0, -20.0, -18.0, -54.0, -64.0, 2.0, 11.0, 8.0, 32.0, 1.0, -64.0, -64.0, -44.0, -39.0, -64.0, -33.0, -3.0, -64.0, -37.0, -24.0, -1.0, 2.0, -35.0, -48.0, -64.0, -36.0, -64.0, -64.0, -63.0, -45.0, -64.0, -62.0, 21.0, -63.0, -43.0, 27.0, -64.0, -40.0, -6.0, -39.0, -40.0, 5.0, -50.0, -64.0, -64.0, -46.0, -6.0, 17.0, 34.0, 0.0, 21.0, 13.0, -51.0, -48.0, 43.0, -51.0, 22.0, -48.0, 29.0, -64.0, -51.0, 24.0, -64.0, -52.0, 23.0, 8.0, 1.0, -50.0, -63.0, 29.0, 9.0, 28.0, -64.0, 43.0, 38.0, -55.0, -46.0, -64.0, -45.0, -64.0, 22.0, -53.0, 28.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2934545506220652, "mean_inference_ms": 9.69659840426491, "mean_action_processing_ms": 0.45391676928143526, "mean_env_wait_ms": 0.289156064476195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26348280906677246, "StateBufferConnector_ms": 0.004312276840209961, "ViewRequirementAgentConnector_ms": 0.18354105949401855}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1151984818532465, "num_agent_steps_trained_throughput_per_sec": 7.1151984818532465, "timesteps_total": 30720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 70862.386, "sample_time_ms": 5955.114, "load_time_ms": 0.278, "load_throughput": 1843491.843, "learn_time_ms": 64906.546, "learn_throughput": 7.888, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 1920, "training_iteration": 60, "trial_id": "f4e01_00169", "date": "2024-02-27_01-14-19", "timestamp": 1708992859, "time_this_iter_s": 71.96386647224426, "time_total_s": 4301.869421243668, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4301.869421243668, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 52.59117647058823, "ram_util_percent": 20.724509803921563}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -25.6, "reward_total_min": -64, "reward_total_max": 53, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9140625, "reward_score_mean": 0.3, "reward_score_min": 0.0, "reward_score_max": 0.9140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9748691607266664, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.110354310274124, "policy_loss": -0.0002649724871541063, "vf_loss": 9.59736889998118, "vf_explained_var": 0.9426596517364184, "kl": 0.0, "entropy": 95.57914212544759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "sampler_results": {"episode_reward_max": 53.0, "episode_reward_min": -64.0, "episode_reward_mean": -25.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -25.6, "reward_total_min": -64, "reward_total_max": 53, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9140625, "reward_score_mean": 0.3, "reward_score_min": 0.0, "reward_score_max": 0.9140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-3.0, -64.0, -37.0, -24.0, -1.0, 2.0, -35.0, -48.0, -64.0, -36.0, -64.0, -64.0, -63.0, -45.0, -64.0, -62.0, 21.0, -63.0, -43.0, 27.0, -64.0, -40.0, -6.0, -39.0, -40.0, 5.0, -50.0, -64.0, -64.0, -46.0, -6.0, 17.0, 34.0, 0.0, 21.0, 13.0, -51.0, -48.0, 43.0, -51.0, 22.0, -48.0, 29.0, -64.0, -51.0, 24.0, -64.0, -52.0, 23.0, 8.0, 1.0, -50.0, -63.0, 29.0, 9.0, 28.0, -64.0, 43.0, 38.0, -55.0, -46.0, -64.0, -45.0, -64.0, 22.0, -53.0, 28.0, 49.0, -48.0, -46.0, -56.0, -57.0, -64.0, 53.0, -55.0, -64.0, 53.0, -57.0, -55.0, -18.0, -64.0, -53.0, 39.0, -64.0, -63.0, -45.0, 43.0, -53.0, 32.0, 23.0, -49.0, -55.0, 33.0, -64.0, -46.0, -50.0, -49.0, -64.0, -44.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2931535384138155, "mean_inference_ms": 9.696239679247336, "mean_action_processing_ms": 0.45383606115699143, "mean_env_wait_ms": 0.28909877666693085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26636290550231934, "StateBufferConnector_ms": 0.004363298416137695, "ViewRequirementAgentConnector_ms": 0.18541646003723145}}, "episode_reward_max": 53.0, "episode_reward_min": -64.0, "episode_reward_mean": -25.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -64.0, -37.0, -24.0, -1.0, 2.0, -35.0, -48.0, -64.0, -36.0, -64.0, -64.0, -63.0, -45.0, -64.0, -62.0, 21.0, -63.0, -43.0, 27.0, -64.0, -40.0, -6.0, -39.0, -40.0, 5.0, -50.0, -64.0, -64.0, -46.0, -6.0, 17.0, 34.0, 0.0, 21.0, 13.0, -51.0, -48.0, 43.0, -51.0, 22.0, -48.0, 29.0, -64.0, -51.0, 24.0, -64.0, -52.0, 23.0, 8.0, 1.0, -50.0, -63.0, 29.0, 9.0, 28.0, -64.0, 43.0, 38.0, -55.0, -46.0, -64.0, -45.0, -64.0, 22.0, -53.0, 28.0, 49.0, -48.0, -46.0, -56.0, -57.0, -64.0, 53.0, -55.0, -64.0, 53.0, -57.0, -55.0, -18.0, -64.0, -53.0, 39.0, -64.0, -63.0, -45.0, 43.0, -53.0, 32.0, 23.0, -49.0, -55.0, 33.0, -64.0, -46.0, -50.0, -49.0, -64.0, -44.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2931535384138155, "mean_inference_ms": 9.696239679247336, "mean_action_processing_ms": 0.45383606115699143, "mean_env_wait_ms": 0.28909877666693085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26636290550231934, "StateBufferConnector_ms": 0.004363298416137695, "ViewRequirementAgentConnector_ms": 0.18541646003723145}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.175615808101902, "num_agent_steps_trained_throughput_per_sec": 7.175615808101902, "timesteps_total": 31232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31232, "timers": {"training_iteration_time_ms": 71000.495, "sample_time_ms": 5973.967, "load_time_ms": 0.284, "load_throughput": 1805518.453, "learn_time_ms": 65025.781, "learn_throughput": 7.874, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "done": false, "episodes_total": 1952, "training_iteration": 61, "trial_id": "f4e01_00169", "date": "2024-02-27_01-15-30", "timestamp": 1708992930, "time_this_iter_s": 71.35788178443909, "time_total_s": 4373.227303028107, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4373.227303028107, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 53.05980392156863, "ram_util_percent": 20.647058823529406}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -21.28, "reward_total_min": -64, "reward_total_max": 53, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.33375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9140625, "reward_score_mean": 0.33375, "reward_score_min": 0.0, "reward_score_max": 0.9140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.6465674837430315, "policy_loss": 0.09429193050600589, "vf_loss": 7.1498266081015265, "vf_explained_var": 0.978780810534954, "kl": 0.0, "entropy": 96.88881855010986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "sampler_results": {"episode_reward_max": 53.0, "episode_reward_min": -64.0, "episode_reward_mean": -21.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -21.28, "reward_total_min": -64, "reward_total_max": 53, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.33375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9140625, "reward_score_mean": 0.33375, "reward_score_min": 0.0, "reward_score_max": 0.9140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [34.0, 0.0, 21.0, 13.0, -51.0, -48.0, 43.0, -51.0, 22.0, -48.0, 29.0, -64.0, -51.0, 24.0, -64.0, -52.0, 23.0, 8.0, 1.0, -50.0, -63.0, 29.0, 9.0, 28.0, -64.0, 43.0, 38.0, -55.0, -46.0, -64.0, -45.0, -64.0, 22.0, -53.0, 28.0, 49.0, -48.0, -46.0, -56.0, -57.0, -64.0, 53.0, -55.0, -64.0, 53.0, -57.0, -55.0, -18.0, -64.0, -53.0, 39.0, -64.0, -63.0, -45.0, 43.0, -53.0, 32.0, 23.0, -49.0, -55.0, 33.0, -64.0, -46.0, -50.0, -49.0, -64.0, -44.0, 43.0, -63.0, -42.0, -64.0, -64.0, 48.0, -47.0, -33.0, -64.0, 31.0, -64.0, -6.0, -52.0, -35.0, 31.0, -64.0, 48.0, 14.0, 44.0, 41.0, 26.0, -46.0, -47.0, -48.0, -64.0, -62.0, -64.0, 37.0, -63.0, 33.0, -8.0, 16.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2927534273397354, "mean_inference_ms": 9.694714075721745, "mean_action_processing_ms": 0.45370483546459967, "mean_env_wait_ms": 0.2890180933238183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26604723930358887, "StateBufferConnector_ms": 0.0043370723724365234, "ViewRequirementAgentConnector_ms": 0.183335542678833}}, "episode_reward_max": 53.0, "episode_reward_min": -64.0, "episode_reward_mean": -21.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.0, 0.0, 21.0, 13.0, -51.0, -48.0, 43.0, -51.0, 22.0, -48.0, 29.0, -64.0, -51.0, 24.0, -64.0, -52.0, 23.0, 8.0, 1.0, -50.0, -63.0, 29.0, 9.0, 28.0, -64.0, 43.0, 38.0, -55.0, -46.0, -64.0, -45.0, -64.0, 22.0, -53.0, 28.0, 49.0, -48.0, -46.0, -56.0, -57.0, -64.0, 53.0, -55.0, -64.0, 53.0, -57.0, -55.0, -18.0, -64.0, -53.0, 39.0, -64.0, -63.0, -45.0, 43.0, -53.0, 32.0, 23.0, -49.0, -55.0, 33.0, -64.0, -46.0, -50.0, -49.0, -64.0, -44.0, 43.0, -63.0, -42.0, -64.0, -64.0, 48.0, -47.0, -33.0, -64.0, 31.0, -64.0, -6.0, -52.0, -35.0, 31.0, -64.0, 48.0, 14.0, 44.0, 41.0, 26.0, -46.0, -47.0, -48.0, -64.0, -62.0, -64.0, 37.0, -63.0, 33.0, -8.0, 16.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2927534273397354, "mean_inference_ms": 9.694714075721745, "mean_action_processing_ms": 0.45370483546459967, "mean_env_wait_ms": 0.2890180933238183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26604723930358887, "StateBufferConnector_ms": 0.0043370723724365234, "ViewRequirementAgentConnector_ms": 0.183335542678833}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.171194099431783, "num_agent_steps_trained_throughput_per_sec": 7.171194099431783, "timesteps_total": 31744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 71044.824, "sample_time_ms": 5954.609, "load_time_ms": 0.283, "load_throughput": 1809626.399, "learn_time_ms": 65089.455, "learn_throughput": 7.866, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "episodes_total": 1984, "training_iteration": 62, "trial_id": "f4e01_00169", "date": "2024-02-27_01-16-44", "timestamp": 1708993004, "time_this_iter_s": 71.40183424949646, "time_total_s": 4444.629137277603, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4444.629137277603, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 52.830769230769235, "ram_util_percent": 20.5875}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -21.93, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.328671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.328671875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.944864066441854, "policy_loss": -0.03707640913004676, "vf_loss": 7.824660336971283, "vf_explained_var": 0.973680266737938, "kl": 0.0, "entropy": 96.11622765858968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -21.93, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -21.93, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.328671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.328671875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [22.0, -53.0, 28.0, 49.0, -48.0, -46.0, -56.0, -57.0, -64.0, 53.0, -55.0, -64.0, 53.0, -57.0, -55.0, -18.0, -64.0, -53.0, 39.0, -64.0, -63.0, -45.0, 43.0, -53.0, 32.0, 23.0, -49.0, -55.0, 33.0, -64.0, -46.0, -50.0, -49.0, -64.0, -44.0, 43.0, -63.0, -42.0, -64.0, -64.0, 48.0, -47.0, -33.0, -64.0, 31.0, -64.0, -6.0, -52.0, -35.0, 31.0, -64.0, 48.0, 14.0, 44.0, 41.0, 26.0, -46.0, -47.0, -48.0, -64.0, -62.0, -64.0, 37.0, -63.0, 33.0, -8.0, 16.0, -64.0, -64.0, 44.0, -49.0, -50.0, 49.0, -45.0, 1.0, -47.0, 59.0, -64.0, -49.0, 39.0, -64.0, -64.0, 31.0, -5.0, -64.0, -53.0, -51.0, -63.0, 33.0, -20.0, 28.0, -38.0, 33.0, -54.0, 12.0, -49.0, -46.0, 28.0, -52.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2923049457910614, "mean_inference_ms": 9.693061730401368, "mean_action_processing_ms": 0.4535813262000215, "mean_env_wait_ms": 0.28894208548054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26609277725219727, "StateBufferConnector_ms": 0.00433802604675293, "ViewRequirementAgentConnector_ms": 0.18648600578308105}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -21.93, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.0, -53.0, 28.0, 49.0, -48.0, -46.0, -56.0, -57.0, -64.0, 53.0, -55.0, -64.0, 53.0, -57.0, -55.0, -18.0, -64.0, -53.0, 39.0, -64.0, -63.0, -45.0, 43.0, -53.0, 32.0, 23.0, -49.0, -55.0, 33.0, -64.0, -46.0, -50.0, -49.0, -64.0, -44.0, 43.0, -63.0, -42.0, -64.0, -64.0, 48.0, -47.0, -33.0, -64.0, 31.0, -64.0, -6.0, -52.0, -35.0, 31.0, -64.0, 48.0, 14.0, 44.0, 41.0, 26.0, -46.0, -47.0, -48.0, -64.0, -62.0, -64.0, 37.0, -63.0, 33.0, -8.0, 16.0, -64.0, -64.0, 44.0, -49.0, -50.0, 49.0, -45.0, 1.0, -47.0, 59.0, -64.0, -49.0, 39.0, -64.0, -64.0, 31.0, -5.0, -64.0, -53.0, -51.0, -63.0, 33.0, -20.0, 28.0, -38.0, 33.0, -54.0, 12.0, -49.0, -46.0, 28.0, -52.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2923049457910614, "mean_inference_ms": 9.693061730401368, "mean_action_processing_ms": 0.4535813262000215, "mean_env_wait_ms": 0.28894208548054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26609277725219727, "StateBufferConnector_ms": 0.00433802604675293, "ViewRequirementAgentConnector_ms": 0.18648600578308105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1309367472062215, "num_agent_steps_trained_throughput_per_sec": 7.1309367472062215, "timesteps_total": 32256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 71124.01, "sample_time_ms": 5956.934, "load_time_ms": 0.283, "load_throughput": 1811763.813, "learn_time_ms": 65166.318, "learn_throughput": 7.857, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 2016, "training_iteration": 63, "trial_id": "f4e01_00169", "date": "2024-02-27_01-17-56", "timestamp": 1708993076, "time_this_iter_s": 71.80498719215393, "time_total_s": 4516.434124469757, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4516.434124469757, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 53.23333333333334, "ram_util_percent": 20.747058823529414}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -21.13, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.334921875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.334921875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9942945291598638, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.999241534868876, "policy_loss": -0.019987898614878454, "vf_loss": 9.45383154153824, "vf_explained_var": 0.9317298750082652, "kl": 0.0, "entropy": 96.79472204844157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -21.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -21.13, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.334921875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.334921875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -64.0, -44.0, 43.0, -63.0, -42.0, -64.0, -64.0, 48.0, -47.0, -33.0, -64.0, 31.0, -64.0, -6.0, -52.0, -35.0, 31.0, -64.0, 48.0, 14.0, 44.0, 41.0, 26.0, -46.0, -47.0, -48.0, -64.0, -62.0, -64.0, 37.0, -63.0, 33.0, -8.0, 16.0, -64.0, -64.0, 44.0, -49.0, -50.0, 49.0, -45.0, 1.0, -47.0, 59.0, -64.0, -49.0, 39.0, -64.0, -64.0, 31.0, -5.0, -64.0, -53.0, -51.0, -63.0, 33.0, -20.0, 28.0, -38.0, 33.0, -54.0, 12.0, -49.0, -46.0, 28.0, -52.0, 54.0, 33.0, -50.0, -54.0, -63.0, -49.0, -47.0, 12.0, 33.0, -64.0, 54.0, -55.0, -64.0, 49.0, -63.0, -51.0, -48.0, 26.0, -64.0, -49.0, 58.0, 28.0, -58.0, -47.0, -64.0, -49.0, 16.0, -49.0, -46.0, -2.0, 17.0, 36.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2920736397757744, "mean_inference_ms": 9.691669191185783, "mean_action_processing_ms": 0.45349127796685723, "mean_env_wait_ms": 0.2888925694356499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26920604705810547, "StateBufferConnector_ms": 0.00435328483581543, "ViewRequirementAgentConnector_ms": 0.19104576110839844}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -21.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -64.0, -44.0, 43.0, -63.0, -42.0, -64.0, -64.0, 48.0, -47.0, -33.0, -64.0, 31.0, -64.0, -6.0, -52.0, -35.0, 31.0, -64.0, 48.0, 14.0, 44.0, 41.0, 26.0, -46.0, -47.0, -48.0, -64.0, -62.0, -64.0, 37.0, -63.0, 33.0, -8.0, 16.0, -64.0, -64.0, 44.0, -49.0, -50.0, 49.0, -45.0, 1.0, -47.0, 59.0, -64.0, -49.0, 39.0, -64.0, -64.0, 31.0, -5.0, -64.0, -53.0, -51.0, -63.0, 33.0, -20.0, 28.0, -38.0, 33.0, -54.0, 12.0, -49.0, -46.0, 28.0, -52.0, 54.0, 33.0, -50.0, -54.0, -63.0, -49.0, -47.0, 12.0, 33.0, -64.0, 54.0, -55.0, -64.0, 49.0, -63.0, -51.0, -48.0, 26.0, -64.0, -49.0, 58.0, 28.0, -58.0, -47.0, -64.0, -49.0, 16.0, -49.0, -46.0, -2.0, 17.0, 36.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2920736397757744, "mean_inference_ms": 9.691669191185783, "mean_action_processing_ms": 0.45349127796685723, "mean_env_wait_ms": 0.2888925694356499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26920604705810547, "StateBufferConnector_ms": 0.00435328483581543, "ViewRequirementAgentConnector_ms": 0.19104576110839844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.146588603782334, "num_agent_steps_trained_throughput_per_sec": 7.146588603782334, "timesteps_total": 32768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 71229.771, "sample_time_ms": 5962.356, "load_time_ms": 0.286, "load_throughput": 1788824.363, "learn_time_ms": 65266.64, "learn_throughput": 7.845, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 2048, "training_iteration": 64, "trial_id": "f4e01_00169", "date": "2024-02-27_01-19-08", "timestamp": 1708993148, "time_this_iter_s": 71.64848732948303, "time_total_s": 4588.08261179924, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4588.08261179924, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 52.89607843137255, "ram_util_percent": 20.860784313725496}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -23.09, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.319609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.319609375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9985508387287457, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.79767455458641, "policy_loss": 0.06631041122600437, "vf_loss": 9.001709028085072, "vf_explained_var": 0.9137093206246694, "kl": 0.0, "entropy": 96.478977394104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -23.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -23.09, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.319609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.319609375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [33.0, -8.0, 16.0, -64.0, -64.0, 44.0, -49.0, -50.0, 49.0, -45.0, 1.0, -47.0, 59.0, -64.0, -49.0, 39.0, -64.0, -64.0, 31.0, -5.0, -64.0, -53.0, -51.0, -63.0, 33.0, -20.0, 28.0, -38.0, 33.0, -54.0, 12.0, -49.0, -46.0, 28.0, -52.0, 54.0, 33.0, -50.0, -54.0, -63.0, -49.0, -47.0, 12.0, 33.0, -64.0, 54.0, -55.0, -64.0, 49.0, -63.0, -51.0, -48.0, 26.0, -64.0, -49.0, 58.0, 28.0, -58.0, -47.0, -64.0, -49.0, 16.0, -49.0, -46.0, -2.0, 17.0, 36.0, -50.0, 20.0, -64.0, -49.0, -50.0, -47.0, -48.0, -7.0, -45.0, -44.0, -64.0, -47.0, -46.0, -52.0, -3.0, -30.0, 49.0, -40.0, -62.0, -63.0, -45.0, -10.0, -64.0, -64.0, 48.0, 10.0, -63.0, 17.0, -63.0, -64.0, 49.0, 5.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292247011893778, "mean_inference_ms": 9.69186201616365, "mean_action_processing_ms": 0.45354143065867647, "mean_env_wait_ms": 0.28892570720989563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2732737064361572, "StateBufferConnector_ms": 0.004506587982177734, "ViewRequirementAgentConnector_ms": 0.19675588607788086}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -23.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, -8.0, 16.0, -64.0, -64.0, 44.0, -49.0, -50.0, 49.0, -45.0, 1.0, -47.0, 59.0, -64.0, -49.0, 39.0, -64.0, -64.0, 31.0, -5.0, -64.0, -53.0, -51.0, -63.0, 33.0, -20.0, 28.0, -38.0, 33.0, -54.0, 12.0, -49.0, -46.0, 28.0, -52.0, 54.0, 33.0, -50.0, -54.0, -63.0, -49.0, -47.0, 12.0, 33.0, -64.0, 54.0, -55.0, -64.0, 49.0, -63.0, -51.0, -48.0, 26.0, -64.0, -49.0, 58.0, 28.0, -58.0, -47.0, -64.0, -49.0, 16.0, -49.0, -46.0, -2.0, 17.0, 36.0, -50.0, 20.0, -64.0, -49.0, -50.0, -47.0, -48.0, -7.0, -45.0, -44.0, -64.0, -47.0, -46.0, -52.0, -3.0, -30.0, 49.0, -40.0, -62.0, -63.0, -45.0, -10.0, -64.0, -64.0, 48.0, 10.0, -63.0, 17.0, -63.0, -64.0, 49.0, 5.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292247011893778, "mean_inference_ms": 9.69186201616365, "mean_action_processing_ms": 0.45354143065867647, "mean_env_wait_ms": 0.28892570720989563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2732737064361572, "StateBufferConnector_ms": 0.004506587982177734, "ViewRequirementAgentConnector_ms": 0.19675588607788086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.088702806923553, "num_agent_steps_trained_throughput_per_sec": 7.088702806923553, "timesteps_total": 33280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 71390.036, "sample_time_ms": 5974.247, "load_time_ms": 0.289, "load_throughput": 1772875.133, "learn_time_ms": 65414.998, "learn_throughput": 7.827, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 2080, "training_iteration": 65, "trial_id": "f4e01_00169", "date": "2024-02-27_01-20-20", "timestamp": 1708993220, "time_this_iter_s": 72.23280382156372, "time_total_s": 4660.315415620804, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4660.315415620804, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 53.96764705882353, "ram_util_percent": 20.849019607843147}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -22.32, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.325625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.325625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9995188092192014, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.853356921672821, "policy_loss": -0.028760886875291665, "vf_loss": 9.238483313719431, "vf_explained_var": 0.9667418559392293, "kl": 0.0, "entropy": 95.29269599914551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -22.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -22.32, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.325625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.325625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, 28.0, -52.0, 54.0, 33.0, -50.0, -54.0, -63.0, -49.0, -47.0, 12.0, 33.0, -64.0, 54.0, -55.0, -64.0, 49.0, -63.0, -51.0, -48.0, 26.0, -64.0, -49.0, 58.0, 28.0, -58.0, -47.0, -64.0, -49.0, 16.0, -49.0, -46.0, -2.0, 17.0, 36.0, -50.0, 20.0, -64.0, -49.0, -50.0, -47.0, -48.0, -7.0, -45.0, -44.0, -64.0, -47.0, -46.0, -52.0, -3.0, -30.0, 49.0, -40.0, -62.0, -63.0, -45.0, -10.0, -64.0, -64.0, 48.0, 10.0, -63.0, 17.0, -63.0, -64.0, 49.0, 5.0, -46.0, 12.0, 48.0, 33.0, 0.0, -3.0, -48.0, -64.0, -42.0, -63.0, -38.0, -35.0, -64.0, -39.0, 54.0, 44.0, -42.0, 54.0, -33.0, -45.0, -64.0, 37.0, -45.0, -63.0, -48.0, 39.0, 15.0, 43.0, -39.0, -29.0, -33.0, -17.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2926026311339205, "mean_inference_ms": 9.693353851857713, "mean_action_processing_ms": 0.4536131955811769, "mean_env_wait_ms": 0.2889943472511038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27507901191711426, "StateBufferConnector_ms": 0.004525661468505859, "ViewRequirementAgentConnector_ms": 0.19720911979675293}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -22.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, 28.0, -52.0, 54.0, 33.0, -50.0, -54.0, -63.0, -49.0, -47.0, 12.0, 33.0, -64.0, 54.0, -55.0, -64.0, 49.0, -63.0, -51.0, -48.0, 26.0, -64.0, -49.0, 58.0, 28.0, -58.0, -47.0, -64.0, -49.0, 16.0, -49.0, -46.0, -2.0, 17.0, 36.0, -50.0, 20.0, -64.0, -49.0, -50.0, -47.0, -48.0, -7.0, -45.0, -44.0, -64.0, -47.0, -46.0, -52.0, -3.0, -30.0, 49.0, -40.0, -62.0, -63.0, -45.0, -10.0, -64.0, -64.0, 48.0, 10.0, -63.0, 17.0, -63.0, -64.0, 49.0, 5.0, -46.0, 12.0, 48.0, 33.0, 0.0, -3.0, -48.0, -64.0, -42.0, -63.0, -38.0, -35.0, -64.0, -39.0, 54.0, 44.0, -42.0, 54.0, -33.0, -45.0, -64.0, 37.0, -45.0, -63.0, -48.0, 39.0, 15.0, 43.0, -39.0, -29.0, -33.0, -17.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2926026311339205, "mean_inference_ms": 9.693353851857713, "mean_action_processing_ms": 0.4536131955811769, "mean_env_wait_ms": 0.2889943472511038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27507901191711426, "StateBufferConnector_ms": 0.004525661468505859, "ViewRequirementAgentConnector_ms": 0.19720911979675293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0994671249820005, "num_agent_steps_trained_throughput_per_sec": 7.0994671249820005, "timesteps_total": 33792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 71556.128, "sample_time_ms": 5987.063, "load_time_ms": 0.287, "load_throughput": 1784217.056, "learn_time_ms": 65568.281, "learn_throughput": 7.809, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "episodes_total": 2112, "training_iteration": 66, "trial_id": "f4e01_00169", "date": "2024-02-27_01-21-32", "timestamp": 1708993292, "time_this_iter_s": 72.12327671051025, "time_total_s": 4732.438692331314, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4732.438692331314, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 54.095145631067965, "ram_util_percent": 20.878640776699037}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.67, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.377578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.377578125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.760302865505219, "policy_loss": -0.007763362132633725, "vf_loss": 9.059353427092235, "vf_explained_var": 0.947810045381387, "kl": 0.0, "entropy": 93.72716547648112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -15.67, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.67, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.377578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.377578125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-2.0, 17.0, 36.0, -50.0, 20.0, -64.0, -49.0, -50.0, -47.0, -48.0, -7.0, -45.0, -44.0, -64.0, -47.0, -46.0, -52.0, -3.0, -30.0, 49.0, -40.0, -62.0, -63.0, -45.0, -10.0, -64.0, -64.0, 48.0, 10.0, -63.0, 17.0, -63.0, -64.0, 49.0, 5.0, -46.0, 12.0, 48.0, 33.0, 0.0, -3.0, -48.0, -64.0, -42.0, -63.0, -38.0, -35.0, -64.0, -39.0, 54.0, 44.0, -42.0, 54.0, -33.0, -45.0, -64.0, 37.0, -45.0, -63.0, -48.0, 39.0, 15.0, 43.0, -39.0, -29.0, -33.0, -17.0, -35.0, -64.0, -2.0, 6.0, -47.0, 48.0, 34.0, -41.0, 58.0, 51.0, 22.0, -47.0, 17.0, -64.0, 22.0, 42.0, -55.0, -43.0, -49.0, -36.0, 38.0, 42.0, 53.0, -37.0, -7.0, -41.0, 48.0, -10.0, 59.0, -44.0, -8.0, -64.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292932859034841, "mean_inference_ms": 9.694693431966147, "mean_action_processing_ms": 0.453643775256792, "mean_env_wait_ms": 0.28909227223202166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2729520797729492, "StateBufferConnector_ms": 0.004698514938354492, "ViewRequirementAgentConnector_ms": 0.19403362274169922}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -15.67, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0, 17.0, 36.0, -50.0, 20.0, -64.0, -49.0, -50.0, -47.0, -48.0, -7.0, -45.0, -44.0, -64.0, -47.0, -46.0, -52.0, -3.0, -30.0, 49.0, -40.0, -62.0, -63.0, -45.0, -10.0, -64.0, -64.0, 48.0, 10.0, -63.0, 17.0, -63.0, -64.0, 49.0, 5.0, -46.0, 12.0, 48.0, 33.0, 0.0, -3.0, -48.0, -64.0, -42.0, -63.0, -38.0, -35.0, -64.0, -39.0, 54.0, 44.0, -42.0, 54.0, -33.0, -45.0, -64.0, 37.0, -45.0, -63.0, -48.0, 39.0, 15.0, 43.0, -39.0, -29.0, -33.0, -17.0, -35.0, -64.0, -2.0, 6.0, -47.0, 48.0, 34.0, -41.0, 58.0, 51.0, 22.0, -47.0, 17.0, -64.0, 22.0, 42.0, -55.0, -43.0, -49.0, -36.0, 38.0, 42.0, 53.0, -37.0, -7.0, -41.0, 48.0, -10.0, 59.0, -44.0, -8.0, -64.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292932859034841, "mean_inference_ms": 9.694693431966147, "mean_action_processing_ms": 0.453643775256792, "mean_env_wait_ms": 0.28909227223202166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2729520797729492, "StateBufferConnector_ms": 0.004698514938354492, "ViewRequirementAgentConnector_ms": 0.19403362274169922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.099571358834287, "num_agent_steps_trained_throughput_per_sec": 7.099571358834287, "timesteps_total": 34304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34304, "timers": {"training_iteration_time_ms": 71624.533, "sample_time_ms": 6006.411, "load_time_ms": 0.298, "load_throughput": 1717025.384, "learn_time_ms": 65617.323, "learn_throughput": 7.803, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "done": false, "episodes_total": 2144, "training_iteration": 67, "trial_id": "f4e01_00169", "date": "2024-02-27_01-22-47", "timestamp": 1708993367, "time_this_iter_s": 72.12207269668579, "time_total_s": 4804.560765028, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4804.560765028, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 52.57714285714286, "ram_util_percent": 20.925714285714285}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.4, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.4109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.4109375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9971816122531891, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.831038578351339, "policy_loss": -0.023532430167930822, "vf_loss": 9.195218253135682, "vf_explained_var": 0.9514764875173569, "kl": 0.0, "entropy": 96.66554457346598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -11.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.4, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.4109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.4109375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 49.0, 5.0, -46.0, 12.0, 48.0, 33.0, 0.0, -3.0, -48.0, -64.0, -42.0, -63.0, -38.0, -35.0, -64.0, -39.0, 54.0, 44.0, -42.0, 54.0, -33.0, -45.0, -64.0, 37.0, -45.0, -63.0, -48.0, 39.0, 15.0, 43.0, -39.0, -29.0, -33.0, -17.0, -35.0, -64.0, -2.0, 6.0, -47.0, 48.0, 34.0, -41.0, 58.0, 51.0, 22.0, -47.0, 17.0, -64.0, 22.0, 42.0, -55.0, -43.0, -49.0, -36.0, 38.0, 42.0, 53.0, -37.0, -7.0, -41.0, 48.0, -10.0, 59.0, -44.0, -8.0, -64.0, 43.0, -27.0, -32.0, 28.0, -43.0, -51.0, 48.0, -49.0, -64.0, 49.0, -10.0, -64.0, 0.0, -34.0, -33.0, -45.0, 38.0, -63.0, 26.0, -63.0, -36.0, 25.0, -44.0, 34.0, -64.0, 26.0, 22.0, -23.0, 22.0, 4.0, -40.0, -44.0, 9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2932512759862231, "mean_inference_ms": 9.695657177726703, "mean_action_processing_ms": 0.45361983692540675, "mean_env_wait_ms": 0.28917313354902746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27284717559814453, "StateBufferConnector_ms": 0.004700422286987305, "ViewRequirementAgentConnector_ms": 0.19351673126220703}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -11.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 49.0, 5.0, -46.0, 12.0, 48.0, 33.0, 0.0, -3.0, -48.0, -64.0, -42.0, -63.0, -38.0, -35.0, -64.0, -39.0, 54.0, 44.0, -42.0, 54.0, -33.0, -45.0, -64.0, 37.0, -45.0, -63.0, -48.0, 39.0, 15.0, 43.0, -39.0, -29.0, -33.0, -17.0, -35.0, -64.0, -2.0, 6.0, -47.0, 48.0, 34.0, -41.0, 58.0, 51.0, 22.0, -47.0, 17.0, -64.0, 22.0, 42.0, -55.0, -43.0, -49.0, -36.0, 38.0, 42.0, 53.0, -37.0, -7.0, -41.0, 48.0, -10.0, 59.0, -44.0, -8.0, -64.0, 43.0, -27.0, -32.0, 28.0, -43.0, -51.0, 48.0, -49.0, -64.0, 49.0, -10.0, -64.0, 0.0, -34.0, -33.0, -45.0, 38.0, -63.0, 26.0, -63.0, -36.0, 25.0, -44.0, 34.0, -64.0, 26.0, 22.0, -23.0, 22.0, 4.0, -40.0, -44.0, 9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2932512759862231, "mean_inference_ms": 9.695657177726703, "mean_action_processing_ms": 0.45361983692540675, "mean_env_wait_ms": 0.28917313354902746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27284717559814453, "StateBufferConnector_ms": 0.004700422286987305, "ViewRequirementAgentConnector_ms": 0.19351673126220703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.142197763677207, "num_agent_steps_trained_throughput_per_sec": 7.142197763677207, "timesteps_total": 34816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 71717.421, "sample_time_ms": 6030.703, "load_time_ms": 0.306, "load_throughput": 1671583.753, "learn_time_ms": 65685.907, "learn_throughput": 7.795, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "episodes_total": 2176, "training_iteration": 68, "trial_id": "f4e01_00169", "date": "2024-02-27_01-23-58", "timestamp": 1708993438, "time_this_iter_s": 71.69180154800415, "time_total_s": 4876.252566576004, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4876.252566576004, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 52.89705882352941, "ram_util_percent": 20.97352941176471}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.38, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.41890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.41890625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.447167474031448, "policy_loss": 0.011842060492684443, "vf_loss": 8.536749056975047, "vf_explained_var": 0.977251224219799, "kl": 0.0, "entropy": 96.4903112411499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -10.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.38, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.41890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.41890625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-29.0, -33.0, -17.0, -35.0, -64.0, -2.0, 6.0, -47.0, 48.0, 34.0, -41.0, 58.0, 51.0, 22.0, -47.0, 17.0, -64.0, 22.0, 42.0, -55.0, -43.0, -49.0, -36.0, 38.0, 42.0, 53.0, -37.0, -7.0, -41.0, 48.0, -10.0, 59.0, -44.0, -8.0, -64.0, 43.0, -27.0, -32.0, 28.0, -43.0, -51.0, 48.0, -49.0, -64.0, 49.0, -10.0, -64.0, 0.0, -34.0, -33.0, -45.0, 38.0, -63.0, 26.0, -63.0, -36.0, 25.0, -44.0, 34.0, -64.0, 26.0, 22.0, -23.0, 22.0, 4.0, -40.0, -44.0, 9.0, -64.0, -55.0, -45.0, -64.0, 20.0, -40.0, 54.0, -55.0, -42.0, 34.0, -46.0, 34.0, 36.0, 44.0, 22.0, 59.0, 15.0, -64.0, -51.0, 30.0, 24.0, 7.0, 26.0, -41.0, -50.0, -49.0, 15.0, -63.0, 21.0, -41.0, -47.0, 26.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2936473013809446, "mean_inference_ms": 9.696342791919669, "mean_action_processing_ms": 0.45365707465056765, "mean_env_wait_ms": 0.28928615964857557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2725718021392822, "StateBufferConnector_ms": 0.00473475456237793, "ViewRequirementAgentConnector_ms": 0.19561028480529785}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -10.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29.0, -33.0, -17.0, -35.0, -64.0, -2.0, 6.0, -47.0, 48.0, 34.0, -41.0, 58.0, 51.0, 22.0, -47.0, 17.0, -64.0, 22.0, 42.0, -55.0, -43.0, -49.0, -36.0, 38.0, 42.0, 53.0, -37.0, -7.0, -41.0, 48.0, -10.0, 59.0, -44.0, -8.0, -64.0, 43.0, -27.0, -32.0, 28.0, -43.0, -51.0, 48.0, -49.0, -64.0, 49.0, -10.0, -64.0, 0.0, -34.0, -33.0, -45.0, 38.0, -63.0, 26.0, -63.0, -36.0, 25.0, -44.0, 34.0, -64.0, 26.0, 22.0, -23.0, 22.0, 4.0, -40.0, -44.0, 9.0, -64.0, -55.0, -45.0, -64.0, 20.0, -40.0, 54.0, -55.0, -42.0, 34.0, -46.0, 34.0, 36.0, 44.0, 22.0, 59.0, 15.0, -64.0, -51.0, 30.0, 24.0, 7.0, 26.0, -41.0, -50.0, -49.0, 15.0, -63.0, 21.0, -41.0, -47.0, 26.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2936473013809446, "mean_inference_ms": 9.696342791919669, "mean_action_processing_ms": 0.45365707465056765, "mean_env_wait_ms": 0.28928615964857557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2725718021392822, "StateBufferConnector_ms": 0.00473475456237793, "ViewRequirementAgentConnector_ms": 0.19561028480529785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.028249418450887, "num_agent_steps_trained_throughput_per_sec": 7.028249418450887, "timesteps_total": 35328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35328, "timers": {"training_iteration_time_ms": 71914.843, "sample_time_ms": 6035.948, "load_time_ms": 0.317, "load_throughput": 1615135.114, "learn_time_ms": 65878.058, "learn_throughput": 7.772, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "done": false, "episodes_total": 2208, "training_iteration": 69, "trial_id": "f4e01_00169", "date": "2024-02-27_01-25-11", "timestamp": 1708993511, "time_this_iter_s": 72.8539354801178, "time_total_s": 4949.106502056122, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4949.106502056122, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 52.8116504854369, "ram_util_percent": 20.838834951456317}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.2, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.3890625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.665495280424754, "policy_loss": -0.024718594551086426, "vf_loss": 8.937078277269999, "vf_explained_var": 0.9743919397393862, "kl": 0.0, "entropy": 97.44287751515706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -14.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.2, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.3890625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -8.0, -64.0, 43.0, -27.0, -32.0, 28.0, -43.0, -51.0, 48.0, -49.0, -64.0, 49.0, -10.0, -64.0, 0.0, -34.0, -33.0, -45.0, 38.0, -63.0, 26.0, -63.0, -36.0, 25.0, -44.0, 34.0, -64.0, 26.0, 22.0, -23.0, 22.0, 4.0, -40.0, -44.0, 9.0, -64.0, -55.0, -45.0, -64.0, 20.0, -40.0, 54.0, -55.0, -42.0, 34.0, -46.0, 34.0, 36.0, 44.0, 22.0, 59.0, 15.0, -64.0, -51.0, 30.0, 24.0, 7.0, 26.0, -41.0, -50.0, -49.0, 15.0, -63.0, 21.0, -41.0, -47.0, 26.0, -58.0, -55.0, 28.0, 38.0, 33.0, 53.0, 43.0, 25.0, -64.0, 54.0, -49.0, -40.0, -37.0, -64.0, 39.0, -64.0, -54.0, -50.0, -31.0, 15.0, -52.0, -64.0, -64.0, -43.0, -51.0, -64.0, 48.0, -32.0, 7.0, -48.0, 49.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937323873897595, "mean_inference_ms": 9.695664214895972, "mean_action_processing_ms": 0.45360651886343967, "mean_env_wait_ms": 0.2892803456969728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2704660892486572, "StateBufferConnector_ms": 0.0045397281646728516, "ViewRequirementAgentConnector_ms": 0.18988585472106934}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -14.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -8.0, -64.0, 43.0, -27.0, -32.0, 28.0, -43.0, -51.0, 48.0, -49.0, -64.0, 49.0, -10.0, -64.0, 0.0, -34.0, -33.0, -45.0, 38.0, -63.0, 26.0, -63.0, -36.0, 25.0, -44.0, 34.0, -64.0, 26.0, 22.0, -23.0, 22.0, 4.0, -40.0, -44.0, 9.0, -64.0, -55.0, -45.0, -64.0, 20.0, -40.0, 54.0, -55.0, -42.0, 34.0, -46.0, 34.0, 36.0, 44.0, 22.0, 59.0, 15.0, -64.0, -51.0, 30.0, 24.0, 7.0, 26.0, -41.0, -50.0, -49.0, 15.0, -63.0, 21.0, -41.0, -47.0, 26.0, -58.0, -55.0, 28.0, 38.0, 33.0, 53.0, 43.0, 25.0, -64.0, 54.0, -49.0, -40.0, -37.0, -64.0, 39.0, -64.0, -54.0, -50.0, -31.0, 15.0, -52.0, -64.0, -64.0, -43.0, -51.0, -64.0, 48.0, -32.0, 7.0, -48.0, 49.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937323873897595, "mean_inference_ms": 9.695664214895972, "mean_action_processing_ms": 0.45360651886343967, "mean_env_wait_ms": 0.2892803456969728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2704660892486572, "StateBufferConnector_ms": 0.0045397281646728516, "ViewRequirementAgentConnector_ms": 0.18988585472106934}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.042629530037047, "num_agent_steps_trained_throughput_per_sec": 7.042629530037047, "timesteps_total": 35840, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 71988.989, "sample_time_ms": 6020.646, "load_time_ms": 0.341, "load_throughput": 1502892.888, "learn_time_ms": 65967.484, "learn_throughput": 7.761, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "episodes_total": 2240, "training_iteration": 70, "trial_id": "f4e01_00169", "date": "2024-02-27_01-26-24", "timestamp": 1708993584, "time_this_iter_s": 72.70550465583801, "time_total_s": 5021.81200671196, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5021.81200671196, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 53.584466019417476, "ram_util_percent": 20.930097087378634}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.63, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.385703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.385703125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9909410730004311, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.591487314303716, "policy_loss": -0.006990327523089946, "vf_loss": 8.792996752262116, "vf_explained_var": 0.9718425254027049, "kl": 0.0, "entropy": 98.64181156158448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -14.63, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.63, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.385703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.385703125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [4.0, -40.0, -44.0, 9.0, -64.0, -55.0, -45.0, -64.0, 20.0, -40.0, 54.0, -55.0, -42.0, 34.0, -46.0, 34.0, 36.0, 44.0, 22.0, 59.0, 15.0, -64.0, -51.0, 30.0, 24.0, 7.0, 26.0, -41.0, -50.0, -49.0, 15.0, -63.0, 21.0, -41.0, -47.0, 26.0, -58.0, -55.0, 28.0, 38.0, 33.0, 53.0, 43.0, 25.0, -64.0, 54.0, -49.0, -40.0, -37.0, -64.0, 39.0, -64.0, -54.0, -50.0, -31.0, 15.0, -52.0, -64.0, -64.0, -43.0, -51.0, -64.0, 48.0, -32.0, 7.0, -48.0, 49.0, 53.0, -41.0, -43.0, 54.0, -43.0, -64.0, -52.0, -44.0, -43.0, 53.0, 58.0, 53.0, -55.0, -64.0, 53.0, -34.0, -46.0, 19.0, 11.0, 47.0, 28.0, -52.0, -41.0, -46.0, -53.0, -45.0, -24.0, 38.0, -46.0, -53.0, -39.0, 22.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2953336682344938, "mean_inference_ms": 9.696323814732814, "mean_action_processing_ms": 0.4536719736024999, "mean_env_wait_ms": 0.28934505237458197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27418088912963867, "StateBufferConnector_ms": 0.00452423095703125, "ViewRequirementAgentConnector_ms": 0.19699335098266602}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -14.63, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.0, -40.0, -44.0, 9.0, -64.0, -55.0, -45.0, -64.0, 20.0, -40.0, 54.0, -55.0, -42.0, 34.0, -46.0, 34.0, 36.0, 44.0, 22.0, 59.0, 15.0, -64.0, -51.0, 30.0, 24.0, 7.0, 26.0, -41.0, -50.0, -49.0, 15.0, -63.0, 21.0, -41.0, -47.0, 26.0, -58.0, -55.0, 28.0, 38.0, 33.0, 53.0, 43.0, 25.0, -64.0, 54.0, -49.0, -40.0, -37.0, -64.0, 39.0, -64.0, -54.0, -50.0, -31.0, 15.0, -52.0, -64.0, -64.0, -43.0, -51.0, -64.0, 48.0, -32.0, 7.0, -48.0, 49.0, 53.0, -41.0, -43.0, 54.0, -43.0, -64.0, -52.0, -44.0, -43.0, 53.0, 58.0, 53.0, -55.0, -64.0, 53.0, -34.0, -46.0, 19.0, 11.0, 47.0, 28.0, -52.0, -41.0, -46.0, -53.0, -45.0, -24.0, 38.0, -46.0, -53.0, -39.0, 22.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2953336682344938, "mean_inference_ms": 9.696323814732814, "mean_action_processing_ms": 0.4536719736024999, "mean_env_wait_ms": 0.28934505237458197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27418088912963867, "StateBufferConnector_ms": 0.00452423095703125, "ViewRequirementAgentConnector_ms": 0.19699335098266602}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.012646243728177, "num_agent_steps_trained_throughput_per_sec": 7.012646243728177, "timesteps_total": 36352, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36352, "timers": {"training_iteration_time_ms": 72154.807, "sample_time_ms": 6062.828, "load_time_ms": 0.34, "load_throughput": 1505526.955, "learn_time_ms": 66091.089, "learn_throughput": 7.747, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "done": false, "episodes_total": 2272, "training_iteration": 71, "trial_id": "f4e01_00169", "date": "2024-02-27_01-27-37", "timestamp": 1708993657, "time_this_iter_s": 73.01646566390991, "time_total_s": 5094.82847237587, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5094.82847237587, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 52.717307692307685, "ram_util_percent": 21.049038461538462}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -16.45, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.371484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.371484375, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.746453110376994, "policy_loss": -0.03524498607342442, "vf_loss": 7.510158638159434, "vf_explained_var": 0.9884340350826581, "kl": 0.0, "entropy": 97.80829054514567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -16.45, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -16.45, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.371484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.371484375, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [21.0, -41.0, -47.0, 26.0, -58.0, -55.0, 28.0, 38.0, 33.0, 53.0, 43.0, 25.0, -64.0, 54.0, -49.0, -40.0, -37.0, -64.0, 39.0, -64.0, -54.0, -50.0, -31.0, 15.0, -52.0, -64.0, -64.0, -43.0, -51.0, -64.0, 48.0, -32.0, 7.0, -48.0, 49.0, 53.0, -41.0, -43.0, 54.0, -43.0, -64.0, -52.0, -44.0, -43.0, 53.0, 58.0, 53.0, -55.0, -64.0, 53.0, -34.0, -46.0, 19.0, 11.0, 47.0, 28.0, -52.0, -41.0, -46.0, -53.0, -45.0, -24.0, 38.0, -46.0, -53.0, -39.0, 22.0, -51.0, -64.0, 48.0, -56.0, -56.0, 48.0, -50.0, -49.0, 42.0, -48.0, 48.0, 42.0, -52.0, -49.0, 7.0, 32.0, -64.0, 33.0, -36.0, -64.0, -64.0, 49.0, -43.0, 53.0, -64.0, -64.0, 14.0, -52.0, -54.0, 53.0, -64.0, -64.0, 26.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.296786084694059, "mean_inference_ms": 9.69663027325859, "mean_action_processing_ms": 0.4537146365224817, "mean_env_wait_ms": 0.2893785677745567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27448344230651855, "StateBufferConnector_ms": 0.004475831985473633, "ViewRequirementAgentConnector_ms": 0.19408130645751953}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -16.45, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, -41.0, -47.0, 26.0, -58.0, -55.0, 28.0, 38.0, 33.0, 53.0, 43.0, 25.0, -64.0, 54.0, -49.0, -40.0, -37.0, -64.0, 39.0, -64.0, -54.0, -50.0, -31.0, 15.0, -52.0, -64.0, -64.0, -43.0, -51.0, -64.0, 48.0, -32.0, 7.0, -48.0, 49.0, 53.0, -41.0, -43.0, 54.0, -43.0, -64.0, -52.0, -44.0, -43.0, 53.0, 58.0, 53.0, -55.0, -64.0, 53.0, -34.0, -46.0, 19.0, 11.0, 47.0, 28.0, -52.0, -41.0, -46.0, -53.0, -45.0, -24.0, 38.0, -46.0, -53.0, -39.0, 22.0, -51.0, -64.0, 48.0, -56.0, -56.0, 48.0, -50.0, -49.0, 42.0, -48.0, 48.0, 42.0, -52.0, -49.0, 7.0, 32.0, -64.0, 33.0, -36.0, -64.0, -64.0, 49.0, -43.0, 53.0, -64.0, -64.0, 14.0, -52.0, -54.0, 53.0, -64.0, -64.0, 26.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.296786084694059, "mean_inference_ms": 9.69663027325859, "mean_action_processing_ms": 0.4537146365224817, "mean_env_wait_ms": 0.2893785677745567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27448344230651855, "StateBufferConnector_ms": 0.004475831985473633, "ViewRequirementAgentConnector_ms": 0.19408130645751953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.063891601559047, "num_agent_steps_trained_throughput_per_sec": 7.063891601559047, "timesteps_total": 36864, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 72263.26, "sample_time_ms": 6078.183, "load_time_ms": 0.342, "load_throughput": 1495253.898, "learn_time_ms": 66184.193, "learn_throughput": 7.736, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 2304, "training_iteration": 72, "trial_id": "f4e01_00169", "date": "2024-02-27_01-28-50", "timestamp": 1708993730, "time_this_iter_s": 72.48661065101624, "time_total_s": 5167.315083026886, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5167.315083026886, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 52.49411764705881, "ram_util_percent": 21.171568627450988}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -17.56, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3628125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.3628125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9988214070598285, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.926936197280884, "policy_loss": -0.0062766984105110165, "vf_loss": 9.318733676274617, "vf_explained_var": 0.9850310881932577, "kl": 0.0, "entropy": 99.15095545450846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -17.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -17.56, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3628125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.3628125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [7.0, -48.0, 49.0, 53.0, -41.0, -43.0, 54.0, -43.0, -64.0, -52.0, -44.0, -43.0, 53.0, 58.0, 53.0, -55.0, -64.0, 53.0, -34.0, -46.0, 19.0, 11.0, 47.0, 28.0, -52.0, -41.0, -46.0, -53.0, -45.0, -24.0, 38.0, -46.0, -53.0, -39.0, 22.0, -51.0, -64.0, 48.0, -56.0, -56.0, 48.0, -50.0, -49.0, 42.0, -48.0, 48.0, 42.0, -52.0, -49.0, 7.0, 32.0, -64.0, 33.0, -36.0, -64.0, -64.0, 49.0, -43.0, 53.0, -64.0, -64.0, 14.0, -52.0, -54.0, 53.0, -64.0, -64.0, 26.0, 54.0, 53.0, -54.0, -33.0, -36.0, 33.0, -64.0, -36.0, 49.0, -64.0, 59.0, -49.0, 28.0, -64.0, -57.0, -55.0, -45.0, -55.0, -64.0, -51.0, 54.0, -49.0, -53.0, 27.0, 33.0, 42.0, -64.0, -49.0, -36.0, -64.0, -49.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2985436643930512, "mean_inference_ms": 9.698585823664494, "mean_action_processing_ms": 0.4538727960366289, "mean_env_wait_ms": 0.2895030922997755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27999424934387207, "StateBufferConnector_ms": 0.0045092105865478516, "ViewRequirementAgentConnector_ms": 0.20202231407165527}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -17.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.0, -48.0, 49.0, 53.0, -41.0, -43.0, 54.0, -43.0, -64.0, -52.0, -44.0, -43.0, 53.0, 58.0, 53.0, -55.0, -64.0, 53.0, -34.0, -46.0, 19.0, 11.0, 47.0, 28.0, -52.0, -41.0, -46.0, -53.0, -45.0, -24.0, 38.0, -46.0, -53.0, -39.0, 22.0, -51.0, -64.0, 48.0, -56.0, -56.0, 48.0, -50.0, -49.0, 42.0, -48.0, 48.0, 42.0, -52.0, -49.0, 7.0, 32.0, -64.0, 33.0, -36.0, -64.0, -64.0, 49.0, -43.0, 53.0, -64.0, -64.0, 14.0, -52.0, -54.0, 53.0, -64.0, -64.0, 26.0, 54.0, 53.0, -54.0, -33.0, -36.0, 33.0, -64.0, -36.0, 49.0, -64.0, 59.0, -49.0, 28.0, -64.0, -57.0, -55.0, -45.0, -55.0, -64.0, -51.0, 54.0, -49.0, -53.0, 27.0, 33.0, 42.0, -64.0, -49.0, -36.0, -64.0, -49.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2985436643930512, "mean_inference_ms": 9.698585823664494, "mean_action_processing_ms": 0.4538727960366289, "mean_env_wait_ms": 0.2895030922997755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27999424934387207, "StateBufferConnector_ms": 0.0045092105865478516, "ViewRequirementAgentConnector_ms": 0.20202231407165527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.993286566370613, "num_agent_steps_trained_throughput_per_sec": 6.993286566370613, "timesteps_total": 37376, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37376, "timers": {"training_iteration_time_ms": 72404.586, "sample_time_ms": 6092.865, "load_time_ms": 0.346, "load_throughput": 1480002.514, "learn_time_ms": 66310.835, "learn_throughput": 7.721, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "done": false, "episodes_total": 2336, "training_iteration": 73, "trial_id": "f4e01_00169", "date": "2024-02-27_01-30-03", "timestamp": 1708993803, "time_this_iter_s": 73.21822237968445, "time_total_s": 5240.53330540657, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5240.53330540657, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 52.75096153846154, "ram_util_percent": 21.324038461538464}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -20.88, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.336875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.336875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.228717517852783, "policy_loss": -0.04169117559989293, "vf_loss": 8.277730027834574, "vf_explained_var": 0.9817141522963841, "kl": 0.0, "entropy": 101.14257907867432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -20.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -20.88, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.336875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.336875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-53.0, -39.0, 22.0, -51.0, -64.0, 48.0, -56.0, -56.0, 48.0, -50.0, -49.0, 42.0, -48.0, 48.0, 42.0, -52.0, -49.0, 7.0, 32.0, -64.0, 33.0, -36.0, -64.0, -64.0, 49.0, -43.0, 53.0, -64.0, -64.0, 14.0, -52.0, -54.0, 53.0, -64.0, -64.0, 26.0, 54.0, 53.0, -54.0, -33.0, -36.0, 33.0, -64.0, -36.0, 49.0, -64.0, 59.0, -49.0, 28.0, -64.0, -57.0, -55.0, -45.0, -55.0, -64.0, -51.0, 54.0, -49.0, -53.0, 27.0, 33.0, 42.0, -64.0, -49.0, -36.0, -64.0, -49.0, -53.0, 53.0, 43.0, 53.0, -64.0, -44.0, -53.0, -64.0, -46.0, 44.0, -55.0, -42.0, -21.0, 49.0, -35.0, -49.0, 34.0, -47.0, -31.0, -60.0, -40.0, -56.0, -63.0, -64.0, -64.0, 43.0, -53.0, -47.0, 28.0, -64.0, 48.0, -54.0, 28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299233108618846, "mean_inference_ms": 9.701661366287283, "mean_action_processing_ms": 0.4540826512808131, "mean_env_wait_ms": 0.2896607993958798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2823824882507324, "StateBufferConnector_ms": 0.004582405090332031, "ViewRequirementAgentConnector_ms": 0.2061758041381836}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -20.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.0, -39.0, 22.0, -51.0, -64.0, 48.0, -56.0, -56.0, 48.0, -50.0, -49.0, 42.0, -48.0, 48.0, 42.0, -52.0, -49.0, 7.0, 32.0, -64.0, 33.0, -36.0, -64.0, -64.0, 49.0, -43.0, 53.0, -64.0, -64.0, 14.0, -52.0, -54.0, 53.0, -64.0, -64.0, 26.0, 54.0, 53.0, -54.0, -33.0, -36.0, 33.0, -64.0, -36.0, 49.0, -64.0, 59.0, -49.0, 28.0, -64.0, -57.0, -55.0, -45.0, -55.0, -64.0, -51.0, 54.0, -49.0, -53.0, 27.0, 33.0, 42.0, -64.0, -49.0, -36.0, -64.0, -49.0, -53.0, 53.0, 43.0, 53.0, -64.0, -44.0, -53.0, -64.0, -46.0, 44.0, -55.0, -42.0, -21.0, 49.0, -35.0, -49.0, 34.0, -47.0, -31.0, -60.0, -40.0, -56.0, -63.0, -64.0, -64.0, 43.0, -53.0, -47.0, 28.0, -64.0, 48.0, -54.0, 28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299233108618846, "mean_inference_ms": 9.701661366287283, "mean_action_processing_ms": 0.4540826512808131, "mean_env_wait_ms": 0.2896607993958798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2823824882507324, "StateBufferConnector_ms": 0.004582405090332031, "ViewRequirementAgentConnector_ms": 0.2061758041381836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.956939726886187, "num_agent_steps_trained_throughput_per_sec": 6.956939726886187, "timesteps_total": 37888, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 72599.884, "sample_time_ms": 6126.327, "load_time_ms": 0.339, "load_throughput": 1511035.497, "learn_time_ms": 66472.679, "learn_throughput": 7.702, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "episodes_total": 2368, "training_iteration": 74, "trial_id": "f4e01_00169", "date": "2024-02-27_01-31-16", "timestamp": 1708993876, "time_this_iter_s": 73.60107398033142, "time_total_s": 5314.134379386902, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5314.134379386902, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 53.638461538461534, "ram_util_percent": 21.415384615384614}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -19.29, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.349296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.349296875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.558015980323156, "policy_loss": -0.013674503937363625, "vf_loss": 8.750924650828043, "vf_explained_var": 0.9832685048381488, "kl": 0.0, "entropy": 100.5502290725708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -19.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -19.29, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.349296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.349296875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, -64.0, -64.0, 26.0, 54.0, 53.0, -54.0, -33.0, -36.0, 33.0, -64.0, -36.0, 49.0, -64.0, 59.0, -49.0, 28.0, -64.0, -57.0, -55.0, -45.0, -55.0, -64.0, -51.0, 54.0, -49.0, -53.0, 27.0, 33.0, 42.0, -64.0, -49.0, -36.0, -64.0, -49.0, -53.0, 53.0, 43.0, 53.0, -64.0, -44.0, -53.0, -64.0, -46.0, 44.0, -55.0, -42.0, -21.0, 49.0, -35.0, -49.0, 34.0, -47.0, -31.0, -60.0, -40.0, -56.0, -63.0, -64.0, -64.0, 43.0, -53.0, -47.0, 28.0, -64.0, 48.0, -54.0, 28.0, -60.0, -64.0, 53.0, 23.0, 23.0, -64.0, -43.0, -64.0, -28.0, -56.0, -21.0, 49.0, 54.0, 44.0, -36.0, -54.0, 34.0, -57.0, 59.0, -55.0, -63.0, -55.0, -46.0, -51.0, 49.0, 32.0, 18.0, -57.0, 31.0, 19.0, -55.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2996794396605282, "mean_inference_ms": 9.704251124093169, "mean_action_processing_ms": 0.45422379440269156, "mean_env_wait_ms": 0.2897867840325396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2814209461212158, "StateBufferConnector_ms": 0.004587650299072266, "ViewRequirementAgentConnector_ms": 0.2065746784210205}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -19.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, -64.0, -64.0, 26.0, 54.0, 53.0, -54.0, -33.0, -36.0, 33.0, -64.0, -36.0, 49.0, -64.0, 59.0, -49.0, 28.0, -64.0, -57.0, -55.0, -45.0, -55.0, -64.0, -51.0, 54.0, -49.0, -53.0, 27.0, 33.0, 42.0, -64.0, -49.0, -36.0, -64.0, -49.0, -53.0, 53.0, 43.0, 53.0, -64.0, -44.0, -53.0, -64.0, -46.0, 44.0, -55.0, -42.0, -21.0, 49.0, -35.0, -49.0, 34.0, -47.0, -31.0, -60.0, -40.0, -56.0, -63.0, -64.0, -64.0, 43.0, -53.0, -47.0, 28.0, -64.0, 48.0, -54.0, 28.0, -60.0, -64.0, 53.0, 23.0, 23.0, -64.0, -43.0, -64.0, -28.0, -56.0, -21.0, 49.0, 54.0, 44.0, -36.0, -54.0, 34.0, -57.0, 59.0, -55.0, -63.0, -55.0, -46.0, -51.0, 49.0, 32.0, 18.0, -57.0, 31.0, 19.0, -55.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2996794396605282, "mean_inference_ms": 9.704251124093169, "mean_action_processing_ms": 0.45422379440269156, "mean_env_wait_ms": 0.2897867840325396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2814209461212158, "StateBufferConnector_ms": 0.004587650299072266, "ViewRequirementAgentConnector_ms": 0.2065746784210205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.07059803734903, "num_agent_steps_trained_throughput_per_sec": 7.07059803734903, "timesteps_total": 38400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 72618.377, "sample_time_ms": 6113.54, "load_time_ms": 0.339, "load_throughput": 1511567.289, "learn_time_ms": 66503.947, "learn_throughput": 7.699, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 2400, "training_iteration": 75, "trial_id": "f4e01_00169", "date": "2024-02-27_01-32-29", "timestamp": 1708993949, "time_this_iter_s": 72.41797399520874, "time_total_s": 5386.552353382111, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5386.552353382111, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 52.73689320388351, "ram_util_percent": 21.12815533980583}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -16.25, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.373046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.373046875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9959680745999019, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.2030861655871075, "policy_loss": -0.004938222374767065, "vf_loss": 9.750353837013245, "vf_explained_var": 0.9748215332627297, "kl": 0.0, "entropy": 99.99815896352132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -16.25, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -16.25, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.373046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.373046875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-36.0, -64.0, -49.0, -53.0, 53.0, 43.0, 53.0, -64.0, -44.0, -53.0, -64.0, -46.0, 44.0, -55.0, -42.0, -21.0, 49.0, -35.0, -49.0, 34.0, -47.0, -31.0, -60.0, -40.0, -56.0, -63.0, -64.0, -64.0, 43.0, -53.0, -47.0, 28.0, -64.0, 48.0, -54.0, 28.0, -60.0, -64.0, 53.0, 23.0, 23.0, -64.0, -43.0, -64.0, -28.0, -56.0, -21.0, 49.0, 54.0, 44.0, -36.0, -54.0, 34.0, -57.0, 59.0, -55.0, -63.0, -55.0, -46.0, -51.0, 49.0, 32.0, 18.0, -57.0, 31.0, 19.0, -55.0, -34.0, 48.0, 37.0, -63.0, -63.0, -52.0, -64.0, 43.0, 39.0, 38.0, 25.0, -53.0, -64.0, -39.0, 48.0, -40.0, 47.0, -64.0, -64.0, -52.0, 34.0, -64.0, -64.0, 58.0, -22.0, -51.0, 38.0, 48.0, -53.0, 54.0, 52.0, -40.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2997200952502939, "mean_inference_ms": 9.704466678641879, "mean_action_processing_ms": 0.45420872960312875, "mean_env_wait_ms": 0.28978176395011646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27070045471191406, "StateBufferConnector_ms": 0.004459381103515625, "ViewRequirementAgentConnector_ms": 0.19371795654296875}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -16.25, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.0, -64.0, -49.0, -53.0, 53.0, 43.0, 53.0, -64.0, -44.0, -53.0, -64.0, -46.0, 44.0, -55.0, -42.0, -21.0, 49.0, -35.0, -49.0, 34.0, -47.0, -31.0, -60.0, -40.0, -56.0, -63.0, -64.0, -64.0, 43.0, -53.0, -47.0, 28.0, -64.0, 48.0, -54.0, 28.0, -60.0, -64.0, 53.0, 23.0, 23.0, -64.0, -43.0, -64.0, -28.0, -56.0, -21.0, 49.0, 54.0, 44.0, -36.0, -54.0, 34.0, -57.0, 59.0, -55.0, -63.0, -55.0, -46.0, -51.0, 49.0, 32.0, 18.0, -57.0, 31.0, 19.0, -55.0, -34.0, 48.0, 37.0, -63.0, -63.0, -52.0, -64.0, 43.0, 39.0, 38.0, 25.0, -53.0, -64.0, -39.0, 48.0, -40.0, 47.0, -64.0, -64.0, -52.0, 34.0, -64.0, -64.0, 58.0, -22.0, -51.0, 38.0, 48.0, -53.0, 54.0, 52.0, -40.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2997200952502939, "mean_inference_ms": 9.704466678641879, "mean_action_processing_ms": 0.45420872960312875, "mean_env_wait_ms": 0.28978176395011646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27070045471191406, "StateBufferConnector_ms": 0.004459381103515625, "ViewRequirementAgentConnector_ms": 0.19371795654296875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.124868135021988, "num_agent_steps_trained_throughput_per_sec": 7.124868135021988, "timesteps_total": 38912, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 72592.666, "sample_time_ms": 6075.386, "load_time_ms": 0.337, "load_throughput": 1519266.819, "learn_time_ms": 66516.387, "learn_throughput": 7.697, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "episodes_total": 2432, "training_iteration": 76, "trial_id": "f4e01_00169", "date": "2024-02-27_01-33-41", "timestamp": 1708994021, "time_this_iter_s": 71.86617541313171, "time_total_s": 5458.418528795242, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5458.418528795242, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 52.856862745098034, "ram_util_percent": 20.84019607843138}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.06, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.39015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.39015625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9257759974648555, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.299267550309499, "policy_loss": 0.004101262078620493, "vf_loss": 9.887219560146331, "vf_explained_var": 0.9733254243930181, "kl": 0.0, "entropy": 104.22748076121012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -14.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.06, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.39015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.39015625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 48.0, -54.0, 28.0, -60.0, -64.0, 53.0, 23.0, 23.0, -64.0, -43.0, -64.0, -28.0, -56.0, -21.0, 49.0, 54.0, 44.0, -36.0, -54.0, 34.0, -57.0, 59.0, -55.0, -63.0, -55.0, -46.0, -51.0, 49.0, 32.0, 18.0, -57.0, 31.0, 19.0, -55.0, -34.0, 48.0, 37.0, -63.0, -63.0, -52.0, -64.0, 43.0, 39.0, 38.0, 25.0, -53.0, -64.0, -39.0, 48.0, -40.0, 47.0, -64.0, -64.0, -52.0, 34.0, -64.0, -64.0, 58.0, -22.0, -51.0, 38.0, 48.0, -53.0, 54.0, 52.0, -40.0, 48.0, -64.0, -43.0, 54.0, -56.0, -27.0, -63.0, -56.0, -21.0, -63.0, -64.0, 48.0, 44.0, -64.0, -64.0, -54.0, -39.0, 47.0, 48.0, -12.0, 43.0, -56.0, -56.0, -64.0, 33.0, 54.0, -28.0, -64.0, 54.0, -21.0, -64.0, -64.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995635891209592, "mean_inference_ms": 9.703493864875247, "mean_action_processing_ms": 0.45409690026683164, "mean_env_wait_ms": 0.2897046798140686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679314613342285, "StateBufferConnector_ms": 0.004441022872924805, "ViewRequirementAgentConnector_ms": 0.1909337043762207}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": -14.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 48.0, -54.0, 28.0, -60.0, -64.0, 53.0, 23.0, 23.0, -64.0, -43.0, -64.0, -28.0, -56.0, -21.0, 49.0, 54.0, 44.0, -36.0, -54.0, 34.0, -57.0, 59.0, -55.0, -63.0, -55.0, -46.0, -51.0, 49.0, 32.0, 18.0, -57.0, 31.0, 19.0, -55.0, -34.0, 48.0, 37.0, -63.0, -63.0, -52.0, -64.0, 43.0, 39.0, 38.0, 25.0, -53.0, -64.0, -39.0, 48.0, -40.0, 47.0, -64.0, -64.0, -52.0, 34.0, -64.0, -64.0, 58.0, -22.0, -51.0, 38.0, 48.0, -53.0, 54.0, 52.0, -40.0, 48.0, -64.0, -43.0, 54.0, -56.0, -27.0, -63.0, -56.0, -21.0, -63.0, -64.0, 48.0, 44.0, -64.0, -64.0, -54.0, -39.0, 47.0, 48.0, -12.0, 43.0, -56.0, -56.0, -64.0, 33.0, 54.0, -28.0, -64.0, 54.0, -21.0, -64.0, -64.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995635891209592, "mean_inference_ms": 9.703493864875247, "mean_action_processing_ms": 0.45409690026683164, "mean_env_wait_ms": 0.2897046798140686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679314613342285, "StateBufferConnector_ms": 0.004441022872924805, "ViewRequirementAgentConnector_ms": 0.1909337043762207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.13520533263823, "num_agent_steps_trained_throughput_per_sec": 7.13520533263823, "timesteps_total": 39424, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39424, "timers": {"training_iteration_time_ms": 72556.649, "sample_time_ms": 6090.277, "load_time_ms": 0.334, "load_throughput": 1531510.232, "learn_time_ms": 66465.478, "learn_throughput": 7.703, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "done": false, "episodes_total": 2464, "training_iteration": 77, "trial_id": "f4e01_00169", "date": "2024-02-27_01-34-53", "timestamp": 1708994093, "time_this_iter_s": 71.76182198524475, "time_total_s": 5530.180350780487, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5530.180350780487, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 52.787254901960786, "ram_util_percent": 20.897058823529417}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.75, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.400390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.400390625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9851201097170512, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.0075072884559635, "policy_loss": -0.018847404684250554, "vf_loss": 9.465022603670755, "vf_explained_var": 0.9110696385304133, "kl": 0.0, "entropy": 102.12972119649251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -12.75, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.75, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.400390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.400390625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [31.0, 19.0, -55.0, -34.0, 48.0, 37.0, -63.0, -63.0, -52.0, -64.0, 43.0, 39.0, 38.0, 25.0, -53.0, -64.0, -39.0, 48.0, -40.0, 47.0, -64.0, -64.0, -52.0, 34.0, -64.0, -64.0, 58.0, -22.0, -51.0, 38.0, 48.0, -53.0, 54.0, 52.0, -40.0, 48.0, -64.0, -43.0, 54.0, -56.0, -27.0, -63.0, -56.0, -21.0, -63.0, -64.0, 48.0, 44.0, -64.0, -64.0, -54.0, -39.0, 47.0, 48.0, -12.0, 43.0, -56.0, -56.0, -64.0, 33.0, 54.0, -28.0, -64.0, 54.0, -21.0, -64.0, -64.0, 48.0, 44.0, 53.0, 53.0, 37.0, -54.0, -50.0, -4.0, 39.0, -63.0, -27.0, 19.0, -50.0, 32.0, 49.0, -64.0, -32.0, -55.0, -43.0, -42.0, -3.0, -62.0, 11.0, -44.0, -61.0, -52.0, -62.0, 7.0, 53.0, -59.0, 43.0, -14.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995274552258258, "mean_inference_ms": 9.703266211041058, "mean_action_processing_ms": 0.45406956149727834, "mean_env_wait_ms": 0.28966992503361694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2685973644256592, "StateBufferConnector_ms": 0.0044438838958740234, "ViewRequirementAgentConnector_ms": 0.19370508193969727}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -12.75, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.0, 19.0, -55.0, -34.0, 48.0, 37.0, -63.0, -63.0, -52.0, -64.0, 43.0, 39.0, 38.0, 25.0, -53.0, -64.0, -39.0, 48.0, -40.0, 47.0, -64.0, -64.0, -52.0, 34.0, -64.0, -64.0, 58.0, -22.0, -51.0, 38.0, 48.0, -53.0, 54.0, 52.0, -40.0, 48.0, -64.0, -43.0, 54.0, -56.0, -27.0, -63.0, -56.0, -21.0, -63.0, -64.0, 48.0, 44.0, -64.0, -64.0, -54.0, -39.0, 47.0, 48.0, -12.0, 43.0, -56.0, -56.0, -64.0, 33.0, 54.0, -28.0, -64.0, 54.0, -21.0, -64.0, -64.0, 48.0, 44.0, 53.0, 53.0, 37.0, -54.0, -50.0, -4.0, 39.0, -63.0, -27.0, 19.0, -50.0, 32.0, 49.0, -64.0, -32.0, -55.0, -43.0, -42.0, -3.0, -62.0, 11.0, -44.0, -61.0, -52.0, -62.0, 7.0, 53.0, -59.0, 43.0, -14.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995274552258258, "mean_inference_ms": 9.703266211041058, "mean_action_processing_ms": 0.45406956149727834, "mean_env_wait_ms": 0.28966992503361694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2685973644256592, "StateBufferConnector_ms": 0.0044438838958740234, "ViewRequirementAgentConnector_ms": 0.19370508193969727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0881786301950065, "num_agent_steps_trained_throughput_per_sec": 7.0881786301950065, "timesteps_total": 39936, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 72611.282, "sample_time_ms": 6100.1, "load_time_ms": 0.332, "load_throughput": 1544285.667, "learn_time_ms": 66510.288, "learn_throughput": 7.698, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "episodes_total": 2496, "training_iteration": 78, "trial_id": "f4e01_00169", "date": "2024-02-27_01-36-06", "timestamp": 1708994166, "time_this_iter_s": 72.23804235458374, "time_total_s": 5602.418393135071, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5602.418393135071, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 54.02038834951457, "ram_util_percent": 20.88543689320389}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -4.54, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.46453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.46453125, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.715719477335612, "policy_loss": 0.0259110312598447, "vf_loss": 8.936441417535146, "vf_explained_var": 0.9825610140959422, "kl": 0.0, "entropy": 95.68110014597575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -4.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -4.54, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.46453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.46453125, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 52.0, -40.0, 48.0, -64.0, -43.0, 54.0, -56.0, -27.0, -63.0, -56.0, -21.0, -63.0, -64.0, 48.0, 44.0, -64.0, -64.0, -54.0, -39.0, 47.0, 48.0, -12.0, 43.0, -56.0, -56.0, -64.0, 33.0, 54.0, -28.0, -64.0, 54.0, -21.0, -64.0, -64.0, 48.0, 44.0, 53.0, 53.0, 37.0, -54.0, -50.0, -4.0, 39.0, -63.0, -27.0, 19.0, -50.0, 32.0, 49.0, -64.0, -32.0, -55.0, -43.0, -42.0, -3.0, -62.0, 11.0, -44.0, -61.0, -52.0, -62.0, 7.0, 53.0, -59.0, 43.0, -14.0, 54.0, 43.0, 11.0, 43.0, 52.0, 44.0, 31.0, 48.0, -53.0, -10.0, 53.0, -50.0, -55.0, 42.0, 49.0, -50.0, -53.0, 25.0, 48.0, 53.0, 44.0, -57.0, 43.0, -63.0, 47.0, 49.0, -54.0, -53.0, -2.0, 49.0, 43.0, 48.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2998363285490202, "mean_inference_ms": 9.705191074430115, "mean_action_processing_ms": 0.454185568928579, "mean_env_wait_ms": 0.2897545639304128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27670884132385254, "StateBufferConnector_ms": 0.0046274662017822266, "ViewRequirementAgentConnector_ms": 0.20508837699890137}}, "episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -4.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 52.0, -40.0, 48.0, -64.0, -43.0, 54.0, -56.0, -27.0, -63.0, -56.0, -21.0, -63.0, -64.0, 48.0, 44.0, -64.0, -64.0, -54.0, -39.0, 47.0, 48.0, -12.0, 43.0, -56.0, -56.0, -64.0, 33.0, 54.0, -28.0, -64.0, 54.0, -21.0, -64.0, -64.0, 48.0, 44.0, 53.0, 53.0, 37.0, -54.0, -50.0, -4.0, 39.0, -63.0, -27.0, 19.0, -50.0, 32.0, 49.0, -64.0, -32.0, -55.0, -43.0, -42.0, -3.0, -62.0, 11.0, -44.0, -61.0, -52.0, -62.0, 7.0, 53.0, -59.0, 43.0, -14.0, 54.0, 43.0, 11.0, 43.0, 52.0, 44.0, 31.0, 48.0, -53.0, -10.0, 53.0, -50.0, -55.0, 42.0, 49.0, -50.0, -53.0, 25.0, 48.0, 53.0, 44.0, -57.0, 43.0, -63.0, 47.0, 49.0, -54.0, -53.0, -2.0, 49.0, 43.0, 48.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2998363285490202, "mean_inference_ms": 9.705191074430115, "mean_action_processing_ms": 0.454185568928579, "mean_env_wait_ms": 0.2897545639304128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27670884132385254, "StateBufferConnector_ms": 0.0046274662017822266, "ViewRequirementAgentConnector_ms": 0.20508837699890137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.988241675627738, "num_agent_steps_trained_throughput_per_sec": 6.988241675627738, "timesteps_total": 40448, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40448, "timers": {"training_iteration_time_ms": 72652.988, "sample_time_ms": 6099.635, "load_time_ms": 0.326, "load_throughput": 1568307.637, "learn_time_ms": 66552.464, "learn_throughput": 7.693, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "done": false, "episodes_total": 2528, "training_iteration": 79, "trial_id": "f4e01_00169", "date": "2024-02-27_01-37-19", "timestamp": 1708994239, "time_this_iter_s": 73.27112221717834, "time_total_s": 5675.689515352249, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5675.689515352249, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 55.8, "ram_util_percent": 20.75961538461539}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -2.43, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.481015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.481015625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.740660631656647, "policy_loss": -0.0005953116497645776, "vf_loss": 9.017245030403137, "vf_explained_var": 0.9878665775060653, "kl": 0.0, "entropy": 98.81226819356283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -2.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -2.43, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.481015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.481015625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-21.0, -64.0, -64.0, 48.0, 44.0, 53.0, 53.0, 37.0, -54.0, -50.0, -4.0, 39.0, -63.0, -27.0, 19.0, -50.0, 32.0, 49.0, -64.0, -32.0, -55.0, -43.0, -42.0, -3.0, -62.0, 11.0, -44.0, -61.0, -52.0, -62.0, 7.0, 53.0, -59.0, 43.0, -14.0, 54.0, 43.0, 11.0, 43.0, 52.0, 44.0, 31.0, 48.0, -53.0, -10.0, 53.0, -50.0, -55.0, 42.0, 49.0, -50.0, -53.0, 25.0, 48.0, 53.0, 44.0, -57.0, 43.0, -63.0, 47.0, 49.0, -54.0, -53.0, -2.0, 49.0, 43.0, 48.0, 48.0, 42.0, 34.0, 52.0, 49.0, 43.0, 43.0, -63.0, -55.0, 46.0, -53.0, -62.0, -56.0, 58.0, 37.0, -63.0, 31.0, -55.0, 53.0, -63.0, -61.0, -56.0, -51.0, 53.0, -64.0, -64.0, 53.0, 48.0, -55.0, -54.0, -46.0, 42.0, 29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3001806788902635, "mean_inference_ms": 9.707502327915138, "mean_action_processing_ms": 0.4543532917994517, "mean_env_wait_ms": 0.2898730544246164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779817581176758, "StateBufferConnector_ms": 0.004625797271728516, "ViewRequirementAgentConnector_ms": 0.20412731170654297}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -2.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.0, -64.0, -64.0, 48.0, 44.0, 53.0, 53.0, 37.0, -54.0, -50.0, -4.0, 39.0, -63.0, -27.0, 19.0, -50.0, 32.0, 49.0, -64.0, -32.0, -55.0, -43.0, -42.0, -3.0, -62.0, 11.0, -44.0, -61.0, -52.0, -62.0, 7.0, 53.0, -59.0, 43.0, -14.0, 54.0, 43.0, 11.0, 43.0, 52.0, 44.0, 31.0, 48.0, -53.0, -10.0, 53.0, -50.0, -55.0, 42.0, 49.0, -50.0, -53.0, 25.0, 48.0, 53.0, 44.0, -57.0, 43.0, -63.0, 47.0, 49.0, -54.0, -53.0, -2.0, 49.0, 43.0, 48.0, 48.0, 42.0, 34.0, 52.0, 49.0, 43.0, 43.0, -63.0, -55.0, 46.0, -53.0, -62.0, -56.0, 58.0, 37.0, -63.0, 31.0, -55.0, 53.0, -63.0, -61.0, -56.0, -51.0, 53.0, -64.0, -64.0, 53.0, 48.0, -55.0, -54.0, -46.0, 42.0, 29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3001806788902635, "mean_inference_ms": 9.707502327915138, "mean_action_processing_ms": 0.4543532917994517, "mean_env_wait_ms": 0.2898730544246164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779817581176758, "StateBufferConnector_ms": 0.004625797271728516, "ViewRequirementAgentConnector_ms": 0.20412731170654297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.070814873646589, "num_agent_steps_trained_throughput_per_sec": 7.070814873646589, "timesteps_total": 40960, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 72624.008, "sample_time_ms": 6136.245, "load_time_ms": 0.3, "load_throughput": 1706654.731, "learn_time_ms": 66486.894, "learn_throughput": 7.701, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 2560, "training_iteration": 80, "trial_id": "f4e01_00169", "date": "2024-02-27_01-38-31", "timestamp": 1708994311, "time_this_iter_s": 72.41578340530396, "time_total_s": 5748.105298757553, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5748.105298757553, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 52.74705882352941, "ram_util_percent": 20.746078431372556}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 5.23, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.540859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.540859375, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9982797051469485, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.906063163280487, "policy_loss": 0.008403676375746728, "vf_loss": 9.262893271446227, "vf_explained_var": 0.9256684129436811, "kl": 0.0, "entropy": 98.9437967936198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 5.23, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.540859375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.540859375, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, 43.0, -14.0, 54.0, 43.0, 11.0, 43.0, 52.0, 44.0, 31.0, 48.0, -53.0, -10.0, 53.0, -50.0, -55.0, 42.0, 49.0, -50.0, -53.0, 25.0, 48.0, 53.0, 44.0, -57.0, 43.0, -63.0, 47.0, 49.0, -54.0, -53.0, -2.0, 49.0, 43.0, 48.0, 48.0, 42.0, 34.0, 52.0, 49.0, 43.0, 43.0, -63.0, -55.0, 46.0, -53.0, -62.0, -56.0, 58.0, 37.0, -63.0, 31.0, -55.0, 53.0, -63.0, -61.0, -56.0, -51.0, 53.0, -64.0, -64.0, 53.0, 48.0, -55.0, -54.0, -46.0, 42.0, 29.0, -60.0, 43.0, 26.0, 33.0, 58.0, 53.0, -61.0, 38.0, -60.0, 33.0, -60.0, 42.0, 26.0, -1.0, -58.0, 44.0, -62.0, 42.0, 6.0, 21.0, 48.0, 44.0, -63.0, 52.0, -58.0, -59.0, 28.0, 43.0, 54.0, 38.0, 38.0, 26.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3004878989303665, "mean_inference_ms": 9.709338069873167, "mean_action_processing_ms": 0.45448752943948917, "mean_env_wait_ms": 0.28996877221235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27858591079711914, "StateBufferConnector_ms": 0.004627227783203125, "ViewRequirementAgentConnector_ms": 0.20240330696105957}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, 43.0, -14.0, 54.0, 43.0, 11.0, 43.0, 52.0, 44.0, 31.0, 48.0, -53.0, -10.0, 53.0, -50.0, -55.0, 42.0, 49.0, -50.0, -53.0, 25.0, 48.0, 53.0, 44.0, -57.0, 43.0, -63.0, 47.0, 49.0, -54.0, -53.0, -2.0, 49.0, 43.0, 48.0, 48.0, 42.0, 34.0, 52.0, 49.0, 43.0, 43.0, -63.0, -55.0, 46.0, -53.0, -62.0, -56.0, 58.0, 37.0, -63.0, 31.0, -55.0, 53.0, -63.0, -61.0, -56.0, -51.0, 53.0, -64.0, -64.0, 53.0, 48.0, -55.0, -54.0, -46.0, 42.0, 29.0, -60.0, 43.0, 26.0, 33.0, 58.0, 53.0, -61.0, 38.0, -60.0, 33.0, -60.0, 42.0, 26.0, -1.0, -58.0, 44.0, -62.0, 42.0, 6.0, 21.0, 48.0, 44.0, -63.0, 52.0, -58.0, -59.0, 28.0, 43.0, 54.0, 38.0, 38.0, 26.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3004878989303665, "mean_inference_ms": 9.709338069873167, "mean_action_processing_ms": 0.45448752943948917, "mean_env_wait_ms": 0.28996877221235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27858591079711914, "StateBufferConnector_ms": 0.004627227783203125, "ViewRequirementAgentConnector_ms": 0.20240330696105957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.051602559236014, "num_agent_steps_trained_throughput_per_sec": 7.051602559236014, "timesteps_total": 41472, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41472, "timers": {"training_iteration_time_ms": 72583.676, "sample_time_ms": 6105.303, "load_time_ms": 0.298, "load_throughput": 1715516.575, "learn_time_ms": 66477.537, "learn_throughput": 7.702, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "done": false, "episodes_total": 2592, "training_iteration": 81, "trial_id": "f4e01_00169", "date": "2024-02-27_01-39-44", "timestamp": 1708994384, "time_this_iter_s": 72.6128044128418, "time_total_s": 5820.718103170395, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5820.718103170395, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 52.79902912621358, "ram_util_percent": 20.80873786407767}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -1.48, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.4884375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.4884375, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.323636964956919, "policy_loss": -0.0033100970128240683, "vf_loss": 8.366529409090678, "vf_explained_var": 0.9841452072064082, "kl": 0.0, "entropy": 102.0031276067098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -1.48, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -1.48, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.4884375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.4884375, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [49.0, 43.0, 48.0, 48.0, 42.0, 34.0, 52.0, 49.0, 43.0, 43.0, -63.0, -55.0, 46.0, -53.0, -62.0, -56.0, 58.0, 37.0, -63.0, 31.0, -55.0, 53.0, -63.0, -61.0, -56.0, -51.0, 53.0, -64.0, -64.0, 53.0, 48.0, -55.0, -54.0, -46.0, 42.0, 29.0, -60.0, 43.0, 26.0, 33.0, 58.0, 53.0, -61.0, 38.0, -60.0, 33.0, -60.0, 42.0, 26.0, -1.0, -58.0, 44.0, -62.0, 42.0, 6.0, 21.0, 48.0, 44.0, -63.0, 52.0, -58.0, -59.0, 28.0, 43.0, 54.0, 38.0, 38.0, 26.0, 38.0, -61.0, -61.0, -64.0, -62.0, 54.0, -63.0, 10.0, 48.0, -63.0, 20.0, 25.0, -62.0, 48.0, -64.0, 53.0, 44.0, -64.0, -63.0, 31.0, 42.0, -58.0, -63.0, 22.0, 39.0, -56.0, 48.0, 6.0, -64.0, 43.0, -64.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3005035013361685, "mean_inference_ms": 9.70979853136115, "mean_action_processing_ms": 0.45452198362487123, "mean_env_wait_ms": 0.2899816179889516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27256202697753906, "StateBufferConnector_ms": 0.00450897216796875, "ViewRequirementAgentConnector_ms": 0.1936054229736328}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -1.48, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 43.0, 48.0, 48.0, 42.0, 34.0, 52.0, 49.0, 43.0, 43.0, -63.0, -55.0, 46.0, -53.0, -62.0, -56.0, 58.0, 37.0, -63.0, 31.0, -55.0, 53.0, -63.0, -61.0, -56.0, -51.0, 53.0, -64.0, -64.0, 53.0, 48.0, -55.0, -54.0, -46.0, 42.0, 29.0, -60.0, 43.0, 26.0, 33.0, 58.0, 53.0, -61.0, 38.0, -60.0, 33.0, -60.0, 42.0, 26.0, -1.0, -58.0, 44.0, -62.0, 42.0, 6.0, 21.0, 48.0, 44.0, -63.0, 52.0, -58.0, -59.0, 28.0, 43.0, 54.0, 38.0, 38.0, 26.0, 38.0, -61.0, -61.0, -64.0, -62.0, 54.0, -63.0, 10.0, 48.0, -63.0, 20.0, 25.0, -62.0, 48.0, -64.0, 53.0, 44.0, -64.0, -63.0, 31.0, 42.0, -58.0, -63.0, 22.0, 39.0, -56.0, 48.0, 6.0, -64.0, 43.0, -64.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3005035013361685, "mean_inference_ms": 9.70979853136115, "mean_action_processing_ms": 0.45452198362487123, "mean_env_wait_ms": 0.2899816179889516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27256202697753906, "StateBufferConnector_ms": 0.00450897216796875, "ViewRequirementAgentConnector_ms": 0.1936054229736328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.038816617600798, "num_agent_steps_trained_throughput_per_sec": 7.038816617600798, "timesteps_total": 41984, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 72609.496, "sample_time_ms": 6088.013, "load_time_ms": 0.295, "load_throughput": 1734779.585, "learn_time_ms": 66520.653, "learn_throughput": 7.697, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "episodes_total": 2624, "training_iteration": 82, "trial_id": "f4e01_00169", "date": "2024-02-27_01-40-57", "timestamp": 1708994457, "time_this_iter_s": 72.74472236633301, "time_total_s": 5893.462825536728, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5893.462825536728, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 53.362135922330104, "ram_util_percent": 21.044660194174753}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -3.18, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.47515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.47515625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.704772500197093, "policy_loss": -0.028976709814742208, "vf_loss": 9.005454953511556, "vf_explained_var": 0.9794317771991093, "kl": 0.0, "entropy": 102.81618576049804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "sampler_results": {"episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -3.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -3.18, "reward_total_min": -64, "reward_total_max": 58, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.47515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.953125, "reward_score_mean": 0.47515625, "reward_score_min": 0.0, "reward_score_max": 0.953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-54.0, -46.0, 42.0, 29.0, -60.0, 43.0, 26.0, 33.0, 58.0, 53.0, -61.0, 38.0, -60.0, 33.0, -60.0, 42.0, 26.0, -1.0, -58.0, 44.0, -62.0, 42.0, 6.0, 21.0, 48.0, 44.0, -63.0, 52.0, -58.0, -59.0, 28.0, 43.0, 54.0, 38.0, 38.0, 26.0, 38.0, -61.0, -61.0, -64.0, -62.0, 54.0, -63.0, 10.0, 48.0, -63.0, 20.0, 25.0, -62.0, 48.0, -64.0, 53.0, 44.0, -64.0, -63.0, 31.0, 42.0, -58.0, -63.0, 22.0, 39.0, -56.0, 48.0, 6.0, -64.0, 43.0, -64.0, -61.0, 29.0, 36.0, -56.0, 48.0, 34.0, -56.0, 33.0, -57.0, 49.0, -57.0, 53.0, 18.0, -63.0, 42.0, 44.0, -63.0, -61.0, -57.0, -63.0, 43.0, 36.0, 19.0, 43.0, -58.0, -63.0, 53.0, -64.0, 39.0, 39.0, 26.0, -64.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3001236213302587, "mean_inference_ms": 9.70788349705561, "mean_action_processing_ms": 0.4543817022270368, "mean_env_wait_ms": 0.28985832444202286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26273632049560547, "StateBufferConnector_ms": 0.00434422492980957, "ViewRequirementAgentConnector_ms": 0.18140578269958496}}, "episode_reward_max": 58.0, "episode_reward_min": -64.0, "episode_reward_mean": -3.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.0, -46.0, 42.0, 29.0, -60.0, 43.0, 26.0, 33.0, 58.0, 53.0, -61.0, 38.0, -60.0, 33.0, -60.0, 42.0, 26.0, -1.0, -58.0, 44.0, -62.0, 42.0, 6.0, 21.0, 48.0, 44.0, -63.0, 52.0, -58.0, -59.0, 28.0, 43.0, 54.0, 38.0, 38.0, 26.0, 38.0, -61.0, -61.0, -64.0, -62.0, 54.0, -63.0, 10.0, 48.0, -63.0, 20.0, 25.0, -62.0, 48.0, -64.0, 53.0, 44.0, -64.0, -63.0, 31.0, 42.0, -58.0, -63.0, 22.0, 39.0, -56.0, 48.0, 6.0, -64.0, 43.0, -64.0, -61.0, 29.0, 36.0, -56.0, 48.0, 34.0, -56.0, 33.0, -57.0, 49.0, -57.0, 53.0, 18.0, -63.0, 42.0, 44.0, -63.0, -61.0, -57.0, -63.0, 43.0, 36.0, 19.0, 43.0, -58.0, -63.0, 53.0, -64.0, 39.0, 39.0, 26.0, -64.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3001236213302587, "mean_inference_ms": 9.70788349705561, "mean_action_processing_ms": 0.4543817022270368, "mean_env_wait_ms": 0.28985832444202286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26273632049560547, "StateBufferConnector_ms": 0.00434422492980957, "ViewRequirementAgentConnector_ms": 0.18140578269958496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.138585468163933, "num_agent_steps_trained_throughput_per_sec": 7.138585468163933, "timesteps_total": 42496, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42496, "timers": {"training_iteration_time_ms": 72460.476, "sample_time_ms": 6054.102, "load_time_ms": 0.294, "load_throughput": 1740826.563, "learn_time_ms": 66405.539, "learn_throughput": 7.71, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "done": false, "episodes_total": 2656, "training_iteration": 83, "trial_id": "f4e01_00169", "date": "2024-02-27_01-42-09", "timestamp": 1708994529, "time_this_iter_s": 71.72808599472046, "time_total_s": 5965.190911531448, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5965.190911531448, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 53.384313725490195, "ram_util_percent": 21.04019607843137}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -0.14, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.49890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.49890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9918980640669663, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.851780553658803, "policy_loss": -0.008105209904412429, "vf_loss": 9.203565704822541, "vf_explained_var": 0.9782996078332266, "kl": 0.0, "entropy": 97.60462036132813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -0.14, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.49890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.49890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 38.0, 38.0, 26.0, 38.0, -61.0, -61.0, -64.0, -62.0, 54.0, -63.0, 10.0, 48.0, -63.0, 20.0, 25.0, -62.0, 48.0, -64.0, 53.0, 44.0, -64.0, -63.0, 31.0, 42.0, -58.0, -63.0, 22.0, 39.0, -56.0, 48.0, 6.0, -64.0, 43.0, -64.0, -61.0, 29.0, 36.0, -56.0, 48.0, 34.0, -56.0, 33.0, -57.0, 49.0, -57.0, 53.0, 18.0, -63.0, 42.0, 44.0, -63.0, -61.0, -57.0, -63.0, 43.0, 36.0, 19.0, 43.0, -58.0, -63.0, 53.0, -64.0, 39.0, 39.0, 26.0, -64.0, -63.0, -62.0, -64.0, 30.0, 19.0, -55.0, -61.0, 58.0, 59.0, 44.0, 58.0, 12.0, 29.0, 18.0, 53.0, -64.0, 24.0, 53.0, 33.0, 53.0, -63.0, 49.0, 64.0, 43.0, 18.0, -53.0, 33.0, -63.0, 53.0, 49.0, 48.0, 53.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299469647939186, "mean_inference_ms": 9.704878079049847, "mean_action_processing_ms": 0.4541647349303831, "mean_env_wait_ms": 0.2896792258755474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2584714889526367, "StateBufferConnector_ms": 0.004271507263183594, "ViewRequirementAgentConnector_ms": 0.1771552562713623}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 38.0, 38.0, 26.0, 38.0, -61.0, -61.0, -64.0, -62.0, 54.0, -63.0, 10.0, 48.0, -63.0, 20.0, 25.0, -62.0, 48.0, -64.0, 53.0, 44.0, -64.0, -63.0, 31.0, 42.0, -58.0, -63.0, 22.0, 39.0, -56.0, 48.0, 6.0, -64.0, 43.0, -64.0, -61.0, 29.0, 36.0, -56.0, 48.0, 34.0, -56.0, 33.0, -57.0, 49.0, -57.0, 53.0, 18.0, -63.0, 42.0, 44.0, -63.0, -61.0, -57.0, -63.0, 43.0, 36.0, 19.0, 43.0, -58.0, -63.0, 53.0, -64.0, 39.0, 39.0, 26.0, -64.0, -63.0, -62.0, -64.0, 30.0, 19.0, -55.0, -61.0, 58.0, 59.0, 44.0, 58.0, 12.0, 29.0, 18.0, 53.0, -64.0, 24.0, 53.0, 33.0, 53.0, -63.0, 49.0, 64.0, 43.0, 18.0, -53.0, 33.0, -63.0, 53.0, 49.0, 48.0, 53.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299469647939186, "mean_inference_ms": 9.704878079049847, "mean_action_processing_ms": 0.4541647349303831, "mean_env_wait_ms": 0.2896792258755474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2584714889526367, "StateBufferConnector_ms": 0.004271507263183594, "ViewRequirementAgentConnector_ms": 0.1771552562713623}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.044961143307057, "num_agent_steps_trained_throughput_per_sec": 7.044961143307057, "timesteps_total": 43008, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 72368.527, "sample_time_ms": 6007.52, "load_time_ms": 0.297, "load_throughput": 1722396.253, "learn_time_ms": 66360.177, "learn_throughput": 7.715, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 2688, "training_iteration": 84, "trial_id": "f4e01_00169", "date": "2024-02-27_01-43-21", "timestamp": 1708994601, "time_this_iter_s": 72.68123579025269, "time_total_s": 6037.872147321701, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6037.872147321701, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 52.87087378640776, "ram_util_percent": 20.970873786407772}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -0.29, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.497734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.497734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9964250564575196, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.831896324952443, "policy_loss": 0.06615491594808796, "vf_loss": 9.05570198694865, "vf_explained_var": 0.983550081650416, "kl": 0.0, "entropy": 102.23599192301432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -0.29, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.497734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.497734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 43.0, -64.0, -61.0, 29.0, 36.0, -56.0, 48.0, 34.0, -56.0, 33.0, -57.0, 49.0, -57.0, 53.0, 18.0, -63.0, 42.0, 44.0, -63.0, -61.0, -57.0, -63.0, 43.0, 36.0, 19.0, 43.0, -58.0, -63.0, 53.0, -64.0, 39.0, 39.0, 26.0, -64.0, -63.0, -62.0, -64.0, 30.0, 19.0, -55.0, -61.0, 58.0, 59.0, 44.0, 58.0, 12.0, 29.0, 18.0, 53.0, -64.0, 24.0, 53.0, 33.0, 53.0, -63.0, 49.0, 64.0, 43.0, 18.0, -53.0, 33.0, -63.0, 53.0, 49.0, 48.0, 53.0, -55.0, 43.0, -59.0, -62.0, -63.0, 43.0, 59.0, -54.0, 52.0, 38.0, -56.0, -63.0, 59.0, -59.0, -58.0, -64.0, 49.0, -64.0, -62.0, 37.0, -59.0, -63.0, 48.0, -59.0, 24.0, 53.0, 21.0, 54.0, 58.0, 43.0, 54.0, 37.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991323607746645, "mean_inference_ms": 9.70357115980275, "mean_action_processing_ms": 0.4540879177344624, "mean_env_wait_ms": 0.2896028646730569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26547980308532715, "StateBufferConnector_ms": 0.004380702972412109, "ViewRequirementAgentConnector_ms": 0.18694591522216797}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 43.0, -64.0, -61.0, 29.0, 36.0, -56.0, 48.0, 34.0, -56.0, 33.0, -57.0, 49.0, -57.0, 53.0, 18.0, -63.0, 42.0, 44.0, -63.0, -61.0, -57.0, -63.0, 43.0, 36.0, 19.0, 43.0, -58.0, -63.0, 53.0, -64.0, 39.0, 39.0, 26.0, -64.0, -63.0, -62.0, -64.0, 30.0, 19.0, -55.0, -61.0, 58.0, 59.0, 44.0, 58.0, 12.0, 29.0, 18.0, 53.0, -64.0, 24.0, 53.0, 33.0, 53.0, -63.0, 49.0, 64.0, 43.0, 18.0, -53.0, 33.0, -63.0, 53.0, 49.0, 48.0, 53.0, -55.0, 43.0, -59.0, -62.0, -63.0, 43.0, 59.0, -54.0, 52.0, 38.0, -56.0, -63.0, 59.0, -59.0, -58.0, -64.0, 49.0, -64.0, -62.0, 37.0, -59.0, -63.0, 48.0, -59.0, 24.0, 53.0, 21.0, 54.0, 58.0, 43.0, 54.0, 37.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991323607746645, "mean_inference_ms": 9.70357115980275, "mean_action_processing_ms": 0.4540879177344624, "mean_env_wait_ms": 0.2896028646730569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26547980308532715, "StateBufferConnector_ms": 0.004380702972412109, "ViewRequirementAgentConnector_ms": 0.18694591522216797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.117760736415928, "num_agent_steps_trained_throughput_per_sec": 7.117760736415928, "timesteps_total": 43520, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43520, "timers": {"training_iteration_time_ms": 72320.548, "sample_time_ms": 6027.431, "load_time_ms": 0.298, "load_throughput": 1718261.84, "learn_time_ms": 66292.302, "learn_throughput": 7.723, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "done": false, "episodes_total": 2720, "training_iteration": 85, "trial_id": "f4e01_00169", "date": "2024-02-27_01-44-33", "timestamp": 1708994673, "time_this_iter_s": 71.9379358291626, "time_total_s": 6109.810083150864, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6109.810083150864, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 53.143137254901966, "ram_util_percent": 20.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -0.15, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.498828125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.498828125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9985398004452387, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.162397543589274, "policy_loss": -0.007054128202920159, "vf_loss": 9.689771382013957, "vf_explained_var": 0.9553407246867816, "kl": 0.0, "entropy": 105.1380626042684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -0.15, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.498828125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.498828125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [39.0, 26.0, -64.0, -63.0, -62.0, -64.0, 30.0, 19.0, -55.0, -61.0, 58.0, 59.0, 44.0, 58.0, 12.0, 29.0, 18.0, 53.0, -64.0, 24.0, 53.0, 33.0, 53.0, -63.0, 49.0, 64.0, 43.0, 18.0, -53.0, 33.0, -63.0, 53.0, 49.0, 48.0, 53.0, -55.0, 43.0, -59.0, -62.0, -63.0, 43.0, 59.0, -54.0, 52.0, 38.0, -56.0, -63.0, 59.0, -59.0, -58.0, -64.0, 49.0, -64.0, -62.0, 37.0, -59.0, -63.0, 48.0, -59.0, 24.0, 53.0, 21.0, 54.0, 58.0, 43.0, 54.0, 37.0, -62.0, -59.0, 59.0, -58.0, 43.0, 59.0, 59.0, -64.0, -64.0, -58.0, -64.0, 43.0, -63.0, 14.0, 58.0, -60.0, 53.0, 31.0, -63.0, -61.0, -60.0, -62.0, 54.0, 35.0, 58.0, 53.0, -64.0, 44.0, 43.0, -52.0, -59.0, -64.0, 38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2988424207846778, "mean_inference_ms": 9.702762488712159, "mean_action_processing_ms": 0.45404451943040003, "mean_env_wait_ms": 0.2895538129315309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26786160469055176, "StateBufferConnector_ms": 0.0044155120849609375, "ViewRequirementAgentConnector_ms": 0.18822216987609863}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 26.0, -64.0, -63.0, -62.0, -64.0, 30.0, 19.0, -55.0, -61.0, 58.0, 59.0, 44.0, 58.0, 12.0, 29.0, 18.0, 53.0, -64.0, 24.0, 53.0, 33.0, 53.0, -63.0, 49.0, 64.0, 43.0, 18.0, -53.0, 33.0, -63.0, 53.0, 49.0, 48.0, 53.0, -55.0, 43.0, -59.0, -62.0, -63.0, 43.0, 59.0, -54.0, 52.0, 38.0, -56.0, -63.0, 59.0, -59.0, -58.0, -64.0, 49.0, -64.0, -62.0, 37.0, -59.0, -63.0, 48.0, -59.0, 24.0, 53.0, 21.0, 54.0, 58.0, 43.0, 54.0, 37.0, -62.0, -59.0, 59.0, -58.0, 43.0, 59.0, 59.0, -64.0, -64.0, -58.0, -64.0, 43.0, -63.0, 14.0, 58.0, -60.0, 53.0, 31.0, -63.0, -61.0, -60.0, -62.0, 54.0, 35.0, 58.0, 53.0, -64.0, 44.0, 43.0, -52.0, -59.0, -64.0, 38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2988424207846778, "mean_inference_ms": 9.702762488712159, "mean_action_processing_ms": 0.45404451943040003, "mean_env_wait_ms": 0.2895538129315309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26786160469055176, "StateBufferConnector_ms": 0.0044155120849609375, "ViewRequirementAgentConnector_ms": 0.18822216987609863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.096483898589901, "num_agent_steps_trained_throughput_per_sec": 7.096483898589901, "timesteps_total": 44032, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 72349.29, "sample_time_ms": 6039.728, "load_time_ms": 0.302, "load_throughput": 1692798.083, "learn_time_ms": 66308.734, "learn_throughput": 7.721, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "episodes_total": 2752, "training_iteration": 86, "trial_id": "f4e01_00169", "date": "2024-02-27_01-45-45", "timestamp": 1708994745, "time_this_iter_s": 72.15368843078613, "time_total_s": 6181.96377158165, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6181.96377158165, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 54.05588235294118, "ram_util_percent": 20.814705882352936}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 1.07, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.508359375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.508359375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9891908590992292, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.142909729480744, "policy_loss": 0.011731220254053673, "vf_loss": 9.629659322897593, "vf_explained_var": 0.9496524184942245, "kl": 0.0, "entropy": 100.50915463765462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 1.07, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 1.07, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.508359375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.508359375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [49.0, 48.0, 53.0, -55.0, 43.0, -59.0, -62.0, -63.0, 43.0, 59.0, -54.0, 52.0, 38.0, -56.0, -63.0, 59.0, -59.0, -58.0, -64.0, 49.0, -64.0, -62.0, 37.0, -59.0, -63.0, 48.0, -59.0, 24.0, 53.0, 21.0, 54.0, 58.0, 43.0, 54.0, 37.0, -62.0, -59.0, 59.0, -58.0, 43.0, 59.0, 59.0, -64.0, -64.0, -58.0, -64.0, 43.0, -63.0, 14.0, 58.0, -60.0, 53.0, 31.0, -63.0, -61.0, -60.0, -62.0, 54.0, 35.0, 58.0, 53.0, -64.0, 44.0, 43.0, -52.0, -59.0, -64.0, 38.0, 58.0, 53.0, 64.0, -64.0, 59.0, 54.0, -63.0, -63.0, -64.0, 39.0, -59.0, 33.0, 48.0, 44.0, -61.0, 59.0, 53.0, 59.0, -64.0, -60.0, 38.0, -64.0, 54.0, 43.0, 58.0, 49.0, -63.0, 53.0, -61.0, 53.0, 49.0, 44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298903469851724, "mean_inference_ms": 9.704111309582274, "mean_action_processing_ms": 0.4541137107771798, "mean_env_wait_ms": 0.2895901209785267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2753133773803711, "StateBufferConnector_ms": 0.0045435428619384766, "ViewRequirementAgentConnector_ms": 0.19608378410339355}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 1.07, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 48.0, 53.0, -55.0, 43.0, -59.0, -62.0, -63.0, 43.0, 59.0, -54.0, 52.0, 38.0, -56.0, -63.0, 59.0, -59.0, -58.0, -64.0, 49.0, -64.0, -62.0, 37.0, -59.0, -63.0, 48.0, -59.0, 24.0, 53.0, 21.0, 54.0, 58.0, 43.0, 54.0, 37.0, -62.0, -59.0, 59.0, -58.0, 43.0, 59.0, 59.0, -64.0, -64.0, -58.0, -64.0, 43.0, -63.0, 14.0, 58.0, -60.0, 53.0, 31.0, -63.0, -61.0, -60.0, -62.0, 54.0, 35.0, 58.0, 53.0, -64.0, 44.0, 43.0, -52.0, -59.0, -64.0, 38.0, 58.0, 53.0, 64.0, -64.0, 59.0, 54.0, -63.0, -63.0, -64.0, 39.0, -59.0, 33.0, 48.0, 44.0, -61.0, 59.0, 53.0, 59.0, -64.0, -60.0, 38.0, -64.0, 54.0, 43.0, 58.0, 49.0, -63.0, 53.0, -61.0, 53.0, 49.0, 44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298903469851724, "mean_inference_ms": 9.704111309582274, "mean_action_processing_ms": 0.4541137107771798, "mean_env_wait_ms": 0.2895901209785267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2753133773803711, "StateBufferConnector_ms": 0.0045435428619384766, "ViewRequirementAgentConnector_ms": 0.19608378410339355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.147348933905463, "num_agent_steps_trained_throughput_per_sec": 7.147348933905463, "timesteps_total": 44544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44544, "timers": {"training_iteration_time_ms": 72337.099, "sample_time_ms": 6049.966, "load_time_ms": 0.299, "load_throughput": 1714557.803, "learn_time_ms": 66286.305, "learn_throughput": 7.724, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "done": false, "episodes_total": 2784, "training_iteration": 87, "trial_id": "f4e01_00169", "date": "2024-02-27_01-46-57", "timestamp": 1708994817, "time_this_iter_s": 71.63996243476868, "time_total_s": 6253.6037340164185, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6253.6037340164185, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 53.25196078431372, "ram_util_percent": 20.74901960784314}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 6.94, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.55421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.55421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9929757729172707, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.846233654022217, "policy_loss": -0.004959301774700483, "vf_loss": 9.189912684758504, "vf_explained_var": 0.9721907263000806, "kl": 0.0, "entropy": 99.8594430287679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 6.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 6.94, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.55421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.55421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [43.0, 54.0, 37.0, -62.0, -59.0, 59.0, -58.0, 43.0, 59.0, 59.0, -64.0, -64.0, -58.0, -64.0, 43.0, -63.0, 14.0, 58.0, -60.0, 53.0, 31.0, -63.0, -61.0, -60.0, -62.0, 54.0, 35.0, 58.0, 53.0, -64.0, 44.0, 43.0, -52.0, -59.0, -64.0, 38.0, 58.0, 53.0, 64.0, -64.0, 59.0, 54.0, -63.0, -63.0, -64.0, 39.0, -59.0, 33.0, 48.0, 44.0, -61.0, 59.0, 53.0, 59.0, -64.0, -60.0, 38.0, -64.0, 54.0, 43.0, 58.0, 49.0, -63.0, 53.0, -61.0, 53.0, 49.0, 44.0, -60.0, 9.0, 36.0, 48.0, -60.0, 33.0, 38.0, 10.0, 21.0, 33.0, 48.0, -62.0, -62.0, 58.0, 5.0, 43.0, 59.0, 48.0, 44.0, 54.0, 48.0, -55.0, -58.0, 49.0, 49.0, -60.0, -64.0, 44.0, 54.0, 49.0, 33.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298774447672316, "mean_inference_ms": 9.704304482177442, "mean_action_processing_ms": 0.4540813589821434, "mean_env_wait_ms": 0.28956641249420295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2724318504333496, "StateBufferConnector_ms": 0.004650115966796875, "ViewRequirementAgentConnector_ms": 0.18854022026062012}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 6.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 54.0, 37.0, -62.0, -59.0, 59.0, -58.0, 43.0, 59.0, 59.0, -64.0, -64.0, -58.0, -64.0, 43.0, -63.0, 14.0, 58.0, -60.0, 53.0, 31.0, -63.0, -61.0, -60.0, -62.0, 54.0, 35.0, 58.0, 53.0, -64.0, 44.0, 43.0, -52.0, -59.0, -64.0, 38.0, 58.0, 53.0, 64.0, -64.0, 59.0, 54.0, -63.0, -63.0, -64.0, 39.0, -59.0, 33.0, 48.0, 44.0, -61.0, 59.0, 53.0, 59.0, -64.0, -60.0, 38.0, -64.0, 54.0, 43.0, 58.0, 49.0, -63.0, 53.0, -61.0, 53.0, 49.0, 44.0, -60.0, 9.0, 36.0, 48.0, -60.0, 33.0, 38.0, 10.0, 21.0, 33.0, 48.0, -62.0, -62.0, 58.0, 5.0, 43.0, 59.0, 48.0, 44.0, 54.0, 48.0, -55.0, -58.0, 49.0, 49.0, -60.0, -64.0, 44.0, 54.0, 49.0, 33.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298774447672316, "mean_inference_ms": 9.704304482177442, "mean_action_processing_ms": 0.4540813589821434, "mean_env_wait_ms": 0.28956641249420295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2724318504333496, "StateBufferConnector_ms": 0.004650115966796875, "ViewRequirementAgentConnector_ms": 0.18854022026062012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.149875030386368, "num_agent_steps_trained_throughput_per_sec": 7.149875030386368, "timesteps_total": 45056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 72274.769, "sample_time_ms": 6028.357, "load_time_ms": 0.294, "load_throughput": 1742521.623, "learn_time_ms": 66245.595, "learn_throughput": 7.729, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "episodes_total": 2816, "training_iteration": 88, "trial_id": "f4e01_00169", "date": "2024-02-27_01-48-12", "timestamp": 1708994892, "time_this_iter_s": 71.6149070262909, "time_total_s": 6325.218641042709, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6325.218641042709, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 52.64811320754717, "ram_util_percent": 20.870754716981132}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 5.43, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.542421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.542421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9983711888392767, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.112890676657359, "policy_loss": -0.011273935219893854, "vf_loss": 9.61864329179128, "vf_explained_var": 0.9676308582226435, "kl": 0.0, "entropy": 109.58596858978271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 5.43, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.542421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.542421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -59.0, -64.0, 38.0, 58.0, 53.0, 64.0, -64.0, 59.0, 54.0, -63.0, -63.0, -64.0, 39.0, -59.0, 33.0, 48.0, 44.0, -61.0, 59.0, 53.0, 59.0, -64.0, -60.0, 38.0, -64.0, 54.0, 43.0, 58.0, 49.0, -63.0, 53.0, -61.0, 53.0, 49.0, 44.0, -60.0, 9.0, 36.0, 48.0, -60.0, 33.0, 38.0, 10.0, 21.0, 33.0, 48.0, -62.0, -62.0, 58.0, 5.0, 43.0, 59.0, 48.0, 44.0, 54.0, 48.0, -55.0, -58.0, 49.0, 49.0, -60.0, -64.0, 44.0, 54.0, 49.0, 33.0, 43.0, -64.0, 14.0, 59.0, 58.0, 42.0, 59.0, 26.0, -61.0, -63.0, 44.0, -63.0, -62.0, 39.0, -63.0, 54.0, -63.0, 18.0, -63.0, 59.0, -62.0, -62.0, -62.0, 49.0, 64.0, -62.0, -62.0, -60.0, 43.0, 44.0, 43.0, 48.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298790553976572, "mean_inference_ms": 9.705135448383087, "mean_action_processing_ms": 0.45411336451621553, "mean_env_wait_ms": 0.28959659049704983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2767348289489746, "StateBufferConnector_ms": 0.0047092437744140625, "ViewRequirementAgentConnector_ms": 0.1942732334136963}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -59.0, -64.0, 38.0, 58.0, 53.0, 64.0, -64.0, 59.0, 54.0, -63.0, -63.0, -64.0, 39.0, -59.0, 33.0, 48.0, 44.0, -61.0, 59.0, 53.0, 59.0, -64.0, -60.0, 38.0, -64.0, 54.0, 43.0, 58.0, 49.0, -63.0, 53.0, -61.0, 53.0, 49.0, 44.0, -60.0, 9.0, 36.0, 48.0, -60.0, 33.0, 38.0, 10.0, 21.0, 33.0, 48.0, -62.0, -62.0, 58.0, 5.0, 43.0, 59.0, 48.0, 44.0, 54.0, 48.0, -55.0, -58.0, 49.0, 49.0, -60.0, -64.0, 44.0, 54.0, 49.0, 33.0, 43.0, -64.0, 14.0, 59.0, 58.0, 42.0, 59.0, 26.0, -61.0, -63.0, 44.0, -63.0, -62.0, 39.0, -63.0, 54.0, -63.0, 18.0, -63.0, 59.0, -62.0, -62.0, -62.0, 49.0, 64.0, -62.0, -62.0, -60.0, 43.0, 44.0, 43.0, 48.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298790553976572, "mean_inference_ms": 9.705135448383087, "mean_action_processing_ms": 0.45411336451621553, "mean_env_wait_ms": 0.28959659049704983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2767348289489746, "StateBufferConnector_ms": 0.0047092437744140625, "ViewRequirementAgentConnector_ms": 0.1942732334136963}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.10191589157635, "num_agent_steps_trained_throughput_per_sec": 7.10191589157635, "timesteps_total": 45568, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45568, "timers": {"training_iteration_time_ms": 72157.497, "sample_time_ms": 6019.853, "load_time_ms": 0.287, "load_throughput": 1783031.923, "learn_time_ms": 66136.839, "learn_throughput": 7.742, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "done": false, "episodes_total": 2848, "training_iteration": 89, "trial_id": "f4e01_00169", "date": "2024-02-27_01-49-24", "timestamp": 1708994964, "time_this_iter_s": 72.09856629371643, "time_total_s": 6397.317207336426, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6397.317207336426, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 52.773529411764706, "ram_util_percent": 20.906862745098042}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 5.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.54265625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.54265625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9969680214921633, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.145056247711182, "policy_loss": 0.007907680887728929, "vf_loss": 9.639035987854005, "vf_explained_var": 0.9862842867771785, "kl": 0.0, "entropy": 105.13844184875488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.46, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 5.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.54265625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.54265625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, 53.0, 49.0, 44.0, -60.0, 9.0, 36.0, 48.0, -60.0, 33.0, 38.0, 10.0, 21.0, 33.0, 48.0, -62.0, -62.0, 58.0, 5.0, 43.0, 59.0, 48.0, 44.0, 54.0, 48.0, -55.0, -58.0, 49.0, 49.0, -60.0, -64.0, 44.0, 54.0, 49.0, 33.0, 43.0, -64.0, 14.0, 59.0, 58.0, 42.0, 59.0, 26.0, -61.0, -63.0, 44.0, -63.0, -62.0, 39.0, -63.0, 54.0, -63.0, 18.0, -63.0, 59.0, -62.0, -62.0, -62.0, 49.0, 64.0, -62.0, -62.0, -60.0, 43.0, 44.0, 43.0, 48.0, -64.0, -64.0, 59.0, 59.0, 49.0, 53.0, -58.0, 48.0, -59.0, -64.0, -63.0, -64.0, -59.0, 44.0, 54.0, 53.0, 49.0, 49.0, -64.0, 48.0, -54.0, 59.0, 54.0, -64.0, 53.0, 59.0, -53.0, 31.0, 20.0, 54.0, 49.0, -56.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2985327629656644, "mean_inference_ms": 9.704115773940144, "mean_action_processing_ms": 0.45404052089568225, "mean_env_wait_ms": 0.2895493994082964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2694363594055176, "StateBufferConnector_ms": 0.004614591598510742, "ViewRequirementAgentConnector_ms": 0.18639397621154785}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.46, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, 53.0, 49.0, 44.0, -60.0, 9.0, 36.0, 48.0, -60.0, 33.0, 38.0, 10.0, 21.0, 33.0, 48.0, -62.0, -62.0, 58.0, 5.0, 43.0, 59.0, 48.0, 44.0, 54.0, 48.0, -55.0, -58.0, 49.0, 49.0, -60.0, -64.0, 44.0, 54.0, 49.0, 33.0, 43.0, -64.0, 14.0, 59.0, 58.0, 42.0, 59.0, 26.0, -61.0, -63.0, 44.0, -63.0, -62.0, 39.0, -63.0, 54.0, -63.0, 18.0, -63.0, 59.0, -62.0, -62.0, -62.0, 49.0, 64.0, -62.0, -62.0, -60.0, 43.0, 44.0, 43.0, 48.0, -64.0, -64.0, 59.0, 59.0, 49.0, 53.0, -58.0, 48.0, -59.0, -64.0, -63.0, -64.0, -59.0, 44.0, 54.0, 53.0, 49.0, 49.0, -64.0, 48.0, -54.0, 59.0, 54.0, -64.0, 53.0, 59.0, -53.0, 31.0, 20.0, 54.0, 49.0, -56.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2985327629656644, "mean_inference_ms": 9.704115773940144, "mean_action_processing_ms": 0.45404052089568225, "mean_env_wait_ms": 0.2895493994082964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2694363594055176, "StateBufferConnector_ms": 0.004614591598510742, "ViewRequirementAgentConnector_ms": 0.18639397621154785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.176745429944882, "num_agent_steps_trained_throughput_per_sec": 7.176745429944882, "timesteps_total": 46080, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 72050.62, "sample_time_ms": 5990.455, "load_time_ms": 0.287, "load_throughput": 1785552.214, "learn_time_ms": 66059.378, "learn_throughput": 7.751, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "episodes_total": 2880, "training_iteration": 90, "trial_id": "f4e01_00169", "date": "2024-02-27_01-50-35", "timestamp": 1708995035, "time_this_iter_s": 71.34695935249329, "time_total_s": 6468.664166688919, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6468.664166688919, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 53.63921568627451, "ram_util_percent": 20.98921568627451}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 1.43, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.511171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.511171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9966993982593219, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.27889944712321, "policy_loss": -0.004397394508123398, "vf_loss": 9.868577202161154, "vf_explained_var": 0.9736245766282081, "kl": 0.0, "entropy": 103.73083985646566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 1.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 1.43, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.511171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.511171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 49.0, 33.0, 43.0, -64.0, 14.0, 59.0, 58.0, 42.0, 59.0, 26.0, -61.0, -63.0, 44.0, -63.0, -62.0, 39.0, -63.0, 54.0, -63.0, 18.0, -63.0, 59.0, -62.0, -62.0, -62.0, 49.0, 64.0, -62.0, -62.0, -60.0, 43.0, 44.0, 43.0, 48.0, -64.0, -64.0, 59.0, 59.0, 49.0, 53.0, -58.0, 48.0, -59.0, -64.0, -63.0, -64.0, -59.0, 44.0, 54.0, 53.0, 49.0, 49.0, -64.0, 48.0, -54.0, 59.0, 54.0, -64.0, 53.0, 59.0, -53.0, 31.0, 20.0, 54.0, 49.0, -56.0, -63.0, 43.0, 54.0, -62.0, 48.0, 52.0, 43.0, -60.0, 43.0, 38.0, 18.0, -59.0, 53.0, 49.0, -57.0, -59.0, -62.0, 48.0, -62.0, 53.0, 42.0, 49.0, 59.0, 48.0, -64.0, 53.0, -63.0, -51.0, -59.0, -62.0, -63.0, 30.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2983249514645454, "mean_inference_ms": 9.702893954583056, "mean_action_processing_ms": 0.45396827881339313, "mean_env_wait_ms": 0.28949759855626994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26920175552368164, "StateBufferConnector_ms": 0.004397392272949219, "ViewRequirementAgentConnector_ms": 0.18706512451171875}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 1.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 49.0, 33.0, 43.0, -64.0, 14.0, 59.0, 58.0, 42.0, 59.0, 26.0, -61.0, -63.0, 44.0, -63.0, -62.0, 39.0, -63.0, 54.0, -63.0, 18.0, -63.0, 59.0, -62.0, -62.0, -62.0, 49.0, 64.0, -62.0, -62.0, -60.0, 43.0, 44.0, 43.0, 48.0, -64.0, -64.0, 59.0, 59.0, 49.0, 53.0, -58.0, 48.0, -59.0, -64.0, -63.0, -64.0, -59.0, 44.0, 54.0, 53.0, 49.0, 49.0, -64.0, 48.0, -54.0, 59.0, 54.0, -64.0, 53.0, 59.0, -53.0, 31.0, 20.0, 54.0, 49.0, -56.0, -63.0, 43.0, 54.0, -62.0, 48.0, 52.0, 43.0, -60.0, 43.0, 38.0, 18.0, -59.0, 53.0, 49.0, -57.0, -59.0, -62.0, 48.0, -62.0, 53.0, 42.0, 49.0, 59.0, 48.0, -64.0, 53.0, -63.0, -51.0, -59.0, -62.0, -63.0, 30.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2983249514645454, "mean_inference_ms": 9.702893954583056, "mean_action_processing_ms": 0.45396827881339313, "mean_env_wait_ms": 0.28949759855626994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26920175552368164, "StateBufferConnector_ms": 0.004397392272949219, "ViewRequirementAgentConnector_ms": 0.18706512451171875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.152628464758362, "num_agent_steps_trained_throughput_per_sec": 7.152628464758362, "timesteps_total": 46592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46592, "timers": {"training_iteration_time_ms": 71948.066, "sample_time_ms": 5976.621, "load_time_ms": 0.285, "load_throughput": 1799316.002, "learn_time_ms": 65970.663, "learn_throughput": 7.761, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "done": false, "episodes_total": 2912, "training_iteration": 91, "trial_id": "f4e01_00169", "date": "2024-02-27_01-51-47", "timestamp": 1708995107, "time_this_iter_s": 71.58717584609985, "time_total_s": 6540.251342535019, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6540.251342535019, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 53.801980198019805, "ram_util_percent": 21.051485148514846}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 0.18, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.50140625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.50140625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9973260929187139, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.1405339479446415, "policy_loss": -0.018998648754010597, "vf_loss": 9.674192460378011, "vf_explained_var": 0.9444940040508906, "kl": 0.0, "entropy": 105.44395662943522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 0.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 0.18, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.50140625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.50140625, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [44.0, 43.0, 48.0, -64.0, -64.0, 59.0, 59.0, 49.0, 53.0, -58.0, 48.0, -59.0, -64.0, -63.0, -64.0, -59.0, 44.0, 54.0, 53.0, 49.0, 49.0, -64.0, 48.0, -54.0, 59.0, 54.0, -64.0, 53.0, 59.0, -53.0, 31.0, 20.0, 54.0, 49.0, -56.0, -63.0, 43.0, 54.0, -62.0, 48.0, 52.0, 43.0, -60.0, 43.0, 38.0, 18.0, -59.0, 53.0, 49.0, -57.0, -59.0, -62.0, 48.0, -62.0, 53.0, 42.0, 49.0, 59.0, 48.0, -64.0, 53.0, -63.0, -51.0, -59.0, -62.0, -63.0, 30.0, -62.0, 54.0, -56.0, 44.0, -63.0, 39.0, -56.0, -61.0, 47.0, -53.0, -59.0, 58.0, 53.0, -51.0, 38.0, 53.0, -62.0, 53.0, -61.0, 44.0, -57.0, -59.0, -62.0, -60.0, 54.0, 59.0, 58.0, -58.0, 17.0, -62.0, 36.0, 44.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980855103687836, "mean_inference_ms": 9.701784411888775, "mean_action_processing_ms": 0.45387330173649104, "mean_env_wait_ms": 0.28942074514584876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679746150970459, "StateBufferConnector_ms": 0.004359722137451172, "ViewRequirementAgentConnector_ms": 0.18675589561462402}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 0.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 43.0, 48.0, -64.0, -64.0, 59.0, 59.0, 49.0, 53.0, -58.0, 48.0, -59.0, -64.0, -63.0, -64.0, -59.0, 44.0, 54.0, 53.0, 49.0, 49.0, -64.0, 48.0, -54.0, 59.0, 54.0, -64.0, 53.0, 59.0, -53.0, 31.0, 20.0, 54.0, 49.0, -56.0, -63.0, 43.0, 54.0, -62.0, 48.0, 52.0, 43.0, -60.0, 43.0, 38.0, 18.0, -59.0, 53.0, 49.0, -57.0, -59.0, -62.0, 48.0, -62.0, 53.0, 42.0, 49.0, 59.0, 48.0, -64.0, 53.0, -63.0, -51.0, -59.0, -62.0, -63.0, 30.0, -62.0, 54.0, -56.0, 44.0, -63.0, 39.0, -56.0, -61.0, 47.0, -53.0, -59.0, 58.0, 53.0, -51.0, 38.0, 53.0, -62.0, 53.0, -61.0, 44.0, -57.0, -59.0, -62.0, -60.0, 54.0, 59.0, 58.0, -58.0, 17.0, -62.0, 36.0, 44.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980855103687836, "mean_inference_ms": 9.701784411888775, "mean_action_processing_ms": 0.45387330173649104, "mean_env_wait_ms": 0.28942074514584876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2679746150970459, "StateBufferConnector_ms": 0.004359722137451172, "ViewRequirementAgentConnector_ms": 0.18675589561462402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.12156920268191, "num_agent_steps_trained_throughput_per_sec": 7.12156920268191, "timesteps_total": 47104, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 71863.543, "sample_time_ms": 5990.574, "load_time_ms": 0.284, "load_throughput": 1799919.242, "learn_time_ms": 65872.181, "learn_throughput": 7.773, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "episodes_total": 2944, "training_iteration": 92, "trial_id": "f4e01_00169", "date": "2024-02-27_01-52-59", "timestamp": 1708995179, "time_this_iter_s": 71.89951491355896, "time_total_s": 6612.150857448578, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6612.150857448578, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 53.153921568627446, "ram_util_percent": 20.93039215686275}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 4.55, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.535546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.535546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9964205622673035, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.871066192785899, "policy_loss": 0.012143394785622756, "vf_loss": 9.202053153514862, "vf_explained_var": 0.8235295737783114, "kl": 0.0, "entropy": 98.90953191121419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 4.55, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 4.55, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.535546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.535546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 49.0, -56.0, -63.0, 43.0, 54.0, -62.0, 48.0, 52.0, 43.0, -60.0, 43.0, 38.0, 18.0, -59.0, 53.0, 49.0, -57.0, -59.0, -62.0, 48.0, -62.0, 53.0, 42.0, 49.0, 59.0, 48.0, -64.0, 53.0, -63.0, -51.0, -59.0, -62.0, -63.0, 30.0, -62.0, 54.0, -56.0, 44.0, -63.0, 39.0, -56.0, -61.0, 47.0, -53.0, -59.0, 58.0, 53.0, -51.0, 38.0, 53.0, -62.0, 53.0, -61.0, 44.0, -57.0, -59.0, -62.0, -60.0, 54.0, 59.0, 58.0, -58.0, 17.0, -62.0, 36.0, 44.0, -61.0, 53.0, 64.0, 48.0, 54.0, 48.0, 58.0, 25.0, 38.0, -52.0, -45.0, 26.0, 58.0, -63.0, 48.0, 59.0, 52.0, -50.0, 58.0, 37.0, -60.0, 53.0, 48.0, 41.0, -53.0, -62.0, 28.0, 58.0, 54.0, 43.0, 36.0, -55.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980813201778807, "mean_inference_ms": 9.70170491701689, "mean_action_processing_ms": 0.4538643978515941, "mean_env_wait_ms": 0.2894132062370493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2711308002471924, "StateBufferConnector_ms": 0.004422664642333984, "ViewRequirementAgentConnector_ms": 0.19068408012390137}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 4.55, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 49.0, -56.0, -63.0, 43.0, 54.0, -62.0, 48.0, 52.0, 43.0, -60.0, 43.0, 38.0, 18.0, -59.0, 53.0, 49.0, -57.0, -59.0, -62.0, 48.0, -62.0, 53.0, 42.0, 49.0, 59.0, 48.0, -64.0, 53.0, -63.0, -51.0, -59.0, -62.0, -63.0, 30.0, -62.0, 54.0, -56.0, 44.0, -63.0, 39.0, -56.0, -61.0, 47.0, -53.0, -59.0, 58.0, 53.0, -51.0, 38.0, 53.0, -62.0, 53.0, -61.0, 44.0, -57.0, -59.0, -62.0, -60.0, 54.0, 59.0, 58.0, -58.0, 17.0, -62.0, 36.0, 44.0, -61.0, 53.0, 64.0, 48.0, 54.0, 48.0, 58.0, 25.0, 38.0, -52.0, -45.0, 26.0, 58.0, -63.0, 48.0, 59.0, 52.0, -50.0, 58.0, 37.0, -60.0, 53.0, 48.0, 41.0, -53.0, -62.0, 28.0, 58.0, 54.0, 43.0, 36.0, -55.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980813201778807, "mean_inference_ms": 9.70170491701689, "mean_action_processing_ms": 0.4538643978515941, "mean_env_wait_ms": 0.2894132062370493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2711308002471924, "StateBufferConnector_ms": 0.004422664642333984, "ViewRequirementAgentConnector_ms": 0.19068408012390137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.090316582355144, "num_agent_steps_trained_throughput_per_sec": 7.090316582355144, "timesteps_total": 47616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47616, "timers": {"training_iteration_time_ms": 71912.371, "sample_time_ms": 6025.347, "load_time_ms": 0.303, "load_throughput": 1689734.557, "learn_time_ms": 65886.207, "learn_throughput": 7.771, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "done": false, "episodes_total": 2976, "training_iteration": 93, "trial_id": "f4e01_00169", "date": "2024-02-27_01-54-11", "timestamp": 1708995251, "time_this_iter_s": 72.21619749069214, "time_total_s": 6684.36705493927, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6684.36705493927, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 52.86960784313726, "ram_util_percent": 21.0156862745098}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 6.69, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.552265625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.552265625, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9923698465029399, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.819697078069051, "policy_loss": -0.033333114658792816, "vf_loss": 9.192798268795013, "vf_explained_var": 0.967125284175078, "kl": 0.0, "entropy": 101.70493386586507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 6.69, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 6.69, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.552265625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.552265625, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -63.0, 30.0, -62.0, 54.0, -56.0, 44.0, -63.0, 39.0, -56.0, -61.0, 47.0, -53.0, -59.0, 58.0, 53.0, -51.0, 38.0, 53.0, -62.0, 53.0, -61.0, 44.0, -57.0, -59.0, -62.0, -60.0, 54.0, 59.0, 58.0, -58.0, 17.0, -62.0, 36.0, 44.0, -61.0, 53.0, 64.0, 48.0, 54.0, 48.0, 58.0, 25.0, 38.0, -52.0, -45.0, 26.0, 58.0, -63.0, 48.0, 59.0, 52.0, -50.0, 58.0, 37.0, -60.0, 53.0, 48.0, 41.0, -53.0, -62.0, 28.0, 58.0, 54.0, 43.0, 36.0, -55.0, 36.0, -61.0, 53.0, 59.0, 64.0, 48.0, 49.0, 49.0, 64.0, 64.0, 53.0, -56.0, 53.0, 58.0, 52.0, 38.0, 48.0, -55.0, 33.0, -59.0, -50.0, -55.0, -63.0, 49.0, -58.0, 58.0, 15.0, -52.0, 59.0, -51.0, -60.0, -61.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980300348808615, "mean_inference_ms": 9.701661308088479, "mean_action_processing_ms": 0.453856708679359, "mean_env_wait_ms": 0.28940560159387835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26988959312438965, "StateBufferConnector_ms": 0.00441741943359375, "ViewRequirementAgentConnector_ms": 0.1913142204284668}}, "episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 6.69, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -63.0, 30.0, -62.0, 54.0, -56.0, 44.0, -63.0, 39.0, -56.0, -61.0, 47.0, -53.0, -59.0, 58.0, 53.0, -51.0, 38.0, 53.0, -62.0, 53.0, -61.0, 44.0, -57.0, -59.0, -62.0, -60.0, 54.0, 59.0, 58.0, -58.0, 17.0, -62.0, 36.0, 44.0, -61.0, 53.0, 64.0, 48.0, 54.0, 48.0, 58.0, 25.0, 38.0, -52.0, -45.0, 26.0, 58.0, -63.0, 48.0, 59.0, 52.0, -50.0, 58.0, 37.0, -60.0, 53.0, 48.0, 41.0, -53.0, -62.0, 28.0, 58.0, 54.0, 43.0, 36.0, -55.0, 36.0, -61.0, 53.0, 59.0, 64.0, 48.0, 49.0, 49.0, 64.0, 64.0, 53.0, -56.0, 53.0, 58.0, 52.0, 38.0, 48.0, -55.0, 33.0, -59.0, -50.0, -55.0, -63.0, 49.0, -58.0, 58.0, 15.0, -52.0, 59.0, -51.0, -60.0, -61.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980300348808615, "mean_inference_ms": 9.701661308088479, "mean_action_processing_ms": 0.453856708679359, "mean_env_wait_ms": 0.28940560159387835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26988959312438965, "StateBufferConnector_ms": 0.00441741943359375, "ViewRequirementAgentConnector_ms": 0.1913142204284668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.157036842206649, "num_agent_steps_trained_throughput_per_sec": 7.157036842206649, "timesteps_total": 48128, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 71798.564, "sample_time_ms": 6029.684, "load_time_ms": 0.298, "load_throughput": 1716476.419, "learn_time_ms": 65768.072, "learn_throughput": 7.785, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "episodes_total": 3008, "training_iteration": 94, "trial_id": "f4e01_00169", "date": "2024-02-27_01-55-23", "timestamp": 1708995323, "time_this_iter_s": 71.54336285591125, "time_total_s": 6755.910417795181, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6755.910417795181, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 53.38039215686275, "ram_util_percent": 21.146078431372537}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.54, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.62140625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.62140625, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9789282987515132, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.220320373773575, "policy_loss": -0.039935598025719325, "vf_loss": 9.832389032840728, "vf_explained_var": 0.8742255772153537, "kl": 0.0, "entropy": 99.16268068949381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 15.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.54, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.62140625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.62140625, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, 36.0, 44.0, -61.0, 53.0, 64.0, 48.0, 54.0, 48.0, 58.0, 25.0, 38.0, -52.0, -45.0, 26.0, 58.0, -63.0, 48.0, 59.0, 52.0, -50.0, 58.0, 37.0, -60.0, 53.0, 48.0, 41.0, -53.0, -62.0, 28.0, 58.0, 54.0, 43.0, 36.0, -55.0, 36.0, -61.0, 53.0, 59.0, 64.0, 48.0, 49.0, 49.0, 64.0, 64.0, 53.0, -56.0, 53.0, 58.0, 52.0, 38.0, 48.0, -55.0, 33.0, -59.0, -50.0, -55.0, -63.0, 49.0, -58.0, 58.0, 15.0, -52.0, 59.0, -51.0, -60.0, -61.0, 48.0, 58.0, 52.0, 54.0, 58.0, 64.0, 21.0, 54.0, 44.0, -49.0, 44.0, -60.0, -56.0, -60.0, 64.0, -63.0, -56.0, 53.0, 49.0, 59.0, 58.0, -63.0, 59.0, 42.0, -57.0, 64.0, 48.0, 48.0, 58.0, -51.0, -56.0, 53.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980609194297619, "mean_inference_ms": 9.70204230383447, "mean_action_processing_ms": 0.4538937178020855, "mean_env_wait_ms": 0.2894311056683938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2706918716430664, "StateBufferConnector_ms": 0.0046460628509521484, "ViewRequirementAgentConnector_ms": 0.19220376014709473}}, "episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 15.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, 36.0, 44.0, -61.0, 53.0, 64.0, 48.0, 54.0, 48.0, 58.0, 25.0, 38.0, -52.0, -45.0, 26.0, 58.0, -63.0, 48.0, 59.0, 52.0, -50.0, 58.0, 37.0, -60.0, 53.0, 48.0, 41.0, -53.0, -62.0, 28.0, 58.0, 54.0, 43.0, 36.0, -55.0, 36.0, -61.0, 53.0, 59.0, 64.0, 48.0, 49.0, 49.0, 64.0, 64.0, 53.0, -56.0, 53.0, 58.0, 52.0, 38.0, 48.0, -55.0, 33.0, -59.0, -50.0, -55.0, -63.0, 49.0, -58.0, 58.0, 15.0, -52.0, 59.0, -51.0, -60.0, -61.0, 48.0, 58.0, 52.0, 54.0, 58.0, 64.0, 21.0, 54.0, 44.0, -49.0, 44.0, -60.0, -56.0, -60.0, 64.0, -63.0, -56.0, 53.0, 49.0, 59.0, 58.0, -63.0, 59.0, 42.0, -57.0, 64.0, 48.0, 48.0, 58.0, -51.0, -56.0, 53.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2980609194297619, "mean_inference_ms": 9.70204230383447, "mean_action_processing_ms": 0.4538937178020855, "mean_env_wait_ms": 0.2894311056683938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2706918716430664, "StateBufferConnector_ms": 0.0046460628509521484, "ViewRequirementAgentConnector_ms": 0.19220376014709473}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.133502579060679, "num_agent_steps_trained_throughput_per_sec": 7.133502579060679, "timesteps_total": 48640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48640, "timers": {"training_iteration_time_ms": 71782.689, "sample_time_ms": 6019.168, "load_time_ms": 0.296, "load_throughput": 1728357.061, "learn_time_ms": 65762.705, "learn_throughput": 7.786, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "done": false, "episodes_total": 3040, "training_iteration": 95, "trial_id": "f4e01_00169", "date": "2024-02-27_01-56-36", "timestamp": 1708995396, "time_this_iter_s": 71.77956485748291, "time_total_s": 6827.689982652664, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6827.689982652664, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 53.94271844660194, "ram_util_percent": 21.048543689320383}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 14.3, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61171875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.61171875, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.8833268761634825, "policy_loss": -0.02877761973068118, "vf_loss": 9.285580639044444, "vf_explained_var": 0.9606485893328984, "kl": 0.0, "entropy": 102.17411994934082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 14.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 14.3, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61171875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.61171875, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [43.0, 36.0, -55.0, 36.0, -61.0, 53.0, 59.0, 64.0, 48.0, 49.0, 49.0, 64.0, 64.0, 53.0, -56.0, 53.0, 58.0, 52.0, 38.0, 48.0, -55.0, 33.0, -59.0, -50.0, -55.0, -63.0, 49.0, -58.0, 58.0, 15.0, -52.0, 59.0, -51.0, -60.0, -61.0, 48.0, 58.0, 52.0, 54.0, 58.0, 64.0, 21.0, 54.0, 44.0, -49.0, 44.0, -60.0, -56.0, -60.0, 64.0, -63.0, -56.0, 53.0, 49.0, 59.0, 58.0, -63.0, 59.0, 42.0, -57.0, 64.0, 48.0, 48.0, 58.0, -51.0, -56.0, 53.0, 48.0, 64.0, 64.0, -57.0, -56.0, 44.0, -47.0, 22.0, 59.0, -56.0, 53.0, 59.0, 59.0, 49.0, 59.0, 58.0, 58.0, 59.0, 64.0, -39.0, 53.0, -57.0, -54.0, 48.0, 43.0, -6.0, -28.0, 59.0, -34.0, -48.0, 59.0, -38.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2979187509763037, "mean_inference_ms": 9.701724256545738, "mean_action_processing_ms": 0.4538651988792418, "mean_env_wait_ms": 0.2894002978951344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.269564151763916, "StateBufferConnector_ms": 0.0046122074127197266, "ViewRequirementAgentConnector_ms": 0.18904662132263184}}, "episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 14.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 36.0, -55.0, 36.0, -61.0, 53.0, 59.0, 64.0, 48.0, 49.0, 49.0, 64.0, 64.0, 53.0, -56.0, 53.0, 58.0, 52.0, 38.0, 48.0, -55.0, 33.0, -59.0, -50.0, -55.0, -63.0, 49.0, -58.0, 58.0, 15.0, -52.0, 59.0, -51.0, -60.0, -61.0, 48.0, 58.0, 52.0, 54.0, 58.0, 64.0, 21.0, 54.0, 44.0, -49.0, 44.0, -60.0, -56.0, -60.0, 64.0, -63.0, -56.0, 53.0, 49.0, 59.0, 58.0, -63.0, 59.0, 42.0, -57.0, 64.0, 48.0, 48.0, 58.0, -51.0, -56.0, 53.0, 48.0, 64.0, 64.0, -57.0, -56.0, 44.0, -47.0, 22.0, 59.0, -56.0, 53.0, 59.0, 59.0, 49.0, 59.0, 58.0, 58.0, 59.0, 64.0, -39.0, 53.0, -57.0, -54.0, 48.0, 43.0, -6.0, -28.0, 59.0, -34.0, -48.0, 59.0, -38.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2979187509763037, "mean_inference_ms": 9.701724256545738, "mean_action_processing_ms": 0.4538651988792418, "mean_env_wait_ms": 0.2894002978951344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.269564151763916, "StateBufferConnector_ms": 0.0046122074127197266, "ViewRequirementAgentConnector_ms": 0.18904662132263184}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.114004440616917, "num_agent_steps_trained_throughput_per_sec": 7.114004440616917, "timesteps_total": 49152, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 71764.92, "sample_time_ms": 6028.907, "load_time_ms": 0.296, "load_throughput": 1727244.951, "learn_time_ms": 65735.198, "learn_throughput": 7.789, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 3072, "training_iteration": 96, "trial_id": "f4e01_00169", "date": "2024-02-27_01-57-48", "timestamp": 1708995468, "time_this_iter_s": 71.97609877586365, "time_total_s": 6899.666081428528, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6899.666081428528, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 53.616666666666674, "ram_util_percent": 21.029411764705877}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 13.08, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6021875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.6021875, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.654537924130758, "policy_loss": -0.037492267321795225, "vf_loss": 8.93993084828059, "vf_explained_var": 0.938326537112395, "kl": 0.0, "entropy": 98.31538098653158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 13.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 13.08, "reward_total_min": -63, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6021875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 1.0, "reward_score_mean": 0.6021875, "reward_score_min": 0.0078125, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-51.0, -60.0, -61.0, 48.0, 58.0, 52.0, 54.0, 58.0, 64.0, 21.0, 54.0, 44.0, -49.0, 44.0, -60.0, -56.0, -60.0, 64.0, -63.0, -56.0, 53.0, 49.0, 59.0, 58.0, -63.0, 59.0, 42.0, -57.0, 64.0, 48.0, 48.0, 58.0, -51.0, -56.0, 53.0, 48.0, 64.0, 64.0, -57.0, -56.0, 44.0, -47.0, 22.0, 59.0, -56.0, 53.0, 59.0, 59.0, 49.0, 59.0, 58.0, 58.0, 59.0, 64.0, -39.0, 53.0, -57.0, -54.0, 48.0, 43.0, -6.0, -28.0, 59.0, -34.0, -48.0, 59.0, -38.0, -57.0, 53.0, -56.0, 48.0, 52.0, -53.0, 46.0, -61.0, -58.0, 27.0, 21.0, 51.0, -58.0, -52.0, 54.0, -59.0, -61.0, 53.0, 54.0, 49.0, 58.0, 48.0, 52.0, 53.0, 48.0, 53.0, 58.0, -50.0, 47.0, 29.0, 53.0, -49.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297792108399826, "mean_inference_ms": 9.70172788405773, "mean_action_processing_ms": 0.4538472699796299, "mean_env_wait_ms": 0.2893812520321881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703876495361328, "StateBufferConnector_ms": 0.0046231746673583984, "ViewRequirementAgentConnector_ms": 0.187974214553833}}, "episode_reward_max": 64.0, "episode_reward_min": -63.0, "episode_reward_mean": 13.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.0, -60.0, -61.0, 48.0, 58.0, 52.0, 54.0, 58.0, 64.0, 21.0, 54.0, 44.0, -49.0, 44.0, -60.0, -56.0, -60.0, 64.0, -63.0, -56.0, 53.0, 49.0, 59.0, 58.0, -63.0, 59.0, 42.0, -57.0, 64.0, 48.0, 48.0, 58.0, -51.0, -56.0, 53.0, 48.0, 64.0, 64.0, -57.0, -56.0, 44.0, -47.0, 22.0, 59.0, -56.0, 53.0, 59.0, 59.0, 49.0, 59.0, 58.0, 58.0, 59.0, 64.0, -39.0, 53.0, -57.0, -54.0, 48.0, 43.0, -6.0, -28.0, 59.0, -34.0, -48.0, 59.0, -38.0, -57.0, 53.0, -56.0, 48.0, 52.0, -53.0, 46.0, -61.0, -58.0, 27.0, 21.0, 51.0, -58.0, -52.0, 54.0, -59.0, -61.0, 53.0, 54.0, 49.0, 58.0, 48.0, 52.0, 53.0, 48.0, 53.0, 58.0, -50.0, 47.0, 29.0, 53.0, -49.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297792108399826, "mean_inference_ms": 9.70172788405773, "mean_action_processing_ms": 0.4538472699796299, "mean_env_wait_ms": 0.2893812520321881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2703876495361328, "StateBufferConnector_ms": 0.0046231746673583984, "ViewRequirementAgentConnector_ms": 0.187974214553833}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.152232639123633, "num_agent_steps_trained_throughput_per_sec": 7.152232639123633, "timesteps_total": 49664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49664, "timers": {"training_iteration_time_ms": 71760.028, "sample_time_ms": 6005.161, "load_time_ms": 0.299, "load_throughput": 1712916.685, "learn_time_ms": 65754.052, "learn_throughput": 7.787, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "done": false, "episodes_total": 3104, "training_iteration": 97, "trial_id": "f4e01_00169", "date": "2024-02-27_01-58-59", "timestamp": 1708995539, "time_this_iter_s": 71.59116387367249, "time_total_s": 6971.2572453022, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6971.2572453022, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 54.08333333333332, "ram_util_percent": 21.040196078431368}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.7, "reward_total_min": -61, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63828125, "reward_percentile_min": 0.0234375, "reward_percentile_max": 1.0, "reward_score_mean": 0.63828125, "reward_score_min": 0.0234375, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.61968244711558, "policy_loss": -0.050014041767766075, "vf_loss": 8.90485339164734, "vf_explained_var": 0.9891927510499954, "kl": 0.0, "entropy": 96.03403949737549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -61.0, "episode_reward_mean": 17.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.7, "reward_total_min": -61, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63828125, "reward_percentile_min": 0.0234375, "reward_percentile_max": 1.0, "reward_score_mean": 0.63828125, "reward_score_min": 0.0234375, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-51.0, -56.0, 53.0, 48.0, 64.0, 64.0, -57.0, -56.0, 44.0, -47.0, 22.0, 59.0, -56.0, 53.0, 59.0, 59.0, 49.0, 59.0, 58.0, 58.0, 59.0, 64.0, -39.0, 53.0, -57.0, -54.0, 48.0, 43.0, -6.0, -28.0, 59.0, -34.0, -48.0, 59.0, -38.0, -57.0, 53.0, -56.0, 48.0, 52.0, -53.0, 46.0, -61.0, -58.0, 27.0, 21.0, 51.0, -58.0, -52.0, 54.0, -59.0, -61.0, 53.0, 54.0, 49.0, 58.0, 48.0, 52.0, 53.0, 48.0, 53.0, 58.0, -50.0, 47.0, 29.0, 53.0, -49.0, -55.0, 59.0, 59.0, -52.0, 58.0, 59.0, -48.0, 59.0, 34.0, -61.0, -49.0, 59.0, -60.0, 58.0, 58.0, 53.0, 44.0, 54.0, 53.0, 39.0, 64.0, 54.0, 33.0, 43.0, -60.0, 37.0, 54.0, -44.0, 49.0, 53.0, 58.0, 54.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2977014751395344, "mean_inference_ms": 9.70141452601422, "mean_action_processing_ms": 0.45381708902858814, "mean_env_wait_ms": 0.28936811144666585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27016735076904297, "StateBufferConnector_ms": 0.0044023990631103516, "ViewRequirementAgentConnector_ms": 0.1895008087158203}}, "episode_reward_max": 64.0, "episode_reward_min": -61.0, "episode_reward_mean": 17.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.0, -56.0, 53.0, 48.0, 64.0, 64.0, -57.0, -56.0, 44.0, -47.0, 22.0, 59.0, -56.0, 53.0, 59.0, 59.0, 49.0, 59.0, 58.0, 58.0, 59.0, 64.0, -39.0, 53.0, -57.0, -54.0, 48.0, 43.0, -6.0, -28.0, 59.0, -34.0, -48.0, 59.0, -38.0, -57.0, 53.0, -56.0, 48.0, 52.0, -53.0, 46.0, -61.0, -58.0, 27.0, 21.0, 51.0, -58.0, -52.0, 54.0, -59.0, -61.0, 53.0, 54.0, 49.0, 58.0, 48.0, 52.0, 53.0, 48.0, 53.0, 58.0, -50.0, 47.0, 29.0, 53.0, -49.0, -55.0, 59.0, 59.0, -52.0, 58.0, 59.0, -48.0, 59.0, 34.0, -61.0, -49.0, 59.0, -60.0, 58.0, 58.0, 53.0, 44.0, 54.0, 53.0, 39.0, 64.0, 54.0, 33.0, 43.0, -60.0, 37.0, 54.0, -44.0, 49.0, 53.0, 58.0, 54.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2977014751395344, "mean_inference_ms": 9.70141452601422, "mean_action_processing_ms": 0.45381708902858814, "mean_env_wait_ms": 0.28936811144666585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27016735076904297, "StateBufferConnector_ms": 0.0044023990631103516, "ViewRequirementAgentConnector_ms": 0.1895008087158203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.24920901413109, "num_agent_steps_trained_throughput_per_sec": 7.24920901413109, "timesteps_total": 50176, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 71661.902, "sample_time_ms": 6012.91, "load_time_ms": 0.299, "load_throughput": 1714831.628, "learn_time_ms": 65648.182, "learn_throughput": 7.799, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "episodes_total": 3136, "training_iteration": 98, "trial_id": "f4e01_00169", "date": "2024-02-27_02-00-10", "timestamp": 1708995610, "time_this_iter_s": 70.63350105285645, "time_total_s": 7041.890746355057, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7041.890746355057, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 55.355, "ram_util_percent": 21.145000000000003}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 11.99, "reward_total_min": -61, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.593671875, "reward_percentile_min": 0.0234375, "reward_percentile_max": 1.0, "reward_score_mean": 0.593671875, "reward_score_min": 0.0234375, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9914797740677993, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.649528006712596, "policy_loss": -0.022494324731330076, "vf_loss": 8.908506405353545, "vf_explained_var": 0.9797359650333722, "kl": 0.0, "entropy": 104.19533735911051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -61.0, "episode_reward_mean": 11.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 11.99, "reward_total_min": -61, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.593671875, "reward_percentile_min": 0.0234375, "reward_percentile_max": 1.0, "reward_score_mean": 0.593671875, "reward_score_min": 0.0234375, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, 59.0, -38.0, -57.0, 53.0, -56.0, 48.0, 52.0, -53.0, 46.0, -61.0, -58.0, 27.0, 21.0, 51.0, -58.0, -52.0, 54.0, -59.0, -61.0, 53.0, 54.0, 49.0, 58.0, 48.0, 52.0, 53.0, 48.0, 53.0, 58.0, -50.0, 47.0, 29.0, 53.0, -49.0, -55.0, 59.0, 59.0, -52.0, 58.0, 59.0, -48.0, 59.0, 34.0, -61.0, -49.0, 59.0, -60.0, 58.0, 58.0, 53.0, 44.0, 54.0, 53.0, 39.0, 64.0, 54.0, 33.0, 43.0, -60.0, 37.0, 54.0, -44.0, 49.0, 53.0, 58.0, 54.0, 54.0, -53.0, -59.0, -60.0, -44.0, 59.0, -46.0, -55.0, -56.0, -49.0, -52.0, -40.0, 49.0, 64.0, -36.0, 38.0, 48.0, 59.0, -60.0, -43.0, -48.0, -47.0, 49.0, 42.0, -42.0, -45.0, 52.0, 49.0, 59.0, 54.0, 59.0, 53.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2974316669181882, "mean_inference_ms": 9.700319111804498, "mean_action_processing_ms": 0.4537295462019529, "mean_env_wait_ms": 0.289323201278381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.266477108001709, "StateBufferConnector_ms": 0.0043222904205322266, "ViewRequirementAgentConnector_ms": 0.1841728687286377}}, "episode_reward_max": 64.0, "episode_reward_min": -61.0, "episode_reward_mean": 11.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, 59.0, -38.0, -57.0, 53.0, -56.0, 48.0, 52.0, -53.0, 46.0, -61.0, -58.0, 27.0, 21.0, 51.0, -58.0, -52.0, 54.0, -59.0, -61.0, 53.0, 54.0, 49.0, 58.0, 48.0, 52.0, 53.0, 48.0, 53.0, 58.0, -50.0, 47.0, 29.0, 53.0, -49.0, -55.0, 59.0, 59.0, -52.0, 58.0, 59.0, -48.0, 59.0, 34.0, -61.0, -49.0, 59.0, -60.0, 58.0, 58.0, 53.0, 44.0, 54.0, 53.0, 39.0, 64.0, 54.0, 33.0, 43.0, -60.0, 37.0, 54.0, -44.0, 49.0, 53.0, 58.0, 54.0, 54.0, -53.0, -59.0, -60.0, -44.0, 59.0, -46.0, -55.0, -56.0, -49.0, -52.0, -40.0, 49.0, 64.0, -36.0, 38.0, 48.0, 59.0, -60.0, -43.0, -48.0, -47.0, 49.0, 42.0, -42.0, -45.0, 52.0, 49.0, 59.0, 54.0, 59.0, 53.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2974316669181882, "mean_inference_ms": 9.700319111804498, "mean_action_processing_ms": 0.4537295462019529, "mean_env_wait_ms": 0.289323201278381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.266477108001709, "StateBufferConnector_ms": 0.0043222904205322266, "ViewRequirementAgentConnector_ms": 0.1841728687286377}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.159656941300251, "num_agent_steps_trained_throughput_per_sec": 7.159656941300251, "timesteps_total": 50688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50688, "timers": {"training_iteration_time_ms": 71603.762, "sample_time_ms": 5990.521, "load_time_ms": 0.3, "load_throughput": 1705028.7, "learn_time_ms": 65612.437, "learn_throughput": 7.803, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "done": false, "episodes_total": 3168, "training_iteration": 99, "trial_id": "f4e01_00169", "date": "2024-02-27_02-01-22", "timestamp": 1708995682, "time_this_iter_s": 71.51697945594788, "time_total_s": 7113.407725811005, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7113.407725811005, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 56.33960396039603, "ram_util_percent": 21.268316831683176}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.32, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6196875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6196875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.388159863154093, "policy_loss": -0.041262597280244034, "vf_loss": 8.527477935949962, "vf_explained_var": 0.9491893589496613, "kl": 0.0, "entropy": 93.73636716206869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.32, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6196875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6196875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [29.0, 53.0, -49.0, -55.0, 59.0, 59.0, -52.0, 58.0, 59.0, -48.0, 59.0, 34.0, -61.0, -49.0, 59.0, -60.0, 58.0, 58.0, 53.0, 44.0, 54.0, 53.0, 39.0, 64.0, 54.0, 33.0, 43.0, -60.0, 37.0, 54.0, -44.0, 49.0, 53.0, 58.0, 54.0, 54.0, -53.0, -59.0, -60.0, -44.0, 59.0, -46.0, -55.0, -56.0, -49.0, -52.0, -40.0, 49.0, 64.0, -36.0, 38.0, 48.0, 59.0, -60.0, -43.0, -48.0, -47.0, 49.0, 42.0, -42.0, -45.0, 52.0, 49.0, 59.0, 54.0, 59.0, 53.0, 64.0, 58.0, 49.0, 59.0, 53.0, -53.0, -55.0, -51.0, 52.0, -64.0, -60.0, 53.0, 58.0, -62.0, -61.0, 47.0, 48.0, 53.0, 53.0, -63.0, 43.0, 59.0, 43.0, 48.0, 58.0, 48.0, 47.0, -42.0, 53.0, 64.0, 39.0, 34.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2972568907207906, "mean_inference_ms": 9.699411753561932, "mean_action_processing_ms": 0.4536827682407478, "mean_env_wait_ms": 0.28928998750609836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2684817314147949, "StateBufferConnector_ms": 0.004362821578979492, "ViewRequirementAgentConnector_ms": 0.1894237995147705}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.0, 53.0, -49.0, -55.0, 59.0, 59.0, -52.0, 58.0, 59.0, -48.0, 59.0, 34.0, -61.0, -49.0, 59.0, -60.0, 58.0, 58.0, 53.0, 44.0, 54.0, 53.0, 39.0, 64.0, 54.0, 33.0, 43.0, -60.0, 37.0, 54.0, -44.0, 49.0, 53.0, 58.0, 54.0, 54.0, -53.0, -59.0, -60.0, -44.0, 59.0, -46.0, -55.0, -56.0, -49.0, -52.0, -40.0, 49.0, 64.0, -36.0, 38.0, 48.0, 59.0, -60.0, -43.0, -48.0, -47.0, 49.0, 42.0, -42.0, -45.0, 52.0, 49.0, 59.0, 54.0, 59.0, 53.0, 64.0, 58.0, 49.0, 59.0, 53.0, -53.0, -55.0, -51.0, 52.0, -64.0, -60.0, 53.0, 58.0, -62.0, -61.0, 47.0, 48.0, 53.0, 53.0, -63.0, 43.0, 59.0, 43.0, 48.0, 58.0, 48.0, 47.0, -42.0, 53.0, 64.0, 39.0, 34.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2972568907207906, "mean_inference_ms": 9.699411753561932, "mean_action_processing_ms": 0.4536827682407478, "mean_env_wait_ms": 0.28928998750609836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2684817314147949, "StateBufferConnector_ms": 0.004362821578979492, "ViewRequirementAgentConnector_ms": 0.1894237995147705}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.197278503776727, "num_agent_steps_trained_throughput_per_sec": 7.197278503776727, "timesteps_total": 51200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 71583.409, "sample_time_ms": 6008.848, "load_time_ms": 0.3, "load_throughput": 1708691.636, "learn_time_ms": 65573.753, "learn_throughput": 7.808, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 3200, "training_iteration": 100, "trial_id": "f4e01_00169", "date": "2024-02-27_02-02-33", "timestamp": 1708995753, "time_this_iter_s": 71.14314818382263, "time_total_s": 7184.550873994827, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7184.550873994827, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 55.562376237623766, "ram_util_percent": 21.275247524752487}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 9.82, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.57671875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.57671875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.776732075214386, "policy_loss": -0.030591288985063633, "vf_loss": 9.121010891596477, "vf_explained_var": 0.9867140457034111, "kl": 0.0, "entropy": 102.84587008158366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 9.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 9.82, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.57671875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.57671875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 58.0, 54.0, 54.0, -53.0, -59.0, -60.0, -44.0, 59.0, -46.0, -55.0, -56.0, -49.0, -52.0, -40.0, 49.0, 64.0, -36.0, 38.0, 48.0, 59.0, -60.0, -43.0, -48.0, -47.0, 49.0, 42.0, -42.0, -45.0, 52.0, 49.0, 59.0, 54.0, 59.0, 53.0, 64.0, 58.0, 49.0, 59.0, 53.0, -53.0, -55.0, -51.0, 52.0, -64.0, -60.0, 53.0, 58.0, -62.0, -61.0, 47.0, 48.0, 53.0, 53.0, -63.0, 43.0, 59.0, 43.0, 48.0, 58.0, 48.0, 47.0, -42.0, 53.0, 64.0, 39.0, 34.0, 58.0, -63.0, -63.0, -61.0, 64.0, 38.0, 59.0, 44.0, 59.0, 43.0, 48.0, 39.0, -39.0, 53.0, -49.0, -63.0, 59.0, -64.0, -29.0, -48.0, -63.0, -46.0, -33.0, 64.0, 59.0, -42.0, -50.0, 37.0, 59.0, 59.0, 42.0, -38.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2968517558888693, "mean_inference_ms": 9.697410387352914, "mean_action_processing_ms": 0.4535484002867169, "mean_env_wait_ms": 0.28918446415673954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2640419006347656, "StateBufferConnector_ms": 0.004281044006347656, "ViewRequirementAgentConnector_ms": 0.1798861026763916}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 9.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 58.0, 54.0, 54.0, -53.0, -59.0, -60.0, -44.0, 59.0, -46.0, -55.0, -56.0, -49.0, -52.0, -40.0, 49.0, 64.0, -36.0, 38.0, 48.0, 59.0, -60.0, -43.0, -48.0, -47.0, 49.0, 42.0, -42.0, -45.0, 52.0, 49.0, 59.0, 54.0, 59.0, 53.0, 64.0, 58.0, 49.0, 59.0, 53.0, -53.0, -55.0, -51.0, 52.0, -64.0, -60.0, 53.0, 58.0, -62.0, -61.0, 47.0, 48.0, 53.0, 53.0, -63.0, 43.0, 59.0, 43.0, 48.0, 58.0, 48.0, 47.0, -42.0, 53.0, 64.0, 39.0, 34.0, 58.0, -63.0, -63.0, -61.0, 64.0, 38.0, 59.0, 44.0, 59.0, 43.0, 48.0, 39.0, -39.0, 53.0, -49.0, -63.0, 59.0, -64.0, -29.0, -48.0, -63.0, -46.0, -33.0, 64.0, 59.0, -42.0, -50.0, 37.0, 59.0, 59.0, 42.0, -38.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2968517558888693, "mean_inference_ms": 9.697410387352914, "mean_action_processing_ms": 0.4535484002867169, "mean_env_wait_ms": 0.28918446415673954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2640419006347656, "StateBufferConnector_ms": 0.004281044006347656, "ViewRequirementAgentConnector_ms": 0.1798861026763916}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.23643968405858, "num_agent_steps_trained_throughput_per_sec": 7.23643968405858, "timesteps_total": 51712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51712, "timers": {"training_iteration_time_ms": 71500.504, "sample_time_ms": 5990.779, "load_time_ms": 0.299, "load_throughput": 1714010.414, "learn_time_ms": 65508.91, "learn_throughput": 7.816, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "done": false, "episodes_total": 3232, "training_iteration": 101, "trial_id": "f4e01_00169", "date": "2024-02-27_02-03-44", "timestamp": 1708995824, "time_this_iter_s": 70.75873827934265, "time_total_s": 7255.30961227417, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7255.30961227417, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 55.26699999999999, "ram_util_percent": 21.033000000000005}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"reward_total_mean": 12.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.594609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.594609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.999193852643172, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.6304832100868225, "policy_loss": -0.03909379833688339, "vf_loss": 8.904665764172872, "vf_explained_var": 0.99299938082695, "kl": 0.0, "entropy": 105.1288377126058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 12.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.594609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.594609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 59.0, 53.0, 64.0, 58.0, 49.0, 59.0, 53.0, -53.0, -55.0, -51.0, 52.0, -64.0, -60.0, 53.0, 58.0, -62.0, -61.0, 47.0, 48.0, 53.0, 53.0, -63.0, 43.0, 59.0, 43.0, 48.0, 58.0, 48.0, 47.0, -42.0, 53.0, 64.0, 39.0, 34.0, 58.0, -63.0, -63.0, -61.0, 64.0, 38.0, 59.0, 44.0, 59.0, 43.0, 48.0, 39.0, -39.0, 53.0, -49.0, -63.0, 59.0, -64.0, -29.0, -48.0, -63.0, -46.0, -33.0, 64.0, 59.0, -42.0, -50.0, 37.0, 59.0, 59.0, 42.0, -38.0, 59.0, -62.0, -26.0, 43.0, 48.0, -18.0, 58.0, 59.0, -32.0, 46.0, -62.0, 64.0, -63.0, -64.0, 54.0, -64.0, -64.0, -61.0, -61.0, 59.0, -35.0, 53.0, 53.0, -45.0, 59.0, -9.0, 36.0, 59.0, -64.0, 59.0, 54.0, 54.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2966224447618964, "mean_inference_ms": 9.696264717297913, "mean_action_processing_ms": 0.45348955054081475, "mean_env_wait_ms": 0.2891314872252799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2714214324951172, "StateBufferConnector_ms": 0.004414081573486328, "ViewRequirementAgentConnector_ms": 0.18749451637268066}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 59.0, 53.0, 64.0, 58.0, 49.0, 59.0, 53.0, -53.0, -55.0, -51.0, 52.0, -64.0, -60.0, 53.0, 58.0, -62.0, -61.0, 47.0, 48.0, 53.0, 53.0, -63.0, 43.0, 59.0, 43.0, 48.0, 58.0, 48.0, 47.0, -42.0, 53.0, 64.0, 39.0, 34.0, 58.0, -63.0, -63.0, -61.0, 64.0, 38.0, 59.0, 44.0, 59.0, 43.0, 48.0, 39.0, -39.0, 53.0, -49.0, -63.0, 59.0, -64.0, -29.0, -48.0, -63.0, -46.0, -33.0, 64.0, 59.0, -42.0, -50.0, 37.0, 59.0, 59.0, 42.0, -38.0, 59.0, -62.0, -26.0, 43.0, 48.0, -18.0, 58.0, 59.0, -32.0, 46.0, -62.0, 64.0, -63.0, -64.0, 54.0, -64.0, -64.0, -61.0, -61.0, 59.0, -35.0, 53.0, 53.0, -45.0, 59.0, -9.0, 36.0, 59.0, -64.0, 59.0, 54.0, 54.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2966224447618964, "mean_inference_ms": 9.696264717297913, "mean_action_processing_ms": 0.45348955054081475, "mean_env_wait_ms": 0.2891314872252799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2714214324951172, "StateBufferConnector_ms": 0.004414081573486328, "ViewRequirementAgentConnector_ms": 0.18749451637268066}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.195216646540401, "num_agent_steps_trained_throughput_per_sec": 7.195216646540401, "timesteps_total": 52224, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 71426.915, "sample_time_ms": 5990.133, "load_time_ms": 0.301, "load_throughput": 1698421.107, "learn_time_ms": 65435.977, "learn_throughput": 7.824, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "episodes_total": 3264, "training_iteration": 102, "trial_id": "f4e01_00169", "date": "2024-02-27_02-04-55", "timestamp": 1708995895, "time_this_iter_s": 71.16347670555115, "time_total_s": 7326.473088979721, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7326.473088979721, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 55.305940594059415, "ram_util_percent": 21.02871287128712}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 8.51, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.566484375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.566484375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.853801544507345, "policy_loss": -0.033111763559281825, "vf_loss": 9.246015167236328, "vf_explained_var": 0.9798001602292061, "kl": 0.0, "entropy": 101.2898120880127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 8.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 8.51, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.566484375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.566484375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, 39.0, 34.0, 58.0, -63.0, -63.0, -61.0, 64.0, 38.0, 59.0, 44.0, 59.0, 43.0, 48.0, 39.0, -39.0, 53.0, -49.0, -63.0, 59.0, -64.0, -29.0, -48.0, -63.0, -46.0, -33.0, 64.0, 59.0, -42.0, -50.0, 37.0, 59.0, 59.0, 42.0, -38.0, 59.0, -62.0, -26.0, 43.0, 48.0, -18.0, 58.0, 59.0, -32.0, 46.0, -62.0, 64.0, -63.0, -64.0, 54.0, -64.0, -64.0, -61.0, -61.0, 59.0, -35.0, 53.0, 53.0, -45.0, 59.0, -9.0, 36.0, 59.0, -64.0, 59.0, 54.0, 54.0, 53.0, -63.0, -63.0, -63.0, 59.0, -33.0, -23.0, 49.0, 47.0, 58.0, 59.0, 53.0, 58.0, -62.0, 59.0, -63.0, 59.0, -29.0, 58.0, 59.0, 59.0, -64.0, 48.0, -32.0, -33.0, -15.0, 48.0, 48.0, 59.0, 43.0, 48.0, -24.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2959917110587897, "mean_inference_ms": 9.693227750314191, "mean_action_processing_ms": 0.453261472273403, "mean_env_wait_ms": 0.28896189511642106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2615065574645996, "StateBufferConnector_ms": 0.004273414611816406, "ViewRequirementAgentConnector_ms": 0.1722555160522461}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 8.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 39.0, 34.0, 58.0, -63.0, -63.0, -61.0, 64.0, 38.0, 59.0, 44.0, 59.0, 43.0, 48.0, 39.0, -39.0, 53.0, -49.0, -63.0, 59.0, -64.0, -29.0, -48.0, -63.0, -46.0, -33.0, 64.0, 59.0, -42.0, -50.0, 37.0, 59.0, 59.0, 42.0, -38.0, 59.0, -62.0, -26.0, 43.0, 48.0, -18.0, 58.0, 59.0, -32.0, 46.0, -62.0, 64.0, -63.0, -64.0, 54.0, -64.0, -64.0, -61.0, -61.0, 59.0, -35.0, 53.0, 53.0, -45.0, 59.0, -9.0, 36.0, 59.0, -64.0, 59.0, 54.0, 54.0, 53.0, -63.0, -63.0, -63.0, 59.0, -33.0, -23.0, 49.0, 47.0, 58.0, 59.0, 53.0, 58.0, -62.0, 59.0, -63.0, 59.0, -29.0, 58.0, 59.0, 59.0, -64.0, 48.0, -32.0, -33.0, -15.0, 48.0, 48.0, 59.0, 43.0, 48.0, -24.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2959917110587897, "mean_inference_ms": 9.693227750314191, "mean_action_processing_ms": 0.453261472273403, "mean_env_wait_ms": 0.28896189511642106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2615065574645996, "StateBufferConnector_ms": 0.004273414611816406, "ViewRequirementAgentConnector_ms": 0.1722555160522461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.26892024903419, "num_agent_steps_trained_throughput_per_sec": 7.26892024903419, "timesteps_total": 52736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52736, "timers": {"training_iteration_time_ms": 71249.487, "sample_time_ms": 5939.236, "load_time_ms": 0.28, "load_throughput": 1829046.63, "learn_time_ms": 65309.486, "learn_throughput": 7.84, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "done": false, "episodes_total": 3296, "training_iteration": 103, "trial_id": "f4e01_00169", "date": "2024-02-27_02-06-05", "timestamp": 1708995965, "time_this_iter_s": 70.44201731681824, "time_total_s": 7396.915106296539, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7396.915106296539, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 54.845, "ram_util_percent": 21.28100000000001}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 10.47, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.581796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.581796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9990147307515145, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.203594287236531, "policy_loss": 0.030548840869838993, "vf_loss": 8.124810755252838, "vf_explained_var": 0.9878755643963814, "kl": 0.0, "entropy": 98.83241189320883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.47, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 10.47, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.581796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.581796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 42.0, -38.0, 59.0, -62.0, -26.0, 43.0, 48.0, -18.0, 58.0, 59.0, -32.0, 46.0, -62.0, 64.0, -63.0, -64.0, 54.0, -64.0, -64.0, -61.0, -61.0, 59.0, -35.0, 53.0, 53.0, -45.0, 59.0, -9.0, 36.0, 59.0, -64.0, 59.0, 54.0, 54.0, 53.0, -63.0, -63.0, -63.0, 59.0, -33.0, -23.0, 49.0, 47.0, 58.0, 59.0, 53.0, 58.0, -62.0, 59.0, -63.0, 59.0, -29.0, 58.0, 59.0, 59.0, -64.0, 48.0, -32.0, -33.0, -15.0, 48.0, 48.0, 59.0, 43.0, 48.0, -24.0, -63.0, 53.0, 48.0, 36.0, -27.0, 38.0, -64.0, 58.0, 47.0, 47.0, 31.0, 53.0, -30.0, 54.0, 36.0, 43.0, -5.0, 59.0, 38.0, 46.0, -21.0, 53.0, -63.0, -64.0, -19.0, -63.0, 53.0, 43.0, 59.0, -62.0, 53.0, -63.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2954831061734715, "mean_inference_ms": 9.69093061563246, "mean_action_processing_ms": 0.45310120554881855, "mean_env_wait_ms": 0.28884317715278335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26315855979919434, "StateBufferConnector_ms": 0.004316091537475586, "ViewRequirementAgentConnector_ms": 0.17809391021728516}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.47, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 42.0, -38.0, 59.0, -62.0, -26.0, 43.0, 48.0, -18.0, 58.0, 59.0, -32.0, 46.0, -62.0, 64.0, -63.0, -64.0, 54.0, -64.0, -64.0, -61.0, -61.0, 59.0, -35.0, 53.0, 53.0, -45.0, 59.0, -9.0, 36.0, 59.0, -64.0, 59.0, 54.0, 54.0, 53.0, -63.0, -63.0, -63.0, 59.0, -33.0, -23.0, 49.0, 47.0, 58.0, 59.0, 53.0, 58.0, -62.0, 59.0, -63.0, 59.0, -29.0, 58.0, 59.0, 59.0, -64.0, 48.0, -32.0, -33.0, -15.0, 48.0, 48.0, 59.0, 43.0, 48.0, -24.0, -63.0, 53.0, 48.0, 36.0, -27.0, 38.0, -64.0, 58.0, 47.0, 47.0, 31.0, 53.0, -30.0, 54.0, 36.0, 43.0, -5.0, 59.0, 38.0, 46.0, -21.0, 53.0, -63.0, -64.0, -19.0, -63.0, 53.0, 43.0, 59.0, -62.0, 53.0, -63.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2954831061734715, "mean_inference_ms": 9.69093061563246, "mean_action_processing_ms": 0.45310120554881855, "mean_env_wait_ms": 0.28884317715278335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26315855979919434, "StateBufferConnector_ms": 0.004316091537475586, "ViewRequirementAgentConnector_ms": 0.17809391021728516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.210456356732838, "num_agent_steps_trained_throughput_per_sec": 7.210456356732838, "timesteps_total": 53248, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 71196.488, "sample_time_ms": 5941.393, "load_time_ms": 0.283, "load_throughput": 1811763.813, "learn_time_ms": 65254.332, "learn_throughput": 7.846, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "episodes_total": 3328, "training_iteration": 104, "trial_id": "f4e01_00169", "date": "2024-02-27_02-07-16", "timestamp": 1708996036, "time_this_iter_s": 71.0131528377533, "time_total_s": 7467.928259134293, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7467.928259134293, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 54.009900990099, "ram_util_percent": 21.28217821782179}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.285984516143799, "policy_loss": -0.04171934096763531, "vf_loss": 8.367718076705932, "vf_explained_var": 0.9706737846136093, "kl": 0.0, "entropy": 97.80104700724284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.46, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 54.0, 54.0, 53.0, -63.0, -63.0, -63.0, 59.0, -33.0, -23.0, 49.0, 47.0, 58.0, 59.0, 53.0, 58.0, -62.0, 59.0, -63.0, 59.0, -29.0, 58.0, 59.0, 59.0, -64.0, 48.0, -32.0, -33.0, -15.0, 48.0, 48.0, 59.0, 43.0, 48.0, -24.0, -63.0, 53.0, 48.0, 36.0, -27.0, 38.0, -64.0, 58.0, 47.0, 47.0, 31.0, 53.0, -30.0, 54.0, 36.0, 43.0, -5.0, 59.0, 38.0, 46.0, -21.0, 53.0, -63.0, -64.0, -19.0, -63.0, 53.0, 43.0, 59.0, -62.0, 53.0, -63.0, -64.0, 58.0, 45.0, 58.0, 53.0, -64.0, 44.0, -7.0, -22.0, 49.0, 42.0, 52.0, -24.0, -26.0, -16.0, 59.0, -63.0, 37.0, 58.0, 64.0, 27.0, 58.0, 48.0, -7.0, 58.0, -64.0, 44.0, 48.0, 59.0, 54.0, 53.0, 58.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2948611425833139, "mean_inference_ms": 9.687877224415374, "mean_action_processing_ms": 0.4528806203090656, "mean_env_wait_ms": 0.28867524513676907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25585198402404785, "StateBufferConnector_ms": 0.0044727325439453125, "ViewRequirementAgentConnector_ms": 0.17239141464233398}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.46, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 54.0, 54.0, 53.0, -63.0, -63.0, -63.0, 59.0, -33.0, -23.0, 49.0, 47.0, 58.0, 59.0, 53.0, 58.0, -62.0, 59.0, -63.0, 59.0, -29.0, 58.0, 59.0, 59.0, -64.0, 48.0, -32.0, -33.0, -15.0, 48.0, 48.0, 59.0, 43.0, 48.0, -24.0, -63.0, 53.0, 48.0, 36.0, -27.0, 38.0, -64.0, 58.0, 47.0, 47.0, 31.0, 53.0, -30.0, 54.0, 36.0, 43.0, -5.0, 59.0, 38.0, 46.0, -21.0, 53.0, -63.0, -64.0, -19.0, -63.0, 53.0, 43.0, 59.0, -62.0, 53.0, -63.0, -64.0, 58.0, 45.0, 58.0, 53.0, -64.0, 44.0, -7.0, -22.0, 49.0, 42.0, 52.0, -24.0, -26.0, -16.0, 59.0, -63.0, 37.0, 58.0, 64.0, 27.0, 58.0, 48.0, -7.0, 58.0, -64.0, 44.0, 48.0, 59.0, 54.0, 53.0, 58.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2948611425833139, "mean_inference_ms": 9.687877224415374, "mean_action_processing_ms": 0.4528806203090656, "mean_env_wait_ms": 0.28867524513676907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25585198402404785, "StateBufferConnector_ms": 0.0044727325439453125, "ViewRequirementAgentConnector_ms": 0.17239141464233398}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.260133784577326, "num_agent_steps_trained_throughput_per_sec": 7.260133784577326, "timesteps_total": 53760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 71071.3, "sample_time_ms": 5912.431, "load_time_ms": 0.285, "load_throughput": 1799165.255, "learn_time_ms": 65158.122, "learn_throughput": 7.858, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 3360, "training_iteration": 105, "trial_id": "f4e01_00169", "date": "2024-02-27_02-08-27", "timestamp": 1708996107, "time_this_iter_s": 70.52756834030151, "time_total_s": 7538.455827474594, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7538.455827474594, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 53.736999999999995, "ram_util_percent": 21.34700000000001}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 12.81, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.600078125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.600078125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.536319800217947, "policy_loss": -0.018882325175218283, "vf_loss": 8.72502804994583, "vf_explained_var": 0.9746969744563103, "kl": 0.0, "entropy": 106.52323703765869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 12.81, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.600078125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.600078125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [43.0, 48.0, -24.0, -63.0, 53.0, 48.0, 36.0, -27.0, 38.0, -64.0, 58.0, 47.0, 47.0, 31.0, 53.0, -30.0, 54.0, 36.0, 43.0, -5.0, 59.0, 38.0, 46.0, -21.0, 53.0, -63.0, -64.0, -19.0, -63.0, 53.0, 43.0, 59.0, -62.0, 53.0, -63.0, -64.0, 58.0, 45.0, 58.0, 53.0, -64.0, 44.0, -7.0, -22.0, 49.0, 42.0, 52.0, -24.0, -26.0, -16.0, 59.0, -63.0, 37.0, 58.0, 64.0, 27.0, 58.0, 48.0, -7.0, 58.0, -64.0, 44.0, 48.0, 59.0, 54.0, 53.0, 58.0, 49.0, -64.0, 53.0, -63.0, 48.0, -15.0, -12.0, 58.0, -64.0, 53.0, -16.0, -27.0, 49.0, 54.0, 64.0, -64.0, -64.0, 58.0, 58.0, -64.0, 53.0, -12.0, -63.0, -30.0, -62.0, 7.0, -64.0, -10.0, 51.0, 26.0, 64.0, 53.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2945056082378665, "mean_inference_ms": 9.686033311045499, "mean_action_processing_ms": 0.4527718164921565, "mean_env_wait_ms": 0.28859981070888163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26366114616394043, "StateBufferConnector_ms": 0.004578828811645508, "ViewRequirementAgentConnector_ms": 0.1816730499267578}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 48.0, -24.0, -63.0, 53.0, 48.0, 36.0, -27.0, 38.0, -64.0, 58.0, 47.0, 47.0, 31.0, 53.0, -30.0, 54.0, 36.0, 43.0, -5.0, 59.0, 38.0, 46.0, -21.0, 53.0, -63.0, -64.0, -19.0, -63.0, 53.0, 43.0, 59.0, -62.0, 53.0, -63.0, -64.0, 58.0, 45.0, 58.0, 53.0, -64.0, 44.0, -7.0, -22.0, 49.0, 42.0, 52.0, -24.0, -26.0, -16.0, 59.0, -63.0, 37.0, 58.0, 64.0, 27.0, 58.0, 48.0, -7.0, 58.0, -64.0, 44.0, 48.0, 59.0, 54.0, 53.0, 58.0, 49.0, -64.0, 53.0, -63.0, 48.0, -15.0, -12.0, 58.0, -64.0, 53.0, -16.0, -27.0, 49.0, 54.0, 64.0, -64.0, -64.0, 58.0, 58.0, -64.0, 53.0, -12.0, -63.0, -30.0, -62.0, 7.0, -64.0, -10.0, 51.0, 26.0, 64.0, 53.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2945056082378665, "mean_inference_ms": 9.686033311045499, "mean_action_processing_ms": 0.4527718164921565, "mean_env_wait_ms": 0.28859981070888163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26366114616394043, "StateBufferConnector_ms": 0.004578828811645508, "ViewRequirementAgentConnector_ms": 0.1816730499267578}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.155212221961871, "num_agent_steps_trained_throughput_per_sec": 7.155212221961871, "timesteps_total": 54272, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 71029.852, "sample_time_ms": 5910.177, "load_time_ms": 0.281, "load_throughput": 1819130.579, "learn_time_ms": 65118.93, "learn_throughput": 7.863, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "episodes_total": 3392, "training_iteration": 106, "trial_id": "f4e01_00169", "date": "2024-02-27_02-09-39", "timestamp": 1708996179, "time_this_iter_s": 71.56138586997986, "time_total_s": 7610.017213344574, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7610.017213344574, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 53.93921568627451, "ram_util_percent": 21.365686274509816}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 9.87, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.577109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.577109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.484583107630412, "policy_loss": -0.03285139215489229, "vf_loss": 8.665710039933522, "vf_explained_var": 0.9866091291109721, "kl": 0.0, "entropy": 103.2706122080485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 9.87, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 9.87, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.577109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.577109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, 53.0, -63.0, -64.0, 58.0, 45.0, 58.0, 53.0, -64.0, 44.0, -7.0, -22.0, 49.0, 42.0, 52.0, -24.0, -26.0, -16.0, 59.0, -63.0, 37.0, 58.0, 64.0, 27.0, 58.0, 48.0, -7.0, 58.0, -64.0, 44.0, 48.0, 59.0, 54.0, 53.0, 58.0, 49.0, -64.0, 53.0, -63.0, 48.0, -15.0, -12.0, 58.0, -64.0, 53.0, -16.0, -27.0, 49.0, 54.0, 64.0, -64.0, -64.0, 58.0, 58.0, -64.0, 53.0, -12.0, -63.0, -30.0, -62.0, 7.0, -64.0, -10.0, 51.0, 26.0, 64.0, 53.0, -63.0, 54.0, -63.0, -9.0, -28.0, 53.0, 48.0, 54.0, 54.0, 59.0, 53.0, -64.0, 38.0, 26.0, -63.0, 38.0, -64.0, 54.0, -2.0, 48.0, -25.0, 53.0, 53.0, -7.0, -64.0, -64.0, -12.0, 16.0, -64.0, 34.0, -64.0, 53.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2940182922947292, "mean_inference_ms": 9.683350332164318, "mean_action_processing_ms": 0.45257747107185964, "mean_env_wait_ms": 0.2884524089811247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2585291862487793, "StateBufferConnector_ms": 0.004527091979980469, "ViewRequirementAgentConnector_ms": 0.17456483840942383}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 9.87, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, 53.0, -63.0, -64.0, 58.0, 45.0, 58.0, 53.0, -64.0, 44.0, -7.0, -22.0, 49.0, 42.0, 52.0, -24.0, -26.0, -16.0, 59.0, -63.0, 37.0, 58.0, 64.0, 27.0, 58.0, 48.0, -7.0, 58.0, -64.0, 44.0, 48.0, 59.0, 54.0, 53.0, 58.0, 49.0, -64.0, 53.0, -63.0, 48.0, -15.0, -12.0, 58.0, -64.0, 53.0, -16.0, -27.0, 49.0, 54.0, 64.0, -64.0, -64.0, 58.0, 58.0, -64.0, 53.0, -12.0, -63.0, -30.0, -62.0, 7.0, -64.0, -10.0, 51.0, 26.0, 64.0, 53.0, -63.0, 54.0, -63.0, -9.0, -28.0, 53.0, 48.0, 54.0, 54.0, 59.0, 53.0, -64.0, 38.0, 26.0, -63.0, 38.0, -64.0, 54.0, -2.0, 48.0, -25.0, 53.0, 53.0, -7.0, -64.0, -64.0, -12.0, 16.0, -64.0, 34.0, -64.0, 53.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2940182922947292, "mean_inference_ms": 9.683350332164318, "mean_action_processing_ms": 0.45257747107185964, "mean_env_wait_ms": 0.2884524089811247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2585291862487793, "StateBufferConnector_ms": 0.004527091979980469, "ViewRequirementAgentConnector_ms": 0.17456483840942383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.173884392602426, "num_agent_steps_trained_throughput_per_sec": 7.173884392602426, "timesteps_total": 54784, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54784, "timers": {"training_iteration_time_ms": 71008.245, "sample_time_ms": 5880.02, "load_time_ms": 0.279, "load_throughput": 1834358.63, "learn_time_ms": 65127.474, "learn_throughput": 7.862, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "done": false, "episodes_total": 3424, "training_iteration": 107, "trial_id": "f4e01_00169", "date": "2024-02-27_02-10-55", "timestamp": 1708996255, "time_this_iter_s": 71.37532901763916, "time_total_s": 7681.392542362213, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7681.392542362213, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 54.73457943925232, "ram_util_percent": 21.32803738317757}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 12.76, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.5996875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.5996875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9928494403759639, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.252118140459061, "policy_loss": 0.007297356054186821, "vf_loss": 9.808146552244823, "vf_explained_var": 0.987041695912679, "kl": 0.0, "entropy": 95.79487241109213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 12.76, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.5996875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.5996875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 53.0, 58.0, 49.0, -64.0, 53.0, -63.0, 48.0, -15.0, -12.0, 58.0, -64.0, 53.0, -16.0, -27.0, 49.0, 54.0, 64.0, -64.0, -64.0, 58.0, 58.0, -64.0, 53.0, -12.0, -63.0, -30.0, -62.0, 7.0, -64.0, -10.0, 51.0, 26.0, 64.0, 53.0, -63.0, 54.0, -63.0, -9.0, -28.0, 53.0, 48.0, 54.0, 54.0, 59.0, 53.0, -64.0, 38.0, 26.0, -63.0, 38.0, -64.0, 54.0, -2.0, 48.0, -25.0, 53.0, 53.0, -7.0, -64.0, -64.0, -12.0, 16.0, -64.0, 34.0, -64.0, 53.0, 54.0, 64.0, -63.0, 45.0, -64.0, 53.0, 49.0, -63.0, -22.0, 38.0, 58.0, -63.0, -64.0, 49.0, 52.0, 58.0, 58.0, 64.0, 64.0, 52.0, 64.0, 59.0, 58.0, -16.0, 58.0, 58.0, 64.0, 58.0, 8.0, 48.0, 53.0, -23.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2938019461668926, "mean_inference_ms": 9.682150991218032, "mean_action_processing_ms": 0.45249680418956645, "mean_env_wait_ms": 0.2883791321670081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2656867504119873, "StateBufferConnector_ms": 0.004569292068481445, "ViewRequirementAgentConnector_ms": 0.18343019485473633}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 53.0, 58.0, 49.0, -64.0, 53.0, -63.0, 48.0, -15.0, -12.0, 58.0, -64.0, 53.0, -16.0, -27.0, 49.0, 54.0, 64.0, -64.0, -64.0, 58.0, 58.0, -64.0, 53.0, -12.0, -63.0, -30.0, -62.0, 7.0, -64.0, -10.0, 51.0, 26.0, 64.0, 53.0, -63.0, 54.0, -63.0, -9.0, -28.0, 53.0, 48.0, 54.0, 54.0, 59.0, 53.0, -64.0, 38.0, 26.0, -63.0, 38.0, -64.0, 54.0, -2.0, 48.0, -25.0, 53.0, 53.0, -7.0, -64.0, -64.0, -12.0, 16.0, -64.0, 34.0, -64.0, 53.0, 54.0, 64.0, -63.0, 45.0, -64.0, 53.0, 49.0, -63.0, -22.0, 38.0, 58.0, -63.0, -64.0, 49.0, 52.0, 58.0, 58.0, 64.0, 64.0, 52.0, 64.0, 59.0, 58.0, -16.0, 58.0, 58.0, 64.0, 58.0, 8.0, 48.0, 53.0, -23.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2938019461668926, "mean_inference_ms": 9.682150991218032, "mean_action_processing_ms": 0.45249680418956645, "mean_env_wait_ms": 0.2883791321670081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2656867504119873, "StateBufferConnector_ms": 0.004569292068481445, "ViewRequirementAgentConnector_ms": 0.18343019485473633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.134137428777761, "num_agent_steps_trained_throughput_per_sec": 7.134137428777761, "timesteps_total": 55296, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 71122.166, "sample_time_ms": 5892.093, "load_time_ms": 0.283, "load_throughput": 1808407.283, "learn_time_ms": 65229.297, "learn_throughput": 7.849, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "episodes_total": 3456, "training_iteration": 108, "trial_id": "f4e01_00169", "date": "2024-02-27_02-12-06", "timestamp": 1708996326, "time_this_iter_s": 71.77308583259583, "time_total_s": 7753.165628194809, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7753.165628194809, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 54.87941176470589, "ram_util_percent": 21.141176470588224}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 16.94, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.105813266833623, "policy_loss": 0.02784837083114932, "vf_loss": 7.975476864973704, "vf_explained_var": 0.9912639925877254, "kl": 0.0, "entropy": 101.7930919011434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 16.94, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [26.0, 64.0, 53.0, -63.0, 54.0, -63.0, -9.0, -28.0, 53.0, 48.0, 54.0, 54.0, 59.0, 53.0, -64.0, 38.0, 26.0, -63.0, 38.0, -64.0, 54.0, -2.0, 48.0, -25.0, 53.0, 53.0, -7.0, -64.0, -64.0, -12.0, 16.0, -64.0, 34.0, -64.0, 53.0, 54.0, 64.0, -63.0, 45.0, -64.0, 53.0, 49.0, -63.0, -22.0, 38.0, 58.0, -63.0, -64.0, 49.0, 52.0, 58.0, 58.0, 64.0, 64.0, 52.0, 64.0, 59.0, 58.0, -16.0, 58.0, 58.0, 64.0, 58.0, 8.0, 48.0, 53.0, -23.0, -33.0, -64.0, 49.0, 54.0, 44.0, 59.0, 54.0, 43.0, 59.0, -11.0, 54.0, -63.0, 53.0, 47.0, 64.0, 48.0, 58.0, -63.0, 59.0, 14.0, 58.0, 39.0, -63.0, -64.0, 54.0, 58.0, 59.0, -63.0, 48.0, -62.0, -18.0, 4.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937277646352834, "mean_inference_ms": 9.681607621172011, "mean_action_processing_ms": 0.4524577905376954, "mean_env_wait_ms": 0.28832933956951246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2693660259246826, "StateBufferConnector_ms": 0.0044672489166259766, "ViewRequirementAgentConnector_ms": 0.18964791297912598}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.0, 64.0, 53.0, -63.0, 54.0, -63.0, -9.0, -28.0, 53.0, 48.0, 54.0, 54.0, 59.0, 53.0, -64.0, 38.0, 26.0, -63.0, 38.0, -64.0, 54.0, -2.0, 48.0, -25.0, 53.0, 53.0, -7.0, -64.0, -64.0, -12.0, 16.0, -64.0, 34.0, -64.0, 53.0, 54.0, 64.0, -63.0, 45.0, -64.0, 53.0, 49.0, -63.0, -22.0, 38.0, 58.0, -63.0, -64.0, 49.0, 52.0, 58.0, 58.0, 64.0, 64.0, 52.0, 64.0, 59.0, 58.0, -16.0, 58.0, 58.0, 64.0, 58.0, 8.0, 48.0, 53.0, -23.0, -33.0, -64.0, 49.0, 54.0, 44.0, 59.0, 54.0, 43.0, 59.0, -11.0, 54.0, -63.0, 53.0, 47.0, 64.0, 48.0, 58.0, -63.0, 59.0, 14.0, 58.0, 39.0, -63.0, -64.0, 54.0, 58.0, 59.0, -63.0, 48.0, -62.0, -18.0, 4.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937277646352834, "mean_inference_ms": 9.681607621172011, "mean_action_processing_ms": 0.4524577905376954, "mean_env_wait_ms": 0.28832933956951246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2693660259246826, "StateBufferConnector_ms": 0.0044672489166259766, "ViewRequirementAgentConnector_ms": 0.18964791297912598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.118125457235317, "num_agent_steps_trained_throughput_per_sec": 7.118125457235317, "timesteps_total": 55808, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55808, "timers": {"training_iteration_time_ms": 71163.891, "sample_time_ms": 5918.296, "load_time_ms": 0.29, "load_throughput": 1767330.794, "learn_time_ms": 65244.798, "learn_throughput": 7.847, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "done": false, "episodes_total": 3488, "training_iteration": 109, "trial_id": "f4e01_00169", "date": "2024-02-27_02-13-18", "timestamp": 1708996398, "time_this_iter_s": 71.9342155456543, "time_total_s": 7825.099843740463, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7825.099843740463, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 53.680392156862744, "ram_util_percent": 21.210784313725497}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.57, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.652890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.652890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.254915535449982, "policy_loss": -0.013018336504076918, "vf_loss": 8.273843057950337, "vf_explained_var": 0.9869206274549166, "kl": 0.0, "entropy": 105.67384707132975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.57, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.57, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.652890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.652890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [34.0, -64.0, 53.0, 54.0, 64.0, -63.0, 45.0, -64.0, 53.0, 49.0, -63.0, -22.0, 38.0, 58.0, -63.0, -64.0, 49.0, 52.0, 58.0, 58.0, 64.0, 64.0, 52.0, 64.0, 59.0, 58.0, -16.0, 58.0, 58.0, 64.0, 58.0, 8.0, 48.0, 53.0, -23.0, -33.0, -64.0, 49.0, 54.0, 44.0, 59.0, 54.0, 43.0, 59.0, -11.0, 54.0, -63.0, 53.0, 47.0, 64.0, 48.0, 58.0, -63.0, 59.0, 14.0, 58.0, 39.0, -63.0, -64.0, 54.0, 58.0, 59.0, -63.0, 48.0, -62.0, -18.0, 4.0, -64.0, 53.0, -14.0, 54.0, -63.0, -13.0, 41.0, -8.0, 64.0, 52.0, 43.0, 47.0, 48.0, 64.0, -13.0, 58.0, 4.0, 58.0, -18.0, -64.0, -2.0, 48.0, -8.0, 64.0, -64.0, 58.0, 59.0, 64.0, -64.0, -63.0, 53.0, -14.0, -9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937507388627572, "mean_inference_ms": 9.681782253912855, "mean_action_processing_ms": 0.4524839047280442, "mean_env_wait_ms": 0.28833130353996483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27231836318969727, "StateBufferConnector_ms": 0.0044786930084228516, "ViewRequirementAgentConnector_ms": 0.1952681541442871}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.57, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.0, -64.0, 53.0, 54.0, 64.0, -63.0, 45.0, -64.0, 53.0, 49.0, -63.0, -22.0, 38.0, 58.0, -63.0, -64.0, 49.0, 52.0, 58.0, 58.0, 64.0, 64.0, 52.0, 64.0, 59.0, 58.0, -16.0, 58.0, 58.0, 64.0, 58.0, 8.0, 48.0, 53.0, -23.0, -33.0, -64.0, 49.0, 54.0, 44.0, 59.0, 54.0, 43.0, 59.0, -11.0, 54.0, -63.0, 53.0, 47.0, 64.0, 48.0, 58.0, -63.0, 59.0, 14.0, 58.0, 39.0, -63.0, -64.0, 54.0, 58.0, 59.0, -63.0, 48.0, -62.0, -18.0, 4.0, -64.0, 53.0, -14.0, 54.0, -63.0, -13.0, 41.0, -8.0, 64.0, 52.0, 43.0, 47.0, 48.0, 64.0, -13.0, 58.0, 4.0, 58.0, -18.0, -64.0, -2.0, 48.0, -8.0, 64.0, -64.0, 58.0, 59.0, 64.0, -64.0, -63.0, 53.0, -14.0, -9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937507388627572, "mean_inference_ms": 9.681782253912855, "mean_action_processing_ms": 0.4524839047280442, "mean_env_wait_ms": 0.28833130353996483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27231836318969727, "StateBufferConnector_ms": 0.0044786930084228516, "ViewRequirementAgentConnector_ms": 0.1952681541442871}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.16700912771535, "num_agent_steps_trained_throughput_per_sec": 7.16700912771535, "timesteps_total": 56320, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 71193.934, "sample_time_ms": 5902.166, "load_time_ms": 0.286, "load_throughput": 1792856.61, "learn_time_ms": 65290.944, "learn_throughput": 7.842, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "episodes_total": 3520, "training_iteration": 110, "trial_id": "f4e01_00169", "date": "2024-02-27_02-14-30", "timestamp": 1708996470, "time_this_iter_s": 71.44368171691895, "time_total_s": 7896.543525457382, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7896.543525457382, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 53.75000000000001, "ram_util_percent": 21.335294117647067}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.52, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.668125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.668125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.655325996875763, "policy_loss": -0.008183630074684818, "vf_loss": 7.324531233310699, "vf_explained_var": 0.9959197516242663, "kl": 0.0, "entropy": 98.29854113260905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.52, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.668125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.668125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, 53.0, -23.0, -33.0, -64.0, 49.0, 54.0, 44.0, 59.0, 54.0, 43.0, 59.0, -11.0, 54.0, -63.0, 53.0, 47.0, 64.0, 48.0, 58.0, -63.0, 59.0, 14.0, 58.0, 39.0, -63.0, -64.0, 54.0, 58.0, 59.0, -63.0, 48.0, -62.0, -18.0, 4.0, -64.0, 53.0, -14.0, 54.0, -63.0, -13.0, 41.0, -8.0, 64.0, 52.0, 43.0, 47.0, 48.0, 64.0, -13.0, 58.0, 4.0, 58.0, -18.0, -64.0, -2.0, 48.0, -8.0, 64.0, -64.0, 58.0, 59.0, 64.0, -64.0, -63.0, 53.0, -14.0, -9.0, -15.0, 58.0, 58.0, 44.0, -20.0, 53.0, 49.0, 53.0, -64.0, 58.0, 59.0, 15.0, 58.0, 64.0, 53.0, 10.0, 59.0, -64.0, 48.0, 54.0, 35.0, 48.0, -4.0, 6.0, 53.0, 59.0, 58.0, 58.0, 58.0, 47.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937513049672966, "mean_inference_ms": 9.681535085712003, "mean_action_processing_ms": 0.45248842092780445, "mean_env_wait_ms": 0.2883252876812605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739298343658447, "StateBufferConnector_ms": 0.0045049190521240234, "ViewRequirementAgentConnector_ms": 0.1939563751220703}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 53.0, -23.0, -33.0, -64.0, 49.0, 54.0, 44.0, 59.0, 54.0, 43.0, 59.0, -11.0, 54.0, -63.0, 53.0, 47.0, 64.0, 48.0, 58.0, -63.0, 59.0, 14.0, 58.0, 39.0, -63.0, -64.0, 54.0, 58.0, 59.0, -63.0, 48.0, -62.0, -18.0, 4.0, -64.0, 53.0, -14.0, 54.0, -63.0, -13.0, 41.0, -8.0, 64.0, 52.0, 43.0, 47.0, 48.0, 64.0, -13.0, 58.0, 4.0, 58.0, -18.0, -64.0, -2.0, 48.0, -8.0, 64.0, -64.0, 58.0, 59.0, 64.0, -64.0, -63.0, 53.0, -14.0, -9.0, -15.0, 58.0, 58.0, 44.0, -20.0, 53.0, 49.0, 53.0, -64.0, 58.0, 59.0, 15.0, 58.0, 64.0, 53.0, 10.0, 59.0, -64.0, 48.0, 54.0, 35.0, 48.0, -4.0, 6.0, 53.0, 59.0, 58.0, 58.0, 58.0, 47.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937513049672966, "mean_inference_ms": 9.681535085712003, "mean_action_processing_ms": 0.45248842092780445, "mean_env_wait_ms": 0.2883252876812605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739298343658447, "StateBufferConnector_ms": 0.0045049190521240234, "ViewRequirementAgentConnector_ms": 0.1939563751220703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.164133547645363, "num_agent_steps_trained_throughput_per_sec": 7.164133547645363, "timesteps_total": 56832, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56832, "timers": {"training_iteration_time_ms": 71265.343, "sample_time_ms": 5925.187, "load_time_ms": 0.289, "load_throughput": 1774633.21, "learn_time_ms": 65339.334, "learn_throughput": 7.836, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "done": false, "episodes_total": 3552, "training_iteration": 111, "trial_id": "f4e01_00169", "date": "2024-02-27_02-15-41", "timestamp": 1708996541, "time_this_iter_s": 71.47235536575317, "time_total_s": 7968.015880823135, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7968.015880823135, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 54.15346534653465, "ram_util_percent": 21.36138613861387}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.31, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.635234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.635234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.250691203276316, "policy_loss": -0.041149445918078224, "vf_loss": 8.311391131083171, "vf_explained_var": 0.9783706133564313, "kl": 0.0, "entropy": 109.70855026245117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.31, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.31, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.635234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.635234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -18.0, 4.0, -64.0, 53.0, -14.0, 54.0, -63.0, -13.0, 41.0, -8.0, 64.0, 52.0, 43.0, 47.0, 48.0, 64.0, -13.0, 58.0, 4.0, 58.0, -18.0, -64.0, -2.0, 48.0, -8.0, 64.0, -64.0, 58.0, 59.0, 64.0, -64.0, -63.0, 53.0, -14.0, -9.0, -15.0, 58.0, 58.0, 44.0, -20.0, 53.0, 49.0, 53.0, -64.0, 58.0, 59.0, 15.0, 58.0, 64.0, 53.0, 10.0, 59.0, -64.0, 48.0, 54.0, 35.0, 48.0, -4.0, 6.0, 53.0, 59.0, 58.0, 58.0, 58.0, 47.0, -64.0, 64.0, 53.0, 59.0, 2.0, 64.0, 8.0, 54.0, 29.0, -64.0, 18.0, 53.0, -64.0, -2.0, 26.0, 59.0, 12.0, 54.0, 53.0, 12.0, -7.0, -5.0, -64.0, 32.0, -64.0, 53.0, -64.0, 58.0, -64.0, 64.0, 54.0, -64.0, 15.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937261319690005, "mean_inference_ms": 9.6813364209617, "mean_action_processing_ms": 0.45249262874691387, "mean_env_wait_ms": 0.2883232897746835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27259016036987305, "StateBufferConnector_ms": 0.004497528076171875, "ViewRequirementAgentConnector_ms": 0.19134044647216797}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.31, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -18.0, 4.0, -64.0, 53.0, -14.0, 54.0, -63.0, -13.0, 41.0, -8.0, 64.0, 52.0, 43.0, 47.0, 48.0, 64.0, -13.0, 58.0, 4.0, 58.0, -18.0, -64.0, -2.0, 48.0, -8.0, 64.0, -64.0, 58.0, 59.0, 64.0, -64.0, -63.0, 53.0, -14.0, -9.0, -15.0, 58.0, 58.0, 44.0, -20.0, 53.0, 49.0, 53.0, -64.0, 58.0, 59.0, 15.0, 58.0, 64.0, 53.0, 10.0, 59.0, -64.0, 48.0, 54.0, 35.0, 48.0, -4.0, 6.0, 53.0, 59.0, 58.0, 58.0, 58.0, 47.0, -64.0, 64.0, 53.0, 59.0, 2.0, 64.0, 8.0, 54.0, 29.0, -64.0, 18.0, 53.0, -64.0, -2.0, 26.0, 59.0, 12.0, 54.0, 53.0, 12.0, -7.0, -5.0, -64.0, 32.0, -64.0, 53.0, -64.0, 58.0, -64.0, 64.0, 54.0, -64.0, 15.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937261319690005, "mean_inference_ms": 9.6813364209617, "mean_action_processing_ms": 0.45249262874691387, "mean_env_wait_ms": 0.2883232897746835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27259016036987305, "StateBufferConnector_ms": 0.004497528076171875, "ViewRequirementAgentConnector_ms": 0.19134044647216797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.180414728866395, "num_agent_steps_trained_throughput_per_sec": 7.180414728866395, "timesteps_total": 57344, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 71280.012, "sample_time_ms": 5932.056, "load_time_ms": 0.287, "load_throughput": 1781404.934, "learn_time_ms": 65347.127, "learn_throughput": 7.835, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "episodes_total": 3584, "training_iteration": 112, "trial_id": "f4e01_00169", "date": "2024-02-27_02-16-53", "timestamp": 1708996613, "time_this_iter_s": 71.3101053237915, "time_total_s": 8039.325986146927, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8039.325986146927, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 54.17425742574256, "ram_util_percent": 21.263366336633666}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.24, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.685568451881409, "policy_loss": -0.02701098583638668, "vf_loss": 7.401600511868795, "vf_explained_var": 0.9869344100356102, "kl": 0.0, "entropy": 100.77195014953614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.24, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, 53.0, -14.0, -9.0, -15.0, 58.0, 58.0, 44.0, -20.0, 53.0, 49.0, 53.0, -64.0, 58.0, 59.0, 15.0, 58.0, 64.0, 53.0, 10.0, 59.0, -64.0, 48.0, 54.0, 35.0, 48.0, -4.0, 6.0, 53.0, 59.0, 58.0, 58.0, 58.0, 47.0, -64.0, 64.0, 53.0, 59.0, 2.0, 64.0, 8.0, 54.0, 29.0, -64.0, 18.0, 53.0, -64.0, -2.0, 26.0, 59.0, 12.0, 54.0, 53.0, 12.0, -7.0, -5.0, -64.0, 32.0, -64.0, 53.0, -64.0, 58.0, -64.0, 64.0, 54.0, -64.0, 15.0, -62.0, 53.0, 54.0, 59.0, 43.0, 64.0, -64.0, 59.0, -4.0, 58.0, 64.0, 9.0, 64.0, 59.0, 58.0, -64.0, 48.0, 48.0, 53.0, -3.0, 64.0, 2.0, 3.0, 64.0, 58.0, 47.0, 52.0, -64.0, -64.0, 64.0, 17.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937811495426523, "mean_inference_ms": 9.681427009577245, "mean_action_processing_ms": 0.45252510986679284, "mean_env_wait_ms": 0.2883419986216675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2747023105621338, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.19197607040405273}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, 53.0, -14.0, -9.0, -15.0, 58.0, 58.0, 44.0, -20.0, 53.0, 49.0, 53.0, -64.0, 58.0, 59.0, 15.0, 58.0, 64.0, 53.0, 10.0, 59.0, -64.0, 48.0, 54.0, 35.0, 48.0, -4.0, 6.0, 53.0, 59.0, 58.0, 58.0, 58.0, 47.0, -64.0, 64.0, 53.0, 59.0, 2.0, 64.0, 8.0, 54.0, 29.0, -64.0, 18.0, 53.0, -64.0, -2.0, 26.0, 59.0, 12.0, 54.0, 53.0, 12.0, -7.0, -5.0, -64.0, 32.0, -64.0, 53.0, -64.0, 58.0, -64.0, 64.0, 54.0, -64.0, 15.0, -62.0, 53.0, 54.0, 59.0, 43.0, 64.0, -64.0, 59.0, -4.0, 58.0, 64.0, 9.0, 64.0, 59.0, 58.0, -64.0, 48.0, 48.0, 53.0, -3.0, 64.0, 2.0, 3.0, 64.0, 58.0, 47.0, 52.0, -64.0, -64.0, 64.0, 17.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937811495426523, "mean_inference_ms": 9.681427009577245, "mean_action_processing_ms": 0.45252510986679284, "mean_env_wait_ms": 0.2883419986216675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2747023105621338, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.19197607040405273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.173007090395305, "num_agent_steps_trained_throughput_per_sec": 7.173007090395305, "timesteps_total": 57856, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57856, "timers": {"training_iteration_time_ms": 71374.195, "sample_time_ms": 5971.977, "load_time_ms": 0.295, "load_throughput": 1733939.159, "learn_time_ms": 65401.368, "learn_throughput": 7.829, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "done": false, "episodes_total": 3616, "training_iteration": 113, "trial_id": "f4e01_00169", "date": "2024-02-27_02-18-04", "timestamp": 1708996684, "time_this_iter_s": 71.38378429412842, "time_total_s": 8110.709770441055, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8110.709770441055, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 54.0059405940594, "ram_util_percent": 20.92079207920792}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.38, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.0493845244248705, "policy_loss": -0.04302268630514542, "vf_loss": 7.9981599648793535, "vf_explained_var": 0.9557402819395066, "kl": 0.0, "entropy": 104.13685162862141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.38, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 47.0, -64.0, 64.0, 53.0, 59.0, 2.0, 64.0, 8.0, 54.0, 29.0, -64.0, 18.0, 53.0, -64.0, -2.0, 26.0, 59.0, 12.0, 54.0, 53.0, 12.0, -7.0, -5.0, -64.0, 32.0, -64.0, 53.0, -64.0, 58.0, -64.0, 64.0, 54.0, -64.0, 15.0, -62.0, 53.0, 54.0, 59.0, 43.0, 64.0, -64.0, 59.0, -4.0, 58.0, 64.0, 9.0, 64.0, 59.0, 58.0, -64.0, 48.0, 48.0, 53.0, -3.0, 64.0, 2.0, 3.0, 64.0, 58.0, 47.0, 52.0, -64.0, -64.0, 64.0, 17.0, -64.0, 64.0, -64.0, 54.0, 52.0, 59.0, 44.0, 59.0, -64.0, -63.0, -64.0, 48.0, 53.0, 58.0, 35.0, -64.0, -64.0, 58.0, 33.0, 5.0, 58.0, 32.0, -64.0, -64.0, -3.0, 53.0, 49.0, 58.0, 64.0, 0.0, 54.0, 53.0, 23.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.293502809443734, "mean_inference_ms": 9.680111173413016, "mean_action_processing_ms": 0.452432740721784, "mean_env_wait_ms": 0.28826597494124195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.264739990234375, "StateBufferConnector_ms": 0.004332065582275391, "ViewRequirementAgentConnector_ms": 0.18210721015930176}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 47.0, -64.0, 64.0, 53.0, 59.0, 2.0, 64.0, 8.0, 54.0, 29.0, -64.0, 18.0, 53.0, -64.0, -2.0, 26.0, 59.0, 12.0, 54.0, 53.0, 12.0, -7.0, -5.0, -64.0, 32.0, -64.0, 53.0, -64.0, 58.0, -64.0, 64.0, 54.0, -64.0, 15.0, -62.0, 53.0, 54.0, 59.0, 43.0, 64.0, -64.0, 59.0, -4.0, 58.0, 64.0, 9.0, 64.0, 59.0, 58.0, -64.0, 48.0, 48.0, 53.0, -3.0, 64.0, 2.0, 3.0, 64.0, 58.0, 47.0, 52.0, -64.0, -64.0, 64.0, 17.0, -64.0, 64.0, -64.0, 54.0, 52.0, 59.0, 44.0, 59.0, -64.0, -63.0, -64.0, 48.0, 53.0, 58.0, 35.0, -64.0, -64.0, 58.0, 33.0, 5.0, 58.0, 32.0, -64.0, -64.0, -3.0, 53.0, 49.0, 58.0, 64.0, 0.0, 54.0, 53.0, 23.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.293502809443734, "mean_inference_ms": 9.680111173413016, "mean_action_processing_ms": 0.452432740721784, "mean_env_wait_ms": 0.28826597494124195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.264739990234375, "StateBufferConnector_ms": 0.004332065582275391, "ViewRequirementAgentConnector_ms": 0.18210721015930176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.299198614966941, "num_agent_steps_trained_throughput_per_sec": 7.299198614966941, "timesteps_total": 58368, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 71287.865, "sample_time_ms": 5938.589, "load_time_ms": 0.291, "load_throughput": 1756632.841, "learn_time_ms": 65348.433, "learn_throughput": 7.835, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "episodes_total": 3648, "training_iteration": 114, "trial_id": "f4e01_00169", "date": "2024-02-27_02-19-14", "timestamp": 1708996754, "time_this_iter_s": 70.14976930618286, "time_total_s": 8180.859539747238, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8180.859539747238, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 53.75, "ram_util_percent": 20.995}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.82, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63921875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63921875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.9373968998591105, "policy_loss": -0.03729862134593229, "vf_loss": 7.813281444708506, "vf_explained_var": 0.9750388647119205, "kl": 0.0, "entropy": 104.00972398122151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.82, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63921875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63921875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, -64.0, 15.0, -62.0, 53.0, 54.0, 59.0, 43.0, 64.0, -64.0, 59.0, -4.0, 58.0, 64.0, 9.0, 64.0, 59.0, 58.0, -64.0, 48.0, 48.0, 53.0, -3.0, 64.0, 2.0, 3.0, 64.0, 58.0, 47.0, 52.0, -64.0, -64.0, 64.0, 17.0, -64.0, 64.0, -64.0, 54.0, 52.0, 59.0, 44.0, 59.0, -64.0, -63.0, -64.0, 48.0, 53.0, 58.0, 35.0, -64.0, -64.0, 58.0, 33.0, 5.0, 58.0, 32.0, -64.0, -64.0, -3.0, 53.0, 49.0, 58.0, 64.0, 0.0, 54.0, 53.0, 23.0, -64.0, -63.0, 59.0, 9.0, 58.0, 47.0, -64.0, 54.0, 53.0, 16.0, 53.0, 53.0, 53.0, 33.0, 54.0, -64.0, -10.0, 1.0, 43.0, 59.0, 33.0, -64.0, -64.0, 58.0, -64.0, 64.0, 54.0, 53.0, -64.0, 48.0, 32.0, 48.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2932359214799651, "mean_inference_ms": 9.678800594143615, "mean_action_processing_ms": 0.4523628604209912, "mean_env_wait_ms": 0.2882027425112885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2658965587615967, "StateBufferConnector_ms": 0.004331350326538086, "ViewRequirementAgentConnector_ms": 0.18413019180297852}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -64.0, 15.0, -62.0, 53.0, 54.0, 59.0, 43.0, 64.0, -64.0, 59.0, -4.0, 58.0, 64.0, 9.0, 64.0, 59.0, 58.0, -64.0, 48.0, 48.0, 53.0, -3.0, 64.0, 2.0, 3.0, 64.0, 58.0, 47.0, 52.0, -64.0, -64.0, 64.0, 17.0, -64.0, 64.0, -64.0, 54.0, 52.0, 59.0, 44.0, 59.0, -64.0, -63.0, -64.0, 48.0, 53.0, 58.0, 35.0, -64.0, -64.0, 58.0, 33.0, 5.0, 58.0, 32.0, -64.0, -64.0, -3.0, 53.0, 49.0, 58.0, 64.0, 0.0, 54.0, 53.0, 23.0, -64.0, -63.0, 59.0, 9.0, 58.0, 47.0, -64.0, 54.0, 53.0, 16.0, 53.0, 53.0, 53.0, 33.0, 54.0, -64.0, -10.0, 1.0, 43.0, 59.0, 33.0, -64.0, -64.0, 58.0, -64.0, 64.0, 54.0, 53.0, -64.0, 48.0, 32.0, 48.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2932359214799651, "mean_inference_ms": 9.678800594143615, "mean_action_processing_ms": 0.4523628604209912, "mean_env_wait_ms": 0.2882027425112885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2658965587615967, "StateBufferConnector_ms": 0.004331350326538086, "ViewRequirementAgentConnector_ms": 0.18413019180297852}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.192166830390321, "num_agent_steps_trained_throughput_per_sec": 7.192166830390321, "timesteps_total": 58880, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58880, "timers": {"training_iteration_time_ms": 71354.51, "sample_time_ms": 5965.567, "load_time_ms": 0.291, "load_throughput": 1758070.936, "learn_time_ms": 65388.096, "learn_throughput": 7.83, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "done": false, "episodes_total": 3680, "training_iteration": 115, "trial_id": "f4e01_00169", "date": "2024-02-27_02-20-26", "timestamp": 1708996826, "time_this_iter_s": 71.19368481636047, "time_total_s": 8252.053224563599, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8252.053224563599, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 53.92574257425743, "ram_util_percent": 21.015841584158416}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.8, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6390625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6390625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.506759685277939, "policy_loss": -0.027983648205796876, "vf_loss": 7.122290368874868, "vf_explained_var": 0.9911978393793106, "kl": 0.0, "entropy": 104.69444363911947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.8, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6390625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6390625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, 17.0, -64.0, 64.0, -64.0, 54.0, 52.0, 59.0, 44.0, 59.0, -64.0, -63.0, -64.0, 48.0, 53.0, 58.0, 35.0, -64.0, -64.0, 58.0, 33.0, 5.0, 58.0, 32.0, -64.0, -64.0, -3.0, 53.0, 49.0, 58.0, 64.0, 0.0, 54.0, 53.0, 23.0, -64.0, -63.0, 59.0, 9.0, 58.0, 47.0, -64.0, 54.0, 53.0, 16.0, 53.0, 53.0, 53.0, 33.0, 54.0, -64.0, -10.0, 1.0, 43.0, 59.0, 33.0, -64.0, -64.0, 58.0, -64.0, 64.0, 54.0, 53.0, -64.0, 48.0, 32.0, 48.0, -64.0, 19.0, 64.0, 4.0, -64.0, 59.0, 37.0, 59.0, -64.0, 58.0, 31.0, 64.0, 53.0, 15.0, 53.0, 15.0, 40.0, 59.0, -64.0, -64.0, -64.0, -64.0, 1.0, 54.0, 64.0, 64.0, 51.0, 43.0, 10.0, 58.0, 53.0, 58.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2928759577031081, "mean_inference_ms": 9.677226605143101, "mean_action_processing_ms": 0.45227083331129253, "mean_env_wait_ms": 0.2881165685118087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26224231719970703, "StateBufferConnector_ms": 0.004257678985595703, "ViewRequirementAgentConnector_ms": 0.18235468864440918}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 17.0, -64.0, 64.0, -64.0, 54.0, 52.0, 59.0, 44.0, 59.0, -64.0, -63.0, -64.0, 48.0, 53.0, 58.0, 35.0, -64.0, -64.0, 58.0, 33.0, 5.0, 58.0, 32.0, -64.0, -64.0, -3.0, 53.0, 49.0, 58.0, 64.0, 0.0, 54.0, 53.0, 23.0, -64.0, -63.0, 59.0, 9.0, 58.0, 47.0, -64.0, 54.0, 53.0, 16.0, 53.0, 53.0, 53.0, 33.0, 54.0, -64.0, -10.0, 1.0, 43.0, 59.0, 33.0, -64.0, -64.0, 58.0, -64.0, 64.0, 54.0, 53.0, -64.0, 48.0, 32.0, 48.0, -64.0, 19.0, 64.0, 4.0, -64.0, 59.0, 37.0, 59.0, -64.0, 58.0, 31.0, 64.0, 53.0, 15.0, 53.0, 15.0, 40.0, 59.0, -64.0, -64.0, -64.0, -64.0, 1.0, 54.0, 64.0, 64.0, 51.0, 43.0, 10.0, 58.0, 53.0, 58.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2928759577031081, "mean_inference_ms": 9.677226605143101, "mean_action_processing_ms": 0.45227083331129253, "mean_env_wait_ms": 0.2881165685118087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26224231719970703, "StateBufferConnector_ms": 0.004257678985595703, "ViewRequirementAgentConnector_ms": 0.18235468864440918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.143901082786462, "num_agent_steps_trained_throughput_per_sec": 7.143901082786462, "timesteps_total": 59392, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 71365.838, "sample_time_ms": 5966.413, "load_time_ms": 0.294, "load_throughput": 1743228.872, "learn_time_ms": 65398.562, "learn_throughput": 7.829, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "episodes_total": 3712, "training_iteration": 116, "trial_id": "f4e01_00169", "date": "2024-02-27_02-21-37", "timestamp": 1708996897, "time_this_iter_s": 71.67493224143982, "time_total_s": 8323.728156805038, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8323.728156805038, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 54.49705882352941, "ram_util_percent": 21.078431372549016}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.457291513681412, "policy_loss": -0.03524732117851575, "vf_loss": 7.056003717581431, "vf_explained_var": 0.9880394195516904, "kl": 0.0, "entropy": 101.7209358215332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.46, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 53.0, 23.0, -64.0, -63.0, 59.0, 9.0, 58.0, 47.0, -64.0, 54.0, 53.0, 16.0, 53.0, 53.0, 53.0, 33.0, 54.0, -64.0, -10.0, 1.0, 43.0, 59.0, 33.0, -64.0, -64.0, 58.0, -64.0, 64.0, 54.0, 53.0, -64.0, 48.0, 32.0, 48.0, -64.0, 19.0, 64.0, 4.0, -64.0, 59.0, 37.0, 59.0, -64.0, 58.0, 31.0, 64.0, 53.0, 15.0, 53.0, 15.0, 40.0, 59.0, -64.0, -64.0, -64.0, -64.0, 1.0, 54.0, 64.0, 64.0, 51.0, 43.0, 10.0, 58.0, 53.0, 58.0, 59.0, -63.0, 58.0, 58.0, 36.0, 58.0, 25.0, 58.0, 59.0, 45.0, 53.0, 54.0, 21.0, 42.0, -64.0, 59.0, -64.0, 43.0, 38.0, 31.0, -63.0, 59.0, -64.0, 64.0, 53.0, 47.0, 58.0, 53.0, 46.0, 58.0, 58.0, 53.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292814941559322, "mean_inference_ms": 9.677015782488693, "mean_action_processing_ms": 0.45229787318956866, "mean_env_wait_ms": 0.2881207217510057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2701585292816162, "StateBufferConnector_ms": 0.004410505294799805, "ViewRequirementAgentConnector_ms": 0.19334840774536133}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.46, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 53.0, 23.0, -64.0, -63.0, 59.0, 9.0, 58.0, 47.0, -64.0, 54.0, 53.0, 16.0, 53.0, 53.0, 53.0, 33.0, 54.0, -64.0, -10.0, 1.0, 43.0, 59.0, 33.0, -64.0, -64.0, 58.0, -64.0, 64.0, 54.0, 53.0, -64.0, 48.0, 32.0, 48.0, -64.0, 19.0, 64.0, 4.0, -64.0, 59.0, 37.0, 59.0, -64.0, 58.0, 31.0, 64.0, 53.0, 15.0, 53.0, 15.0, 40.0, 59.0, -64.0, -64.0, -64.0, -64.0, 1.0, 54.0, 64.0, 64.0, 51.0, 43.0, 10.0, 58.0, 53.0, 58.0, 59.0, -63.0, 58.0, 58.0, 36.0, 58.0, 25.0, 58.0, 59.0, 45.0, 53.0, 54.0, 21.0, 42.0, -64.0, 59.0, -64.0, 43.0, 38.0, 31.0, -63.0, 59.0, -64.0, 64.0, 53.0, 47.0, 58.0, 53.0, 46.0, 58.0, 58.0, 53.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292814941559322, "mean_inference_ms": 9.677015782488693, "mean_action_processing_ms": 0.45229787318956866, "mean_env_wait_ms": 0.2881207217510057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2701585292816162, "StateBufferConnector_ms": 0.004410505294799805, "ViewRequirementAgentConnector_ms": 0.19334840774536133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.163859162520373, "num_agent_steps_trained_throughput_per_sec": 7.163859162520373, "timesteps_total": 59904, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59904, "timers": {"training_iteration_time_ms": 71375.827, "sample_time_ms": 5996.834, "load_time_ms": 0.297, "load_throughput": 1725302.2, "learn_time_ms": 65378.137, "learn_throughput": 7.831, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "done": false, "episodes_total": 3744, "training_iteration": 117, "trial_id": "f4e01_00169", "date": "2024-02-27_02-22-49", "timestamp": 1708996969, "time_this_iter_s": 71.47500085830688, "time_total_s": 8395.203157663345, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8395.203157663345, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 53.674257425742574, "ram_util_percent": 21.2930693069307}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 25.95, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.702734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.702734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.348919989665349, "policy_loss": -0.04982536571721236, "vf_loss": 6.908691223462423, "vf_explained_var": 0.9838905980189642, "kl": 0.0, "entropy": 101.828493309021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.95, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 25.95, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.702734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.702734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, 32.0, 48.0, -64.0, 19.0, 64.0, 4.0, -64.0, 59.0, 37.0, 59.0, -64.0, 58.0, 31.0, 64.0, 53.0, 15.0, 53.0, 15.0, 40.0, 59.0, -64.0, -64.0, -64.0, -64.0, 1.0, 54.0, 64.0, 64.0, 51.0, 43.0, 10.0, 58.0, 53.0, 58.0, 59.0, -63.0, 58.0, 58.0, 36.0, 58.0, 25.0, 58.0, 59.0, 45.0, 53.0, 54.0, 21.0, 42.0, -64.0, 59.0, -64.0, 43.0, 38.0, 31.0, -63.0, 59.0, -64.0, 64.0, 53.0, 47.0, 58.0, 53.0, 46.0, 58.0, 58.0, 53.0, -64.0, 57.0, 53.0, 54.0, -63.0, 59.0, 43.0, 59.0, 58.0, 49.0, -64.0, 53.0, -63.0, 10.0, 59.0, 48.0, 64.0, 7.0, 59.0, 58.0, 38.0, 36.0, -64.0, 46.0, 53.0, -64.0, 52.0, -64.0, 52.0, 37.0, 37.0, 58.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2928787398771093, "mean_inference_ms": 9.677328195795083, "mean_action_processing_ms": 0.4523581873503012, "mean_env_wait_ms": 0.2881490643430098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27303385734558105, "StateBufferConnector_ms": 0.004460334777832031, "ViewRequirementAgentConnector_ms": 0.1952524185180664}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.95, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 32.0, 48.0, -64.0, 19.0, 64.0, 4.0, -64.0, 59.0, 37.0, 59.0, -64.0, 58.0, 31.0, 64.0, 53.0, 15.0, 53.0, 15.0, 40.0, 59.0, -64.0, -64.0, -64.0, -64.0, 1.0, 54.0, 64.0, 64.0, 51.0, 43.0, 10.0, 58.0, 53.0, 58.0, 59.0, -63.0, 58.0, 58.0, 36.0, 58.0, 25.0, 58.0, 59.0, 45.0, 53.0, 54.0, 21.0, 42.0, -64.0, 59.0, -64.0, 43.0, 38.0, 31.0, -63.0, 59.0, -64.0, 64.0, 53.0, 47.0, 58.0, 53.0, 46.0, 58.0, 58.0, 53.0, -64.0, 57.0, 53.0, 54.0, -63.0, 59.0, 43.0, 59.0, 58.0, 49.0, -64.0, 53.0, -63.0, 10.0, 59.0, 48.0, 64.0, 7.0, 59.0, 58.0, 38.0, 36.0, -64.0, 46.0, 53.0, -64.0, 52.0, -64.0, 52.0, 37.0, 37.0, 58.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2928787398771093, "mean_inference_ms": 9.677328195795083, "mean_action_processing_ms": 0.4523581873503012, "mean_env_wait_ms": 0.2881490643430098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27303385734558105, "StateBufferConnector_ms": 0.004460334777832031, "ViewRequirementAgentConnector_ms": 0.1952524185180664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.168131423308004, "num_agent_steps_trained_throughput_per_sec": 7.168131423308004, "timesteps_total": 60416, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 71341.794, "sample_time_ms": 5997.022, "load_time_ms": 0.303, "load_throughput": 1691731.249, "learn_time_ms": 65343.917, "learn_throughput": 7.835, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "episodes_total": 3776, "training_iteration": 118, "trial_id": "f4e01_00169", "date": "2024-02-27_02-24-00", "timestamp": 1708997040, "time_this_iter_s": 71.4324779510498, "time_total_s": 8466.635635614395, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8466.635635614395, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 53.85980392156863, "ram_util_percent": 21.289215686274506}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 29.99, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.734296875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.734296875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.529495785633723, "policy_loss": -0.03900853544473648, "vf_loss": 7.17531555891037, "vf_explained_var": 0.9892739589015643, "kl": 0.0, "entropy": 100.09535554250081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 29.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 29.99, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.734296875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.734296875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 53.0, 58.0, 59.0, -63.0, 58.0, 58.0, 36.0, 58.0, 25.0, 58.0, 59.0, 45.0, 53.0, 54.0, 21.0, 42.0, -64.0, 59.0, -64.0, 43.0, 38.0, 31.0, -63.0, 59.0, -64.0, 64.0, 53.0, 47.0, 58.0, 53.0, 46.0, 58.0, 58.0, 53.0, -64.0, 57.0, 53.0, 54.0, -63.0, 59.0, 43.0, 59.0, 58.0, 49.0, -64.0, 53.0, -63.0, 10.0, 59.0, 48.0, 64.0, 7.0, 59.0, 58.0, 38.0, 36.0, -64.0, 46.0, 53.0, -64.0, 52.0, -64.0, 52.0, 37.0, 37.0, 58.0, 48.0, -62.0, 52.0, 58.0, 54.0, 43.0, 33.0, 28.0, 59.0, 58.0, -64.0, 58.0, 49.0, 53.0, -64.0, 12.0, 53.0, 52.0, -64.0, 58.0, 43.0, 28.0, -64.0, 58.0, 58.0, 54.0, 43.0, 53.0, 64.0, 64.0, 23.0, 53.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2930361770869758, "mean_inference_ms": 9.677843159275076, "mean_action_processing_ms": 0.4524371824093983, "mean_env_wait_ms": 0.2881965212574032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27605152130126953, "StateBufferConnector_ms": 0.004515171051025391, "ViewRequirementAgentConnector_ms": 0.19794344902038574}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 29.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 53.0, 58.0, 59.0, -63.0, 58.0, 58.0, 36.0, 58.0, 25.0, 58.0, 59.0, 45.0, 53.0, 54.0, 21.0, 42.0, -64.0, 59.0, -64.0, 43.0, 38.0, 31.0, -63.0, 59.0, -64.0, 64.0, 53.0, 47.0, 58.0, 53.0, 46.0, 58.0, 58.0, 53.0, -64.0, 57.0, 53.0, 54.0, -63.0, 59.0, 43.0, 59.0, 58.0, 49.0, -64.0, 53.0, -63.0, 10.0, 59.0, 48.0, 64.0, 7.0, 59.0, 58.0, 38.0, 36.0, -64.0, 46.0, 53.0, -64.0, 52.0, -64.0, 52.0, 37.0, 37.0, 58.0, 48.0, -62.0, 52.0, 58.0, 54.0, 43.0, 33.0, 28.0, 59.0, 58.0, -64.0, 58.0, 49.0, 53.0, -64.0, 12.0, 53.0, 52.0, -64.0, 58.0, 43.0, 28.0, -64.0, 58.0, 58.0, 54.0, 43.0, 53.0, 64.0, 64.0, 23.0, 53.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2930361770869758, "mean_inference_ms": 9.677843159275076, "mean_action_processing_ms": 0.4524371824093983, "mean_env_wait_ms": 0.2881965212574032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27605152130126953, "StateBufferConnector_ms": 0.004515171051025391, "ViewRequirementAgentConnector_ms": 0.19794344902038574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.17125289006614, "num_agent_steps_trained_throughput_per_sec": 7.17125289006614, "timesteps_total": 60928, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60928, "timers": {"training_iteration_time_ms": 71288.504, "sample_time_ms": 5992.815, "load_time_ms": 0.295, "load_throughput": 1734639.457, "learn_time_ms": 65294.839, "learn_throughput": 7.841, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "done": false, "episodes_total": 3808, "training_iteration": 119, "trial_id": "f4e01_00169", "date": "2024-02-27_02-25-12", "timestamp": 1708997112, "time_this_iter_s": 71.40167140960693, "time_total_s": 8538.037307024002, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8538.037307024002, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 54.21089108910891, "ram_util_percent": 21.078217821782175}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 33.51, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.761796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.761796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.8467236399650573, "policy_loss": -0.029611587151885034, "vf_loss": 6.088191310564677, "vf_explained_var": 0.9841060817241669, "kl": 0.0, "entropy": 97.05725351969402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 33.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 33.51, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.761796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.761796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 58.0, 53.0, -64.0, 57.0, 53.0, 54.0, -63.0, 59.0, 43.0, 59.0, 58.0, 49.0, -64.0, 53.0, -63.0, 10.0, 59.0, 48.0, 64.0, 7.0, 59.0, 58.0, 38.0, 36.0, -64.0, 46.0, 53.0, -64.0, 52.0, -64.0, 52.0, 37.0, 37.0, 58.0, 48.0, -62.0, 52.0, 58.0, 54.0, 43.0, 33.0, 28.0, 59.0, 58.0, -64.0, 58.0, 49.0, 53.0, -64.0, 12.0, 53.0, 52.0, -64.0, 58.0, 43.0, 28.0, -64.0, 58.0, 58.0, 54.0, 43.0, 53.0, 64.0, 64.0, 23.0, 53.0, 58.0, 22.0, 58.0, 54.0, 58.0, 38.0, 42.0, 59.0, 49.0, -64.0, 59.0, 53.0, 43.0, 34.0, 58.0, 47.0, 64.0, 49.0, 53.0, 59.0, 54.0, 58.0, 64.0, 53.0, -64.0, 28.0, 39.0, 54.0, 59.0, 58.0, 53.0, 31.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.293323626748915, "mean_inference_ms": 9.679045266408007, "mean_action_processing_ms": 0.4525681382783182, "mean_env_wait_ms": 0.2882855321087447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27886104583740234, "StateBufferConnector_ms": 0.0046198368072509766, "ViewRequirementAgentConnector_ms": 0.2031848430633545}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 33.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 58.0, 53.0, -64.0, 57.0, 53.0, 54.0, -63.0, 59.0, 43.0, 59.0, 58.0, 49.0, -64.0, 53.0, -63.0, 10.0, 59.0, 48.0, 64.0, 7.0, 59.0, 58.0, 38.0, 36.0, -64.0, 46.0, 53.0, -64.0, 52.0, -64.0, 52.0, 37.0, 37.0, 58.0, 48.0, -62.0, 52.0, 58.0, 54.0, 43.0, 33.0, 28.0, 59.0, 58.0, -64.0, 58.0, 49.0, 53.0, -64.0, 12.0, 53.0, 52.0, -64.0, 58.0, 43.0, 28.0, -64.0, 58.0, 58.0, 54.0, 43.0, 53.0, 64.0, 64.0, 23.0, 53.0, 58.0, 22.0, 58.0, 54.0, 58.0, 38.0, 42.0, 59.0, 49.0, -64.0, 59.0, 53.0, 43.0, 34.0, 58.0, 47.0, 64.0, 49.0, 53.0, 59.0, 54.0, 58.0, 64.0, 53.0, -64.0, 28.0, 39.0, 54.0, 59.0, 58.0, 53.0, 31.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.293323626748915, "mean_inference_ms": 9.679045266408007, "mean_action_processing_ms": 0.4525681382783182, "mean_env_wait_ms": 0.2882855321087447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27886104583740234, "StateBufferConnector_ms": 0.0046198368072509766, "ViewRequirementAgentConnector_ms": 0.2031848430633545}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1120446571052325, "num_agent_steps_trained_throughput_per_sec": 7.1120446571052325, "timesteps_total": 61440, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 71343.716, "sample_time_ms": 6021.638, "load_time_ms": 0.303, "load_throughput": 1688007.898, "learn_time_ms": 65321.244, "learn_throughput": 7.838, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 3840, "training_iteration": 120, "trial_id": "f4e01_00169", "date": "2024-02-27_02-26-24", "timestamp": 1708997184, "time_this_iter_s": 71.99574899673462, "time_total_s": 8610.033056020737, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8610.033056020737, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 54.33039215686274, "ram_util_percent": 21.06078431372549}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 29.6, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.73125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.73125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.6703028361002605, "policy_loss": -0.033176802936941384, "vf_loss": 7.3873084823290505, "vf_explained_var": 0.9933781375487646, "kl": 0.0, "entropy": 106.9303518295288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 29.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 29.6, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.73125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.73125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [37.0, 37.0, 58.0, 48.0, -62.0, 52.0, 58.0, 54.0, 43.0, 33.0, 28.0, 59.0, 58.0, -64.0, 58.0, 49.0, 53.0, -64.0, 12.0, 53.0, 52.0, -64.0, 58.0, 43.0, 28.0, -64.0, 58.0, 58.0, 54.0, 43.0, 53.0, 64.0, 64.0, 23.0, 53.0, 58.0, 22.0, 58.0, 54.0, 58.0, 38.0, 42.0, 59.0, 49.0, -64.0, 59.0, 53.0, 43.0, 34.0, 58.0, 47.0, 64.0, 49.0, 53.0, 59.0, 54.0, 58.0, 64.0, 53.0, -64.0, 28.0, 39.0, 54.0, 59.0, 58.0, 53.0, 31.0, 58.0, -64.0, 52.0, -64.0, 59.0, 28.0, -63.0, 53.0, 53.0, 38.0, 40.0, 8.0, 54.0, 54.0, -64.0, 54.0, -64.0, 53.0, -64.0, 32.0, 53.0, 58.0, 53.0, -64.0, -63.0, 31.0, 53.0, 59.0, 64.0, -64.0, 28.0, -63.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2934838893253817, "mean_inference_ms": 9.679489273877204, "mean_action_processing_ms": 0.45264009277855466, "mean_env_wait_ms": 0.2883449787134305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27522730827331543, "StateBufferConnector_ms": 0.004529714584350586, "ViewRequirementAgentConnector_ms": 0.1990506649017334}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 29.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 37.0, 58.0, 48.0, -62.0, 52.0, 58.0, 54.0, 43.0, 33.0, 28.0, 59.0, 58.0, -64.0, 58.0, 49.0, 53.0, -64.0, 12.0, 53.0, 52.0, -64.0, 58.0, 43.0, 28.0, -64.0, 58.0, 58.0, 54.0, 43.0, 53.0, 64.0, 64.0, 23.0, 53.0, 58.0, 22.0, 58.0, 54.0, 58.0, 38.0, 42.0, 59.0, 49.0, -64.0, 59.0, 53.0, 43.0, 34.0, 58.0, 47.0, 64.0, 49.0, 53.0, 59.0, 54.0, 58.0, 64.0, 53.0, -64.0, 28.0, 39.0, 54.0, 59.0, 58.0, 53.0, 31.0, 58.0, -64.0, 52.0, -64.0, 59.0, 28.0, -63.0, 53.0, 53.0, 38.0, 40.0, 8.0, 54.0, 54.0, -64.0, 54.0, -64.0, 53.0, -64.0, 32.0, 53.0, 58.0, 53.0, -64.0, -63.0, 31.0, 53.0, 59.0, 64.0, -64.0, 28.0, -63.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2934838893253817, "mean_inference_ms": 9.679489273877204, "mean_action_processing_ms": 0.45264009277855466, "mean_env_wait_ms": 0.2883449787134305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27522730827331543, "StateBufferConnector_ms": 0.004529714584350586, "ViewRequirementAgentConnector_ms": 0.1990506649017334}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.132663174530257, "num_agent_steps_trained_throughput_per_sec": 7.132663174530257, "timesteps_total": 61952, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61952, "timers": {"training_iteration_time_ms": 71375.248, "sample_time_ms": 6015.368, "load_time_ms": 0.3, "load_throughput": 1708012.128, "learn_time_ms": 65359.057, "learn_throughput": 7.834, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "done": false, "episodes_total": 3872, "training_iteration": 121, "trial_id": "f4e01_00169", "date": "2024-02-27_02-27-36", "timestamp": 1708997256, "time_this_iter_s": 71.78786444664001, "time_total_s": 8681.820920467377, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8681.820920467377, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 54.461764705882345, "ram_util_percent": 20.91862745098039}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 34.0, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.974565331141154, "policy_loss": -0.03492406007523338, "vf_loss": 6.297323892513911, "vf_explained_var": 0.9424263800183932, "kl": 0.0, "entropy": 98.24885520935058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 34.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 34.0, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, 23.0, 53.0, 58.0, 22.0, 58.0, 54.0, 58.0, 38.0, 42.0, 59.0, 49.0, -64.0, 59.0, 53.0, 43.0, 34.0, 58.0, 47.0, 64.0, 49.0, 53.0, 59.0, 54.0, 58.0, 64.0, 53.0, -64.0, 28.0, 39.0, 54.0, 59.0, 58.0, 53.0, 31.0, 58.0, -64.0, 52.0, -64.0, 59.0, 28.0, -63.0, 53.0, 53.0, 38.0, 40.0, 8.0, 54.0, 54.0, -64.0, 54.0, -64.0, 53.0, -64.0, 32.0, 53.0, 58.0, 53.0, -64.0, -63.0, 31.0, 53.0, 59.0, 64.0, -64.0, 28.0, -63.0, 59.0, 26.0, 27.0, 28.0, -64.0, 52.0, 53.0, 53.0, 53.0, 53.0, 58.0, 59.0, 54.0, 53.0, 48.0, 59.0, 48.0, 58.0, 59.0, 58.0, 58.0, 64.0, 54.0, 53.0, 64.0, 58.0, 58.0, 59.0, 58.0, 48.0, 36.0, -64.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2936163785036583, "mean_inference_ms": 9.679869625777357, "mean_action_processing_ms": 0.4527027839431682, "mean_env_wait_ms": 0.28840565275157076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27448439598083496, "StateBufferConnector_ms": 0.0045621395111083984, "ViewRequirementAgentConnector_ms": 0.19847464561462402}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 34.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 23.0, 53.0, 58.0, 22.0, 58.0, 54.0, 58.0, 38.0, 42.0, 59.0, 49.0, -64.0, 59.0, 53.0, 43.0, 34.0, 58.0, 47.0, 64.0, 49.0, 53.0, 59.0, 54.0, 58.0, 64.0, 53.0, -64.0, 28.0, 39.0, 54.0, 59.0, 58.0, 53.0, 31.0, 58.0, -64.0, 52.0, -64.0, 59.0, 28.0, -63.0, 53.0, 53.0, 38.0, 40.0, 8.0, 54.0, 54.0, -64.0, 54.0, -64.0, 53.0, -64.0, 32.0, 53.0, 58.0, 53.0, -64.0, -63.0, 31.0, 53.0, 59.0, 64.0, -64.0, 28.0, -63.0, 59.0, 26.0, 27.0, 28.0, -64.0, 52.0, 53.0, 53.0, 53.0, 53.0, 58.0, 59.0, 54.0, 53.0, 48.0, 59.0, 48.0, 58.0, 59.0, 58.0, 58.0, 64.0, 54.0, 53.0, 64.0, 58.0, 58.0, 59.0, 58.0, 48.0, 36.0, -64.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2936163785036583, "mean_inference_ms": 9.679869625777357, "mean_action_processing_ms": 0.4527027839431682, "mean_env_wait_ms": 0.28840565275157076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27448439598083496, "StateBufferConnector_ms": 0.0045621395111083984, "ViewRequirementAgentConnector_ms": 0.19847464561462402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.099779084600379, "num_agent_steps_trained_throughput_per_sec": 7.099779084600379, "timesteps_total": 62464, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 71456.231, "sample_time_ms": 6009.397, "load_time_ms": 0.298, "load_throughput": 1715516.575, "learn_time_ms": 65446.005, "learn_throughput": 7.823, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "episodes_total": 3904, "training_iteration": 122, "trial_id": "f4e01_00169", "date": "2024-02-27_02-28-48", "timestamp": 1708997328, "time_this_iter_s": 72.12034940719604, "time_total_s": 8753.941269874573, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8753.941269874573, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 53.989215686274505, "ram_util_percent": 20.823529411764714}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.39, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.706171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.706171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.029310594002406, "policy_loss": -0.03892660308629274, "vf_loss": 6.389593505859375, "vf_explained_var": 0.9838817601402601, "kl": 0.0, "entropy": 101.80442708333334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.39, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.39, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.706171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.706171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 53.0, 31.0, 58.0, -64.0, 52.0, -64.0, 59.0, 28.0, -63.0, 53.0, 53.0, 38.0, 40.0, 8.0, 54.0, 54.0, -64.0, 54.0, -64.0, 53.0, -64.0, 32.0, 53.0, 58.0, 53.0, -64.0, -63.0, 31.0, 53.0, 59.0, 64.0, -64.0, 28.0, -63.0, 59.0, 26.0, 27.0, 28.0, -64.0, 52.0, 53.0, 53.0, 53.0, 53.0, 58.0, 59.0, 54.0, 53.0, 48.0, 59.0, 48.0, 58.0, 59.0, 58.0, 58.0, 64.0, 54.0, 53.0, 64.0, 58.0, 58.0, 59.0, 58.0, 48.0, 36.0, -64.0, 42.0, 53.0, 34.0, 53.0, 54.0, -64.0, -64.0, 64.0, 53.0, 53.0, 43.0, -64.0, -64.0, 48.0, 54.0, 54.0, 58.0, -64.0, 59.0, 64.0, 64.0, 58.0, 58.0, 41.0, -63.0, -64.0, -64.0, 25.0, -64.0, 58.0, 58.0, 33.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937117911686615, "mean_inference_ms": 9.680010502815984, "mean_action_processing_ms": 0.4527283926740424, "mean_env_wait_ms": 0.2884384135459662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2722196578979492, "StateBufferConnector_ms": 0.004563331604003906, "ViewRequirementAgentConnector_ms": 0.19400572776794434}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.39, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 53.0, 31.0, 58.0, -64.0, 52.0, -64.0, 59.0, 28.0, -63.0, 53.0, 53.0, 38.0, 40.0, 8.0, 54.0, 54.0, -64.0, 54.0, -64.0, 53.0, -64.0, 32.0, 53.0, 58.0, 53.0, -64.0, -63.0, 31.0, 53.0, 59.0, 64.0, -64.0, 28.0, -63.0, 59.0, 26.0, 27.0, 28.0, -64.0, 52.0, 53.0, 53.0, 53.0, 53.0, 58.0, 59.0, 54.0, 53.0, 48.0, 59.0, 48.0, 58.0, 59.0, 58.0, 58.0, 64.0, 54.0, 53.0, 64.0, 58.0, 58.0, 59.0, 58.0, 48.0, 36.0, -64.0, 42.0, 53.0, 34.0, 53.0, 54.0, -64.0, -64.0, 64.0, 53.0, 53.0, 43.0, -64.0, -64.0, 48.0, 54.0, 54.0, 58.0, -64.0, 59.0, 64.0, 64.0, 58.0, 58.0, 41.0, -63.0, -64.0, -64.0, 25.0, -64.0, 58.0, 58.0, 33.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2937117911686615, "mean_inference_ms": 9.680010502815984, "mean_action_processing_ms": 0.4527283926740424, "mean_env_wait_ms": 0.2884384135459662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2722196578979492, "StateBufferConnector_ms": 0.004563331604003906, "ViewRequirementAgentConnector_ms": 0.19400572776794434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.023175842422294, "num_agent_steps_trained_throughput_per_sec": 7.023175842422294, "timesteps_total": 62976, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62976, "timers": {"training_iteration_time_ms": 71608.508, "sample_time_ms": 6020.259, "load_time_ms": 0.295, "load_throughput": 1737165.222, "learn_time_ms": 65587.438, "learn_throughput": 7.806, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "done": false, "episodes_total": 3936, "training_iteration": 123, "trial_id": "f4e01_00169", "date": "2024-02-27_02-30-01", "timestamp": 1708997401, "time_this_iter_s": 72.90655708312988, "time_total_s": 8826.847826957703, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8826.847826957703, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 54.35242718446603, "ram_util_percent": 20.945631067961166}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 29.56, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.7309375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.7309375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.460685513416926, "policy_loss": -0.05069290952136119, "vf_loss": 7.085593350728353, "vf_explained_var": 0.9888933206597964, "kl": 0.0, "entropy": 105.18781121571858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 29.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 29.56, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.7309375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.7309375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 28.0, -63.0, 59.0, 26.0, 27.0, 28.0, -64.0, 52.0, 53.0, 53.0, 53.0, 53.0, 58.0, 59.0, 54.0, 53.0, 48.0, 59.0, 48.0, 58.0, 59.0, 58.0, 58.0, 64.0, 54.0, 53.0, 64.0, 58.0, 58.0, 59.0, 58.0, 48.0, 36.0, -64.0, 42.0, 53.0, 34.0, 53.0, 54.0, -64.0, -64.0, 64.0, 53.0, 53.0, 43.0, -64.0, -64.0, 48.0, 54.0, 54.0, 58.0, -64.0, 59.0, 64.0, 64.0, 58.0, 58.0, 41.0, -63.0, -64.0, -64.0, 25.0, -64.0, 58.0, 58.0, 33.0, 53.0, 59.0, 43.0, -64.0, -64.0, 64.0, 32.0, -64.0, 32.0, 54.0, 53.0, 25.0, 53.0, 53.0, -64.0, 58.0, 38.0, 54.0, 26.0, 53.0, 43.0, 50.0, 47.0, 54.0, 54.0, 33.0, 38.0, -64.0, 48.0, 58.0, 43.0, 58.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2938900910781623, "mean_inference_ms": 9.680767102605445, "mean_action_processing_ms": 0.4528013805274665, "mean_env_wait_ms": 0.28849807059001586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2756993770599365, "StateBufferConnector_ms": 0.004627227783203125, "ViewRequirementAgentConnector_ms": 0.19727110862731934}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 29.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 28.0, -63.0, 59.0, 26.0, 27.0, 28.0, -64.0, 52.0, 53.0, 53.0, 53.0, 53.0, 58.0, 59.0, 54.0, 53.0, 48.0, 59.0, 48.0, 58.0, 59.0, 58.0, 58.0, 64.0, 54.0, 53.0, 64.0, 58.0, 58.0, 59.0, 58.0, 48.0, 36.0, -64.0, 42.0, 53.0, 34.0, 53.0, 54.0, -64.0, -64.0, 64.0, 53.0, 53.0, 43.0, -64.0, -64.0, 48.0, 54.0, 54.0, 58.0, -64.0, 59.0, 64.0, 64.0, 58.0, 58.0, 41.0, -63.0, -64.0, -64.0, 25.0, -64.0, 58.0, 58.0, 33.0, 53.0, 59.0, 43.0, -64.0, -64.0, 64.0, 32.0, -64.0, 32.0, 54.0, 53.0, 25.0, 53.0, 53.0, -64.0, 58.0, 38.0, 54.0, 26.0, 53.0, 43.0, 50.0, 47.0, 54.0, 54.0, 33.0, 38.0, -64.0, 48.0, 58.0, 43.0, 58.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2938900910781623, "mean_inference_ms": 9.680767102605445, "mean_action_processing_ms": 0.4528013805274665, "mean_env_wait_ms": 0.28849807059001586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2756993770599365, "StateBufferConnector_ms": 0.004627227783203125, "ViewRequirementAgentConnector_ms": 0.19727110862731934}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.057646364384117, "num_agent_steps_trained_throughput_per_sec": 7.057646364384117, "timesteps_total": 63488, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 71848.581, "sample_time_ms": 6070.02, "load_time_ms": 0.297, "load_throughput": 1722396.253, "learn_time_ms": 65777.733, "learn_throughput": 7.784, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "episodes_total": 3968, "training_iteration": 124, "trial_id": "f4e01_00169", "date": "2024-02-27_02-31-13", "timestamp": 1708997473, "time_this_iter_s": 72.55065941810608, "time_total_s": 8899.398486375809, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8899.398486375809, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 55.171844660194175, "ram_util_percent": 21.113592233009708}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.17, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.704453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.704453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.567277602354685, "policy_loss": -0.043391906966765724, "vf_loss": 7.241540304819742, "vf_explained_var": 0.958107469479243, "kl": 0.0, "entropy": 103.04764728546142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.17, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.17, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.704453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.704453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, 36.0, -64.0, 42.0, 53.0, 34.0, 53.0, 54.0, -64.0, -64.0, 64.0, 53.0, 53.0, 43.0, -64.0, -64.0, 48.0, 54.0, 54.0, 58.0, -64.0, 59.0, 64.0, 64.0, 58.0, 58.0, 41.0, -63.0, -64.0, -64.0, 25.0, -64.0, 58.0, 58.0, 33.0, 53.0, 59.0, 43.0, -64.0, -64.0, 64.0, 32.0, -64.0, 32.0, 54.0, 53.0, 25.0, 53.0, 53.0, -64.0, 58.0, 38.0, 54.0, 26.0, 53.0, 43.0, 50.0, 47.0, 54.0, 54.0, 33.0, 38.0, -64.0, 48.0, 58.0, 43.0, 58.0, 53.0, -64.0, 59.0, 48.0, 53.0, 47.0, 1.0, 53.0, 18.0, 58.0, -64.0, 43.0, -64.0, 64.0, 22.0, 59.0, 53.0, -64.0, 59.0, 48.0, 58.0, 58.0, 58.0, 64.0, 27.0, 54.0, 64.0, 47.0, 39.0, -64.0, 58.0, 38.0, 52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2941549421580962, "mean_inference_ms": 9.682353989320365, "mean_action_processing_ms": 0.4529049392069186, "mean_env_wait_ms": 0.2885636076067105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27587389945983887, "StateBufferConnector_ms": 0.004656791687011719, "ViewRequirementAgentConnector_ms": 0.19875073432922363}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.17, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 36.0, -64.0, 42.0, 53.0, 34.0, 53.0, 54.0, -64.0, -64.0, 64.0, 53.0, 53.0, 43.0, -64.0, -64.0, 48.0, 54.0, 54.0, 58.0, -64.0, 59.0, 64.0, 64.0, 58.0, 58.0, 41.0, -63.0, -64.0, -64.0, 25.0, -64.0, 58.0, 58.0, 33.0, 53.0, 59.0, 43.0, -64.0, -64.0, 64.0, 32.0, -64.0, 32.0, 54.0, 53.0, 25.0, 53.0, 53.0, -64.0, 58.0, 38.0, 54.0, 26.0, 53.0, 43.0, 50.0, 47.0, 54.0, 54.0, 33.0, 38.0, -64.0, 48.0, 58.0, 43.0, 58.0, 53.0, -64.0, 59.0, 48.0, 53.0, 47.0, 1.0, 53.0, 18.0, 58.0, -64.0, 43.0, -64.0, 64.0, 22.0, 59.0, 53.0, -64.0, 59.0, 48.0, 58.0, 58.0, 58.0, 64.0, 27.0, 54.0, 64.0, 47.0, 39.0, -64.0, 58.0, 38.0, 52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2941549421580962, "mean_inference_ms": 9.682353989320365, "mean_action_processing_ms": 0.4529049392069186, "mean_env_wait_ms": 0.2885636076067105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27587389945983887, "StateBufferConnector_ms": 0.004656791687011719, "ViewRequirementAgentConnector_ms": 0.19875073432922363}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.081400615881108, "num_agent_steps_trained_throughput_per_sec": 7.081400615881108, "timesteps_total": 64000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 71959.933, "sample_time_ms": 6082.432, "load_time_ms": 0.297, "load_throughput": 1722120.006, "learn_time_ms": 65876.658, "learn_throughput": 7.772, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 4000, "training_iteration": 125, "trial_id": "f4e01_00169", "date": "2024-02-27_02-32-28", "timestamp": 1708997548, "time_this_iter_s": 72.30731558799744, "time_total_s": 8971.705801963806, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8971.705801963806, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 53.241904761904756, "ram_util_percent": 21.193333333333335}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.99, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.710859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.710859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.489616394042969, "policy_loss": -0.040664895856752994, "vf_loss": 7.115282205740611, "vf_explained_var": 0.9446568777163823, "kl": 0.0, "entropy": 104.46562773386637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.99, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.710859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.710859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 58.0, 33.0, 53.0, 59.0, 43.0, -64.0, -64.0, 64.0, 32.0, -64.0, 32.0, 54.0, 53.0, 25.0, 53.0, 53.0, -64.0, 58.0, 38.0, 54.0, 26.0, 53.0, 43.0, 50.0, 47.0, 54.0, 54.0, 33.0, 38.0, -64.0, 48.0, 58.0, 43.0, 58.0, 53.0, -64.0, 59.0, 48.0, 53.0, 47.0, 1.0, 53.0, 18.0, 58.0, -64.0, 43.0, -64.0, 64.0, 22.0, 59.0, 53.0, -64.0, 59.0, 48.0, 58.0, 58.0, 58.0, 64.0, 27.0, 54.0, 64.0, 47.0, 39.0, -64.0, 58.0, 38.0, 52.0, 40.0, -64.0, 49.0, 59.0, 53.0, 49.0, 43.0, 11.0, -64.0, 59.0, 58.0, 54.0, 59.0, 58.0, 32.0, 53.0, 59.0, 59.0, 48.0, -63.0, -64.0, -64.0, 54.0, -64.0, 48.0, 29.0, 59.0, 53.0, -64.0, -64.0, 48.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2945439326032204, "mean_inference_ms": 9.684600971186583, "mean_action_processing_ms": 0.4530411089602579, "mean_env_wait_ms": 0.2886415612719783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2780466079711914, "StateBufferConnector_ms": 0.004632711410522461, "ViewRequirementAgentConnector_ms": 0.20449113845825195}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 58.0, 33.0, 53.0, 59.0, 43.0, -64.0, -64.0, 64.0, 32.0, -64.0, 32.0, 54.0, 53.0, 25.0, 53.0, 53.0, -64.0, 58.0, 38.0, 54.0, 26.0, 53.0, 43.0, 50.0, 47.0, 54.0, 54.0, 33.0, 38.0, -64.0, 48.0, 58.0, 43.0, 58.0, 53.0, -64.0, 59.0, 48.0, 53.0, 47.0, 1.0, 53.0, 18.0, 58.0, -64.0, 43.0, -64.0, 64.0, 22.0, 59.0, 53.0, -64.0, 59.0, 48.0, 58.0, 58.0, 58.0, 64.0, 27.0, 54.0, 64.0, 47.0, 39.0, -64.0, 58.0, 38.0, 52.0, 40.0, -64.0, 49.0, 59.0, 53.0, 49.0, 43.0, 11.0, -64.0, 59.0, 58.0, 54.0, 59.0, 58.0, 32.0, 53.0, 59.0, 59.0, 48.0, -63.0, -64.0, -64.0, 54.0, -64.0, 48.0, 29.0, 59.0, 53.0, -64.0, -64.0, 48.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2945439326032204, "mean_inference_ms": 9.684600971186583, "mean_action_processing_ms": 0.4530411089602579, "mean_env_wait_ms": 0.2886415612719783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2780466079711914, "StateBufferConnector_ms": 0.004632711410522461, "ViewRequirementAgentConnector_ms": 0.20449113845825195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.049507695727945, "num_agent_steps_trained_throughput_per_sec": 7.049507695727945, "timesteps_total": 64512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 72055.9, "sample_time_ms": 6116.372, "load_time_ms": 0.299, "load_throughput": 1713326.67, "learn_time_ms": 65938.692, "learn_throughput": 7.765, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 4032, "training_iteration": 126, "trial_id": "f4e01_00169", "date": "2024-02-27_02-33-40", "timestamp": 1708997620, "time_this_iter_s": 72.63458752632141, "time_total_s": 9044.340389490128, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9044.340389490128, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 52.48834951456311, "ram_util_percent": 21.333009708737876}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 24.55, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.691796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.691796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.651940896113714, "policy_loss": 0.22746074381284415, "vf_loss": 6.9491104284922285, "vf_explained_var": 0.9778837561607361, "kl": 0.0, "entropy": 111.02605717976888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 65024, "num_env_steps_trained": 65024, "num_agent_steps_sampled": 65024, "num_agent_steps_trained": 65024}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.55, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 24.55, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.691796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.691796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 43.0, 58.0, 53.0, -64.0, 59.0, 48.0, 53.0, 47.0, 1.0, 53.0, 18.0, 58.0, -64.0, 43.0, -64.0, 64.0, 22.0, 59.0, 53.0, -64.0, 59.0, 48.0, 58.0, 58.0, 58.0, 64.0, 27.0, 54.0, 64.0, 47.0, 39.0, -64.0, 58.0, 38.0, 52.0, 40.0, -64.0, 49.0, 59.0, 53.0, 49.0, 43.0, 11.0, -64.0, 59.0, 58.0, 54.0, 59.0, 58.0, 32.0, 53.0, 59.0, 59.0, 48.0, -63.0, -64.0, -64.0, 54.0, -64.0, 48.0, 29.0, 59.0, 53.0, -64.0, -64.0, 48.0, -64.0, -64.0, 58.0, 59.0, -64.0, 17.0, 58.0, 58.0, 58.0, 59.0, 53.0, 64.0, -64.0, -63.0, 43.0, -64.0, -64.0, 54.0, 42.0, 58.0, -64.0, 44.0, 49.0, 59.0, 46.0, 53.0, 37.0, 48.0, 58.0, 58.0, -64.0, 43.0, 37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2948345941218917, "mean_inference_ms": 9.686028728407589, "mean_action_processing_ms": 0.4531219139498599, "mean_env_wait_ms": 0.28868167357917984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27462124824523926, "StateBufferConnector_ms": 0.004728794097900391, "ViewRequirementAgentConnector_ms": 0.20024514198303223}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.55, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 43.0, 58.0, 53.0, -64.0, 59.0, 48.0, 53.0, 47.0, 1.0, 53.0, 18.0, 58.0, -64.0, 43.0, -64.0, 64.0, 22.0, 59.0, 53.0, -64.0, 59.0, 48.0, 58.0, 58.0, 58.0, 64.0, 27.0, 54.0, 64.0, 47.0, 39.0, -64.0, 58.0, 38.0, 52.0, 40.0, -64.0, 49.0, 59.0, 53.0, 49.0, 43.0, 11.0, -64.0, 59.0, 58.0, 54.0, 59.0, 58.0, 32.0, 53.0, 59.0, 59.0, 48.0, -63.0, -64.0, -64.0, 54.0, -64.0, 48.0, 29.0, 59.0, 53.0, -64.0, -64.0, 48.0, -64.0, -64.0, 58.0, 59.0, -64.0, 17.0, 58.0, 58.0, 58.0, 59.0, 53.0, 64.0, -64.0, -63.0, 43.0, -64.0, -64.0, 54.0, 42.0, 58.0, -64.0, 44.0, 49.0, 59.0, 46.0, 53.0, 37.0, 48.0, 58.0, 58.0, -64.0, 43.0, 37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2948345941218917, "mean_inference_ms": 9.686028728407589, "mean_action_processing_ms": 0.4531219139498599, "mean_env_wait_ms": 0.28868167357917984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27462124824523926, "StateBufferConnector_ms": 0.004728794097900391, "ViewRequirementAgentConnector_ms": 0.20024514198303223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65024, "num_agent_steps_trained": 65024, "num_env_steps_sampled": 65024, "num_env_steps_trained": 65024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0545276764926585, "num_agent_steps_trained_throughput_per_sec": 7.0545276764926585, "timesteps_total": 65024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65024, "timers": {"training_iteration_time_ms": 72166.663, "sample_time_ms": 6106.872, "load_time_ms": 0.293, "load_throughput": 1744786.844, "learn_time_ms": 66058.956, "learn_throughput": 7.751, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 65024, "num_env_steps_trained": 65024, "num_agent_steps_sampled": 65024, "num_agent_steps_trained": 65024}, "done": false, "episodes_total": 4064, "training_iteration": 127, "trial_id": "f4e01_00169", "date": "2024-02-27_02-34-53", "timestamp": 1708997693, "time_this_iter_s": 72.58289361000061, "time_total_s": 9116.923283100128, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9116.923283100128, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 52.84757281553398, "ram_util_percent": 21.392233009708743}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.21, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.642265625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.642265625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9929250959306956, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.126494153340658, "policy_loss": 0.07728620701624701, "vf_loss": 7.930311012268066, "vf_explained_var": 0.965187797943751, "kl": 0.0, "entropy": 108.12044226328531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.21, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.21, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.642265625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.642265625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 58.0, 38.0, 52.0, 40.0, -64.0, 49.0, 59.0, 53.0, 49.0, 43.0, 11.0, -64.0, 59.0, 58.0, 54.0, 59.0, 58.0, 32.0, 53.0, 59.0, 59.0, 48.0, -63.0, -64.0, -64.0, 54.0, -64.0, 48.0, 29.0, 59.0, 53.0, -64.0, -64.0, 48.0, -64.0, -64.0, 58.0, 59.0, -64.0, 17.0, 58.0, 58.0, 58.0, 59.0, 53.0, 64.0, -64.0, -63.0, 43.0, -64.0, -64.0, 54.0, 42.0, 58.0, -64.0, 44.0, 49.0, 59.0, 46.0, 53.0, 37.0, 48.0, 58.0, 58.0, -64.0, 43.0, 37.0, -64.0, -64.0, 58.0, 3.0, 49.0, -64.0, 59.0, 47.0, 27.0, -64.0, 59.0, -64.0, 58.0, 52.0, 16.0, 48.0, 64.0, 44.0, 21.0, 21.0, 33.0, 59.0, 21.0, -64.0, 43.0, 28.0, 39.0, -64.0, -64.0, 52.0, 64.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2950973692400074, "mean_inference_ms": 9.686943122729035, "mean_action_processing_ms": 0.4531921185757438, "mean_env_wait_ms": 0.2887214476845196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2756021022796631, "StateBufferConnector_ms": 0.004736900329589844, "ViewRequirementAgentConnector_ms": 0.2007598876953125}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.21, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 58.0, 38.0, 52.0, 40.0, -64.0, 49.0, 59.0, 53.0, 49.0, 43.0, 11.0, -64.0, 59.0, 58.0, 54.0, 59.0, 58.0, 32.0, 53.0, 59.0, 59.0, 48.0, -63.0, -64.0, -64.0, 54.0, -64.0, 48.0, 29.0, 59.0, 53.0, -64.0, -64.0, 48.0, -64.0, -64.0, 58.0, 59.0, -64.0, 17.0, 58.0, 58.0, 58.0, 59.0, 53.0, 64.0, -64.0, -63.0, 43.0, -64.0, -64.0, 54.0, 42.0, 58.0, -64.0, 44.0, 49.0, 59.0, 46.0, 53.0, 37.0, 48.0, 58.0, 58.0, -64.0, 43.0, 37.0, -64.0, -64.0, 58.0, 3.0, 49.0, -64.0, 59.0, 47.0, 27.0, -64.0, 59.0, -64.0, 58.0, 52.0, 16.0, 48.0, 64.0, 44.0, 21.0, 21.0, 33.0, 59.0, 21.0, -64.0, 43.0, 28.0, 39.0, -64.0, -64.0, 52.0, 64.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2950973692400074, "mean_inference_ms": 9.686943122729035, "mean_action_processing_ms": 0.4531921185757438, "mean_env_wait_ms": 0.2887214476845196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2756021022796631, "StateBufferConnector_ms": 0.004736900329589844, "ViewRequirementAgentConnector_ms": 0.2007598876953125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.122283919561682, "num_agent_steps_trained_throughput_per_sec": 7.122283919561682, "timesteps_total": 65536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 72212.64, "sample_time_ms": 6099.777, "load_time_ms": 0.285, "load_throughput": 1796907.077, "learn_time_ms": 66112.044, "learn_throughput": 7.744, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "episodes_total": 4096, "training_iteration": 128, "trial_id": "f4e01_00169", "date": "2024-02-27_02-36-05", "timestamp": 1708997765, "time_this_iter_s": 71.89248466491699, "time_total_s": 9188.815767765045, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9188.815767765045, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 52.6686274509804, "ram_util_percent": 21.302941176470597}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 10.29, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.580390625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.580390625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6155871893589695, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.296202047665914, "policy_loss": 0.10590445029859742, "vf_loss": 9.722512018680572, "vf_explained_var": 0.987191899617513, "kl": 0.0, "entropy": 98.79313468933105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 66048, "num_env_steps_trained": 66048, "num_agent_steps_sampled": 66048, "num_agent_steps_trained": 66048}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 10.29, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.580390625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.580390625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 48.0, -64.0, -64.0, 58.0, 59.0, -64.0, 17.0, 58.0, 58.0, 58.0, 59.0, 53.0, 64.0, -64.0, -63.0, 43.0, -64.0, -64.0, 54.0, 42.0, 58.0, -64.0, 44.0, 49.0, 59.0, 46.0, 53.0, 37.0, 48.0, 58.0, 58.0, -64.0, 43.0, 37.0, -64.0, -64.0, 58.0, 3.0, 49.0, -64.0, 59.0, 47.0, 27.0, -64.0, 59.0, -64.0, 58.0, 52.0, 16.0, 48.0, 64.0, 44.0, 21.0, 21.0, 33.0, 59.0, 21.0, -64.0, 43.0, 28.0, 39.0, -64.0, -64.0, 52.0, 64.0, 23.0, -64.0, 53.0, 53.0, 59.0, -64.0, -32.0, 6.0, -64.0, -64.0, 58.0, 5.0, -64.0, 52.0, 53.0, -64.0, 48.0, -64.0, -64.0, -29.0, 53.0, 59.0, -64.0, -16.0, 59.0, 54.0, 54.0, -25.0, -15.0, -24.0, 46.0, 29.0, -29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2952090067311186, "mean_inference_ms": 9.68785969630183, "mean_action_processing_ms": 0.4532192584513255, "mean_env_wait_ms": 0.2887458277243749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27451086044311523, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.19809532165527344}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 48.0, -64.0, -64.0, 58.0, 59.0, -64.0, 17.0, 58.0, 58.0, 58.0, 59.0, 53.0, 64.0, -64.0, -63.0, 43.0, -64.0, -64.0, 54.0, 42.0, 58.0, -64.0, 44.0, 49.0, 59.0, 46.0, 53.0, 37.0, 48.0, 58.0, 58.0, -64.0, 43.0, 37.0, -64.0, -64.0, 58.0, 3.0, 49.0, -64.0, 59.0, 47.0, 27.0, -64.0, 59.0, -64.0, 58.0, 52.0, 16.0, 48.0, 64.0, 44.0, 21.0, 21.0, 33.0, 59.0, 21.0, -64.0, 43.0, 28.0, 39.0, -64.0, -64.0, 52.0, 64.0, 23.0, -64.0, 53.0, 53.0, 59.0, -64.0, -32.0, 6.0, -64.0, -64.0, 58.0, 5.0, -64.0, 52.0, 53.0, -64.0, 48.0, -64.0, -64.0, -29.0, 53.0, 59.0, -64.0, -16.0, 59.0, 54.0, 54.0, -25.0, -15.0, -24.0, 46.0, 29.0, -29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2952090067311186, "mean_inference_ms": 9.68785969630183, "mean_action_processing_ms": 0.4532192584513255, "mean_env_wait_ms": 0.2887458277243749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27451086044311523, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.19809532165527344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66048, "num_agent_steps_trained": 66048, "num_env_steps_sampled": 66048, "num_env_steps_trained": 66048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.102456525086086, "num_agent_steps_trained_throughput_per_sec": 7.102456525086086, "timesteps_total": 66048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 66048, "timers": {"training_iteration_time_ms": 72281.798, "sample_time_ms": 6121.004, "load_time_ms": 0.287, "load_throughput": 1781848.364, "learn_time_ms": 66159.993, "learn_throughput": 7.739, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 66048, "num_env_steps_trained": 66048, "num_agent_steps_sampled": 66048, "num_agent_steps_trained": 66048}, "done": false, "episodes_total": 4128, "training_iteration": 129, "trial_id": "f4e01_00169", "date": "2024-02-27_02-37-17", "timestamp": 1708997837, "time_this_iter_s": 72.09323692321777, "time_total_s": 9260.909004688263, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9260.909004688263, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 53.07549019607842, "ram_util_percent": 21.250980392156876}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 13.61, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.606328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.606328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9582948343207439, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.411059224605561, "policy_loss": 0.22990457796064825, "vf_loss": 8.137547145287195, "vf_explained_var": 0.9766420856118202, "kl": 0.0, "entropy": 98.2120735168457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 13.61, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 13.61, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.606328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.606328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, -64.0, 43.0, 37.0, -64.0, -64.0, 58.0, 3.0, 49.0, -64.0, 59.0, 47.0, 27.0, -64.0, 59.0, -64.0, 58.0, 52.0, 16.0, 48.0, 64.0, 44.0, 21.0, 21.0, 33.0, 59.0, 21.0, -64.0, 43.0, 28.0, 39.0, -64.0, -64.0, 52.0, 64.0, 23.0, -64.0, 53.0, 53.0, 59.0, -64.0, -32.0, 6.0, -64.0, -64.0, 58.0, 5.0, -64.0, 52.0, 53.0, -64.0, 48.0, -64.0, -64.0, -29.0, 53.0, 59.0, -64.0, -16.0, 59.0, 54.0, 54.0, -25.0, -15.0, -24.0, 46.0, 29.0, -29.0, 41.0, 64.0, 58.0, 59.0, -27.0, 59.0, 58.0, 58.0, 64.0, -15.0, -64.0, 31.0, 54.0, 58.0, -5.0, -63.0, 53.0, 64.0, -63.0, 54.0, 26.0, 54.0, 41.0, -64.0, -21.0, 59.0, 48.0, -64.0, 54.0, 44.0, 48.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2952488251905365, "mean_inference_ms": 9.688878349371505, "mean_action_processing_ms": 0.453248357727215, "mean_env_wait_ms": 0.2887677054499502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27219247817993164, "StateBufferConnector_ms": 0.0044879913330078125, "ViewRequirementAgentConnector_ms": 0.19434905052185059}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 13.61, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, -64.0, 43.0, 37.0, -64.0, -64.0, 58.0, 3.0, 49.0, -64.0, 59.0, 47.0, 27.0, -64.0, 59.0, -64.0, 58.0, 52.0, 16.0, 48.0, 64.0, 44.0, 21.0, 21.0, 33.0, 59.0, 21.0, -64.0, 43.0, 28.0, 39.0, -64.0, -64.0, 52.0, 64.0, 23.0, -64.0, 53.0, 53.0, 59.0, -64.0, -32.0, 6.0, -64.0, -64.0, 58.0, 5.0, -64.0, 52.0, 53.0, -64.0, 48.0, -64.0, -64.0, -29.0, 53.0, 59.0, -64.0, -16.0, 59.0, 54.0, 54.0, -25.0, -15.0, -24.0, 46.0, 29.0, -29.0, 41.0, 64.0, 58.0, 59.0, -27.0, 59.0, 58.0, 58.0, 64.0, -15.0, -64.0, 31.0, 54.0, 58.0, -5.0, -63.0, 53.0, 64.0, -63.0, 54.0, 26.0, 54.0, 41.0, -64.0, -21.0, 59.0, 48.0, -64.0, 54.0, 44.0, 48.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2952488251905365, "mean_inference_ms": 9.688878349371505, "mean_action_processing_ms": 0.453248357727215, "mean_env_wait_ms": 0.2887677054499502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27219247817993164, "StateBufferConnector_ms": 0.0044879913330078125, "ViewRequirementAgentConnector_ms": 0.19434905052185059}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0603262142127505, "num_agent_steps_trained_throughput_per_sec": 7.0603262142127505, "timesteps_total": 66560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 72334.531, "sample_time_ms": 6099.86, "load_time_ms": 0.282, "load_throughput": 1817129.504, "learn_time_ms": 66233.878, "learn_throughput": 7.73, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "episodes_total": 4160, "training_iteration": 130, "trial_id": "f4e01_00169", "date": "2024-02-27_02-38-30", "timestamp": 1708997910, "time_this_iter_s": 72.52313590049744, "time_total_s": 9333.43214058876, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9333.43214058876, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 52.899029126213584, "ram_util_percent": 21.30194174757282}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.72, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6228125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6228125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9920979437728723, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.594904464483261, "policy_loss": 0.23474078207897645, "vf_loss": 8.41869965394338, "vf_explained_var": 0.9633768041928609, "kl": 0.0, "entropy": 111.64528598785401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 67072, "num_env_steps_trained": 67072, "num_agent_steps_sampled": 67072, "num_agent_steps_trained": 67072}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.72, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6228125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6228125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 52.0, 64.0, 23.0, -64.0, 53.0, 53.0, 59.0, -64.0, -32.0, 6.0, -64.0, -64.0, 58.0, 5.0, -64.0, 52.0, 53.0, -64.0, 48.0, -64.0, -64.0, -29.0, 53.0, 59.0, -64.0, -16.0, 59.0, 54.0, 54.0, -25.0, -15.0, -24.0, 46.0, 29.0, -29.0, 41.0, 64.0, 58.0, 59.0, -27.0, 59.0, 58.0, 58.0, 64.0, -15.0, -64.0, 31.0, 54.0, 58.0, -5.0, -63.0, 53.0, 64.0, -63.0, 54.0, 26.0, 54.0, 41.0, -64.0, -21.0, 59.0, 48.0, -64.0, 54.0, 44.0, 48.0, 53.0, 48.0, -64.0, 59.0, 51.0, -64.0, 59.0, 58.0, 43.0, 47.0, -12.0, 33.0, 42.0, 14.0, -29.0, -64.0, -10.0, 42.0, 48.0, 52.0, -64.0, 59.0, 49.0, 54.0, 48.0, -30.0, 47.0, 53.0, 58.0, 59.0, -29.0, -29.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2954210073363013, "mean_inference_ms": 9.690689966101187, "mean_action_processing_ms": 0.4533201469932331, "mean_env_wait_ms": 0.28882167885905363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2753005027770996, "StateBufferConnector_ms": 0.004527568817138672, "ViewRequirementAgentConnector_ms": 0.20018601417541504}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 52.0, 64.0, 23.0, -64.0, 53.0, 53.0, 59.0, -64.0, -32.0, 6.0, -64.0, -64.0, 58.0, 5.0, -64.0, 52.0, 53.0, -64.0, 48.0, -64.0, -64.0, -29.0, 53.0, 59.0, -64.0, -16.0, 59.0, 54.0, 54.0, -25.0, -15.0, -24.0, 46.0, 29.0, -29.0, 41.0, 64.0, 58.0, 59.0, -27.0, 59.0, 58.0, 58.0, 64.0, -15.0, -64.0, 31.0, 54.0, 58.0, -5.0, -63.0, 53.0, 64.0, -63.0, 54.0, 26.0, 54.0, 41.0, -64.0, -21.0, 59.0, 48.0, -64.0, 54.0, 44.0, 48.0, 53.0, 48.0, -64.0, 59.0, 51.0, -64.0, 59.0, 58.0, 43.0, 47.0, -12.0, 33.0, 42.0, 14.0, -29.0, -64.0, -10.0, 42.0, 48.0, 52.0, -64.0, 59.0, 49.0, 54.0, 48.0, -30.0, 47.0, 53.0, 58.0, 59.0, -29.0, -29.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2954210073363013, "mean_inference_ms": 9.690689966101187, "mean_action_processing_ms": 0.4533201469932331, "mean_env_wait_ms": 0.28882167885905363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2753005027770996, "StateBufferConnector_ms": 0.004527568817138672, "ViewRequirementAgentConnector_ms": 0.20018601417541504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67072, "num_agent_steps_trained": 67072, "num_env_steps_sampled": 67072, "num_env_steps_trained": 67072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.026169002942088, "num_agent_steps_trained_throughput_per_sec": 7.026169002942088, "timesteps_total": 67072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 67072, "timers": {"training_iteration_time_ms": 72443.33, "sample_time_ms": 6132.477, "load_time_ms": 0.287, "load_throughput": 1785106.939, "learn_time_ms": 66310.044, "learn_throughput": 7.721, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 67072, "num_env_steps_trained": 67072, "num_agent_steps_sampled": 67072, "num_agent_steps_trained": 67072}, "done": false, "episodes_total": 4192, "training_iteration": 131, "trial_id": "f4e01_00169", "date": "2024-02-27_02-39-43", "timestamp": 1708997983, "time_this_iter_s": 72.87565398216248, "time_total_s": 9406.307794570923, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9406.307794570923, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 53.14271844660194, "ram_util_percent": 21.24271844660196}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.87, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.639609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.639609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.2278634190559385, "policy_loss": 0.04504375296334426, "vf_loss": 8.140162293116251, "vf_explained_var": 0.9630552043517431, "kl": 0.0, "entropy": 110.19863904317221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.87, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.87, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.639609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.639609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-24.0, 46.0, 29.0, -29.0, 41.0, 64.0, 58.0, 59.0, -27.0, 59.0, 58.0, 58.0, 64.0, -15.0, -64.0, 31.0, 54.0, 58.0, -5.0, -63.0, 53.0, 64.0, -63.0, 54.0, 26.0, 54.0, 41.0, -64.0, -21.0, 59.0, 48.0, -64.0, 54.0, 44.0, 48.0, 53.0, 48.0, -64.0, 59.0, 51.0, -64.0, 59.0, 58.0, 43.0, 47.0, -12.0, 33.0, 42.0, 14.0, -29.0, -64.0, -10.0, 42.0, 48.0, 52.0, -64.0, 59.0, 49.0, 54.0, 48.0, -30.0, 47.0, 53.0, 58.0, 59.0, -29.0, -29.0, 58.0, -64.0, 49.0, -63.0, -64.0, 53.0, 31.0, -21.0, -64.0, -64.0, 53.0, 49.0, -64.0, -64.0, 48.0, 64.0, 32.0, -20.0, -3.0, 58.0, 21.0, 54.0, -14.0, 32.0, -17.0, 38.0, -64.0, 44.0, 48.0, 58.0, 16.0, 54.0, 47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.295514761732676, "mean_inference_ms": 9.691406795396647, "mean_action_processing_ms": 0.4533436737098208, "mean_env_wait_ms": 0.2888554597257587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2741208076477051, "StateBufferConnector_ms": 0.004463672637939453, "ViewRequirementAgentConnector_ms": 0.19589877128601074}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.87, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 46.0, 29.0, -29.0, 41.0, 64.0, 58.0, 59.0, -27.0, 59.0, 58.0, 58.0, 64.0, -15.0, -64.0, 31.0, 54.0, 58.0, -5.0, -63.0, 53.0, 64.0, -63.0, 54.0, 26.0, 54.0, 41.0, -64.0, -21.0, 59.0, 48.0, -64.0, 54.0, 44.0, 48.0, 53.0, 48.0, -64.0, 59.0, 51.0, -64.0, 59.0, 58.0, 43.0, 47.0, -12.0, 33.0, 42.0, 14.0, -29.0, -64.0, -10.0, 42.0, 48.0, 52.0, -64.0, 59.0, 49.0, 54.0, 48.0, -30.0, 47.0, 53.0, 58.0, 59.0, -29.0, -29.0, 58.0, -64.0, 49.0, -63.0, -64.0, 53.0, 31.0, -21.0, -64.0, -64.0, 53.0, 49.0, -64.0, -64.0, 48.0, 64.0, 32.0, -20.0, -3.0, 58.0, 21.0, 54.0, -14.0, 32.0, -17.0, 38.0, -64.0, 44.0, 48.0, 58.0, 16.0, 54.0, 47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.295514761732676, "mean_inference_ms": 9.691406795396647, "mean_action_processing_ms": 0.4533436737098208, "mean_env_wait_ms": 0.2888554597257587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2741208076477051, "StateBufferConnector_ms": 0.004463672637939453, "ViewRequirementAgentConnector_ms": 0.19589877128601074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.996103412754225, "num_agent_steps_trained_throughput_per_sec": 6.996103412754225, "timesteps_total": 67584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 72550.2, "sample_time_ms": 6126.537, "load_time_ms": 0.293, "load_throughput": 1745354.07, "learn_time_ms": 66422.85, "learn_throughput": 7.708, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "done": false, "episodes_total": 4224, "training_iteration": 132, "trial_id": "f4e01_00169", "date": "2024-02-27_02-40-56", "timestamp": 1708998056, "time_this_iter_s": 73.18878626823425, "time_total_s": 9479.496580839157, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9479.496580839157, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 53.64519230769231, "ram_util_percent": 21.189423076923074}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.652578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.652578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.9913198431332906, "policy_loss": -0.04490094308275729, "vf_loss": 6.339308396975199, "vf_explained_var": 0.9362940336267154, "kl": 0.0, "entropy": 108.11429367065429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 68096, "num_agent_steps_sampled": 68096, "num_agent_steps_trained": 68096}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.53, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.652578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.652578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 44.0, 48.0, 53.0, 48.0, -64.0, 59.0, 51.0, -64.0, 59.0, 58.0, 43.0, 47.0, -12.0, 33.0, 42.0, 14.0, -29.0, -64.0, -10.0, 42.0, 48.0, 52.0, -64.0, 59.0, 49.0, 54.0, 48.0, -30.0, 47.0, 53.0, 58.0, 59.0, -29.0, -29.0, 58.0, -64.0, 49.0, -63.0, -64.0, 53.0, 31.0, -21.0, -64.0, -64.0, 53.0, 49.0, -64.0, -64.0, 48.0, 64.0, 32.0, -20.0, -3.0, 58.0, 21.0, 54.0, -14.0, 32.0, -17.0, 38.0, -64.0, 44.0, 48.0, 58.0, 16.0, 54.0, 47.0, 53.0, 54.0, 48.0, 44.0, 43.0, 54.0, -4.0, 17.0, 41.0, 53.0, 58.0, 15.0, 54.0, 64.0, -64.0, 37.0, 47.0, -63.0, 53.0, 19.0, 59.0, -64.0, 4.0, 53.0, 26.0, 59.0, 54.0, 14.0, 58.0, -64.0, 47.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2957712443236784, "mean_inference_ms": 9.692592584073738, "mean_action_processing_ms": 0.45341100807747964, "mean_env_wait_ms": 0.28891845521949366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2791581153869629, "StateBufferConnector_ms": 0.0045642852783203125, "ViewRequirementAgentConnector_ms": 0.20412969589233398}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.53, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 44.0, 48.0, 53.0, 48.0, -64.0, 59.0, 51.0, -64.0, 59.0, 58.0, 43.0, 47.0, -12.0, 33.0, 42.0, 14.0, -29.0, -64.0, -10.0, 42.0, 48.0, 52.0, -64.0, 59.0, 49.0, 54.0, 48.0, -30.0, 47.0, 53.0, 58.0, 59.0, -29.0, -29.0, 58.0, -64.0, 49.0, -63.0, -64.0, 53.0, 31.0, -21.0, -64.0, -64.0, 53.0, 49.0, -64.0, -64.0, 48.0, 64.0, 32.0, -20.0, -3.0, 58.0, 21.0, 54.0, -14.0, 32.0, -17.0, 38.0, -64.0, 44.0, 48.0, 58.0, 16.0, 54.0, 47.0, 53.0, 54.0, 48.0, 44.0, 43.0, 54.0, -4.0, 17.0, 41.0, 53.0, 58.0, 15.0, 54.0, 64.0, -64.0, 37.0, 47.0, -63.0, 53.0, 19.0, 59.0, -64.0, 4.0, 53.0, 26.0, 59.0, 54.0, 14.0, 58.0, -64.0, 47.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2957712443236784, "mean_inference_ms": 9.692592584073738, "mean_action_processing_ms": 0.45341100807747964, "mean_env_wait_ms": 0.28891845521949366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2791581153869629, "StateBufferConnector_ms": 0.0045642852783203125, "ViewRequirementAgentConnector_ms": 0.20412969589233398}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68096, "num_agent_steps_trained": 68096, "num_env_steps_sampled": 68096, "num_env_steps_trained": 68096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.898104956485957, "num_agent_steps_trained_throughput_per_sec": 6.898104956485957, "timesteps_total": 68096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 68096, "timers": {"training_iteration_time_ms": 72682.379, "sample_time_ms": 6132.485, "load_time_ms": 0.295, "load_throughput": 1732819.856, "learn_time_ms": 66549.069, "learn_throughput": 7.694, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 68096, "num_agent_steps_sampled": 68096, "num_agent_steps_trained": 68096}, "done": false, "episodes_total": 4256, "training_iteration": 133, "trial_id": "f4e01_00169", "date": "2024-02-27_02-42-10", "timestamp": 1708998130, "time_this_iter_s": 74.22854137420654, "time_total_s": 9553.725122213364, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9553.725122213364, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 53.47904761904762, "ram_util_percent": 21.271428571428576}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.93, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.647890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.647890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.671799767017364, "policy_loss": -0.034986037916193403, "vf_loss": 7.3925011396408085, "vf_explained_var": 0.9574732139706612, "kl": 0.0, "entropy": 109.00730463663737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.93, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.93, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.647890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.647890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -29.0, -29.0, 58.0, -64.0, 49.0, -63.0, -64.0, 53.0, 31.0, -21.0, -64.0, -64.0, 53.0, 49.0, -64.0, -64.0, 48.0, 64.0, 32.0, -20.0, -3.0, 58.0, 21.0, 54.0, -14.0, 32.0, -17.0, 38.0, -64.0, 44.0, 48.0, 58.0, 16.0, 54.0, 47.0, 53.0, 54.0, 48.0, 44.0, 43.0, 54.0, -4.0, 17.0, 41.0, 53.0, 58.0, 15.0, 54.0, 64.0, -64.0, 37.0, 47.0, -63.0, 53.0, 19.0, 59.0, -64.0, 4.0, 53.0, 26.0, 59.0, 54.0, 14.0, 58.0, -64.0, 47.0, -64.0, -64.0, 64.0, 9.0, 21.0, -64.0, 38.0, 64.0, 58.0, -64.0, 48.0, 28.0, 48.0, 49.0, 42.0, -1.0, 64.0, 53.0, 58.0, 47.0, 49.0, 48.0, 49.0, 54.0, -64.0, -63.0, 33.0, 48.0, 22.0, 48.0, 54.0, 7.0, -17.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2960569260061772, "mean_inference_ms": 9.6938103235458, "mean_action_processing_ms": 0.45348872820250435, "mean_env_wait_ms": 0.2889869919428161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2790405750274658, "StateBufferConnector_ms": 0.004548549652099609, "ViewRequirementAgentConnector_ms": 0.20382022857666016}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.93, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -29.0, -29.0, 58.0, -64.0, 49.0, -63.0, -64.0, 53.0, 31.0, -21.0, -64.0, -64.0, 53.0, 49.0, -64.0, -64.0, 48.0, 64.0, 32.0, -20.0, -3.0, 58.0, 21.0, 54.0, -14.0, 32.0, -17.0, 38.0, -64.0, 44.0, 48.0, 58.0, 16.0, 54.0, 47.0, 53.0, 54.0, 48.0, 44.0, 43.0, 54.0, -4.0, 17.0, 41.0, 53.0, 58.0, 15.0, 54.0, 64.0, -64.0, 37.0, 47.0, -63.0, 53.0, 19.0, 59.0, -64.0, 4.0, 53.0, 26.0, 59.0, 54.0, 14.0, 58.0, -64.0, 47.0, -64.0, -64.0, 64.0, 9.0, 21.0, -64.0, 38.0, 64.0, 58.0, -64.0, 48.0, 28.0, 48.0, 49.0, 42.0, -1.0, 64.0, 53.0, 58.0, 47.0, 49.0, 48.0, 49.0, 54.0, -64.0, -63.0, 33.0, 48.0, 22.0, 48.0, 54.0, 7.0, -17.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2960569260061772, "mean_inference_ms": 9.6938103235458, "mean_action_processing_ms": 0.45348872820250435, "mean_env_wait_ms": 0.2889869919428161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2790405750274658, "StateBufferConnector_ms": 0.004548549652099609, "ViewRequirementAgentConnector_ms": 0.20382022857666016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.9527483769612095, "num_agent_steps_trained_throughput_per_sec": 6.9527483769612095, "timesteps_total": 68608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 72791.83, "sample_time_ms": 6145.33, "load_time_ms": 0.296, "load_throughput": 1731981.328, "learn_time_ms": 66645.661, "learn_throughput": 7.682, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "done": false, "episodes_total": 4288, "training_iteration": 134, "trial_id": "f4e01_00169", "date": "2024-02-27_02-43-24", "timestamp": 1708998204, "time_this_iter_s": 73.64576196670532, "time_total_s": 9627.370884180069, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9627.370884180069, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 52.472115384615385, "ram_util_percent": 21.412500000000005}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.18, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9992172459761302, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.554562570651372, "policy_loss": 0.07595287829947968, "vf_loss": 8.604731492201488, "vf_explained_var": 0.9634309038519859, "kl": 0.0, "entropy": 108.88826681772868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.18, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 16.0, 54.0, 47.0, 53.0, 54.0, 48.0, 44.0, 43.0, 54.0, -4.0, 17.0, 41.0, 53.0, 58.0, 15.0, 54.0, 64.0, -64.0, 37.0, 47.0, -63.0, 53.0, 19.0, 59.0, -64.0, 4.0, 53.0, 26.0, 59.0, 54.0, 14.0, 58.0, -64.0, 47.0, -64.0, -64.0, 64.0, 9.0, 21.0, -64.0, 38.0, 64.0, 58.0, -64.0, 48.0, 28.0, 48.0, 49.0, 42.0, -1.0, 64.0, 53.0, 58.0, 47.0, 49.0, 48.0, 49.0, 54.0, -64.0, -63.0, 33.0, 48.0, 22.0, 48.0, 54.0, 7.0, -17.0, 33.0, 58.0, -3.0, -64.0, -64.0, 8.0, 15.0, -63.0, 9.0, 58.0, 58.0, 58.0, -2.0, 49.0, 53.0, -63.0, -1.0, 10.0, 58.0, 59.0, -64.0, 13.0, -64.0, 58.0, 52.0, 38.0, 53.0, 48.0, 54.0, 36.0, -64.0, 46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2964901378962586, "mean_inference_ms": 9.69545290478303, "mean_action_processing_ms": 0.45362978872579723, "mean_env_wait_ms": 0.28907392152147127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2881028652191162, "StateBufferConnector_ms": 0.0045702457427978516, "ViewRequirementAgentConnector_ms": 0.20572328567504883}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 16.0, 54.0, 47.0, 53.0, 54.0, 48.0, 44.0, 43.0, 54.0, -4.0, 17.0, 41.0, 53.0, 58.0, 15.0, 54.0, 64.0, -64.0, 37.0, 47.0, -63.0, 53.0, 19.0, 59.0, -64.0, 4.0, 53.0, 26.0, 59.0, 54.0, 14.0, 58.0, -64.0, 47.0, -64.0, -64.0, 64.0, 9.0, 21.0, -64.0, 38.0, 64.0, 58.0, -64.0, 48.0, 28.0, 48.0, 49.0, 42.0, -1.0, 64.0, 53.0, 58.0, 47.0, 49.0, 48.0, 49.0, 54.0, -64.0, -63.0, 33.0, 48.0, 22.0, 48.0, 54.0, 7.0, -17.0, 33.0, 58.0, -3.0, -64.0, -64.0, 8.0, 15.0, -63.0, 9.0, 58.0, 58.0, 58.0, -2.0, 49.0, 53.0, -63.0, -1.0, 10.0, 58.0, 59.0, -64.0, 13.0, -64.0, 58.0, 52.0, 38.0, 53.0, 48.0, 54.0, 36.0, -64.0, 46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2964901378962586, "mean_inference_ms": 9.69545290478303, "mean_action_processing_ms": 0.45362978872579723, "mean_env_wait_ms": 0.28907392152147127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2881028652191162, "StateBufferConnector_ms": 0.0045702457427978516, "ViewRequirementAgentConnector_ms": 0.20572328567504883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120, "num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.958574894525914, "num_agent_steps_trained_throughput_per_sec": 6.958574894525914, "timesteps_total": 69120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 69120, "timers": {"training_iteration_time_ms": 72919.451, "sample_time_ms": 6139.398, "load_time_ms": 0.298, "load_throughput": 1719913.221, "learn_time_ms": 66779.216, "learn_throughput": 7.667, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120}, "done": false, "episodes_total": 4320, "training_iteration": 135, "trial_id": "f4e01_00169", "date": "2024-02-27_02-44-37", "timestamp": 1708998277, "time_this_iter_s": 73.58337640762329, "time_total_s": 9700.954260587692, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9700.954260587692, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 52.25047619047619, "ram_util_percent": 21.59142857142857}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.621328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.621328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.2267161468664805, "policy_loss": 0.2989402063190937, "vf_loss": 7.739589198430379, "vf_explained_var": 0.9504058962066968, "kl": 0.0, "entropy": 120.72689679463704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.53, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.621328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.621328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, -64.0, 47.0, -64.0, -64.0, 64.0, 9.0, 21.0, -64.0, 38.0, 64.0, 58.0, -64.0, 48.0, 28.0, 48.0, 49.0, 42.0, -1.0, 64.0, 53.0, 58.0, 47.0, 49.0, 48.0, 49.0, 54.0, -64.0, -63.0, 33.0, 48.0, 22.0, 48.0, 54.0, 7.0, -17.0, 33.0, 58.0, -3.0, -64.0, -64.0, 8.0, 15.0, -63.0, 9.0, 58.0, 58.0, 58.0, -2.0, 49.0, 53.0, -63.0, -1.0, 10.0, 58.0, 59.0, -64.0, 13.0, -64.0, 58.0, 52.0, 38.0, 53.0, 48.0, 54.0, 36.0, -64.0, 46.0, 25.0, 38.0, 59.0, 58.0, 54.0, -12.0, -20.0, -64.0, 59.0, -63.0, 43.0, 11.0, 53.0, -64.0, 11.0, -64.0, 59.0, -64.0, -64.0, -2.0, -62.0, 64.0, 64.0, 39.0, -63.0, 14.0, 39.0, 48.0, -15.0, 40.0, 59.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2969557195368124, "mean_inference_ms": 9.697370323106885, "mean_action_processing_ms": 0.45379527324280977, "mean_env_wait_ms": 0.2891791839064391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2893946170806885, "StateBufferConnector_ms": 0.004586458206176758, "ViewRequirementAgentConnector_ms": 0.20998024940490723}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.53, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, -64.0, 47.0, -64.0, -64.0, 64.0, 9.0, 21.0, -64.0, 38.0, 64.0, 58.0, -64.0, 48.0, 28.0, 48.0, 49.0, 42.0, -1.0, 64.0, 53.0, 58.0, 47.0, 49.0, 48.0, 49.0, 54.0, -64.0, -63.0, 33.0, 48.0, 22.0, 48.0, 54.0, 7.0, -17.0, 33.0, 58.0, -3.0, -64.0, -64.0, 8.0, 15.0, -63.0, 9.0, 58.0, 58.0, 58.0, -2.0, 49.0, 53.0, -63.0, -1.0, 10.0, 58.0, 59.0, -64.0, 13.0, -64.0, 58.0, 52.0, 38.0, 53.0, 48.0, 54.0, 36.0, -64.0, 46.0, 25.0, 38.0, 59.0, 58.0, 54.0, -12.0, -20.0, -64.0, 59.0, -63.0, 43.0, 11.0, 53.0, -64.0, 11.0, -64.0, 59.0, -64.0, -64.0, -2.0, -62.0, 64.0, 64.0, 39.0, -63.0, 14.0, 39.0, 48.0, -15.0, 40.0, 59.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2969557195368124, "mean_inference_ms": 9.697370323106885, "mean_action_processing_ms": 0.45379527324280977, "mean_env_wait_ms": 0.2891791839064391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2893946170806885, "StateBufferConnector_ms": 0.004586458206176758, "ViewRequirementAgentConnector_ms": 0.20998024940490723}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.003804867572843, "num_agent_steps_trained_throughput_per_sec": 7.003804867572843, "timesteps_total": 69632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 72966.843, "sample_time_ms": 6134.849, "load_time_ms": 0.299, "load_throughput": 1715242.53, "learn_time_ms": 66831.158, "learn_throughput": 7.661, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "episodes_total": 4352, "training_iteration": 136, "trial_id": "f4e01_00169", "date": "2024-02-27_02-45-51", "timestamp": 1708998351, "time_this_iter_s": 73.1083595752716, "time_total_s": 9774.062620162964, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9774.062620162964, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 52.75728155339806, "ram_util_percent": 21.60582524271844}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.99, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.640546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.640546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.532207562526067, "policy_loss": 0.07664020031224936, "vf_loss": 8.56854117711385, "vf_explained_var": 0.7585539529720943, "kl": 0.0, "entropy": 111.37488358815511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 70144, "num_env_steps_trained": 70144, "num_agent_steps_sampled": 70144, "num_agent_steps_trained": 70144}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.99, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.640546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.640546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, 54.0, 7.0, -17.0, 33.0, 58.0, -3.0, -64.0, -64.0, 8.0, 15.0, -63.0, 9.0, 58.0, 58.0, 58.0, -2.0, 49.0, 53.0, -63.0, -1.0, 10.0, 58.0, 59.0, -64.0, 13.0, -64.0, 58.0, 52.0, 38.0, 53.0, 48.0, 54.0, 36.0, -64.0, 46.0, 25.0, 38.0, 59.0, 58.0, 54.0, -12.0, -20.0, -64.0, 59.0, -63.0, 43.0, 11.0, 53.0, -64.0, 11.0, -64.0, 59.0, -64.0, -64.0, -2.0, -62.0, 64.0, 64.0, 39.0, -63.0, 14.0, 39.0, 48.0, -15.0, 40.0, 59.0, 58.0, 64.0, -29.0, 54.0, 37.0, -9.0, 59.0, 58.0, 64.0, 58.0, 59.0, -19.0, -21.0, 53.0, 6.0, 49.0, 59.0, 64.0, 7.0, 64.0, -27.0, -17.0, -28.0, 59.0, 58.0, -28.0, 53.0, 12.0, 17.0, 59.0, -28.0, 47.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297324835532857, "mean_inference_ms": 9.699174545272314, "mean_action_processing_ms": 0.45394706844455707, "mean_env_wait_ms": 0.28926885552199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28844523429870605, "StateBufferConnector_ms": 0.004601240158081055, "ViewRequirementAgentConnector_ms": 0.2086331844329834}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 54.0, 7.0, -17.0, 33.0, 58.0, -3.0, -64.0, -64.0, 8.0, 15.0, -63.0, 9.0, 58.0, 58.0, 58.0, -2.0, 49.0, 53.0, -63.0, -1.0, 10.0, 58.0, 59.0, -64.0, 13.0, -64.0, 58.0, 52.0, 38.0, 53.0, 48.0, 54.0, 36.0, -64.0, 46.0, 25.0, 38.0, 59.0, 58.0, 54.0, -12.0, -20.0, -64.0, 59.0, -63.0, 43.0, 11.0, 53.0, -64.0, 11.0, -64.0, 59.0, -64.0, -64.0, -2.0, -62.0, 64.0, 64.0, 39.0, -63.0, 14.0, 39.0, 48.0, -15.0, 40.0, 59.0, 58.0, 64.0, -29.0, 54.0, 37.0, -9.0, 59.0, 58.0, 64.0, 58.0, 59.0, -19.0, -21.0, 53.0, 6.0, 49.0, 59.0, 64.0, 7.0, 64.0, -27.0, -17.0, -28.0, 59.0, 58.0, -28.0, 53.0, 12.0, 17.0, 59.0, -28.0, 47.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297324835532857, "mean_inference_ms": 9.699174545272314, "mean_action_processing_ms": 0.45394706844455707, "mean_env_wait_ms": 0.28926885552199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28844523429870605, "StateBufferConnector_ms": 0.004601240158081055, "ViewRequirementAgentConnector_ms": 0.2086331844329834}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70144, "num_agent_steps_trained": 70144, "num_env_steps_sampled": 70144, "num_env_steps_trained": 70144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.9987327292448365, "num_agent_steps_trained_throughput_per_sec": 6.9987327292448365, "timesteps_total": 70144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 70144, "timers": {"training_iteration_time_ms": 73024.703, "sample_time_ms": 6162.554, "load_time_ms": 0.303, "load_throughput": 1690399.597, "learn_time_ms": 66861.303, "learn_throughput": 7.658, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 70144, "num_env_steps_trained": 70144, "num_agent_steps_sampled": 70144, "num_agent_steps_trained": 70144}, "done": false, "episodes_total": 4384, "training_iteration": 137, "trial_id": "f4e01_00169", "date": "2024-02-27_02-47-04", "timestamp": 1708998424, "time_this_iter_s": 73.1613507270813, "time_total_s": 9847.223970890045, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9847.223970890045, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 52.67596153846153, "ram_util_percent": 21.524999999999995}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.57, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.652890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.652890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9945948377251626, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.254620631535848, "policy_loss": 0.19276967926416547, "vf_loss": 7.950168200333914, "vf_explained_var": 0.962409749130408, "kl": 0.0, "entropy": 120.1332181930542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.57, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.57, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.652890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.652890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 36.0, -64.0, 46.0, 25.0, 38.0, 59.0, 58.0, 54.0, -12.0, -20.0, -64.0, 59.0, -63.0, 43.0, 11.0, 53.0, -64.0, 11.0, -64.0, 59.0, -64.0, -64.0, -2.0, -62.0, 64.0, 64.0, 39.0, -63.0, 14.0, 39.0, 48.0, -15.0, 40.0, 59.0, 58.0, 64.0, -29.0, 54.0, 37.0, -9.0, 59.0, 58.0, 64.0, 58.0, 59.0, -19.0, -21.0, 53.0, 6.0, 49.0, 59.0, 64.0, 7.0, 64.0, -27.0, -17.0, -28.0, 59.0, 58.0, -28.0, 53.0, 12.0, 17.0, 59.0, -28.0, 47.0, 43.0, -64.0, 49.0, 59.0, 58.0, 53.0, -63.0, 53.0, 58.0, 64.0, -9.0, 59.0, 58.0, 64.0, 58.0, 12.0, 17.0, 18.0, -22.0, -64.0, 54.0, 29.0, 52.0, 28.0, 17.0, 48.0, 22.0, -64.0, 59.0, -64.0, 38.0, 37.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2976120374180637, "mean_inference_ms": 9.700849531396294, "mean_action_processing_ms": 0.45408326297536006, "mean_env_wait_ms": 0.28935917575187864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28222227096557617, "StateBufferConnector_ms": 0.004631757736206055, "ViewRequirementAgentConnector_ms": 0.21176624298095703}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.57, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 36.0, -64.0, 46.0, 25.0, 38.0, 59.0, 58.0, 54.0, -12.0, -20.0, -64.0, 59.0, -63.0, 43.0, 11.0, 53.0, -64.0, 11.0, -64.0, 59.0, -64.0, -64.0, -2.0, -62.0, 64.0, 64.0, 39.0, -63.0, 14.0, 39.0, 48.0, -15.0, 40.0, 59.0, 58.0, 64.0, -29.0, 54.0, 37.0, -9.0, 59.0, 58.0, 64.0, 58.0, 59.0, -19.0, -21.0, 53.0, 6.0, 49.0, 59.0, 64.0, 7.0, 64.0, -27.0, -17.0, -28.0, 59.0, 58.0, -28.0, 53.0, 12.0, 17.0, 59.0, -28.0, 47.0, 43.0, -64.0, 49.0, 59.0, 58.0, 53.0, -63.0, 53.0, 58.0, 64.0, -9.0, 59.0, 58.0, 64.0, 58.0, 12.0, 17.0, 18.0, -22.0, -64.0, 54.0, 29.0, 52.0, 28.0, 17.0, 48.0, 22.0, -64.0, 59.0, -64.0, 38.0, 37.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2976120374180637, "mean_inference_ms": 9.700849531396294, "mean_action_processing_ms": 0.45408326297536006, "mean_env_wait_ms": 0.28935917575187864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28222227096557617, "StateBufferConnector_ms": 0.004631757736206055, "ViewRequirementAgentConnector_ms": 0.21176624298095703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.005729464567056, "num_agent_steps_trained_throughput_per_sec": 7.005729464567056, "timesteps_total": 70656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 73144.303, "sample_time_ms": 6165.275, "load_time_ms": 0.306, "load_throughput": 1670673.446, "learn_time_ms": 66978.18, "learn_throughput": 7.644, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "done": false, "episodes_total": 4416, "training_iteration": 138, "trial_id": "f4e01_00169", "date": "2024-02-27_02-48-17", "timestamp": 1708998497, "time_this_iter_s": 73.08817386627197, "time_total_s": 9920.312144756317, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9920.312144756317, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 52.377884615384616, "ram_util_percent": 21.322115384615383}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.49, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.667890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.667890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.980079472064972, "policy_loss": 0.2519675082527101, "vf_loss": 7.425996029376984, "vf_explained_var": 0.9472096254428227, "kl": 0.0, "entropy": 123.66655966440837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 71168, "num_env_steps_trained": 71168, "num_agent_steps_sampled": 71168, "num_agent_steps_trained": 71168}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.49, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.49, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.667890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.667890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-15.0, 40.0, 59.0, 58.0, 64.0, -29.0, 54.0, 37.0, -9.0, 59.0, 58.0, 64.0, 58.0, 59.0, -19.0, -21.0, 53.0, 6.0, 49.0, 59.0, 64.0, 7.0, 64.0, -27.0, -17.0, -28.0, 59.0, 58.0, -28.0, 53.0, 12.0, 17.0, 59.0, -28.0, 47.0, 43.0, -64.0, 49.0, 59.0, 58.0, 53.0, -63.0, 53.0, 58.0, 64.0, -9.0, 59.0, 58.0, 64.0, 58.0, 12.0, 17.0, 18.0, -22.0, -64.0, 54.0, 29.0, 52.0, 28.0, 17.0, 48.0, 22.0, -64.0, 59.0, -64.0, 38.0, 37.0, -64.0, -63.0, -63.0, 15.0, -64.0, 58.0, 58.0, 21.0, 58.0, -64.0, 12.0, 49.0, 48.0, 59.0, 59.0, -2.0, -64.0, 53.0, -63.0, 39.0, -24.0, 11.0, 58.0, 39.0, 22.0, 52.0, 58.0, 54.0, 43.0, 64.0, -63.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298036970006795, "mean_inference_ms": 9.702863385090254, "mean_action_processing_ms": 0.45422961377502274, "mean_env_wait_ms": 0.2894532447804272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28380703926086426, "StateBufferConnector_ms": 0.0046617984771728516, "ViewRequirementAgentConnector_ms": 0.2114856243133545}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.49, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-15.0, 40.0, 59.0, 58.0, 64.0, -29.0, 54.0, 37.0, -9.0, 59.0, 58.0, 64.0, 58.0, 59.0, -19.0, -21.0, 53.0, 6.0, 49.0, 59.0, 64.0, 7.0, 64.0, -27.0, -17.0, -28.0, 59.0, 58.0, -28.0, 53.0, 12.0, 17.0, 59.0, -28.0, 47.0, 43.0, -64.0, 49.0, 59.0, 58.0, 53.0, -63.0, 53.0, 58.0, 64.0, -9.0, 59.0, 58.0, 64.0, 58.0, 12.0, 17.0, 18.0, -22.0, -64.0, 54.0, 29.0, 52.0, 28.0, 17.0, 48.0, 22.0, -64.0, 59.0, -64.0, 38.0, 37.0, -64.0, -63.0, -63.0, 15.0, -64.0, 58.0, 58.0, 21.0, 58.0, -64.0, 12.0, 49.0, 48.0, 59.0, 59.0, -2.0, -64.0, 53.0, -63.0, 39.0, -24.0, 11.0, 58.0, 39.0, 22.0, 52.0, 58.0, 54.0, 43.0, 64.0, -63.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298036970006795, "mean_inference_ms": 9.702863385090254, "mean_action_processing_ms": 0.45422961377502274, "mean_env_wait_ms": 0.2894532447804272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28380703926086426, "StateBufferConnector_ms": 0.0046617984771728516, "ViewRequirementAgentConnector_ms": 0.2114856243133545}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71168, "num_agent_steps_trained": 71168, "num_env_steps_sampled": 71168, "num_env_steps_trained": 71168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.931549684887254, "num_agent_steps_trained_throughput_per_sec": 6.931549684887254, "timesteps_total": 71168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 71168, "timers": {"training_iteration_time_ms": 73322.044, "sample_time_ms": 6175.968, "load_time_ms": 0.31, "load_throughput": 1649879.877, "learn_time_ms": 67145.207, "learn_throughput": 7.625, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 71168, "num_env_steps_trained": 71168, "num_agent_steps_sampled": 71168, "num_agent_steps_trained": 71168}, "done": false, "episodes_total": 4448, "training_iteration": 139, "trial_id": "f4e01_00169", "date": "2024-02-27_02-49-31", "timestamp": 1708998571, "time_this_iter_s": 73.8769645690918, "time_total_s": 9994.189109325409, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9994.189109325409, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 52.51634615384615, "ram_util_percent": 21.389423076923077}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.18, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9404040469477574, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.1484585503737135, "policy_loss": 0.018264479360853632, "vf_loss": 9.62811313867569, "vf_explained_var": 0.9721910879015923, "kl": 0.0, "entropy": 124.5446169535319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.18, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -28.0, 47.0, 43.0, -64.0, 49.0, 59.0, 58.0, 53.0, -63.0, 53.0, 58.0, 64.0, -9.0, 59.0, 58.0, 64.0, 58.0, 12.0, 17.0, 18.0, -22.0, -64.0, 54.0, 29.0, 52.0, 28.0, 17.0, 48.0, 22.0, -64.0, 59.0, -64.0, 38.0, 37.0, -64.0, -63.0, -63.0, 15.0, -64.0, 58.0, 58.0, 21.0, 58.0, -64.0, 12.0, 49.0, 48.0, 59.0, 59.0, -2.0, -64.0, 53.0, -63.0, 39.0, -24.0, 11.0, 58.0, 39.0, 22.0, 52.0, 58.0, 54.0, 43.0, 64.0, -63.0, -64.0, 64.0, 47.0, 47.0, -64.0, 32.0, 24.0, 59.0, 42.0, -64.0, 47.0, 54.0, 47.0, -64.0, 59.0, -64.0, 59.0, 54.0, 14.0, 52.0, 49.0, -64.0, 54.0, 59.0, 53.0, 26.0, -64.0, -64.0, 59.0, -64.0, 31.0, 37.0, 58.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2984948674061767, "mean_inference_ms": 9.704880443536213, "mean_action_processing_ms": 0.4543624519924427, "mean_env_wait_ms": 0.28954468776789993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2838726043701172, "StateBufferConnector_ms": 0.004668474197387695, "ViewRequirementAgentConnector_ms": 0.20823454856872559}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -28.0, 47.0, 43.0, -64.0, 49.0, 59.0, 58.0, 53.0, -63.0, 53.0, 58.0, 64.0, -9.0, 59.0, 58.0, 64.0, 58.0, 12.0, 17.0, 18.0, -22.0, -64.0, 54.0, 29.0, 52.0, 28.0, 17.0, 48.0, 22.0, -64.0, 59.0, -64.0, 38.0, 37.0, -64.0, -63.0, -63.0, 15.0, -64.0, 58.0, 58.0, 21.0, 58.0, -64.0, 12.0, 49.0, 48.0, 59.0, 59.0, -2.0, -64.0, 53.0, -63.0, 39.0, -24.0, 11.0, 58.0, 39.0, 22.0, 52.0, 58.0, 54.0, 43.0, 64.0, -63.0, -64.0, 64.0, 47.0, 47.0, -64.0, 32.0, 24.0, 59.0, 42.0, -64.0, 47.0, 54.0, 47.0, -64.0, 59.0, -64.0, 59.0, 54.0, 14.0, 52.0, 49.0, -64.0, 54.0, 59.0, 53.0, 26.0, -64.0, -64.0, 59.0, -64.0, 31.0, 37.0, 58.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2984948674061767, "mean_inference_ms": 9.704880443536213, "mean_action_processing_ms": 0.4543624519924427, "mean_env_wait_ms": 0.28954468776789993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2838726043701172, "StateBufferConnector_ms": 0.004668474197387695, "ViewRequirementAgentConnector_ms": 0.20823454856872559}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.922943426236213, "num_agent_steps_trained_throughput_per_sec": 6.922943426236213, "timesteps_total": 71680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 73465.952, "sample_time_ms": 6200.211, "load_time_ms": 0.311, "load_throughput": 1643943.694, "learn_time_ms": 67264.869, "learn_throughput": 7.612, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "episodes_total": 4480, "training_iteration": 140, "trial_id": "f4e01_00169", "date": "2024-02-27_02-50-45", "timestamp": 1708998645, "time_this_iter_s": 73.9623327255249, "time_total_s": 10068.151442050934, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10068.151442050934, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 53.62761904761904, "ram_util_percent": 21.515238095238093}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.81, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.623515625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.623515625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9212406908472379, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.560339629650116, "policy_loss": 0.1509395077591762, "vf_loss": 8.496030636628468, "vf_explained_var": 0.925454839070638, "kl": 0.0, "entropy": 123.21163228352864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 72192, "num_env_steps_trained": 72192, "num_agent_steps_sampled": 72192, "num_agent_steps_trained": 72192}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.81, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.623515625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.623515625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 38.0, 37.0, -64.0, -63.0, -63.0, 15.0, -64.0, 58.0, 58.0, 21.0, 58.0, -64.0, 12.0, 49.0, 48.0, 59.0, 59.0, -2.0, -64.0, 53.0, -63.0, 39.0, -24.0, 11.0, 58.0, 39.0, 22.0, 52.0, 58.0, 54.0, 43.0, 64.0, -63.0, -64.0, 64.0, 47.0, 47.0, -64.0, 32.0, 24.0, 59.0, 42.0, -64.0, 47.0, 54.0, 47.0, -64.0, 59.0, -64.0, 59.0, 54.0, 14.0, 52.0, 49.0, -64.0, 54.0, 59.0, 53.0, 26.0, -64.0, -64.0, 59.0, -64.0, 31.0, 37.0, 58.0, -64.0, 64.0, 48.0, -64.0, -64.0, 53.0, 58.0, 33.0, -64.0, 64.0, -64.0, 49.0, 53.0, 59.0, 36.0, 48.0, 53.0, 29.0, 53.0, 36.0, -64.0, 58.0, 59.0, 43.0, 53.0, 41.0, -63.0, 48.0, -64.0, 53.0, 48.0, -63.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2989999539953794, "mean_inference_ms": 9.70705272687888, "mean_action_processing_ms": 0.45448719103435936, "mean_env_wait_ms": 0.28963619071246416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.288388729095459, "StateBufferConnector_ms": 0.004748821258544922, "ViewRequirementAgentConnector_ms": 0.20949864387512207}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 38.0, 37.0, -64.0, -63.0, -63.0, 15.0, -64.0, 58.0, 58.0, 21.0, 58.0, -64.0, 12.0, 49.0, 48.0, 59.0, 59.0, -2.0, -64.0, 53.0, -63.0, 39.0, -24.0, 11.0, 58.0, 39.0, 22.0, 52.0, 58.0, 54.0, 43.0, 64.0, -63.0, -64.0, 64.0, 47.0, 47.0, -64.0, 32.0, 24.0, 59.0, 42.0, -64.0, 47.0, 54.0, 47.0, -64.0, 59.0, -64.0, 59.0, 54.0, 14.0, 52.0, 49.0, -64.0, 54.0, 59.0, 53.0, 26.0, -64.0, -64.0, 59.0, -64.0, 31.0, 37.0, 58.0, -64.0, 64.0, 48.0, -64.0, -64.0, 53.0, 58.0, 33.0, -64.0, 64.0, -64.0, 49.0, 53.0, 59.0, 36.0, 48.0, 53.0, 29.0, 53.0, 36.0, -64.0, 58.0, 59.0, 43.0, 53.0, 41.0, -63.0, 48.0, -64.0, 53.0, 48.0, -63.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2989999539953794, "mean_inference_ms": 9.70705272687888, "mean_action_processing_ms": 0.45448719103435936, "mean_env_wait_ms": 0.28963619071246416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.288388729095459, "StateBufferConnector_ms": 0.004748821258544922, "ViewRequirementAgentConnector_ms": 0.20949864387512207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72192, "num_agent_steps_trained": 72192, "num_env_steps_sampled": 72192, "num_env_steps_trained": 72192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.029536635701783, "num_agent_steps_trained_throughput_per_sec": 7.029536635701783, "timesteps_total": 72192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 72192, "timers": {"training_iteration_time_ms": 73462.462, "sample_time_ms": 6189.717, "load_time_ms": 0.313, "load_throughput": 1635430.392, "learn_time_ms": 67271.859, "learn_throughput": 7.611, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 72192, "num_env_steps_trained": 72192, "num_agent_steps_sampled": 72192, "num_agent_steps_trained": 72192}, "done": false, "episodes_total": 4512, "training_iteration": 141, "trial_id": "f4e01_00169", "date": "2024-02-27_02-51-58", "timestamp": 1708998718, "time_this_iter_s": 72.84109210968018, "time_total_s": 10140.992534160614, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10140.992534160614, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 53.25769230769231, "ram_util_percent": 21.442307692307693}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.52, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.668125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.668125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.675322697559992, "policy_loss": 0.054356557914676765, "vf_loss": 7.2577122489611305, "vf_explained_var": 0.950113582611084, "kl": 0.0, "entropy": 124.48953234354654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.52, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.668125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.668125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, -63.0, -64.0, 64.0, 47.0, 47.0, -64.0, 32.0, 24.0, 59.0, 42.0, -64.0, 47.0, 54.0, 47.0, -64.0, 59.0, -64.0, 59.0, 54.0, 14.0, 52.0, 49.0, -64.0, 54.0, 59.0, 53.0, 26.0, -64.0, -64.0, 59.0, -64.0, 31.0, 37.0, 58.0, -64.0, 64.0, 48.0, -64.0, -64.0, 53.0, 58.0, 33.0, -64.0, 64.0, -64.0, 49.0, 53.0, 59.0, 36.0, 48.0, 53.0, 29.0, 53.0, 36.0, -64.0, 58.0, 59.0, 43.0, 53.0, 41.0, -63.0, 48.0, -64.0, 53.0, 48.0, -63.0, 58.0, 46.0, -64.0, -64.0, 52.0, 38.0, 59.0, -63.0, 59.0, 64.0, 64.0, 58.0, 27.0, 53.0, 64.0, 53.0, 53.0, -7.0, 53.0, 36.0, 48.0, 50.0, -63.0, 37.0, 49.0, 48.0, 33.0, 49.0, 39.0, -64.0, 58.0, 53.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299251659663521, "mean_inference_ms": 9.708333088905372, "mean_action_processing_ms": 0.4545449092080893, "mean_env_wait_ms": 0.2896788117442558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.283066987991333, "StateBufferConnector_ms": 0.004666566848754883, "ViewRequirementAgentConnector_ms": 0.19962239265441895}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, -63.0, -64.0, 64.0, 47.0, 47.0, -64.0, 32.0, 24.0, 59.0, 42.0, -64.0, 47.0, 54.0, 47.0, -64.0, 59.0, -64.0, 59.0, 54.0, 14.0, 52.0, 49.0, -64.0, 54.0, 59.0, 53.0, 26.0, -64.0, -64.0, 59.0, -64.0, 31.0, 37.0, 58.0, -64.0, 64.0, 48.0, -64.0, -64.0, 53.0, 58.0, 33.0, -64.0, 64.0, -64.0, 49.0, 53.0, 59.0, 36.0, 48.0, 53.0, 29.0, 53.0, 36.0, -64.0, 58.0, 59.0, 43.0, 53.0, 41.0, -63.0, 48.0, -64.0, 53.0, 48.0, -63.0, 58.0, 46.0, -64.0, -64.0, 52.0, 38.0, 59.0, -63.0, 59.0, 64.0, 64.0, 58.0, 27.0, 53.0, 64.0, 53.0, 53.0, -7.0, 53.0, 36.0, 48.0, 50.0, -63.0, 37.0, 49.0, 48.0, 33.0, 49.0, 39.0, -64.0, 58.0, 53.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299251659663521, "mean_inference_ms": 9.708333088905372, "mean_action_processing_ms": 0.4545449092080893, "mean_env_wait_ms": 0.2896788117442558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.283066987991333, "StateBufferConnector_ms": 0.004666566848754883, "ViewRequirementAgentConnector_ms": 0.19962239265441895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0282055540251935, "num_agent_steps_trained_throughput_per_sec": 7.0282055540251935, "timesteps_total": 72704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 73429.033, "sample_time_ms": 6196.825, "load_time_ms": 0.307, "load_throughput": 1665103.24, "learn_time_ms": 67231.325, "learn_throughput": 7.615, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "done": false, "episodes_total": 4544, "training_iteration": 142, "trial_id": "f4e01_00169", "date": "2024-02-27_02-53-11", "timestamp": 1708998791, "time_this_iter_s": 72.85461735725403, "time_total_s": 10213.847151517868, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10213.847151517868, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 52.50485436893204, "ram_util_percent": 20.921359223300982}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 23.03, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.679921875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.679921875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.887996051708857, "policy_loss": -0.04392125072578589, "vf_loss": 7.7460936864217125, "vf_explained_var": 0.979413524766763, "kl": 0.0, "entropy": 126.86873950958253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 73216, "num_env_steps_trained": 73216, "num_agent_steps_sampled": 73216, "num_agent_steps_trained": 73216}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.03, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 23.03, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.679921875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.679921875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [31.0, 37.0, 58.0, -64.0, 64.0, 48.0, -64.0, -64.0, 53.0, 58.0, 33.0, -64.0, 64.0, -64.0, 49.0, 53.0, 59.0, 36.0, 48.0, 53.0, 29.0, 53.0, 36.0, -64.0, 58.0, 59.0, 43.0, 53.0, 41.0, -63.0, 48.0, -64.0, 53.0, 48.0, -63.0, 58.0, 46.0, -64.0, -64.0, 52.0, 38.0, 59.0, -63.0, 59.0, 64.0, 64.0, 58.0, 27.0, 53.0, 64.0, 53.0, 53.0, -7.0, 53.0, 36.0, 48.0, 50.0, -63.0, 37.0, 49.0, 48.0, 33.0, 49.0, 39.0, -64.0, 58.0, 53.0, 59.0, 59.0, 48.0, 12.0, -64.0, 48.0, 52.0, 58.0, 53.0, 26.0, 42.0, 44.0, -64.0, 47.0, -64.0, 49.0, -64.0, -64.0, 43.0, 37.0, -64.0, 48.0, 54.0, 20.0, 58.0, 59.0, 64.0, 35.0, -64.0, 37.0, -64.0, 48.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994816993197673, "mean_inference_ms": 9.709572910588268, "mean_action_processing_ms": 0.45459755817023123, "mean_env_wait_ms": 0.28972323758275603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28337693214416504, "StateBufferConnector_ms": 0.004630565643310547, "ViewRequirementAgentConnector_ms": 0.19975972175598145}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.03, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.0, 37.0, 58.0, -64.0, 64.0, 48.0, -64.0, -64.0, 53.0, 58.0, 33.0, -64.0, 64.0, -64.0, 49.0, 53.0, 59.0, 36.0, 48.0, 53.0, 29.0, 53.0, 36.0, -64.0, 58.0, 59.0, 43.0, 53.0, 41.0, -63.0, 48.0, -64.0, 53.0, 48.0, -63.0, 58.0, 46.0, -64.0, -64.0, 52.0, 38.0, 59.0, -63.0, 59.0, 64.0, 64.0, 58.0, 27.0, 53.0, 64.0, 53.0, 53.0, -7.0, 53.0, 36.0, 48.0, 50.0, -63.0, 37.0, 49.0, 48.0, 33.0, 49.0, 39.0, -64.0, 58.0, 53.0, 59.0, 59.0, 48.0, 12.0, -64.0, 48.0, 52.0, 58.0, 53.0, 26.0, 42.0, 44.0, -64.0, 47.0, -64.0, 49.0, -64.0, -64.0, 43.0, 37.0, -64.0, 48.0, 54.0, 20.0, 58.0, 59.0, 64.0, 35.0, -64.0, 37.0, -64.0, 48.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994816993197673, "mean_inference_ms": 9.709572910588268, "mean_action_processing_ms": 0.45459755817023123, "mean_env_wait_ms": 0.28972323758275603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28337693214416504, "StateBufferConnector_ms": 0.004630565643310547, "ViewRequirementAgentConnector_ms": 0.19975972175598145}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73216, "num_agent_steps_trained": 73216, "num_env_steps_sampled": 73216, "num_env_steps_trained": 73216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.997202114439921, "num_agent_steps_trained_throughput_per_sec": 6.997202114439921, "timesteps_total": 73216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73216, "timers": {"training_iteration_time_ms": 73323.913, "sample_time_ms": 6203.211, "load_time_ms": 0.306, "load_throughput": 1675757.821, "learn_time_ms": 67119.819, "learn_throughput": 7.628, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 73216, "num_env_steps_trained": 73216, "num_agent_steps_sampled": 73216, "num_agent_steps_trained": 73216}, "done": false, "episodes_total": 4576, "training_iteration": 143, "trial_id": "f4e01_00169", "date": "2024-02-27_02-54-25", "timestamp": 1708998865, "time_this_iter_s": 73.17724442481995, "time_total_s": 10287.024395942688, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10287.024395942688, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 52.44056603773585, "ram_util_percent": 20.933018867924527}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 25.71, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.700859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.700859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8859720539301634, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.193428927659989, "policy_loss": -0.013232468829179804, "vf_loss": 9.748213128248851, "vf_explained_var": 0.954575918118159, "kl": 0.0, "entropy": 126.43786970774333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.71, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 25.71, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.700859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.700859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 48.0, -63.0, 58.0, 46.0, -64.0, -64.0, 52.0, 38.0, 59.0, -63.0, 59.0, 64.0, 64.0, 58.0, 27.0, 53.0, 64.0, 53.0, 53.0, -7.0, 53.0, 36.0, 48.0, 50.0, -63.0, 37.0, 49.0, 48.0, 33.0, 49.0, 39.0, -64.0, 58.0, 53.0, 59.0, 59.0, 48.0, 12.0, -64.0, 48.0, 52.0, 58.0, 53.0, 26.0, 42.0, 44.0, -64.0, 47.0, -64.0, 49.0, -64.0, -64.0, 43.0, 37.0, -64.0, 48.0, 54.0, 20.0, 58.0, 59.0, 64.0, 35.0, -64.0, 37.0, -64.0, 48.0, 48.0, 22.0, 48.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 22.0, 59.0, 59.0, 54.0, 24.0, -64.0, 47.0, 41.0, 53.0, 53.0, 36.0, 64.0, 58.0, 36.0, 48.0, -64.0, 54.0, 32.0, 17.0, 53.0, 46.0, 43.0, 48.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2996991203604622, "mean_inference_ms": 9.710909231355647, "mean_action_processing_ms": 0.45469754525282413, "mean_env_wait_ms": 0.2897774173253723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27996206283569336, "StateBufferConnector_ms": 0.004608154296875, "ViewRequirementAgentConnector_ms": 0.19881677627563477}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.71, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 48.0, -63.0, 58.0, 46.0, -64.0, -64.0, 52.0, 38.0, 59.0, -63.0, 59.0, 64.0, 64.0, 58.0, 27.0, 53.0, 64.0, 53.0, 53.0, -7.0, 53.0, 36.0, 48.0, 50.0, -63.0, 37.0, 49.0, 48.0, 33.0, 49.0, 39.0, -64.0, 58.0, 53.0, 59.0, 59.0, 48.0, 12.0, -64.0, 48.0, 52.0, 58.0, 53.0, 26.0, 42.0, 44.0, -64.0, 47.0, -64.0, 49.0, -64.0, -64.0, 43.0, 37.0, -64.0, 48.0, 54.0, 20.0, 58.0, 59.0, 64.0, 35.0, -64.0, 37.0, -64.0, 48.0, 48.0, 22.0, 48.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 22.0, 59.0, 59.0, 54.0, 24.0, -64.0, 47.0, 41.0, 53.0, 53.0, 36.0, 64.0, 58.0, 36.0, 48.0, -64.0, 54.0, 32.0, 17.0, 53.0, 46.0, 43.0, 48.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2996991203604622, "mean_inference_ms": 9.710909231355647, "mean_action_processing_ms": 0.45469754525282413, "mean_env_wait_ms": 0.2897774173253723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27996206283569336, "StateBufferConnector_ms": 0.004608154296875, "ViewRequirementAgentConnector_ms": 0.19881677627563477}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.93155046795423, "num_agent_steps_trained_throughput_per_sec": 6.93155046795423, "timesteps_total": 73728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 73346.435, "sample_time_ms": 6198.747, "load_time_ms": 0.315, "load_throughput": 1623315.177, "learn_time_ms": 67146.809, "learn_throughput": 7.625, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "episodes_total": 4608, "training_iteration": 144, "trial_id": "f4e01_00169", "date": "2024-02-27_02-55-39", "timestamp": 1708998939, "time_this_iter_s": 73.87030625343323, "time_total_s": 10360.894702196121, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10360.894702196121, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 52.5923076923077, "ram_util_percent": 20.95673076923077}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.2, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9162433435519536, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.02246103088061, "policy_loss": 0.052181886584730816, "vf_loss": 9.376950069268544, "vf_explained_var": 0.9762589767575264, "kl": 0.0, "entropy": 132.9405949274699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.2, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 58.0, 53.0, 59.0, 59.0, 48.0, 12.0, -64.0, 48.0, 52.0, 58.0, 53.0, 26.0, 42.0, 44.0, -64.0, 47.0, -64.0, 49.0, -64.0, -64.0, 43.0, 37.0, -64.0, 48.0, 54.0, 20.0, 58.0, 59.0, 64.0, 35.0, -64.0, 37.0, -64.0, 48.0, 48.0, 22.0, 48.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 22.0, 59.0, 59.0, 54.0, 24.0, -64.0, 47.0, 41.0, 53.0, 53.0, 36.0, 64.0, 58.0, 36.0, 48.0, -64.0, 54.0, 32.0, 17.0, 53.0, 46.0, 43.0, 48.0, 58.0, 46.0, 58.0, 32.0, 34.0, 46.0, -64.0, 32.0, 39.0, 53.0, -64.0, 53.0, -64.0, 48.0, 31.0, -64.0, 58.0, -64.0, 42.0, 52.0, 53.0, -64.0, -64.0, 48.0, 59.0, 59.0, 53.0, -64.0, 48.0, 53.0, 52.0, 20.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2997834779386417, "mean_inference_ms": 9.711532288820004, "mean_action_processing_ms": 0.45475855641491075, "mean_env_wait_ms": 0.2898010518208423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.273029088973999, "StateBufferConnector_ms": 0.004454374313354492, "ViewRequirementAgentConnector_ms": 0.19090628623962402}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 58.0, 53.0, 59.0, 59.0, 48.0, 12.0, -64.0, 48.0, 52.0, 58.0, 53.0, 26.0, 42.0, 44.0, -64.0, 47.0, -64.0, 49.0, -64.0, -64.0, 43.0, 37.0, -64.0, 48.0, 54.0, 20.0, 58.0, 59.0, 64.0, 35.0, -64.0, 37.0, -64.0, 48.0, 48.0, 22.0, 48.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 22.0, 59.0, 59.0, 54.0, 24.0, -64.0, 47.0, 41.0, 53.0, 53.0, 36.0, 64.0, 58.0, 36.0, 48.0, -64.0, 54.0, 32.0, 17.0, 53.0, 46.0, 43.0, 48.0, 58.0, 46.0, 58.0, 32.0, 34.0, 46.0, -64.0, 32.0, 39.0, 53.0, -64.0, 53.0, -64.0, 48.0, 31.0, -64.0, 58.0, -64.0, 42.0, 52.0, 53.0, -64.0, -64.0, 48.0, 59.0, 59.0, 53.0, -64.0, 48.0, 53.0, 52.0, 20.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2997834779386417, "mean_inference_ms": 9.711532288820004, "mean_action_processing_ms": 0.45475855641491075, "mean_env_wait_ms": 0.2898010518208423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.273029088973999, "StateBufferConnector_ms": 0.004454374313354492, "ViewRequirementAgentConnector_ms": 0.19090628623962402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240, "num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.030109594497866, "num_agent_steps_trained_throughput_per_sec": 7.030109594497866, "timesteps_total": 74240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 74240, "timers": {"training_iteration_time_ms": 73271.564, "sample_time_ms": 6168.079, "load_time_ms": 0.313, "load_throughput": 1638300.006, "learn_time_ms": 67102.597, "learn_throughput": 7.63, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240}, "done": false, "episodes_total": 4640, "training_iteration": 145, "trial_id": "f4e01_00169", "date": "2024-02-27_02-56-52", "timestamp": 1708999012, "time_this_iter_s": 72.83488273620605, "time_total_s": 10433.729584932327, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10433.729584932327, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 52.53846153846153, "ram_util_percent": 21.0625}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.43, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.636171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.636171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9760733892520269, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.865494300921758, "policy_loss": 0.04564534454451253, "vf_loss": 9.14068375825882, "vf_explained_var": 0.9893839826186498, "kl": 0.0, "entropy": 135.99374554951984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.43, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.636171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.636171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [37.0, -64.0, 48.0, 48.0, 22.0, 48.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 22.0, 59.0, 59.0, 54.0, 24.0, -64.0, 47.0, 41.0, 53.0, 53.0, 36.0, 64.0, 58.0, 36.0, 48.0, -64.0, 54.0, 32.0, 17.0, 53.0, 46.0, 43.0, 48.0, 58.0, 46.0, 58.0, 32.0, 34.0, 46.0, -64.0, 32.0, 39.0, 53.0, -64.0, 53.0, -64.0, 48.0, 31.0, -64.0, 58.0, -64.0, 42.0, 52.0, 53.0, -64.0, -64.0, 48.0, 59.0, 59.0, 53.0, -64.0, 48.0, 53.0, 52.0, 20.0, 59.0, -64.0, -64.0, 47.0, -64.0, 48.0, 59.0, 59.0, 58.0, -63.0, 16.0, 41.0, -64.0, 18.0, 39.0, 47.0, -64.0, 24.0, 48.0, 64.0, 59.0, -64.0, 59.0, -64.0, -64.0, 53.0, -64.0, 40.0, -64.0, 58.0, 35.0, -64.0, 32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995767941931526, "mean_inference_ms": 9.710723442214931, "mean_action_processing_ms": 0.4547086623750944, "mean_env_wait_ms": 0.2897437061250888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2625560760498047, "StateBufferConnector_ms": 0.004313945770263672, "ViewRequirementAgentConnector_ms": 0.17887091636657715}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, -64.0, 48.0, 48.0, 22.0, 48.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 22.0, 59.0, 59.0, 54.0, 24.0, -64.0, 47.0, 41.0, 53.0, 53.0, 36.0, 64.0, 58.0, 36.0, 48.0, -64.0, 54.0, 32.0, 17.0, 53.0, 46.0, 43.0, 48.0, 58.0, 46.0, 58.0, 32.0, 34.0, 46.0, -64.0, 32.0, 39.0, 53.0, -64.0, 53.0, -64.0, 48.0, 31.0, -64.0, 58.0, -64.0, 42.0, 52.0, 53.0, -64.0, -64.0, 48.0, 59.0, 59.0, 53.0, -64.0, 48.0, 53.0, 52.0, 20.0, 59.0, -64.0, -64.0, 47.0, -64.0, 48.0, 59.0, 59.0, 58.0, -63.0, 16.0, 41.0, -64.0, 18.0, 39.0, 47.0, -64.0, 24.0, 48.0, 64.0, 59.0, -64.0, 59.0, -64.0, -64.0, 53.0, -64.0, 40.0, -64.0, 58.0, 35.0, -64.0, 32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995767941931526, "mean_inference_ms": 9.710723442214931, "mean_action_processing_ms": 0.4547086623750944, "mean_env_wait_ms": 0.2897437061250888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2625560760498047, "StateBufferConnector_ms": 0.004313945770263672, "ViewRequirementAgentConnector_ms": 0.17887091636657715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.026401974346629, "num_agent_steps_trained_throughput_per_sec": 7.026401974346629, "timesteps_total": 74752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 73248.055, "sample_time_ms": 6121.436, "load_time_ms": 0.307, "load_throughput": 1667300.969, "learn_time_ms": 67125.73, "learn_throughput": 7.627, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "done": false, "episodes_total": 4672, "training_iteration": 146, "trial_id": "f4e01_00169", "date": "2024-02-27_02-58-05", "timestamp": 1708999085, "time_this_iter_s": 72.87341952323914, "time_total_s": 10506.603004455566, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10506.603004455566, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 52.27087378640777, "ram_util_percent": 21.143689320388336}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.01, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.664140625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.664140625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8258874216116965, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.940909620126089, "policy_loss": 0.0416823368674765, "vf_loss": 9.265355789661408, "vf_explained_var": 0.960923716922601, "kl": 0.0, "entropy": 130.10330282847087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 75264, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 75264}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.01, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.01, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.664140625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.664140625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [46.0, 43.0, 48.0, 58.0, 46.0, 58.0, 32.0, 34.0, 46.0, -64.0, 32.0, 39.0, 53.0, -64.0, 53.0, -64.0, 48.0, 31.0, -64.0, 58.0, -64.0, 42.0, 52.0, 53.0, -64.0, -64.0, 48.0, 59.0, 59.0, 53.0, -64.0, 48.0, 53.0, 52.0, 20.0, 59.0, -64.0, -64.0, 47.0, -64.0, 48.0, 59.0, 59.0, 58.0, -63.0, 16.0, 41.0, -64.0, 18.0, 39.0, 47.0, -64.0, 24.0, 48.0, 64.0, 59.0, -64.0, 59.0, -64.0, -64.0, 53.0, -64.0, 40.0, -64.0, 58.0, 35.0, -64.0, 32.0, 38.0, 49.0, 58.0, 58.0, 58.0, 54.0, 43.0, 48.0, 42.0, 59.0, 49.0, 46.0, 33.0, 47.0, 48.0, 64.0, 52.0, 46.0, 48.0, -64.0, -64.0, -64.0, 52.0, 43.0, 53.0, 53.0, 59.0, 43.0, 49.0, 59.0, -64.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299381587220232, "mean_inference_ms": 9.710235867839703, "mean_action_processing_ms": 0.4546555470223349, "mean_env_wait_ms": 0.289690326520759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2655320167541504, "StateBufferConnector_ms": 0.004358530044555664, "ViewRequirementAgentConnector_ms": 0.18060541152954102}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.01, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, 43.0, 48.0, 58.0, 46.0, 58.0, 32.0, 34.0, 46.0, -64.0, 32.0, 39.0, 53.0, -64.0, 53.0, -64.0, 48.0, 31.0, -64.0, 58.0, -64.0, 42.0, 52.0, 53.0, -64.0, -64.0, 48.0, 59.0, 59.0, 53.0, -64.0, 48.0, 53.0, 52.0, 20.0, 59.0, -64.0, -64.0, 47.0, -64.0, 48.0, 59.0, 59.0, 58.0, -63.0, 16.0, 41.0, -64.0, 18.0, 39.0, 47.0, -64.0, 24.0, 48.0, 64.0, 59.0, -64.0, 59.0, -64.0, -64.0, 53.0, -64.0, 40.0, -64.0, 58.0, 35.0, -64.0, 32.0, 38.0, 49.0, 58.0, 58.0, 58.0, 54.0, 43.0, 48.0, 42.0, 59.0, 49.0, 46.0, 33.0, 47.0, 48.0, 64.0, 52.0, 46.0, 48.0, -64.0, -64.0, -64.0, 52.0, 43.0, 53.0, 53.0, 59.0, 43.0, 49.0, 59.0, -64.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299381587220232, "mean_inference_ms": 9.710235867839703, "mean_action_processing_ms": 0.4546555470223349, "mean_env_wait_ms": 0.289690326520759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2655320167541504, "StateBufferConnector_ms": 0.004358530044555664, "ViewRequirementAgentConnector_ms": 0.18060541152954102}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 75264, "num_env_steps_sampled": 75264, "num_env_steps_trained": 75264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.961748955333393, "num_agent_steps_trained_throughput_per_sec": 6.961748955333393, "timesteps_total": 75264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 73286.92, "sample_time_ms": 6130.363, "load_time_ms": 0.308, "load_throughput": 1664716.006, "learn_time_ms": 67155.674, "learn_throughput": 7.624, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 75264, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 75264}, "done": false, "episodes_total": 4704, "training_iteration": 147, "trial_id": "f4e01_00169", "date": "2024-02-27_02-59-19", "timestamp": 1708999159, "time_this_iter_s": 73.54989409446716, "time_total_s": 10580.152898550034, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10580.152898550034, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 52.65865384615385, "ram_util_percent": 21.063461538461542}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 24.84, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6940625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6940625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.586562889814377, "policy_loss": 0.03527984997878472, "vf_loss": 7.148267741998037, "vf_explained_var": 0.9580885325868924, "kl": 0.0, "entropy": 135.45362650553386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 24.84, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6940625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6940625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 52.0, 20.0, 59.0, -64.0, -64.0, 47.0, -64.0, 48.0, 59.0, 59.0, 58.0, -63.0, 16.0, 41.0, -64.0, 18.0, 39.0, 47.0, -64.0, 24.0, 48.0, 64.0, 59.0, -64.0, 59.0, -64.0, -64.0, 53.0, -64.0, 40.0, -64.0, 58.0, 35.0, -64.0, 32.0, 38.0, 49.0, 58.0, 58.0, 58.0, 54.0, 43.0, 48.0, 42.0, 59.0, 49.0, 46.0, 33.0, 47.0, 48.0, 64.0, 52.0, 46.0, 48.0, -64.0, -64.0, -64.0, 52.0, 43.0, 53.0, 53.0, 59.0, 43.0, 49.0, 59.0, -64.0, 58.0, 53.0, -64.0, -64.0, 58.0, 64.0, 54.0, 54.0, 44.0, -64.0, 58.0, 48.0, 58.0, 58.0, 53.0, 53.0, 46.0, 53.0, 48.0, 48.0, -64.0, 53.0, 59.0, 48.0, 44.0, 59.0, 52.0, 59.0, 53.0, -64.0, -64.0, 58.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994422510210026, "mean_inference_ms": 9.711266033060829, "mean_action_processing_ms": 0.45466371579663994, "mean_env_wait_ms": 0.2896997576817867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2734675407409668, "StateBufferConnector_ms": 0.004483699798583984, "ViewRequirementAgentConnector_ms": 0.18955111503601074}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 52.0, 20.0, 59.0, -64.0, -64.0, 47.0, -64.0, 48.0, 59.0, 59.0, 58.0, -63.0, 16.0, 41.0, -64.0, 18.0, 39.0, 47.0, -64.0, 24.0, 48.0, 64.0, 59.0, -64.0, 59.0, -64.0, -64.0, 53.0, -64.0, 40.0, -64.0, 58.0, 35.0, -64.0, 32.0, 38.0, 49.0, 58.0, 58.0, 58.0, 54.0, 43.0, 48.0, 42.0, 59.0, 49.0, 46.0, 33.0, 47.0, 48.0, 64.0, 52.0, 46.0, 48.0, -64.0, -64.0, -64.0, 52.0, 43.0, 53.0, 53.0, 59.0, 43.0, 49.0, 59.0, -64.0, 58.0, 53.0, -64.0, -64.0, 58.0, 64.0, 54.0, 54.0, 44.0, -64.0, 58.0, 48.0, 58.0, 58.0, 53.0, 53.0, 46.0, 53.0, 48.0, 48.0, -64.0, 53.0, 59.0, 48.0, 44.0, 59.0, 52.0, 59.0, 53.0, -64.0, -64.0, 58.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994422510210026, "mean_inference_ms": 9.711266033060829, "mean_action_processing_ms": 0.45466371579663994, "mean_env_wait_ms": 0.2896997576817867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2734675407409668, "StateBufferConnector_ms": 0.004483699798583984, "ViewRequirementAgentConnector_ms": 0.18955111503601074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.971997488529402, "num_agent_steps_trained_throughput_per_sec": 6.971997488529402, "timesteps_total": 75776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 73322.278, "sample_time_ms": 6152.168, "load_time_ms": 0.311, "load_throughput": 1647727.805, "learn_time_ms": 67169.202, "learn_throughput": 7.623, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "done": false, "episodes_total": 4736, "training_iteration": 148, "trial_id": "f4e01_00169", "date": "2024-02-27_03-00-32", "timestamp": 1708999232, "time_this_iter_s": 73.44229125976562, "time_total_s": 10653.5951898098, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10653.5951898098, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 53.1548076923077, "ram_util_percent": 21.097115384615385}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 32.07, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.750546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.750546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.876679690678914, "policy_loss": 0.0069008444746335345, "vf_loss": 9.219103753566742, "vf_explained_var": 0.9327738364537557, "kl": 0.0, "entropy": 134.45859858194987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 76288, "num_env_steps_trained": 76288, "num_agent_steps_sampled": 76288, "num_agent_steps_trained": 76288}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 32.07, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 32.07, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.750546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.750546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 35.0, -64.0, 32.0, 38.0, 49.0, 58.0, 58.0, 58.0, 54.0, 43.0, 48.0, 42.0, 59.0, 49.0, 46.0, 33.0, 47.0, 48.0, 64.0, 52.0, 46.0, 48.0, -64.0, -64.0, -64.0, 52.0, 43.0, 53.0, 53.0, 59.0, 43.0, 49.0, 59.0, -64.0, 58.0, 53.0, -64.0, -64.0, 58.0, 64.0, 54.0, 54.0, 44.0, -64.0, 58.0, 48.0, 58.0, 58.0, 53.0, 53.0, 46.0, 53.0, 48.0, 48.0, -64.0, 53.0, 59.0, 48.0, 44.0, 59.0, 52.0, 59.0, 53.0, -64.0, -64.0, 58.0, 59.0, 48.0, 58.0, 53.0, 54.0, -64.0, 64.0, 49.0, -64.0, 58.0, 49.0, 44.0, 58.0, 53.0, 15.0, 43.0, 47.0, 36.0, 52.0, 49.0, -64.0, 52.0, 53.0, 27.0, 48.0, 46.0, 43.0, -64.0, 59.0, 64.0, -64.0, 47.0, 34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994744624765537, "mean_inference_ms": 9.712177476901017, "mean_action_processing_ms": 0.45466424682184736, "mean_env_wait_ms": 0.28970456912422515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.272442102432251, "StateBufferConnector_ms": 0.004446744918823242, "ViewRequirementAgentConnector_ms": 0.18879985809326172}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 32.07, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 35.0, -64.0, 32.0, 38.0, 49.0, 58.0, 58.0, 58.0, 54.0, 43.0, 48.0, 42.0, 59.0, 49.0, 46.0, 33.0, 47.0, 48.0, 64.0, 52.0, 46.0, 48.0, -64.0, -64.0, -64.0, 52.0, 43.0, 53.0, 53.0, 59.0, 43.0, 49.0, 59.0, -64.0, 58.0, 53.0, -64.0, -64.0, 58.0, 64.0, 54.0, 54.0, 44.0, -64.0, 58.0, 48.0, 58.0, 58.0, 53.0, 53.0, 46.0, 53.0, 48.0, 48.0, -64.0, 53.0, 59.0, 48.0, 44.0, 59.0, 52.0, 59.0, 53.0, -64.0, -64.0, 58.0, 59.0, 48.0, 58.0, 53.0, 54.0, -64.0, 64.0, 49.0, -64.0, 58.0, 49.0, 44.0, 58.0, 53.0, 15.0, 43.0, 47.0, 36.0, 52.0, 49.0, -64.0, 52.0, 53.0, 27.0, 48.0, 46.0, 43.0, -64.0, 59.0, 64.0, -64.0, 47.0, 34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994744624765537, "mean_inference_ms": 9.712177476901017, "mean_action_processing_ms": 0.45466424682184736, "mean_env_wait_ms": 0.28970456912422515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.272442102432251, "StateBufferConnector_ms": 0.004446744918823242, "ViewRequirementAgentConnector_ms": 0.18879985809326172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76288, "num_agent_steps_trained": 76288, "num_env_steps_sampled": 76288, "num_env_steps_trained": 76288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.027362161634763, "num_agent_steps_trained_throughput_per_sec": 7.027362161634763, "timesteps_total": 76288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 76288, "timers": {"training_iteration_time_ms": 73221.571, "sample_time_ms": 6091.629, "load_time_ms": 0.308, "load_throughput": 1661238.994, "learn_time_ms": 67129.042, "learn_throughput": 7.627, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 76288, "num_env_steps_trained": 76288, "num_agent_steps_sampled": 76288, "num_agent_steps_trained": 76288}, "done": false, "episodes_total": 4768, "training_iteration": 149, "trial_id": "f4e01_00169", "date": "2024-02-27_03-01-45", "timestamp": 1708999305, "time_this_iter_s": 72.86310338973999, "time_total_s": 10726.45829319954, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10726.45829319954, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 53.255339805825244, "ram_util_percent": 20.985436893203882}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 27.36, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.71375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.71375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.894440964857737, "policy_loss": -0.03635176030220464, "vf_loss": 7.744327549139658, "vf_explained_var": 0.9795403510332108, "kl": 0.0, "entropy": 133.77811635335286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 27.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 27.36, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.71375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.71375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [49.0, 59.0, -64.0, 58.0, 53.0, -64.0, -64.0, 58.0, 64.0, 54.0, 54.0, 44.0, -64.0, 58.0, 48.0, 58.0, 58.0, 53.0, 53.0, 46.0, 53.0, 48.0, 48.0, -64.0, 53.0, 59.0, 48.0, 44.0, 59.0, 52.0, 59.0, 53.0, -64.0, -64.0, 58.0, 59.0, 48.0, 58.0, 53.0, 54.0, -64.0, 64.0, 49.0, -64.0, 58.0, 49.0, 44.0, 58.0, 53.0, 15.0, 43.0, 47.0, 36.0, 52.0, 49.0, -64.0, 52.0, 53.0, 27.0, 48.0, 46.0, 43.0, -64.0, 59.0, 64.0, -64.0, 47.0, 34.0, -64.0, 12.0, 58.0, 53.0, -64.0, 58.0, 53.0, 58.0, -64.0, 49.0, 58.0, 41.0, 48.0, 64.0, 52.0, 64.0, 58.0, 12.0, 64.0, 30.0, 48.0, -2.0, 37.0, -64.0, 54.0, -64.0, 52.0, 2.0, 23.0, -64.0, -64.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994108636796695, "mean_inference_ms": 9.712307935124858, "mean_action_processing_ms": 0.4546301817451736, "mean_env_wait_ms": 0.2896883002017615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27114439010620117, "StateBufferConnector_ms": 0.0044324398040771484, "ViewRequirementAgentConnector_ms": 0.18688368797302246}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 27.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 59.0, -64.0, 58.0, 53.0, -64.0, -64.0, 58.0, 64.0, 54.0, 54.0, 44.0, -64.0, 58.0, 48.0, 58.0, 58.0, 53.0, 53.0, 46.0, 53.0, 48.0, 48.0, -64.0, 53.0, 59.0, 48.0, 44.0, 59.0, 52.0, 59.0, 53.0, -64.0, -64.0, 58.0, 59.0, 48.0, 58.0, 53.0, 54.0, -64.0, 64.0, 49.0, -64.0, 58.0, 49.0, 44.0, 58.0, 53.0, 15.0, 43.0, 47.0, 36.0, 52.0, 49.0, -64.0, 52.0, 53.0, 27.0, 48.0, 46.0, 43.0, -64.0, 59.0, 64.0, -64.0, 47.0, 34.0, -64.0, 12.0, 58.0, 53.0, -64.0, 58.0, 53.0, 58.0, -64.0, 49.0, 58.0, 41.0, 48.0, 64.0, 52.0, 64.0, 58.0, 12.0, 64.0, 30.0, 48.0, -2.0, 37.0, -64.0, 54.0, -64.0, 52.0, 2.0, 23.0, -64.0, -64.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2994108636796695, "mean_inference_ms": 9.712307935124858, "mean_action_processing_ms": 0.4546301817451736, "mean_env_wait_ms": 0.2896883002017615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27114439010620117, "StateBufferConnector_ms": 0.0044324398040771484, "ViewRequirementAgentConnector_ms": 0.18688368797302246}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.01791573969016, "num_agent_steps_trained_throughput_per_sec": 7.01791573969016, "timesteps_total": 76800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 73121.488, "sample_time_ms": 6070.461, "load_time_ms": 0.312, "load_throughput": 1640051.663, "learn_time_ms": 67050.125, "learn_throughput": 7.636, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "episodes_total": 4800, "training_iteration": 150, "trial_id": "f4e01_00169", "date": "2024-02-27_03-02-58", "timestamp": 1708999378, "time_this_iter_s": 72.96139454841614, "time_total_s": 10799.419687747955, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10799.419687747955, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 52.97403846153846, "ram_util_percent": 20.92596153846154}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 24.03, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.687734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.687734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.6320914367834725, "policy_loss": -0.020098072853094586, "vf_loss": 7.306751918792725, "vf_explained_var": 0.985570302605629, "kl": 0.0, "entropy": 135.18204676310222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 77312, "num_env_steps_trained": 77312, "num_agent_steps_sampled": 77312, "num_agent_steps_trained": 77312}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.03, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 24.03, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.687734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.687734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 58.0, 59.0, 48.0, 58.0, 53.0, 54.0, -64.0, 64.0, 49.0, -64.0, 58.0, 49.0, 44.0, 58.0, 53.0, 15.0, 43.0, 47.0, 36.0, 52.0, 49.0, -64.0, 52.0, 53.0, 27.0, 48.0, 46.0, 43.0, -64.0, 59.0, 64.0, -64.0, 47.0, 34.0, -64.0, 12.0, 58.0, 53.0, -64.0, 58.0, 53.0, 58.0, -64.0, 49.0, 58.0, 41.0, 48.0, 64.0, 52.0, 64.0, 58.0, 12.0, 64.0, 30.0, 48.0, -2.0, 37.0, -64.0, 54.0, -64.0, 52.0, 2.0, 23.0, -64.0, -64.0, 43.0, 53.0, 47.0, 58.0, 46.0, 28.0, 49.0, 54.0, 9.0, 59.0, 26.0, -64.0, 19.0, 59.0, 31.0, 54.0, -64.0, 48.0, -64.0, -64.0, 64.0, 37.0, 64.0, 26.0, 23.0, 43.0, 18.0, 52.0, 18.0, -64.0, 40.0, 37.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991633238620013, "mean_inference_ms": 9.711300142453343, "mean_action_processing_ms": 0.4545666683171282, "mean_env_wait_ms": 0.2896427162229516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26675915718078613, "StateBufferConnector_ms": 0.004362344741821289, "ViewRequirementAgentConnector_ms": 0.18371176719665527}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.03, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 58.0, 59.0, 48.0, 58.0, 53.0, 54.0, -64.0, 64.0, 49.0, -64.0, 58.0, 49.0, 44.0, 58.0, 53.0, 15.0, 43.0, 47.0, 36.0, 52.0, 49.0, -64.0, 52.0, 53.0, 27.0, 48.0, 46.0, 43.0, -64.0, 59.0, 64.0, -64.0, 47.0, 34.0, -64.0, 12.0, 58.0, 53.0, -64.0, 58.0, 53.0, 58.0, -64.0, 49.0, 58.0, 41.0, 48.0, 64.0, 52.0, 64.0, 58.0, 12.0, 64.0, 30.0, 48.0, -2.0, 37.0, -64.0, 54.0, -64.0, 52.0, 2.0, 23.0, -64.0, -64.0, 43.0, 53.0, 47.0, 58.0, 46.0, 28.0, 49.0, 54.0, 9.0, 59.0, 26.0, -64.0, 19.0, 59.0, 31.0, 54.0, -64.0, 48.0, -64.0, -64.0, 64.0, 37.0, 64.0, 26.0, 23.0, 43.0, 18.0, 52.0, 18.0, -64.0, 40.0, 37.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991633238620013, "mean_inference_ms": 9.711300142453343, "mean_action_processing_ms": 0.4545666683171282, "mean_env_wait_ms": 0.2896427162229516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26675915718078613, "StateBufferConnector_ms": 0.004362344741821289, "ViewRequirementAgentConnector_ms": 0.18371176719665527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77312, "num_agent_steps_trained": 77312, "num_env_steps_sampled": 77312, "num_env_steps_trained": 77312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.038396401505176, "num_agent_steps_trained_throughput_per_sec": 7.038396401505176, "timesteps_total": 77312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 77312, "timers": {"training_iteration_time_ms": 73112.319, "sample_time_ms": 6052.546, "load_time_ms": 0.305, "load_throughput": 1679952.787, "learn_time_ms": 67058.896, "learn_throughput": 7.635, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 77312, "num_env_steps_trained": 77312, "num_agent_steps_sampled": 77312, "num_agent_steps_trained": 77312}, "done": false, "episodes_total": 4832, "training_iteration": 151, "trial_id": "f4e01_00169", "date": "2024-02-27_03-04-11", "timestamp": 1708999451, "time_this_iter_s": 72.74938559532166, "time_total_s": 10872.169073343277, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10872.169073343277, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 52.935922330097114, "ram_util_percent": 20.878640776699037}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.44, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6675, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6675, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9619209835926692, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.325874916712443, "policy_loss": -0.0022441134477655094, "vf_loss": 9.938975071907043, "vf_explained_var": 0.9528869047760964, "kl": 0.0, "entropy": 134.90611152648927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.44, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6675, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6675, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, -64.0, 47.0, 34.0, -64.0, 12.0, 58.0, 53.0, -64.0, 58.0, 53.0, 58.0, -64.0, 49.0, 58.0, 41.0, 48.0, 64.0, 52.0, 64.0, 58.0, 12.0, 64.0, 30.0, 48.0, -2.0, 37.0, -64.0, 54.0, -64.0, 52.0, 2.0, 23.0, -64.0, -64.0, 43.0, 53.0, 47.0, 58.0, 46.0, 28.0, 49.0, 54.0, 9.0, 59.0, 26.0, -64.0, 19.0, 59.0, 31.0, 54.0, -64.0, 48.0, -64.0, -64.0, 64.0, 37.0, 64.0, 26.0, 23.0, 43.0, 18.0, 52.0, 18.0, -64.0, 40.0, 37.0, 48.0, 27.0, 59.0, 48.0, 42.0, 54.0, 42.0, 59.0, 59.0, -64.0, 59.0, 35.0, 64.0, 58.0, 48.0, -64.0, -64.0, 64.0, -64.0, -64.0, -64.0, 58.0, 59.0, 59.0, -64.0, 64.0, 26.0, 53.0, 59.0, 53.0, 59.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2990912600595863, "mean_inference_ms": 9.711020231462099, "mean_action_processing_ms": 0.4545831114784102, "mean_env_wait_ms": 0.2896514577140435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739431858062744, "StateBufferConnector_ms": 0.004445314407348633, "ViewRequirementAgentConnector_ms": 0.19117021560668945}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, -64.0, 47.0, 34.0, -64.0, 12.0, 58.0, 53.0, -64.0, 58.0, 53.0, 58.0, -64.0, 49.0, 58.0, 41.0, 48.0, 64.0, 52.0, 64.0, 58.0, 12.0, 64.0, 30.0, 48.0, -2.0, 37.0, -64.0, 54.0, -64.0, 52.0, 2.0, 23.0, -64.0, -64.0, 43.0, 53.0, 47.0, 58.0, 46.0, 28.0, 49.0, 54.0, 9.0, 59.0, 26.0, -64.0, 19.0, 59.0, 31.0, 54.0, -64.0, 48.0, -64.0, -64.0, 64.0, 37.0, 64.0, 26.0, 23.0, 43.0, 18.0, 52.0, 18.0, -64.0, 40.0, 37.0, 48.0, 27.0, 59.0, 48.0, 42.0, 54.0, 42.0, 59.0, 59.0, -64.0, 59.0, 35.0, 64.0, 58.0, 48.0, -64.0, -64.0, 64.0, -64.0, -64.0, -64.0, 58.0, 59.0, 59.0, -64.0, 64.0, 26.0, 53.0, 59.0, 53.0, 59.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2990912600595863, "mean_inference_ms": 9.711020231462099, "mean_action_processing_ms": 0.4545831114784102, "mean_env_wait_ms": 0.2896514577140435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739431858062744, "StateBufferConnector_ms": 0.004445314407348633, "ViewRequirementAgentConnector_ms": 0.19117021560668945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.141362961197761, "num_agent_steps_trained_throughput_per_sec": 7.141362961197761, "timesteps_total": 77824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 72996.888, "sample_time_ms": 6055.281, "load_time_ms": 0.313, "load_throughput": 1636676.814, "learn_time_ms": 66940.711, "learn_throughput": 7.649, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "episodes_total": 4864, "training_iteration": 152, "trial_id": "f4e01_00169", "date": "2024-02-27_03-05-23", "timestamp": 1708999523, "time_this_iter_s": 71.70030117034912, "time_total_s": 10943.869374513626, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10943.869374513626, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 53.38431372549017, "ram_util_percent": 20.78921568627452}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.18, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.2283472637335455, "policy_loss": 0.046489872969686985, "vf_loss": 6.568045973777771, "vf_explained_var": 0.9548783719539642, "kl": 0.0, "entropy": 137.53954633076987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 78336, "num_env_steps_trained": 78336, "num_agent_steps_sampled": 78336, "num_agent_steps_trained": 78336}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.18, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [23.0, -64.0, -64.0, 43.0, 53.0, 47.0, 58.0, 46.0, 28.0, 49.0, 54.0, 9.0, 59.0, 26.0, -64.0, 19.0, 59.0, 31.0, 54.0, -64.0, 48.0, -64.0, -64.0, 64.0, 37.0, 64.0, 26.0, 23.0, 43.0, 18.0, 52.0, 18.0, -64.0, 40.0, 37.0, 48.0, 27.0, 59.0, 48.0, 42.0, 54.0, 42.0, 59.0, 59.0, -64.0, 59.0, 35.0, 64.0, 58.0, 48.0, -64.0, -64.0, 64.0, -64.0, -64.0, -64.0, 58.0, 59.0, 59.0, -64.0, 64.0, 26.0, 53.0, 59.0, 53.0, 59.0, -64.0, -64.0, 59.0, 58.0, -64.0, 54.0, -64.0, 38.0, -64.0, 48.0, 37.0, 53.0, 47.0, 48.0, 48.0, -64.0, 38.0, 24.0, -64.0, 26.0, 48.0, 64.0, 64.0, 43.0, 58.0, 38.0, 59.0, 52.0, 58.0, 54.0, 58.0, 27.0, 41.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995762580086956, "mean_inference_ms": 9.710906601714019, "mean_action_processing_ms": 0.4546044469116805, "mean_env_wait_ms": 0.28966771704771815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27333545684814453, "StateBufferConnector_ms": 0.0044612884521484375, "ViewRequirementAgentConnector_ms": 0.19276690483093262}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.0, -64.0, -64.0, 43.0, 53.0, 47.0, 58.0, 46.0, 28.0, 49.0, 54.0, 9.0, 59.0, 26.0, -64.0, 19.0, 59.0, 31.0, 54.0, -64.0, 48.0, -64.0, -64.0, 64.0, 37.0, 64.0, 26.0, 23.0, 43.0, 18.0, 52.0, 18.0, -64.0, 40.0, 37.0, 48.0, 27.0, 59.0, 48.0, 42.0, 54.0, 42.0, 59.0, 59.0, -64.0, 59.0, 35.0, 64.0, 58.0, 48.0, -64.0, -64.0, 64.0, -64.0, -64.0, -64.0, 58.0, 59.0, 59.0, -64.0, 64.0, 26.0, 53.0, 59.0, 53.0, 59.0, -64.0, -64.0, 59.0, 58.0, -64.0, 54.0, -64.0, 38.0, -64.0, 48.0, 37.0, 53.0, 47.0, 48.0, 48.0, -64.0, 38.0, 24.0, -64.0, 26.0, 48.0, 64.0, 64.0, 43.0, 58.0, 38.0, 59.0, 52.0, 58.0, 54.0, 58.0, 27.0, 41.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995762580086956, "mean_inference_ms": 9.710906601714019, "mean_action_processing_ms": 0.4546044469116805, "mean_env_wait_ms": 0.28966771704771815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27333545684814453, "StateBufferConnector_ms": 0.0044612884521484375, "ViewRequirementAgentConnector_ms": 0.19276690483093262}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78336, "num_agent_steps_trained": 78336, "num_env_steps_sampled": 78336, "num_env_steps_trained": 78336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.163105255356673, "num_agent_steps_trained_throughput_per_sec": 7.163105255356673, "timesteps_total": 78336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 78336, "timers": {"training_iteration_time_ms": 72827.418, "sample_time_ms": 6047.801, "load_time_ms": 0.313, "load_throughput": 1636427.378, "learn_time_ms": 66778.729, "learn_throughput": 7.667, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 78336, "num_env_steps_trained": 78336, "num_agent_steps_sampled": 78336, "num_agent_steps_trained": 78336}, "done": false, "episodes_total": 4896, "training_iteration": 153, "trial_id": "f4e01_00169", "date": "2024-02-27_03-06-35", "timestamp": 1708999595, "time_this_iter_s": 71.48260760307312, "time_total_s": 11015.3519821167, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11015.3519821167, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 52.71287128712871, "ram_util_percent": 20.851485148514858}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.42, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.65171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.65171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9833266427119572, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.55906654993693, "policy_loss": 0.001390655020562311, "vf_loss": 8.72891331911087, "vf_explained_var": 0.9468992526332537, "kl": 0.0, "entropy": 138.1838675181071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.42, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.42, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.65171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.65171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 40.0, 37.0, 48.0, 27.0, 59.0, 48.0, 42.0, 54.0, 42.0, 59.0, 59.0, -64.0, 59.0, 35.0, 64.0, 58.0, 48.0, -64.0, -64.0, 64.0, -64.0, -64.0, -64.0, 58.0, 59.0, 59.0, -64.0, 64.0, 26.0, 53.0, 59.0, 53.0, 59.0, -64.0, -64.0, 59.0, 58.0, -64.0, 54.0, -64.0, 38.0, -64.0, 48.0, 37.0, 53.0, 47.0, 48.0, 48.0, -64.0, 38.0, 24.0, -64.0, 26.0, 48.0, 64.0, 64.0, 43.0, 58.0, 38.0, 59.0, 52.0, 58.0, 54.0, 58.0, 27.0, 41.0, -64.0, 43.0, 46.0, 58.0, 53.0, 9.0, 54.0, -64.0, 58.0, 52.0, -64.0, 31.0, -64.0, 54.0, 53.0, -64.0, -63.0, 58.0, -64.0, 58.0, -64.0, 16.0, 27.0, -64.0, -64.0, -64.0, 59.0, 59.0, 44.0, 64.0, 43.0, 42.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3000256753446622, "mean_inference_ms": 9.710614266170214, "mean_action_processing_ms": 0.4546087047276586, "mean_env_wait_ms": 0.2896752397542422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27161216735839844, "StateBufferConnector_ms": 0.0044384002685546875, "ViewRequirementAgentConnector_ms": 0.18934893608093262}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.42, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 40.0, 37.0, 48.0, 27.0, 59.0, 48.0, 42.0, 54.0, 42.0, 59.0, 59.0, -64.0, 59.0, 35.0, 64.0, 58.0, 48.0, -64.0, -64.0, 64.0, -64.0, -64.0, -64.0, 58.0, 59.0, 59.0, -64.0, 64.0, 26.0, 53.0, 59.0, 53.0, 59.0, -64.0, -64.0, 59.0, 58.0, -64.0, 54.0, -64.0, 38.0, -64.0, 48.0, 37.0, 53.0, 47.0, 48.0, 48.0, -64.0, 38.0, 24.0, -64.0, 26.0, 48.0, 64.0, 64.0, 43.0, 58.0, 38.0, 59.0, 52.0, 58.0, 54.0, 58.0, 27.0, 41.0, -64.0, 43.0, 46.0, 58.0, 53.0, 9.0, 54.0, -64.0, 58.0, 52.0, -64.0, 31.0, -64.0, 54.0, 53.0, -64.0, -63.0, 58.0, -64.0, 58.0, -64.0, 16.0, 27.0, -64.0, -64.0, -64.0, 59.0, 59.0, 44.0, 64.0, 43.0, 42.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3000256753446622, "mean_inference_ms": 9.710614266170214, "mean_action_processing_ms": 0.4546087047276586, "mean_env_wait_ms": 0.2896752397542422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27161216735839844, "StateBufferConnector_ms": 0.0044384002685546875, "ViewRequirementAgentConnector_ms": 0.18934893608093262}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.136225392524877, "num_agent_steps_trained_throughput_per_sec": 7.136225392524877, "timesteps_total": 78848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 72615.562, "sample_time_ms": 6019.4, "load_time_ms": 0.305, "load_throughput": 1677852.682, "learn_time_ms": 66595.274, "learn_throughput": 7.688, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "done": false, "episodes_total": 4928, "training_iteration": 154, "trial_id": "f4e01_00169", "date": "2024-02-27_03-07-46", "timestamp": 1708999666, "time_this_iter_s": 71.75203084945679, "time_total_s": 11087.104012966156, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11087.104012966156, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 53.227450980392156, "ram_util_percent": 20.897058823529413}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.44, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6753125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6753125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.706669692198435, "policy_loss": 0.044794171062919004, "vf_loss": 7.321964848041534, "vf_explained_var": 0.9638968840241432, "kl": 0.0, "entropy": 140.86090062459309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.44, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6753125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6753125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 59.0, -64.0, -64.0, 59.0, 58.0, -64.0, 54.0, -64.0, 38.0, -64.0, 48.0, 37.0, 53.0, 47.0, 48.0, 48.0, -64.0, 38.0, 24.0, -64.0, 26.0, 48.0, 64.0, 64.0, 43.0, 58.0, 38.0, 59.0, 52.0, 58.0, 54.0, 58.0, 27.0, 41.0, -64.0, 43.0, 46.0, 58.0, 53.0, 9.0, 54.0, -64.0, 58.0, 52.0, -64.0, 31.0, -64.0, 54.0, 53.0, -64.0, -63.0, 58.0, -64.0, 58.0, -64.0, 16.0, 27.0, -64.0, -64.0, -64.0, 59.0, 59.0, 44.0, 64.0, 43.0, 42.0, 49.0, 59.0, 59.0, 13.0, -64.0, -64.0, -64.0, 27.0, 58.0, 58.0, 27.0, 64.0, 59.0, -64.0, 58.0, 13.0, 59.0, 46.0, 64.0, 59.0, 59.0, 64.0, 7.0, 23.0, 42.0, -64.0, 64.0, 58.0, 51.0, 59.0, 64.0, 64.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3004941654620443, "mean_inference_ms": 9.710575967403933, "mean_action_processing_ms": 0.454629706756825, "mean_env_wait_ms": 0.2896907783920026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2718510627746582, "StateBufferConnector_ms": 0.004455089569091797, "ViewRequirementAgentConnector_ms": 0.19132685661315918}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 59.0, -64.0, -64.0, 59.0, 58.0, -64.0, 54.0, -64.0, 38.0, -64.0, 48.0, 37.0, 53.0, 47.0, 48.0, 48.0, -64.0, 38.0, 24.0, -64.0, 26.0, 48.0, 64.0, 64.0, 43.0, 58.0, 38.0, 59.0, 52.0, 58.0, 54.0, 58.0, 27.0, 41.0, -64.0, 43.0, 46.0, 58.0, 53.0, 9.0, 54.0, -64.0, 58.0, 52.0, -64.0, 31.0, -64.0, 54.0, 53.0, -64.0, -63.0, 58.0, -64.0, 58.0, -64.0, 16.0, 27.0, -64.0, -64.0, -64.0, 59.0, 59.0, 44.0, 64.0, 43.0, 42.0, 49.0, 59.0, 59.0, 13.0, -64.0, -64.0, -64.0, 27.0, 58.0, 58.0, 27.0, 64.0, 59.0, -64.0, 58.0, 13.0, 59.0, 46.0, 64.0, 59.0, 59.0, 64.0, 7.0, 23.0, 42.0, -64.0, 64.0, 58.0, 51.0, 59.0, 64.0, 64.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3004941654620443, "mean_inference_ms": 9.710575967403933, "mean_action_processing_ms": 0.454629706756825, "mean_env_wait_ms": 0.2896907783920026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2718510627746582, "StateBufferConnector_ms": 0.004455089569091797, "ViewRequirementAgentConnector_ms": 0.19132685661315918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360, "num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.050133954878313, "num_agent_steps_trained_throughput_per_sec": 7.050133954878313, "timesteps_total": 79360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 79360, "timers": {"training_iteration_time_ms": 72594.875, "sample_time_ms": 6047.969, "load_time_ms": 0.302, "load_throughput": 1694534.56, "learn_time_ms": 66546.016, "learn_throughput": 7.694, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360}, "done": false, "episodes_total": 4960, "training_iteration": 155, "trial_id": "f4e01_00169", "date": "2024-02-27_03-08-59", "timestamp": 1708999739, "time_this_iter_s": 72.62897372245789, "time_total_s": 11159.732986688614, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11159.732986688614, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 52.63106796116505, "ram_util_percent": 21.11844660194175}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.98, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64828125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64828125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.965059252580007, "policy_loss": -0.02352305150901278, "vf_loss": 7.835092047850291, "vf_explained_var": 0.9677535484234492, "kl": 0.0, "entropy": 140.3061180114746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.98, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64828125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64828125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 27.0, 41.0, -64.0, 43.0, 46.0, 58.0, 53.0, 9.0, 54.0, -64.0, 58.0, 52.0, -64.0, 31.0, -64.0, 54.0, 53.0, -64.0, -63.0, 58.0, -64.0, 58.0, -64.0, 16.0, 27.0, -64.0, -64.0, -64.0, 59.0, 59.0, 44.0, 64.0, 43.0, 42.0, 49.0, 59.0, 59.0, 13.0, -64.0, -64.0, -64.0, 27.0, 58.0, 58.0, 27.0, 64.0, 59.0, -64.0, 58.0, 13.0, 59.0, 46.0, 64.0, 59.0, 59.0, 64.0, 7.0, 23.0, 42.0, -64.0, 64.0, 58.0, 51.0, 59.0, 64.0, 64.0, 53.0, 36.0, 0.0, 32.0, -64.0, 59.0, 53.0, 27.0, 49.0, -2.0, 53.0, 42.0, -64.0, 58.0, -64.0, 53.0, 64.0, -64.0, 25.0, 28.0, 52.0, 37.0, -64.0, -64.0, 58.0, 3.0, 10.0, 59.0, 59.0, 58.0, -64.0, -64.0, 33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300418883831063, "mean_inference_ms": 9.71009951213157, "mean_action_processing_ms": 0.4546264700313779, "mean_env_wait_ms": 0.2896820880548133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2708914279937744, "StateBufferConnector_ms": 0.004392385482788086, "ViewRequirementAgentConnector_ms": 0.18803668022155762}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 27.0, 41.0, -64.0, 43.0, 46.0, 58.0, 53.0, 9.0, 54.0, -64.0, 58.0, 52.0, -64.0, 31.0, -64.0, 54.0, 53.0, -64.0, -63.0, 58.0, -64.0, 58.0, -64.0, 16.0, 27.0, -64.0, -64.0, -64.0, 59.0, 59.0, 44.0, 64.0, 43.0, 42.0, 49.0, 59.0, 59.0, 13.0, -64.0, -64.0, -64.0, 27.0, 58.0, 58.0, 27.0, 64.0, 59.0, -64.0, 58.0, 13.0, 59.0, 46.0, 64.0, 59.0, 59.0, 64.0, 7.0, 23.0, 42.0, -64.0, 64.0, 58.0, 51.0, 59.0, 64.0, 64.0, 53.0, 36.0, 0.0, 32.0, -64.0, 59.0, 53.0, 27.0, 49.0, -2.0, 53.0, 42.0, -64.0, 58.0, -64.0, 53.0, 64.0, -64.0, 25.0, 28.0, 52.0, 37.0, -64.0, -64.0, 58.0, 3.0, 10.0, 59.0, 59.0, 58.0, -64.0, -64.0, 33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300418883831063, "mean_inference_ms": 9.71009951213157, "mean_action_processing_ms": 0.4546264700313779, "mean_env_wait_ms": 0.2896820880548133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2708914279937744, "StateBufferConnector_ms": 0.004392385482788086, "ViewRequirementAgentConnector_ms": 0.18803668022155762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.079468437748766, "num_agent_steps_trained_throughput_per_sec": 7.079468437748766, "timesteps_total": 79872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 72540.256, "sample_time_ms": 6060.896, "load_time_ms": 0.302, "load_throughput": 1693866.263, "learn_time_ms": 66478.49, "learn_throughput": 7.702, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "done": false, "episodes_total": 4992, "training_iteration": 156, "trial_id": "f4e01_00169", "date": "2024-02-27_03-10-11", "timestamp": 1708999811, "time_this_iter_s": 72.32705163955688, "time_total_s": 11232.06003832817, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11232.06003832817, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 53.248543689320385, "ram_util_percent": 20.910679611650487}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 25.57, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.699765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.699765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.694993251562119, "policy_loss": 0.000813947160107394, "vf_loss": 8.94330627520879, "vf_explained_var": 0.9605080539981524, "kl": 0.0, "entropy": 139.1086284637451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 80384, "num_env_steps_trained": 80384, "num_agent_steps_sampled": 80384, "num_agent_steps_trained": 80384}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.57, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 25.57, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.699765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.699765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, 43.0, 42.0, 49.0, 59.0, 59.0, 13.0, -64.0, -64.0, -64.0, 27.0, 58.0, 58.0, 27.0, 64.0, 59.0, -64.0, 58.0, 13.0, 59.0, 46.0, 64.0, 59.0, 59.0, 64.0, 7.0, 23.0, 42.0, -64.0, 64.0, 58.0, 51.0, 59.0, 64.0, 64.0, 53.0, 36.0, 0.0, 32.0, -64.0, 59.0, 53.0, 27.0, 49.0, -2.0, 53.0, 42.0, -64.0, 58.0, -64.0, 53.0, 64.0, -64.0, 25.0, 28.0, 52.0, 37.0, -64.0, -64.0, 58.0, 3.0, 10.0, 59.0, 59.0, 58.0, -64.0, -64.0, 33.0, 58.0, 53.0, -64.0, 58.0, 58.0, 47.0, 64.0, 59.0, 59.0, 53.0, 35.0, 58.0, 38.0, 64.0, 12.0, 21.0, 53.0, -64.0, 9.0, 30.0, 47.0, 16.0, 52.0, 49.0, 35.0, 16.0, -64.0, 17.0, -64.0, 33.0, 53.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3004001699570338, "mean_inference_ms": 9.71020592180614, "mean_action_processing_ms": 0.4546604722089062, "mean_env_wait_ms": 0.2897024332212069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739887237548828, "StateBufferConnector_ms": 0.0044858455657958984, "ViewRequirementAgentConnector_ms": 0.19614386558532715}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.57, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 43.0, 42.0, 49.0, 59.0, 59.0, 13.0, -64.0, -64.0, -64.0, 27.0, 58.0, 58.0, 27.0, 64.0, 59.0, -64.0, 58.0, 13.0, 59.0, 46.0, 64.0, 59.0, 59.0, 64.0, 7.0, 23.0, 42.0, -64.0, 64.0, 58.0, 51.0, 59.0, 64.0, 64.0, 53.0, 36.0, 0.0, 32.0, -64.0, 59.0, 53.0, 27.0, 49.0, -2.0, 53.0, 42.0, -64.0, 58.0, -64.0, 53.0, 64.0, -64.0, 25.0, 28.0, 52.0, 37.0, -64.0, -64.0, 58.0, 3.0, 10.0, 59.0, 59.0, 58.0, -64.0, -64.0, 33.0, 58.0, 53.0, -64.0, 58.0, 58.0, 47.0, 64.0, 59.0, 59.0, 53.0, 35.0, 58.0, 38.0, 64.0, 12.0, 21.0, 53.0, -64.0, 9.0, 30.0, 47.0, 16.0, 52.0, 49.0, 35.0, 16.0, -64.0, 17.0, -64.0, 33.0, 53.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3004001699570338, "mean_inference_ms": 9.71020592180614, "mean_action_processing_ms": 0.4546604722089062, "mean_env_wait_ms": 0.2897024332212069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739887237548828, "StateBufferConnector_ms": 0.0044858455657958984, "ViewRequirementAgentConnector_ms": 0.19614386558532715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80384, "num_agent_steps_trained": 80384, "num_env_steps_sampled": 80384, "num_env_steps_trained": 80384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.95287288419796, "num_agent_steps_trained_throughput_per_sec": 6.95287288419796, "timesteps_total": 80384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 80384, "timers": {"training_iteration_time_ms": 72549.644, "sample_time_ms": 6045.066, "load_time_ms": 0.297, "load_throughput": 1725302.2, "learn_time_ms": 66503.729, "learn_throughput": 7.699, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 80384, "num_env_steps_trained": 80384, "num_agent_steps_sampled": 80384, "num_agent_steps_trained": 80384}, "done": false, "episodes_total": 5024, "training_iteration": 157, "trial_id": "f4e01_00169", "date": "2024-02-27_03-11-25", "timestamp": 1708999885, "time_this_iter_s": 73.64378476142883, "time_total_s": 11305.7038230896, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11305.7038230896, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 53.67980769230769, "ram_util_percent": 20.971153846153847}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.5, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.54086156686147, "policy_loss": -0.05023680568362276, "vf_loss": 7.2108018358548485, "vf_explained_var": 0.988415486117204, "kl": 0.0, "entropy": 138.95548922220866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.5, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 64.0, 64.0, 53.0, 36.0, 0.0, 32.0, -64.0, 59.0, 53.0, 27.0, 49.0, -2.0, 53.0, 42.0, -64.0, 58.0, -64.0, 53.0, 64.0, -64.0, 25.0, 28.0, 52.0, 37.0, -64.0, -64.0, 58.0, 3.0, 10.0, 59.0, 59.0, 58.0, -64.0, -64.0, 33.0, 58.0, 53.0, -64.0, 58.0, 58.0, 47.0, 64.0, 59.0, 59.0, 53.0, 35.0, 58.0, 38.0, 64.0, 12.0, 21.0, 53.0, -64.0, 9.0, 30.0, 47.0, 16.0, 52.0, 49.0, 35.0, 16.0, -64.0, 17.0, -64.0, 33.0, 53.0, 23.0, 53.0, -64.0, -64.0, 58.0, 14.0, -64.0, 48.0, 37.0, 59.0, 58.0, 12.0, 15.0, 53.0, -64.0, 28.0, 58.0, 53.0, 59.0, 53.0, 59.0, 38.0, 49.0, -64.0, -64.0, 53.0, -64.0, 53.0, 35.0, 58.0, 0.0, 43.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300463599871634, "mean_inference_ms": 9.7105570168013, "mean_action_processing_ms": 0.4546974524433635, "mean_env_wait_ms": 0.2897334167561285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27617573738098145, "StateBufferConnector_ms": 0.004549741744995117, "ViewRequirementAgentConnector_ms": 0.20038819313049316}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 64.0, 64.0, 53.0, 36.0, 0.0, 32.0, -64.0, 59.0, 53.0, 27.0, 49.0, -2.0, 53.0, 42.0, -64.0, 58.0, -64.0, 53.0, 64.0, -64.0, 25.0, 28.0, 52.0, 37.0, -64.0, -64.0, 58.0, 3.0, 10.0, 59.0, 59.0, 58.0, -64.0, -64.0, 33.0, 58.0, 53.0, -64.0, 58.0, 58.0, 47.0, 64.0, 59.0, 59.0, 53.0, 35.0, 58.0, 38.0, 64.0, 12.0, 21.0, 53.0, -64.0, 9.0, 30.0, 47.0, 16.0, 52.0, 49.0, 35.0, 16.0, -64.0, 17.0, -64.0, 33.0, 53.0, 23.0, 53.0, -64.0, -64.0, 58.0, 14.0, -64.0, 48.0, 37.0, 59.0, 58.0, 12.0, 15.0, 53.0, -64.0, 28.0, 58.0, 53.0, 59.0, 53.0, 59.0, 38.0, 49.0, -64.0, -64.0, 53.0, -64.0, 53.0, 35.0, 58.0, 0.0, 43.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300463599871634, "mean_inference_ms": 9.7105570168013, "mean_action_processing_ms": 0.4546974524433635, "mean_env_wait_ms": 0.2897334167561285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27617573738098145, "StateBufferConnector_ms": 0.004549741744995117, "ViewRequirementAgentConnector_ms": 0.20038819313049316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.981243792416052, "num_agent_steps_trained_throughput_per_sec": 6.981243792416052, "timesteps_total": 80896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 72539.919, "sample_time_ms": 6030.625, "load_time_ms": 0.294, "load_throughput": 1742238.884, "learn_time_ms": 66508.469, "learn_throughput": 7.698, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "done": false, "episodes_total": 5056, "training_iteration": 158, "trial_id": "f4e01_00169", "date": "2024-02-27_03-12-38", "timestamp": 1708999958, "time_this_iter_s": 73.34455966949463, "time_total_s": 11379.048382759094, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11379.048382759094, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 52.659615384615385, "ram_util_percent": 20.920192307692307}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.78, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.66234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.66234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.8110197921593985, "policy_loss": -0.024746473176249614, "vf_loss": 7.595078452428182, "vf_explained_var": 0.9688980738321941, "kl": 0.0, "entropy": 142.520054880778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 81408, "num_env_steps_trained": 81408, "num_agent_steps_sampled": 81408, "num_agent_steps_trained": 81408}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.78, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.66234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.66234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, -64.0, -64.0, 33.0, 58.0, 53.0, -64.0, 58.0, 58.0, 47.0, 64.0, 59.0, 59.0, 53.0, 35.0, 58.0, 38.0, 64.0, 12.0, 21.0, 53.0, -64.0, 9.0, 30.0, 47.0, 16.0, 52.0, 49.0, 35.0, 16.0, -64.0, 17.0, -64.0, 33.0, 53.0, 23.0, 53.0, -64.0, -64.0, 58.0, 14.0, -64.0, 48.0, 37.0, 59.0, 58.0, 12.0, 15.0, 53.0, -64.0, 28.0, 58.0, 53.0, 59.0, 53.0, 59.0, 38.0, 49.0, -64.0, -64.0, 53.0, -64.0, 53.0, 35.0, 58.0, 0.0, 43.0, 64.0, 53.0, -64.0, -64.0, 37.0, -64.0, 59.0, -64.0, 38.0, -64.0, 38.0, 38.0, 53.0, 52.0, 21.0, 58.0, 47.0, 43.0, -64.0, 59.0, 58.0, 54.0, 58.0, 26.0, 18.0, 17.0, 53.0, 45.0, 58.0, -64.0, 19.0, 49.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3006733483658044, "mean_inference_ms": 9.71158348038572, "mean_action_processing_ms": 0.4547834177029568, "mean_env_wait_ms": 0.28980525489757564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28064918518066406, "StateBufferConnector_ms": 0.0046329498291015625, "ViewRequirementAgentConnector_ms": 0.20909547805786133}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, -64.0, -64.0, 33.0, 58.0, 53.0, -64.0, 58.0, 58.0, 47.0, 64.0, 59.0, 59.0, 53.0, 35.0, 58.0, 38.0, 64.0, 12.0, 21.0, 53.0, -64.0, 9.0, 30.0, 47.0, 16.0, 52.0, 49.0, 35.0, 16.0, -64.0, 17.0, -64.0, 33.0, 53.0, 23.0, 53.0, -64.0, -64.0, 58.0, 14.0, -64.0, 48.0, 37.0, 59.0, 58.0, 12.0, 15.0, 53.0, -64.0, 28.0, 58.0, 53.0, 59.0, 53.0, 59.0, 38.0, 49.0, -64.0, -64.0, 53.0, -64.0, 53.0, 35.0, 58.0, 0.0, 43.0, 64.0, 53.0, -64.0, -64.0, 37.0, -64.0, 59.0, -64.0, 38.0, -64.0, 38.0, 38.0, 53.0, 52.0, 21.0, 58.0, 47.0, 43.0, -64.0, 59.0, 58.0, 54.0, 58.0, 26.0, 18.0, 17.0, 53.0, 45.0, 58.0, -64.0, 19.0, 49.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3006733483658044, "mean_inference_ms": 9.71158348038572, "mean_action_processing_ms": 0.4547834177029568, "mean_env_wait_ms": 0.28980525489757564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28064918518066406, "StateBufferConnector_ms": 0.0046329498291015625, "ViewRequirementAgentConnector_ms": 0.20909547805786133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81408, "num_agent_steps_trained": 81408, "num_env_steps_sampled": 81408, "num_env_steps_trained": 81408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.077587277705504, "num_agent_steps_trained_throughput_per_sec": 7.077587277705504, "timesteps_total": 81408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81408, "timers": {"training_iteration_time_ms": 72488.216, "sample_time_ms": 6073.039, "load_time_ms": 0.299, "load_throughput": 1711142.349, "learn_time_ms": 66414.344, "learn_throughput": 7.709, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 81408, "num_env_steps_trained": 81408, "num_agent_steps_sampled": 81408, "num_agent_steps_trained": 81408}, "done": false, "episodes_total": 5088, "training_iteration": 159, "trial_id": "f4e01_00169", "date": "2024-02-27_03-13-51", "timestamp": 1709000031, "time_this_iter_s": 72.34600639343262, "time_total_s": 11451.394389152527, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11451.394389152527, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 52.636893203883496, "ram_util_percent": 20.79417475728156}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 24.09, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.688203125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.688203125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.640880769491195, "policy_loss": -0.054307846352458, "vf_loss": 7.374286532402039, "vf_explained_var": 0.9596891989310582, "kl": 0.0, "entropy": 138.29726028442383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 24.09, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.688203125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.688203125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 33.0, 53.0, 23.0, 53.0, -64.0, -64.0, 58.0, 14.0, -64.0, 48.0, 37.0, 59.0, 58.0, 12.0, 15.0, 53.0, -64.0, 28.0, 58.0, 53.0, 59.0, 53.0, 59.0, 38.0, 49.0, -64.0, -64.0, 53.0, -64.0, 53.0, 35.0, 58.0, 0.0, 43.0, 64.0, 53.0, -64.0, -64.0, 37.0, -64.0, 59.0, -64.0, 38.0, -64.0, 38.0, 38.0, 53.0, 52.0, 21.0, 58.0, 47.0, 43.0, -64.0, 59.0, 58.0, 54.0, 58.0, 26.0, 18.0, 17.0, 53.0, 45.0, 58.0, -64.0, 19.0, 49.0, -64.0, 59.0, 54.0, 0.0, 43.0, 53.0, 53.0, 28.0, 54.0, -64.0, 53.0, 37.0, 29.0, 14.0, 52.0, 58.0, 9.0, 58.0, 12.0, 49.0, 54.0, 25.0, 54.0, 48.0, 59.0, 59.0, 48.0, 43.0, 53.0, -64.0, 17.0, 52.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3009342529118744, "mean_inference_ms": 9.712909823913579, "mean_action_processing_ms": 0.4548930093098413, "mean_env_wait_ms": 0.28988511937579015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28168177604675293, "StateBufferConnector_ms": 0.004724264144897461, "ViewRequirementAgentConnector_ms": 0.21069717407226562}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 33.0, 53.0, 23.0, 53.0, -64.0, -64.0, 58.0, 14.0, -64.0, 48.0, 37.0, 59.0, 58.0, 12.0, 15.0, 53.0, -64.0, 28.0, 58.0, 53.0, 59.0, 53.0, 59.0, 38.0, 49.0, -64.0, -64.0, 53.0, -64.0, 53.0, 35.0, 58.0, 0.0, 43.0, 64.0, 53.0, -64.0, -64.0, 37.0, -64.0, 59.0, -64.0, 38.0, -64.0, 38.0, 38.0, 53.0, 52.0, 21.0, 58.0, 47.0, 43.0, -64.0, 59.0, 58.0, 54.0, 58.0, 26.0, 18.0, 17.0, 53.0, 45.0, 58.0, -64.0, 19.0, 49.0, -64.0, 59.0, 54.0, 0.0, 43.0, 53.0, 53.0, 28.0, 54.0, -64.0, 53.0, 37.0, 29.0, 14.0, 52.0, 58.0, 9.0, 58.0, 12.0, 49.0, 54.0, 25.0, 54.0, 48.0, 59.0, 59.0, 48.0, 43.0, 53.0, -64.0, 17.0, 52.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3009342529118744, "mean_inference_ms": 9.712909823913579, "mean_action_processing_ms": 0.4548930093098413, "mean_env_wait_ms": 0.28988511937579015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28168177604675293, "StateBufferConnector_ms": 0.004724264144897461, "ViewRequirementAgentConnector_ms": 0.21069717407226562}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.118193408578287, "num_agent_steps_trained_throughput_per_sec": 7.118193408578287, "timesteps_total": 81920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 72385.439, "sample_time_ms": 6093.0, "load_time_ms": 0.298, "load_throughput": 1718261.84, "learn_time_ms": 66291.612, "learn_throughput": 7.723, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "episodes_total": 5120, "training_iteration": 160, "trial_id": "f4e01_00169", "date": "2024-02-27_03-15-03", "timestamp": 1709000103, "time_this_iter_s": 71.93346929550171, "time_total_s": 11523.327858448029, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11523.327858448029, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 53.48431372549019, "ram_util_percent": 20.719607843137254}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.77, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.677890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.677890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.101918021837871, "policy_loss": -0.05016842572949827, "vf_loss": 8.091892580191294, "vf_explained_var": 0.8712631041804949, "kl": 0.0, "entropy": 143.05304883321125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 82432, "num_env_steps_trained": 82432, "num_agent_steps_sampled": 82432, "num_agent_steps_trained": 82432}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.77, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.77, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.677890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.677890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 0.0, 43.0, 64.0, 53.0, -64.0, -64.0, 37.0, -64.0, 59.0, -64.0, 38.0, -64.0, 38.0, 38.0, 53.0, 52.0, 21.0, 58.0, 47.0, 43.0, -64.0, 59.0, 58.0, 54.0, 58.0, 26.0, 18.0, 17.0, 53.0, 45.0, 58.0, -64.0, 19.0, 49.0, -64.0, 59.0, 54.0, 0.0, 43.0, 53.0, 53.0, 28.0, 54.0, -64.0, 53.0, 37.0, 29.0, 14.0, 52.0, 58.0, 9.0, 58.0, 12.0, 49.0, 54.0, 25.0, 54.0, 48.0, 59.0, 59.0, 48.0, 43.0, 53.0, -64.0, 17.0, 52.0, 64.0, 36.0, 28.0, -64.0, 58.0, -64.0, -64.0, 15.0, -64.0, 58.0, -64.0, 59.0, -64.0, 5.0, 37.0, 43.0, -64.0, 27.0, 0.0, 31.0, 58.0, 28.0, 53.0, 32.0, -64.0, 23.0, 30.0, 58.0, 48.0, 59.0, 53.0, 31.0, 52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301141325380633, "mean_inference_ms": 9.713955341705834, "mean_action_processing_ms": 0.45500909393100586, "mean_env_wait_ms": 0.2899495420788751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2796318531036377, "StateBufferConnector_ms": 0.0046465396881103516, "ViewRequirementAgentConnector_ms": 0.20693755149841309}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.77, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 0.0, 43.0, 64.0, 53.0, -64.0, -64.0, 37.0, -64.0, 59.0, -64.0, 38.0, -64.0, 38.0, 38.0, 53.0, 52.0, 21.0, 58.0, 47.0, 43.0, -64.0, 59.0, 58.0, 54.0, 58.0, 26.0, 18.0, 17.0, 53.0, 45.0, 58.0, -64.0, 19.0, 49.0, -64.0, 59.0, 54.0, 0.0, 43.0, 53.0, 53.0, 28.0, 54.0, -64.0, 53.0, 37.0, 29.0, 14.0, 52.0, 58.0, 9.0, 58.0, 12.0, 49.0, 54.0, 25.0, 54.0, 48.0, 59.0, 59.0, 48.0, 43.0, 53.0, -64.0, 17.0, 52.0, 64.0, 36.0, 28.0, -64.0, 58.0, -64.0, -64.0, 15.0, -64.0, 58.0, -64.0, 59.0, -64.0, 5.0, 37.0, 43.0, -64.0, 27.0, 0.0, 31.0, 58.0, 28.0, 53.0, 32.0, -64.0, 23.0, 30.0, 58.0, 48.0, 59.0, 53.0, 31.0, 52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301141325380633, "mean_inference_ms": 9.713955341705834, "mean_action_processing_ms": 0.45500909393100586, "mean_env_wait_ms": 0.2899495420788751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2796318531036377, "StateBufferConnector_ms": 0.0046465396881103516, "ViewRequirementAgentConnector_ms": 0.20693755149841309}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82432, "num_agent_steps_trained": 82432, "num_env_steps_sampled": 82432, "num_env_steps_trained": 82432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.086762526406023, "num_agent_steps_trained_throughput_per_sec": 7.086762526406023, "timesteps_total": 82432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 82432, "timers": {"training_iteration_time_ms": 72335.792, "sample_time_ms": 6102.94, "load_time_ms": 0.305, "load_throughput": 1679558.617, "learn_time_ms": 66232.009, "learn_throughput": 7.73, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 82432, "num_env_steps_trained": 82432, "num_agent_steps_sampled": 82432, "num_agent_steps_trained": 82432}, "done": false, "episodes_total": 5152, "training_iteration": 161, "trial_id": "f4e01_00169", "date": "2024-02-27_03-16-15", "timestamp": 1709000175, "time_this_iter_s": 72.25267720222473, "time_total_s": 11595.580535650253, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11595.580535650253, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 53.42815533980582, "ram_util_percent": 20.902912621359224}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.64, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6690625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6690625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.721906352043152, "policy_loss": -0.03633143212646246, "vf_loss": 7.4733118136723835, "vf_explained_var": 0.9304355735580127, "kl": 0.0, "entropy": 141.29564984639487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.64, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6690625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6690625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 19.0, 49.0, -64.0, 59.0, 54.0, 0.0, 43.0, 53.0, 53.0, 28.0, 54.0, -64.0, 53.0, 37.0, 29.0, 14.0, 52.0, 58.0, 9.0, 58.0, 12.0, 49.0, 54.0, 25.0, 54.0, 48.0, 59.0, 59.0, 48.0, 43.0, 53.0, -64.0, 17.0, 52.0, 64.0, 36.0, 28.0, -64.0, 58.0, -64.0, -64.0, 15.0, -64.0, 58.0, -64.0, 59.0, -64.0, 5.0, 37.0, 43.0, -64.0, 27.0, 0.0, 31.0, 58.0, 28.0, 53.0, 32.0, -64.0, 23.0, 30.0, 58.0, 48.0, 59.0, 53.0, 31.0, 52.0, 4.0, -64.0, -64.0, 54.0, 33.0, 59.0, 48.0, 52.0, 29.0, -18.0, 42.0, 64.0, 41.0, -64.0, -64.0, 37.0, -18.0, 64.0, 39.0, 33.0, 23.0, 58.0, 54.0, 53.0, 59.0, 58.0, 31.0, 64.0, 26.0, 46.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012724176584913, "mean_inference_ms": 9.714599114560222, "mean_action_processing_ms": 0.45509370454429443, "mean_env_wait_ms": 0.28998298625564156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27517080307006836, "StateBufferConnector_ms": 0.004590272903442383, "ViewRequirementAgentConnector_ms": 0.19910812377929688}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 19.0, 49.0, -64.0, 59.0, 54.0, 0.0, 43.0, 53.0, 53.0, 28.0, 54.0, -64.0, 53.0, 37.0, 29.0, 14.0, 52.0, 58.0, 9.0, 58.0, 12.0, 49.0, 54.0, 25.0, 54.0, 48.0, 59.0, 59.0, 48.0, 43.0, 53.0, -64.0, 17.0, 52.0, 64.0, 36.0, 28.0, -64.0, 58.0, -64.0, -64.0, 15.0, -64.0, 58.0, -64.0, 59.0, -64.0, 5.0, 37.0, 43.0, -64.0, 27.0, 0.0, 31.0, 58.0, 28.0, 53.0, 32.0, -64.0, 23.0, 30.0, 58.0, 48.0, 59.0, 53.0, 31.0, 52.0, 4.0, -64.0, -64.0, 54.0, 33.0, 59.0, 48.0, 52.0, 29.0, -18.0, 42.0, 64.0, 41.0, -64.0, -64.0, 37.0, -18.0, 64.0, 39.0, 33.0, 23.0, 58.0, 54.0, 53.0, 59.0, 58.0, 31.0, 64.0, 26.0, 46.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012724176584913, "mean_inference_ms": 9.714599114560222, "mean_action_processing_ms": 0.45509370454429443, "mean_env_wait_ms": 0.28998298625564156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27517080307006836, "StateBufferConnector_ms": 0.004590272903442383, "ViewRequirementAgentConnector_ms": 0.19910812377929688}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.15394699253024, "num_agent_steps_trained_throughput_per_sec": 7.15394699253024, "timesteps_total": 82944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 72323.18, "sample_time_ms": 6099.582, "load_time_ms": 0.301, "load_throughput": 1699361.912, "learn_time_ms": 66222.77, "learn_throughput": 7.731, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "done": false, "episodes_total": 5184, "training_iteration": 162, "trial_id": "f4e01_00169", "date": "2024-02-27_03-17-27", "timestamp": 1709000247, "time_this_iter_s": 71.57401466369629, "time_total_s": 11667.15455031395, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11667.15455031395, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 52.98118811881189, "ram_util_percent": 20.92574257425743}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.16, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.641875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.641875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.618579691648483, "policy_loss": -0.006888777995482087, "vf_loss": 7.264783728122711, "vf_explained_var": 0.9776704902450244, "kl": 0.0, "entropy": 138.3878667195638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 83456, "num_env_steps_trained": 83456, "num_agent_steps_sampled": 83456, "num_agent_steps_trained": 83456}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.16, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.641875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.641875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 17.0, 52.0, 64.0, 36.0, 28.0, -64.0, 58.0, -64.0, -64.0, 15.0, -64.0, 58.0, -64.0, 59.0, -64.0, 5.0, 37.0, 43.0, -64.0, 27.0, 0.0, 31.0, 58.0, 28.0, 53.0, 32.0, -64.0, 23.0, 30.0, 58.0, 48.0, 59.0, 53.0, 31.0, 52.0, 4.0, -64.0, -64.0, 54.0, 33.0, 59.0, 48.0, 52.0, 29.0, -18.0, 42.0, 64.0, 41.0, -64.0, -64.0, 37.0, -18.0, 64.0, 39.0, 33.0, 23.0, 58.0, 54.0, 53.0, 59.0, 58.0, 31.0, 64.0, 26.0, 46.0, -64.0, -64.0, 59.0, 31.0, 32.0, 53.0, 59.0, 48.0, 48.0, 24.0, 14.0, -64.0, 53.0, -64.0, 54.0, 36.0, 59.0, 54.0, -64.0, 58.0, -64.0, -64.0, 58.0, -64.0, -64.0, 52.0, 36.0, 58.0, 52.0, 40.0, 4.0, 47.0, 58.0, 47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012787532754992, "mean_inference_ms": 9.714508133905515, "mean_action_processing_ms": 0.4551301892930026, "mean_env_wait_ms": 0.2899831226123755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.272599458694458, "StateBufferConnector_ms": 0.0044574737548828125, "ViewRequirementAgentConnector_ms": 0.19337844848632812}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 17.0, 52.0, 64.0, 36.0, 28.0, -64.0, 58.0, -64.0, -64.0, 15.0, -64.0, 58.0, -64.0, 59.0, -64.0, 5.0, 37.0, 43.0, -64.0, 27.0, 0.0, 31.0, 58.0, 28.0, 53.0, 32.0, -64.0, 23.0, 30.0, 58.0, 48.0, 59.0, 53.0, 31.0, 52.0, 4.0, -64.0, -64.0, 54.0, 33.0, 59.0, 48.0, 52.0, 29.0, -18.0, 42.0, 64.0, 41.0, -64.0, -64.0, 37.0, -18.0, 64.0, 39.0, 33.0, 23.0, 58.0, 54.0, 53.0, 59.0, 58.0, 31.0, 64.0, 26.0, 46.0, -64.0, -64.0, 59.0, 31.0, 32.0, 53.0, 59.0, 48.0, 48.0, 24.0, 14.0, -64.0, 53.0, -64.0, 54.0, 36.0, 59.0, 54.0, -64.0, 58.0, -64.0, -64.0, 58.0, -64.0, -64.0, 52.0, 36.0, 58.0, 52.0, 40.0, 4.0, 47.0, 58.0, 47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012787532754992, "mean_inference_ms": 9.714508133905515, "mean_action_processing_ms": 0.4551301892930026, "mean_env_wait_ms": 0.2899831226123755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.272599458694458, "StateBufferConnector_ms": 0.0044574737548828125, "ViewRequirementAgentConnector_ms": 0.19337844848632812}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83456, "num_agent_steps_trained": 83456, "num_env_steps_sampled": 83456, "num_env_steps_trained": 83456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.140427923467982, "num_agent_steps_trained_throughput_per_sec": 7.140427923467982, "timesteps_total": 83456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 83456, "timers": {"training_iteration_time_ms": 72345.882, "sample_time_ms": 6080.155, "load_time_ms": 0.298, "load_throughput": 1719224.76, "learn_time_ms": 66264.911, "learn_throughput": 7.727, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 83456, "num_env_steps_trained": 83456, "num_agent_steps_sampled": 83456, "num_agent_steps_trained": 83456}, "done": false, "episodes_total": 5216, "training_iteration": 163, "trial_id": "f4e01_00169", "date": "2024-02-27_03-18-39", "timestamp": 1709000319, "time_this_iter_s": 71.70957660675049, "time_total_s": 11738.8641269207, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11738.8641269207, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 52.82843137254902, "ram_util_percent": 20.894117647058817}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 23.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.680546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.680546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.121594949563344, "policy_loss": -0.035486101444500186, "vf_loss": 6.529132080078125, "vf_explained_var": 0.9442591269810995, "kl": 0.0, "entropy": 141.34294713338215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 23.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.680546875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.680546875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 53.0, 31.0, 52.0, 4.0, -64.0, -64.0, 54.0, 33.0, 59.0, 48.0, 52.0, 29.0, -18.0, 42.0, 64.0, 41.0, -64.0, -64.0, 37.0, -18.0, 64.0, 39.0, 33.0, 23.0, 58.0, 54.0, 53.0, 59.0, 58.0, 31.0, 64.0, 26.0, 46.0, -64.0, -64.0, 59.0, 31.0, 32.0, 53.0, 59.0, 48.0, 48.0, 24.0, 14.0, -64.0, 53.0, -64.0, 54.0, 36.0, 59.0, 54.0, -64.0, 58.0, -64.0, -64.0, 58.0, -64.0, -64.0, 52.0, 36.0, 58.0, 52.0, 40.0, 4.0, 47.0, 58.0, 47.0, 47.0, 59.0, 18.0, 59.0, 64.0, 64.0, 64.0, 53.0, 64.0, 58.0, 53.0, -64.0, -64.0, 48.0, -64.0, 42.0, 59.0, 58.0, 10.0, 59.0, 54.0, -64.0, 41.0, -64.0, 58.0, -64.0, -64.0, 53.0, 59.0, 43.0, 17.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301206410924397, "mean_inference_ms": 9.714088587727055, "mean_action_processing_ms": 0.4551297697839747, "mean_env_wait_ms": 0.2899643385968721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2702138423919678, "StateBufferConnector_ms": 0.004446268081665039, "ViewRequirementAgentConnector_ms": 0.1893141269683838}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 53.0, 31.0, 52.0, 4.0, -64.0, -64.0, 54.0, 33.0, 59.0, 48.0, 52.0, 29.0, -18.0, 42.0, 64.0, 41.0, -64.0, -64.0, 37.0, -18.0, 64.0, 39.0, 33.0, 23.0, 58.0, 54.0, 53.0, 59.0, 58.0, 31.0, 64.0, 26.0, 46.0, -64.0, -64.0, 59.0, 31.0, 32.0, 53.0, 59.0, 48.0, 48.0, 24.0, 14.0, -64.0, 53.0, -64.0, 54.0, 36.0, 59.0, 54.0, -64.0, 58.0, -64.0, -64.0, 58.0, -64.0, -64.0, 52.0, 36.0, 58.0, 52.0, 40.0, 4.0, 47.0, 58.0, 47.0, 47.0, 59.0, 18.0, 59.0, 64.0, 64.0, 64.0, 53.0, 64.0, 58.0, 53.0, -64.0, -64.0, 48.0, -64.0, 42.0, 59.0, 58.0, 10.0, 59.0, 54.0, -64.0, 41.0, -64.0, 58.0, -64.0, -64.0, 53.0, 59.0, 43.0, 17.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301206410924397, "mean_inference_ms": 9.714088587727055, "mean_action_processing_ms": 0.4551297697839747, "mean_env_wait_ms": 0.2899643385968721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2702138423919678, "StateBufferConnector_ms": 0.004446268081665039, "ViewRequirementAgentConnector_ms": 0.1893141269683838}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.078935405054906, "num_agent_steps_trained_throughput_per_sec": 7.078935405054906, "timesteps_total": 83968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 72403.947, "sample_time_ms": 6085.134, "load_time_ms": 0.293, "load_throughput": 1744786.844, "learn_time_ms": 66318.009, "learn_throughput": 7.72, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "episodes_total": 5248, "training_iteration": 164, "trial_id": "f4e01_00169", "date": "2024-02-27_03-19-51", "timestamp": 1709000391, "time_this_iter_s": 72.33261823654175, "time_total_s": 11811.196745157242, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11811.196745157242, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 52.891262135922325, "ram_util_percent": 20.75631067961166}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.33, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.666640625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.666640625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.2792643249034885, "policy_loss": -0.04693728006677702, "vf_loss": 6.794753658771515, "vf_explained_var": 0.9648351555069288, "kl": 0.0, "entropy": 145.01850522359211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.33, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.33, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.666640625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.666640625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [26.0, 46.0, -64.0, -64.0, 59.0, 31.0, 32.0, 53.0, 59.0, 48.0, 48.0, 24.0, 14.0, -64.0, 53.0, -64.0, 54.0, 36.0, 59.0, 54.0, -64.0, 58.0, -64.0, -64.0, 58.0, -64.0, -64.0, 52.0, 36.0, 58.0, 52.0, 40.0, 4.0, 47.0, 58.0, 47.0, 47.0, 59.0, 18.0, 59.0, 64.0, 64.0, 64.0, 53.0, 64.0, 58.0, 53.0, -64.0, -64.0, 48.0, -64.0, 42.0, 59.0, 58.0, 10.0, 59.0, 54.0, -64.0, 41.0, -64.0, 58.0, -64.0, -64.0, 53.0, 59.0, 43.0, 17.0, 23.0, 54.0, 31.0, 59.0, -64.0, 52.0, -64.0, 16.0, -64.0, 48.0, 22.0, -64.0, -64.0, 64.0, 47.0, 64.0, 58.0, 47.0, 43.0, -64.0, 53.0, 37.0, 47.0, 59.0, 59.0, 41.0, 54.0, 43.0, 42.0, 20.0, 53.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3011460392803116, "mean_inference_ms": 9.71367917399911, "mean_action_processing_ms": 0.4551414537335994, "mean_env_wait_ms": 0.28996271844636123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2701432704925537, "StateBufferConnector_ms": 0.0044689178466796875, "ViewRequirementAgentConnector_ms": 0.19115853309631348}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.33, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.0, 46.0, -64.0, -64.0, 59.0, 31.0, 32.0, 53.0, 59.0, 48.0, 48.0, 24.0, 14.0, -64.0, 53.0, -64.0, 54.0, 36.0, 59.0, 54.0, -64.0, 58.0, -64.0, -64.0, 58.0, -64.0, -64.0, 52.0, 36.0, 58.0, 52.0, 40.0, 4.0, 47.0, 58.0, 47.0, 47.0, 59.0, 18.0, 59.0, 64.0, 64.0, 64.0, 53.0, 64.0, 58.0, 53.0, -64.0, -64.0, 48.0, -64.0, 42.0, 59.0, 58.0, 10.0, 59.0, 54.0, -64.0, 41.0, -64.0, 58.0, -64.0, -64.0, 53.0, 59.0, 43.0, 17.0, 23.0, 54.0, 31.0, 59.0, -64.0, 52.0, -64.0, 16.0, -64.0, 48.0, 22.0, -64.0, -64.0, 64.0, 47.0, 64.0, 58.0, 47.0, 43.0, -64.0, 53.0, 37.0, 47.0, 59.0, 59.0, 41.0, 54.0, 43.0, 42.0, 20.0, 53.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3011460392803116, "mean_inference_ms": 9.71367917399911, "mean_action_processing_ms": 0.4551414537335994, "mean_env_wait_ms": 0.28996271844636123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2701432704925537, "StateBufferConnector_ms": 0.0044689178466796875, "ViewRequirementAgentConnector_ms": 0.19115853309631348}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480, "num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.059356464559001, "num_agent_steps_trained_throughput_per_sec": 7.059356464559001, "timesteps_total": 84480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 84480, "timers": {"training_iteration_time_ms": 72394.462, "sample_time_ms": 6077.4, "load_time_ms": 0.295, "load_throughput": 1738290.147, "learn_time_ms": 66316.283, "learn_throughput": 7.721, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480}, "done": false, "episodes_total": 5280, "training_iteration": 165, "trial_id": "f4e01_00169", "date": "2024-02-27_03-21-04", "timestamp": 1709000464, "time_this_iter_s": 72.53298997879028, "time_total_s": 11883.729735136032, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11883.729735136032, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 53.724509803921556, "ram_util_percent": 20.826470588235292}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.703984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.703984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.151414952675501, "policy_loss": -0.042855005338788034, "vf_loss": 6.587541258335113, "vf_explained_var": 0.9928226123253504, "kl": 0.0, "entropy": 143.1536459604899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.703984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.703984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [4.0, 47.0, 58.0, 47.0, 47.0, 59.0, 18.0, 59.0, 64.0, 64.0, 64.0, 53.0, 64.0, 58.0, 53.0, -64.0, -64.0, 48.0, -64.0, 42.0, 59.0, 58.0, 10.0, 59.0, 54.0, -64.0, 41.0, -64.0, 58.0, -64.0, -64.0, 53.0, 59.0, 43.0, 17.0, 23.0, 54.0, 31.0, 59.0, -64.0, 52.0, -64.0, 16.0, -64.0, 48.0, 22.0, -64.0, -64.0, 64.0, 47.0, 64.0, 58.0, 47.0, 43.0, -64.0, 53.0, 37.0, 47.0, 59.0, 59.0, 41.0, 54.0, 43.0, 42.0, 20.0, 53.0, 59.0, -64.0, 59.0, 29.0, 58.0, 49.0, 58.0, 59.0, 36.0, -64.0, 53.0, 17.0, 64.0, -64.0, -64.0, 59.0, 64.0, 27.0, 49.0, 54.0, 49.0, 12.0, 52.0, -64.0, 52.0, 58.0, 34.0, 23.0, 53.0, 64.0, 48.0, 33.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010655995299791, "mean_inference_ms": 9.713330765452618, "mean_action_processing_ms": 0.4551491639071489, "mean_env_wait_ms": 0.28996504793056466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27185821533203125, "StateBufferConnector_ms": 0.0045163631439208984, "ViewRequirementAgentConnector_ms": 0.19070959091186523}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.0, 47.0, 58.0, 47.0, 47.0, 59.0, 18.0, 59.0, 64.0, 64.0, 64.0, 53.0, 64.0, 58.0, 53.0, -64.0, -64.0, 48.0, -64.0, 42.0, 59.0, 58.0, 10.0, 59.0, 54.0, -64.0, 41.0, -64.0, 58.0, -64.0, -64.0, 53.0, 59.0, 43.0, 17.0, 23.0, 54.0, 31.0, 59.0, -64.0, 52.0, -64.0, 16.0, -64.0, 48.0, 22.0, -64.0, -64.0, 64.0, 47.0, 64.0, 58.0, 47.0, 43.0, -64.0, 53.0, 37.0, 47.0, 59.0, 59.0, 41.0, 54.0, 43.0, 42.0, 20.0, 53.0, 59.0, -64.0, 59.0, 29.0, 58.0, 49.0, 58.0, 59.0, 36.0, -64.0, 53.0, 17.0, 64.0, -64.0, -64.0, 59.0, 64.0, 27.0, 49.0, 54.0, 49.0, 12.0, 52.0, -64.0, 52.0, 58.0, 34.0, 23.0, 53.0, 64.0, 48.0, 33.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010655995299791, "mean_inference_ms": 9.713330765452618, "mean_action_processing_ms": 0.4551491639071489, "mean_env_wait_ms": 0.28996504793056466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27185821533203125, "StateBufferConnector_ms": 0.0045163631439208984, "ViewRequirementAgentConnector_ms": 0.19070959091186523}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.04669173827035, "num_agent_steps_trained_throughput_per_sec": 7.04669173827035, "timesteps_total": 84992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 72428.101, "sample_time_ms": 6086.43, "load_time_ms": 0.293, "load_throughput": 1748622.79, "learn_time_ms": 66340.9, "learn_throughput": 7.718, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "done": false, "episodes_total": 5312, "training_iteration": 166, "trial_id": "f4e01_00169", "date": "2024-02-27_03-22-16", "timestamp": 1709000536, "time_this_iter_s": 72.66327738761902, "time_total_s": 11956.393012523651, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11956.393012523651, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 52.96019417475728, "ram_util_percent": 20.685436893203875}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 23.62, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.68453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.68453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.0706526438395185, "policy_loss": 0.003851081985825052, "vf_loss": 7.957943602403005, "vf_explained_var": 0.9574035545190175, "kl": 0.0, "entropy": 142.72190602620444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 85504, "num_env_steps_trained": 85504, "num_agent_steps_sampled": 85504, "num_agent_steps_trained": 85504}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 23.62, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.68453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.68453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 43.0, 17.0, 23.0, 54.0, 31.0, 59.0, -64.0, 52.0, -64.0, 16.0, -64.0, 48.0, 22.0, -64.0, -64.0, 64.0, 47.0, 64.0, 58.0, 47.0, 43.0, -64.0, 53.0, 37.0, 47.0, 59.0, 59.0, 41.0, 54.0, 43.0, 42.0, 20.0, 53.0, 59.0, -64.0, 59.0, 29.0, 58.0, 49.0, 58.0, 59.0, 36.0, -64.0, 53.0, 17.0, 64.0, -64.0, -64.0, 59.0, 64.0, 27.0, 49.0, 54.0, 49.0, 12.0, 52.0, -64.0, 52.0, 58.0, 34.0, 23.0, 53.0, 64.0, 48.0, 33.0, 59.0, -64.0, 29.0, -64.0, 39.0, 53.0, 43.0, 22.0, 59.0, -64.0, 58.0, 22.0, -64.0, 38.0, 48.0, 49.0, -64.0, -64.0, 54.0, -64.0, 29.0, 59.0, 31.0, 48.0, -62.0, 54.0, -64.0, 42.0, 28.0, 58.0, 53.0, 58.0, 38.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010108472638526, "mean_inference_ms": 9.713137499610541, "mean_action_processing_ms": 0.455168447688973, "mean_env_wait_ms": 0.28998240462098324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2743985652923584, "StateBufferConnector_ms": 0.004533529281616211, "ViewRequirementAgentConnector_ms": 0.19278836250305176}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 43.0, 17.0, 23.0, 54.0, 31.0, 59.0, -64.0, 52.0, -64.0, 16.0, -64.0, 48.0, 22.0, -64.0, -64.0, 64.0, 47.0, 64.0, 58.0, 47.0, 43.0, -64.0, 53.0, 37.0, 47.0, 59.0, 59.0, 41.0, 54.0, 43.0, 42.0, 20.0, 53.0, 59.0, -64.0, 59.0, 29.0, 58.0, 49.0, 58.0, 59.0, 36.0, -64.0, 53.0, 17.0, 64.0, -64.0, -64.0, 59.0, 64.0, 27.0, 49.0, 54.0, 49.0, 12.0, 52.0, -64.0, 52.0, 58.0, 34.0, 23.0, 53.0, 64.0, 48.0, 33.0, 59.0, -64.0, 29.0, -64.0, 39.0, 53.0, 43.0, 22.0, 59.0, -64.0, 58.0, 22.0, -64.0, 38.0, 48.0, 49.0, -64.0, -64.0, 54.0, -64.0, 29.0, 59.0, 31.0, 48.0, -62.0, 54.0, -64.0, 42.0, 28.0, 58.0, 53.0, 58.0, 38.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010108472638526, "mean_inference_ms": 9.713137499610541, "mean_action_processing_ms": 0.455168447688973, "mean_env_wait_ms": 0.28998240462098324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2743985652923584, "StateBufferConnector_ms": 0.004533529281616211, "ViewRequirementAgentConnector_ms": 0.19278836250305176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85504, "num_agent_steps_trained": 85504, "num_env_steps_sampled": 85504, "num_env_steps_trained": 85504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.074584953836046, "num_agent_steps_trained_throughput_per_sec": 7.074584953836046, "timesteps_total": 85504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 85504, "timers": {"training_iteration_time_ms": 72301.412, "sample_time_ms": 6076.074, "load_time_ms": 0.291, "load_throughput": 1757207.796, "learn_time_ms": 66224.57, "learn_throughput": 7.731, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 85504, "num_env_steps_trained": 85504, "num_agent_steps_sampled": 85504, "num_agent_steps_trained": 85504}, "done": false, "episodes_total": 5344, "training_iteration": 167, "trial_id": "f4e01_00169", "date": "2024-02-27_03-23-29", "timestamp": 1709000609, "time_this_iter_s": 72.37677025794983, "time_total_s": 12028.769782781601, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12028.769782781601, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 52.3514563106796, "ram_util_percent": 20.718446601941757}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.81, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.639140625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.639140625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.948327100276947, "policy_loss": -0.04887980039153869, "vf_loss": 7.848637863000234, "vf_explained_var": 0.7604977900783221, "kl": 0.0, "entropy": 145.69952837626138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.81, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.639140625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.639140625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [20.0, 53.0, 59.0, -64.0, 59.0, 29.0, 58.0, 49.0, 58.0, 59.0, 36.0, -64.0, 53.0, 17.0, 64.0, -64.0, -64.0, 59.0, 64.0, 27.0, 49.0, 54.0, 49.0, 12.0, 52.0, -64.0, 52.0, 58.0, 34.0, 23.0, 53.0, 64.0, 48.0, 33.0, 59.0, -64.0, 29.0, -64.0, 39.0, 53.0, 43.0, 22.0, 59.0, -64.0, 58.0, 22.0, -64.0, 38.0, 48.0, 49.0, -64.0, -64.0, 54.0, -64.0, 29.0, 59.0, 31.0, 48.0, -62.0, 54.0, -64.0, 42.0, 28.0, 58.0, 53.0, 58.0, 38.0, 42.0, 20.0, -64.0, 58.0, 33.0, -64.0, 42.0, -64.0, -64.0, -64.0, 47.0, 49.0, 47.0, 33.0, -64.0, 58.0, 52.0, 58.0, 54.0, -64.0, 59.0, 54.0, 59.0, 38.0, 53.0, -64.0, 48.0, 64.0, -64.0, -64.0, -64.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30098891876969, "mean_inference_ms": 9.713169021062438, "mean_action_processing_ms": 0.45518439998376437, "mean_env_wait_ms": 0.28999915682292304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2737455368041992, "StateBufferConnector_ms": 0.004513263702392578, "ViewRequirementAgentConnector_ms": 0.1900637149810791}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.0, 53.0, 59.0, -64.0, 59.0, 29.0, 58.0, 49.0, 58.0, 59.0, 36.0, -64.0, 53.0, 17.0, 64.0, -64.0, -64.0, 59.0, 64.0, 27.0, 49.0, 54.0, 49.0, 12.0, 52.0, -64.0, 52.0, 58.0, 34.0, 23.0, 53.0, 64.0, 48.0, 33.0, 59.0, -64.0, 29.0, -64.0, 39.0, 53.0, 43.0, 22.0, 59.0, -64.0, 58.0, 22.0, -64.0, 38.0, 48.0, 49.0, -64.0, -64.0, 54.0, -64.0, 29.0, 59.0, 31.0, 48.0, -62.0, 54.0, -64.0, 42.0, 28.0, 58.0, 53.0, 58.0, 38.0, 42.0, 20.0, -64.0, 58.0, 33.0, -64.0, 42.0, -64.0, -64.0, -64.0, 47.0, 49.0, 47.0, 33.0, -64.0, 58.0, 52.0, 58.0, 54.0, -64.0, 59.0, 54.0, 59.0, 38.0, 53.0, -64.0, 48.0, 64.0, -64.0, -64.0, -64.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30098891876969, "mean_inference_ms": 9.713169021062438, "mean_action_processing_ms": 0.45518439998376437, "mean_env_wait_ms": 0.28999915682292304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2737455368041992, "StateBufferConnector_ms": 0.004513263702392578, "ViewRequirementAgentConnector_ms": 0.1900637149810791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.092012574136617, "num_agent_steps_trained_throughput_per_sec": 7.092012574136617, "timesteps_total": 86016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 72186.865, "sample_time_ms": 6067.64, "load_time_ms": 0.287, "load_throughput": 1782439.947, "learn_time_ms": 66118.468, "learn_throughput": 7.744, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "episodes_total": 5376, "training_iteration": 168, "trial_id": "f4e01_00169", "date": "2024-02-27_03-24-41", "timestamp": 1709000681, "time_this_iter_s": 72.19903135299683, "time_total_s": 12100.968814134598, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12100.968814134598, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 52.55436893203884, "ram_util_percent": 20.72524271844659}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.1, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.874604030450185, "policy_loss": 0.01643611545829723, "vf_loss": 7.630262629191081, "vf_explained_var": 0.9878875906268756, "kl": 0.0, "entropy": 139.8462407430013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 86528, "num_env_steps_trained": 86528, "num_agent_steps_sampled": 86528, "num_agent_steps_trained": 86528}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.1, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61796875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61796875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, 33.0, 59.0, -64.0, 29.0, -64.0, 39.0, 53.0, 43.0, 22.0, 59.0, -64.0, 58.0, 22.0, -64.0, 38.0, 48.0, 49.0, -64.0, -64.0, 54.0, -64.0, 29.0, 59.0, 31.0, 48.0, -62.0, 54.0, -64.0, 42.0, 28.0, 58.0, 53.0, 58.0, 38.0, 42.0, 20.0, -64.0, 58.0, 33.0, -64.0, 42.0, -64.0, -64.0, -64.0, 47.0, 49.0, 47.0, 33.0, -64.0, 58.0, 52.0, 58.0, 54.0, -64.0, 59.0, 54.0, 59.0, 38.0, 53.0, -64.0, 48.0, 64.0, -64.0, -64.0, -64.0, 59.0, -64.0, -64.0, 54.0, -64.0, -64.0, 58.0, 58.0, -64.0, 26.0, 53.0, 53.0, 59.0, 58.0, 53.0, 54.0, 42.0, 46.0, 49.0, 53.0, -64.0, 52.0, 39.0, 53.0, 58.0, 46.0, 46.0, -64.0, 47.0, 48.0, 47.0, -64.0, 33.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010693853296775, "mean_inference_ms": 9.713611494546695, "mean_action_processing_ms": 0.4552275741032221, "mean_env_wait_ms": 0.2900387853489798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2771918773651123, "StateBufferConnector_ms": 0.004560708999633789, "ViewRequirementAgentConnector_ms": 0.1979970932006836}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 33.0, 59.0, -64.0, 29.0, -64.0, 39.0, 53.0, 43.0, 22.0, 59.0, -64.0, 58.0, 22.0, -64.0, 38.0, 48.0, 49.0, -64.0, -64.0, 54.0, -64.0, 29.0, 59.0, 31.0, 48.0, -62.0, 54.0, -64.0, 42.0, 28.0, 58.0, 53.0, 58.0, 38.0, 42.0, 20.0, -64.0, 58.0, 33.0, -64.0, 42.0, -64.0, -64.0, -64.0, 47.0, 49.0, 47.0, 33.0, -64.0, 58.0, 52.0, 58.0, 54.0, -64.0, 59.0, 54.0, 59.0, 38.0, 53.0, -64.0, 48.0, 64.0, -64.0, -64.0, -64.0, 59.0, -64.0, -64.0, 54.0, -64.0, -64.0, 58.0, 58.0, -64.0, 26.0, 53.0, 53.0, 59.0, 58.0, 53.0, 54.0, 42.0, 46.0, 49.0, 53.0, -64.0, 52.0, 39.0, 53.0, 58.0, 46.0, 46.0, -64.0, 47.0, 48.0, 47.0, -64.0, 33.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010693853296775, "mean_inference_ms": 9.713611494546695, "mean_action_processing_ms": 0.4552275741032221, "mean_env_wait_ms": 0.2900387853489798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2771918773651123, "StateBufferConnector_ms": 0.004560708999633789, "ViewRequirementAgentConnector_ms": 0.1979970932006836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86528, "num_agent_steps_trained": 86528, "num_env_steps_sampled": 86528, "num_env_steps_trained": 86528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.082691282891951, "num_agent_steps_trained_throughput_per_sec": 7.082691282891951, "timesteps_total": 86528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 86528, "timers": {"training_iteration_time_ms": 72181.652, "sample_time_ms": 6066.589, "load_time_ms": 0.279, "load_throughput": 1835612.999, "learn_time_ms": 66114.316, "learn_throughput": 7.744, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 86528, "num_env_steps_trained": 86528, "num_agent_steps_sampled": 86528, "num_agent_steps_trained": 86528}, "done": false, "episodes_total": 5408, "training_iteration": 169, "trial_id": "f4e01_00169", "date": "2024-02-27_03-25-53", "timestamp": 1709000753, "time_this_iter_s": 72.29404425621033, "time_total_s": 12173.262858390808, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12173.262858390808, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 53.62450980392157, "ram_util_percent": 20.75490196078432}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.67, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.638046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.638046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.630306746562322, "policy_loss": 0.04278315055804948, "vf_loss": 7.205187324682871, "vf_explained_var": 0.8750069414575895, "kl": 0.0, "entropy": 144.5862186431885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.67, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.67, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.638046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.638046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 58.0, 38.0, 42.0, 20.0, -64.0, 58.0, 33.0, -64.0, 42.0, -64.0, -64.0, -64.0, 47.0, 49.0, 47.0, 33.0, -64.0, 58.0, 52.0, 58.0, 54.0, -64.0, 59.0, 54.0, 59.0, 38.0, 53.0, -64.0, 48.0, 64.0, -64.0, -64.0, -64.0, 59.0, -64.0, -64.0, 54.0, -64.0, -64.0, 58.0, 58.0, -64.0, 26.0, 53.0, 53.0, 59.0, 58.0, 53.0, 54.0, 42.0, 46.0, 49.0, 53.0, -64.0, 52.0, 39.0, 53.0, 58.0, 46.0, 46.0, -64.0, 47.0, 48.0, 47.0, -64.0, 33.0, -64.0, 58.0, 58.0, 64.0, 54.0, 64.0, 53.0, 48.0, -64.0, -64.0, 49.0, 42.0, 34.0, 43.0, -64.0, 58.0, 59.0, -64.0, -64.0, 59.0, 53.0, 31.0, 53.0, 24.0, 31.0, 49.0, 54.0, 59.0, -64.0, 42.0, -64.0, -64.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012188752335345, "mean_inference_ms": 9.71442495369232, "mean_action_processing_ms": 0.45529943570001663, "mean_env_wait_ms": 0.2900958555150689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2773125171661377, "StateBufferConnector_ms": 0.004591941833496094, "ViewRequirementAgentConnector_ms": 0.19883012771606445}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.67, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 58.0, 38.0, 42.0, 20.0, -64.0, 58.0, 33.0, -64.0, 42.0, -64.0, -64.0, -64.0, 47.0, 49.0, 47.0, 33.0, -64.0, 58.0, 52.0, 58.0, 54.0, -64.0, 59.0, 54.0, 59.0, 38.0, 53.0, -64.0, 48.0, 64.0, -64.0, -64.0, -64.0, 59.0, -64.0, -64.0, 54.0, -64.0, -64.0, 58.0, 58.0, -64.0, 26.0, 53.0, 53.0, 59.0, 58.0, 53.0, 54.0, 42.0, 46.0, 49.0, 53.0, -64.0, 52.0, 39.0, 53.0, 58.0, 46.0, 46.0, -64.0, 47.0, 48.0, 47.0, -64.0, 33.0, -64.0, 58.0, 58.0, 64.0, 54.0, 64.0, 53.0, 48.0, -64.0, -64.0, 49.0, 42.0, 34.0, 43.0, -64.0, 58.0, 59.0, -64.0, -64.0, 59.0, 53.0, 31.0, 53.0, 24.0, 31.0, 49.0, 54.0, 59.0, -64.0, 42.0, -64.0, -64.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012188752335345, "mean_inference_ms": 9.71442495369232, "mean_action_processing_ms": 0.45529943570001663, "mean_env_wait_ms": 0.2900958555150689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2773125171661377, "StateBufferConnector_ms": 0.004591941833496094, "ViewRequirementAgentConnector_ms": 0.19883012771606445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1738373973885405, "num_agent_steps_trained_throughput_per_sec": 7.1738373973885405, "timesteps_total": 87040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 72125.86, "sample_time_ms": 6061.906, "load_time_ms": 0.279, "load_throughput": 1837497.774, "learn_time_ms": 66063.182, "learn_throughput": 7.75, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "done": false, "episodes_total": 5440, "training_iteration": 170, "trial_id": "f4e01_00169", "date": "2024-02-27_03-27-05", "timestamp": 1709000825, "time_this_iter_s": 71.37620401382446, "time_total_s": 12244.639062404633, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12244.639062404633, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 51.8764705882353, "ram_util_percent": 19.698039215686276}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.25, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.642578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.642578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.476069941123327, "policy_loss": 0.03247941946998859, "vf_loss": 6.979125245412191, "vf_explained_var": 0.8774096871415774, "kl": 0.0, "entropy": 141.42775433858236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 87552, "num_env_steps_trained": 87552, "num_agent_steps_sampled": 87552, "num_agent_steps_trained": 87552}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.25, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.25, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.642578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.642578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 59.0, -64.0, -64.0, 54.0, -64.0, -64.0, 58.0, 58.0, -64.0, 26.0, 53.0, 53.0, 59.0, 58.0, 53.0, 54.0, 42.0, 46.0, 49.0, 53.0, -64.0, 52.0, 39.0, 53.0, 58.0, 46.0, 46.0, -64.0, 47.0, 48.0, 47.0, -64.0, 33.0, -64.0, 58.0, 58.0, 64.0, 54.0, 64.0, 53.0, 48.0, -64.0, -64.0, 49.0, 42.0, 34.0, 43.0, -64.0, 58.0, 59.0, -64.0, -64.0, 59.0, 53.0, 31.0, 53.0, 24.0, 31.0, 49.0, 54.0, 59.0, -64.0, 42.0, -64.0, -64.0, 59.0, 58.0, 48.0, 58.0, 53.0, 64.0, 59.0, 58.0, -64.0, -64.0, 37.0, -64.0, 59.0, -63.0, 2.0, 59.0, 25.0, 54.0, -64.0, 58.0, 23.0, 59.0, 59.0, 64.0, 47.0, 5.0, 64.0, -14.0, -64.0, -64.0, -64.0, 53.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013827292522868, "mean_inference_ms": 9.715253085172822, "mean_action_processing_ms": 0.45538839370863693, "mean_env_wait_ms": 0.29015527555679277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2794523239135742, "StateBufferConnector_ms": 0.0046215057373046875, "ViewRequirementAgentConnector_ms": 0.20517539978027344}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.25, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 59.0, -64.0, -64.0, 54.0, -64.0, -64.0, 58.0, 58.0, -64.0, 26.0, 53.0, 53.0, 59.0, 58.0, 53.0, 54.0, 42.0, 46.0, 49.0, 53.0, -64.0, 52.0, 39.0, 53.0, 58.0, 46.0, 46.0, -64.0, 47.0, 48.0, 47.0, -64.0, 33.0, -64.0, 58.0, 58.0, 64.0, 54.0, 64.0, 53.0, 48.0, -64.0, -64.0, 49.0, 42.0, 34.0, 43.0, -64.0, 58.0, 59.0, -64.0, -64.0, 59.0, 53.0, 31.0, 53.0, 24.0, 31.0, 49.0, 54.0, 59.0, -64.0, 42.0, -64.0, -64.0, 59.0, 58.0, 48.0, 58.0, 53.0, 64.0, 59.0, 58.0, -64.0, -64.0, 37.0, -64.0, 59.0, -63.0, 2.0, 59.0, 25.0, 54.0, -64.0, 58.0, 23.0, 59.0, 59.0, 64.0, 47.0, 5.0, 64.0, -14.0, -64.0, -64.0, -64.0, 53.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013827292522868, "mean_inference_ms": 9.715253085172822, "mean_action_processing_ms": 0.45538839370863693, "mean_env_wait_ms": 0.29015527555679277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2794523239135742, "StateBufferConnector_ms": 0.0046215057373046875, "ViewRequirementAgentConnector_ms": 0.20517539978027344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87552, "num_agent_steps_trained": 87552, "num_env_steps_sampled": 87552, "num_env_steps_trained": 87552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.104149399689181, "num_agent_steps_trained_throughput_per_sec": 7.104149399689181, "timesteps_total": 87552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 87552, "timers": {"training_iteration_time_ms": 72108.18, "sample_time_ms": 6063.394, "load_time_ms": 0.276, "load_throughput": 1854956.939, "learn_time_ms": 66044.014, "learn_throughput": 7.752, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 87552, "num_env_steps_trained": 87552, "num_agent_steps_sampled": 87552, "num_agent_steps_trained": 87552}, "done": false, "episodes_total": 5472, "training_iteration": 171, "trial_id": "f4e01_00169", "date": "2024-02-27_03-28-17", "timestamp": 1709000897, "time_this_iter_s": 72.07594227790833, "time_total_s": 12316.71500468254, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12316.71500468254, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 51.19607843137255, "ram_util_percent": 19.639215686274504}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.13, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.672890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.672890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.370740373929341, "policy_loss": -0.01162685463981082, "vf_loss": 6.8829675416151685, "vf_explained_var": 0.9170889168977737, "kl": 0.0, "entropy": 142.45434010823567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.13, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.672890625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.672890625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [47.0, -64.0, 33.0, -64.0, 58.0, 58.0, 64.0, 54.0, 64.0, 53.0, 48.0, -64.0, -64.0, 49.0, 42.0, 34.0, 43.0, -64.0, 58.0, 59.0, -64.0, -64.0, 59.0, 53.0, 31.0, 53.0, 24.0, 31.0, 49.0, 54.0, 59.0, -64.0, 42.0, -64.0, -64.0, 59.0, 58.0, 48.0, 58.0, 53.0, 64.0, 59.0, 58.0, -64.0, -64.0, 37.0, -64.0, 59.0, -63.0, 2.0, 59.0, 25.0, 54.0, -64.0, 58.0, 23.0, 59.0, 59.0, 64.0, 47.0, 5.0, 64.0, -14.0, -64.0, -64.0, -64.0, 53.0, 58.0, -9.0, 58.0, 52.0, 7.0, 42.0, 38.0, 5.0, 64.0, 12.0, 4.0, 4.0, 54.0, 26.0, 53.0, 53.0, 58.0, 58.0, 64.0, 59.0, 37.0, 26.0, 53.0, 54.0, 47.0, 48.0, 25.0, 15.0, -6.0, 59.0, -64.0, 44.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3014662637340046, "mean_inference_ms": 9.7156763682131, "mean_action_processing_ms": 0.4554584396170783, "mean_env_wait_ms": 0.29019494349853914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27482128143310547, "StateBufferConnector_ms": 0.004539012908935547, "ViewRequirementAgentConnector_ms": 0.1990957260131836}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.0, -64.0, 33.0, -64.0, 58.0, 58.0, 64.0, 54.0, 64.0, 53.0, 48.0, -64.0, -64.0, 49.0, 42.0, 34.0, 43.0, -64.0, 58.0, 59.0, -64.0, -64.0, 59.0, 53.0, 31.0, 53.0, 24.0, 31.0, 49.0, 54.0, 59.0, -64.0, 42.0, -64.0, -64.0, 59.0, 58.0, 48.0, 58.0, 53.0, 64.0, 59.0, 58.0, -64.0, -64.0, 37.0, -64.0, 59.0, -63.0, 2.0, 59.0, 25.0, 54.0, -64.0, 58.0, 23.0, 59.0, 59.0, 64.0, 47.0, 5.0, 64.0, -14.0, -64.0, -64.0, -64.0, 53.0, 58.0, -9.0, 58.0, 52.0, 7.0, 42.0, 38.0, 5.0, 64.0, 12.0, 4.0, 4.0, 54.0, 26.0, 53.0, 53.0, 58.0, 58.0, 64.0, 59.0, 37.0, 26.0, 53.0, 54.0, 47.0, 48.0, 25.0, 15.0, -6.0, 59.0, -64.0, 44.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3014662637340046, "mean_inference_ms": 9.7156763682131, "mean_action_processing_ms": 0.4554584396170783, "mean_env_wait_ms": 0.29019494349853914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27482128143310547, "StateBufferConnector_ms": 0.004539012908935547, "ViewRequirementAgentConnector_ms": 0.1990957260131836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.133556724923726, "num_agent_steps_trained_throughput_per_sec": 7.133556724923726, "timesteps_total": 88064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 72128.637, "sample_time_ms": 6060.899, "load_time_ms": 0.273, "load_throughput": 1875367.783, "learn_time_ms": 66066.97, "learn_throughput": 7.75, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "done": false, "episodes_total": 5504, "training_iteration": 172, "trial_id": "f4e01_00169", "date": "2024-02-27_03-29-29", "timestamp": 1709000969, "time_this_iter_s": 71.77881193161011, "time_total_s": 12388.493816614151, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12388.493816614151, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 51.353921568627456, "ram_util_percent": 19.599019607843136}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.657109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.657109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9889385084311167, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.735757138331731, "policy_loss": 0.07960822689346969, "vf_loss": 8.883575491110484, "vf_explained_var": 0.6608657881617546, "kl": 0.0, "entropy": 143.15916328430177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 88576, "num_env_steps_trained": 88576, "num_agent_steps_sampled": 88576, "num_agent_steps_trained": 88576}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.11, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.657109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.657109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [42.0, -64.0, -64.0, 59.0, 58.0, 48.0, 58.0, 53.0, 64.0, 59.0, 58.0, -64.0, -64.0, 37.0, -64.0, 59.0, -63.0, 2.0, 59.0, 25.0, 54.0, -64.0, 58.0, 23.0, 59.0, 59.0, 64.0, 47.0, 5.0, 64.0, -14.0, -64.0, -64.0, -64.0, 53.0, 58.0, -9.0, 58.0, 52.0, 7.0, 42.0, 38.0, 5.0, 64.0, 12.0, 4.0, 4.0, 54.0, 26.0, 53.0, 53.0, 58.0, 58.0, 64.0, 59.0, 37.0, 26.0, 53.0, 54.0, 47.0, 48.0, 25.0, 15.0, -6.0, 59.0, -64.0, 44.0, -64.0, 64.0, -64.0, 47.0, 32.0, 16.0, -64.0, 29.0, -64.0, 42.0, -64.0, -64.0, -64.0, 54.0, -64.0, 9.0, 14.0, 59.0, 59.0, 47.0, 53.0, 22.0, 32.0, 28.0, -64.0, 22.0, 59.0, 58.0, 49.0, 52.0, 58.0, 17.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301561964142403, "mean_inference_ms": 9.716130926177362, "mean_action_processing_ms": 0.4555374911138563, "mean_env_wait_ms": 0.29023686163607804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2761387825012207, "StateBufferConnector_ms": 0.004553794860839844, "ViewRequirementAgentConnector_ms": 0.19897675514221191}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, -64.0, -64.0, 59.0, 58.0, 48.0, 58.0, 53.0, 64.0, 59.0, 58.0, -64.0, -64.0, 37.0, -64.0, 59.0, -63.0, 2.0, 59.0, 25.0, 54.0, -64.0, 58.0, 23.0, 59.0, 59.0, 64.0, 47.0, 5.0, 64.0, -14.0, -64.0, -64.0, -64.0, 53.0, 58.0, -9.0, 58.0, 52.0, 7.0, 42.0, 38.0, 5.0, 64.0, 12.0, 4.0, 4.0, 54.0, 26.0, 53.0, 53.0, 58.0, 58.0, 64.0, 59.0, 37.0, 26.0, 53.0, 54.0, 47.0, 48.0, 25.0, 15.0, -6.0, 59.0, -64.0, 44.0, -64.0, 64.0, -64.0, 47.0, 32.0, 16.0, -64.0, 29.0, -64.0, 42.0, -64.0, -64.0, -64.0, 54.0, -64.0, 9.0, 14.0, 59.0, 59.0, 47.0, 53.0, 22.0, 32.0, 28.0, -64.0, 22.0, 59.0, 58.0, 49.0, 52.0, 58.0, 17.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301561964142403, "mean_inference_ms": 9.716130926177362, "mean_action_processing_ms": 0.4555374911138563, "mean_env_wait_ms": 0.29023686163607804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2761387825012207, "StateBufferConnector_ms": 0.004553794860839844, "ViewRequirementAgentConnector_ms": 0.19897675514221191}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88576, "num_agent_steps_trained": 88576, "num_env_steps_sampled": 88576, "num_env_steps_trained": 88576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.0456843519415, "num_agent_steps_trained_throughput_per_sec": 7.0456843519415, "timesteps_total": 88576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 88576, "timers": {"training_iteration_time_ms": 72225.057, "sample_time_ms": 6082.794, "load_time_ms": 0.274, "load_throughput": 1866890.07, "learn_time_ms": 66141.486, "learn_throughput": 7.741, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 88576, "num_env_steps_trained": 88576, "num_agent_steps_sampled": 88576, "num_agent_steps_trained": 88576}, "done": false, "episodes_total": 5536, "training_iteration": 173, "trial_id": "f4e01_00169", "date": "2024-02-27_03-30-42", "timestamp": 1709001042, "time_this_iter_s": 72.67379426956177, "time_total_s": 12461.167610883713, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12461.167610883713, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 51.77378640776699, "ram_util_percent": 19.645631067961165}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.54, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.66046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.66046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9047998114178578, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.237641700108846, "policy_loss": 0.14644337201025337, "vf_loss": 9.566866302490235, "vf_explained_var": 0.8642800385753314, "kl": 0.0, "entropy": 143.50164718627929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.54, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.66046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.66046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 53.0, 58.0, -9.0, 58.0, 52.0, 7.0, 42.0, 38.0, 5.0, 64.0, 12.0, 4.0, 4.0, 54.0, 26.0, 53.0, 53.0, 58.0, 58.0, 64.0, 59.0, 37.0, 26.0, 53.0, 54.0, 47.0, 48.0, 25.0, 15.0, -6.0, 59.0, -64.0, 44.0, -64.0, 64.0, -64.0, 47.0, 32.0, 16.0, -64.0, 29.0, -64.0, 42.0, -64.0, -64.0, -64.0, 54.0, -64.0, 9.0, 14.0, 59.0, 59.0, 47.0, 53.0, 22.0, 32.0, 28.0, -64.0, 22.0, 59.0, 58.0, 49.0, 52.0, 58.0, 17.0, 53.0, 58.0, 54.0, -64.0, -64.0, 38.0, 53.0, 59.0, 42.0, 59.0, 53.0, 47.0, 11.0, 48.0, 59.0, 53.0, 54.0, 33.0, -64.0, 37.0, 18.0, 64.0, 44.0, 9.0, -64.0, 58.0, -64.0, 54.0, 6.0, -64.0, -64.0, 58.0, 11.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3017332529542551, "mean_inference_ms": 9.717703246523138, "mean_action_processing_ms": 0.45561117960689484, "mean_env_wait_ms": 0.29028051187493825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27691173553466797, "StateBufferConnector_ms": 0.00457310676574707, "ViewRequirementAgentConnector_ms": 0.19748926162719727}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 53.0, 58.0, -9.0, 58.0, 52.0, 7.0, 42.0, 38.0, 5.0, 64.0, 12.0, 4.0, 4.0, 54.0, 26.0, 53.0, 53.0, 58.0, 58.0, 64.0, 59.0, 37.0, 26.0, 53.0, 54.0, 47.0, 48.0, 25.0, 15.0, -6.0, 59.0, -64.0, 44.0, -64.0, 64.0, -64.0, 47.0, 32.0, 16.0, -64.0, 29.0, -64.0, 42.0, -64.0, -64.0, -64.0, 54.0, -64.0, 9.0, 14.0, 59.0, 59.0, 47.0, 53.0, 22.0, 32.0, 28.0, -64.0, 22.0, 59.0, 58.0, 49.0, 52.0, 58.0, 17.0, 53.0, 58.0, 54.0, -64.0, -64.0, 38.0, 53.0, 59.0, 42.0, 59.0, 53.0, 47.0, 11.0, 48.0, 59.0, 53.0, 54.0, 33.0, -64.0, 37.0, 18.0, 64.0, 44.0, 9.0, -64.0, 58.0, -64.0, 54.0, 6.0, -64.0, -64.0, 58.0, 11.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3017332529542551, "mean_inference_ms": 9.717703246523138, "mean_action_processing_ms": 0.45561117960689484, "mean_env_wait_ms": 0.29028051187493825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27691173553466797, "StateBufferConnector_ms": 0.00457310676574707, "ViewRequirementAgentConnector_ms": 0.19748926162719727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.062363711580288, "num_agent_steps_trained_throughput_per_sec": 7.062363711580288, "timesteps_total": 89088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 72242.03, "sample_time_ms": 6129.119, "load_time_ms": 0.28, "load_throughput": 1828423.711, "learn_time_ms": 66112.119, "learn_throughput": 7.744, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "done": false, "episodes_total": 5568, "training_iteration": 174, "trial_id": "f4e01_00169", "date": "2024-02-27_03-31-54", "timestamp": 1709001114, "time_this_iter_s": 72.50243425369263, "time_total_s": 12533.670045137405, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12533.670045137405, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 51.874757281553386, "ram_util_percent": 19.75242718446602}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.52, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6446875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6446875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.781610010067622, "policy_loss": -0.017384141586565722, "vf_loss": 9.107928991317749, "vf_explained_var": 0.7846483141183853, "kl": 0.0, "entropy": 137.0607997894287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.52, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6446875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6446875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -64.0, 44.0, -64.0, 64.0, -64.0, 47.0, 32.0, 16.0, -64.0, 29.0, -64.0, 42.0, -64.0, -64.0, -64.0, 54.0, -64.0, 9.0, 14.0, 59.0, 59.0, 47.0, 53.0, 22.0, 32.0, 28.0, -64.0, 22.0, 59.0, 58.0, 49.0, 52.0, 58.0, 17.0, 53.0, 58.0, 54.0, -64.0, -64.0, 38.0, 53.0, 59.0, 42.0, 59.0, 53.0, 47.0, 11.0, 48.0, 59.0, 53.0, 54.0, 33.0, -64.0, 37.0, 18.0, 64.0, 44.0, 9.0, -64.0, 58.0, -64.0, 54.0, 6.0, -64.0, -64.0, 58.0, 11.0, 12.0, -64.0, 42.0, 14.0, 58.0, -64.0, 38.0, 31.0, 53.0, 58.0, -63.0, 33.0, -8.0, 42.0, 64.0, 21.0, 53.0, -12.0, 54.0, 17.0, 36.0, -2.0, 9.0, 64.0, 59.0, 26.0, 14.0, 8.0, 58.0, 37.0, 58.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3019432919024603, "mean_inference_ms": 9.719353941957941, "mean_action_processing_ms": 0.4556945673869644, "mean_env_wait_ms": 0.2903283948087035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27911901473999023, "StateBufferConnector_ms": 0.004651784896850586, "ViewRequirementAgentConnector_ms": 0.20203804969787598}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -64.0, 44.0, -64.0, 64.0, -64.0, 47.0, 32.0, 16.0, -64.0, 29.0, -64.0, 42.0, -64.0, -64.0, -64.0, 54.0, -64.0, 9.0, 14.0, 59.0, 59.0, 47.0, 53.0, 22.0, 32.0, 28.0, -64.0, 22.0, 59.0, 58.0, 49.0, 52.0, 58.0, 17.0, 53.0, 58.0, 54.0, -64.0, -64.0, 38.0, 53.0, 59.0, 42.0, 59.0, 53.0, 47.0, 11.0, 48.0, 59.0, 53.0, 54.0, 33.0, -64.0, 37.0, 18.0, 64.0, 44.0, 9.0, -64.0, 58.0, -64.0, 54.0, 6.0, -64.0, -64.0, 58.0, 11.0, 12.0, -64.0, 42.0, 14.0, 58.0, -64.0, 38.0, 31.0, 53.0, 58.0, -63.0, 33.0, -8.0, 42.0, 64.0, 21.0, 53.0, -12.0, 54.0, 17.0, 36.0, -2.0, 9.0, 64.0, 59.0, 26.0, 14.0, 8.0, 58.0, 37.0, 58.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3019432919024603, "mean_inference_ms": 9.719353941957941, "mean_action_processing_ms": 0.4556945673869644, "mean_env_wait_ms": 0.2903283948087035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27911901473999023, "StateBufferConnector_ms": 0.004651784896850586, "ViewRequirementAgentConnector_ms": 0.20203804969787598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600, "num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.15883323057482, "num_agent_steps_trained_throughput_per_sec": 7.15883323057482, "timesteps_total": 89600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 89600, "timers": {"training_iteration_time_ms": 72141.248, "sample_time_ms": 6129.828, "load_time_ms": 0.284, "load_throughput": 1803698.68, "learn_time_ms": 66010.616, "learn_throughput": 7.756, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600}, "done": false, "episodes_total": 5600, "training_iteration": 175, "trial_id": "f4e01_00169", "date": "2024-02-27_03-33-06", "timestamp": 1709001186, "time_this_iter_s": 71.52515053749084, "time_total_s": 12605.195195674896, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12605.195195674896, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 51.45841584158416, "ram_util_percent": 19.690099009900987}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 23.78, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.68578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.68578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.773155935605367, "policy_loss": -0.018032782524824143, "vf_loss": 9.095669655005137, "vf_explained_var": 0.8296925187110901, "kl": 0.0, "entropy": 140.44192390441896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 23.78, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.68578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.68578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [52.0, 58.0, 17.0, 53.0, 58.0, 54.0, -64.0, -64.0, 38.0, 53.0, 59.0, 42.0, 59.0, 53.0, 47.0, 11.0, 48.0, 59.0, 53.0, 54.0, 33.0, -64.0, 37.0, 18.0, 64.0, 44.0, 9.0, -64.0, 58.0, -64.0, 54.0, 6.0, -64.0, -64.0, 58.0, 11.0, 12.0, -64.0, 42.0, 14.0, 58.0, -64.0, 38.0, 31.0, 53.0, 58.0, -63.0, 33.0, -8.0, 42.0, 64.0, 21.0, 53.0, -12.0, 54.0, 17.0, 36.0, -2.0, 9.0, 64.0, 59.0, 26.0, 14.0, 8.0, 58.0, 37.0, 58.0, 36.0, -64.0, 28.0, 59.0, 29.0, 30.0, 26.0, 54.0, -5.0, -64.0, 38.0, 8.0, 64.0, 59.0, 5.0, 58.0, 15.0, -64.0, 58.0, 53.0, 24.0, 47.0, -64.0, 23.0, 53.0, 14.0, 47.0, 44.0, 58.0, 64.0, 58.0, -1.0, 30.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021738180419, "mean_inference_ms": 9.721552962506632, "mean_action_processing_ms": 0.4557685600660919, "mean_env_wait_ms": 0.29037261875276876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779207229614258, "StateBufferConnector_ms": 0.004620552062988281, "ViewRequirementAgentConnector_ms": 0.20304393768310547}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.0, 58.0, 17.0, 53.0, 58.0, 54.0, -64.0, -64.0, 38.0, 53.0, 59.0, 42.0, 59.0, 53.0, 47.0, 11.0, 48.0, 59.0, 53.0, 54.0, 33.0, -64.0, 37.0, 18.0, 64.0, 44.0, 9.0, -64.0, 58.0, -64.0, 54.0, 6.0, -64.0, -64.0, 58.0, 11.0, 12.0, -64.0, 42.0, 14.0, 58.0, -64.0, 38.0, 31.0, 53.0, 58.0, -63.0, 33.0, -8.0, 42.0, 64.0, 21.0, 53.0, -12.0, 54.0, 17.0, 36.0, -2.0, 9.0, 64.0, 59.0, 26.0, 14.0, 8.0, 58.0, 37.0, 58.0, 36.0, -64.0, 28.0, 59.0, 29.0, 30.0, 26.0, 54.0, -5.0, -64.0, 38.0, 8.0, 64.0, 59.0, 5.0, 58.0, 15.0, -64.0, 58.0, 53.0, 24.0, 47.0, -64.0, 23.0, 53.0, 14.0, 47.0, 44.0, 58.0, 64.0, 58.0, -1.0, 30.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021738180419, "mean_inference_ms": 9.721552962506632, "mean_action_processing_ms": 0.4557685600660919, "mean_env_wait_ms": 0.29037261875276876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779207229614258, "StateBufferConnector_ms": 0.004620552062988281, "ViewRequirementAgentConnector_ms": 0.20304393768310547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.077686904529645, "num_agent_steps_trained_throughput_per_sec": 7.077686904529645, "timesteps_total": 90112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 72109.428, "sample_time_ms": 6164.06, "load_time_ms": 0.289, "load_throughput": 1771120.534, "learn_time_ms": 65944.544, "learn_throughput": 7.764, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "episodes_total": 5632, "training_iteration": 176, "trial_id": "f4e01_00169", "date": "2024-02-27_03-34-18", "timestamp": 1709001258, "time_this_iter_s": 72.34533619880676, "time_total_s": 12677.540531873703, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12677.540531873703, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 51.140776699029125, "ram_util_percent": 19.76504854368932}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 16.24, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.626875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.626875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8597550234446923, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.164490755399068, "policy_loss": -0.0030172787606716155, "vf_loss": 9.686718714237212, "vf_explained_var": 0.16078286270300549, "kl": 0.0, "entropy": 142.01669158935547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 90624, "num_env_steps_trained": 90624, "num_agent_steps_sampled": 90624, "num_agent_steps_trained": 90624}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 16.24, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.626875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.626875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 58.0, 11.0, 12.0, -64.0, 42.0, 14.0, 58.0, -64.0, 38.0, 31.0, 53.0, 58.0, -63.0, 33.0, -8.0, 42.0, 64.0, 21.0, 53.0, -12.0, 54.0, 17.0, 36.0, -2.0, 9.0, 64.0, 59.0, 26.0, 14.0, 8.0, 58.0, 37.0, 58.0, 36.0, -64.0, 28.0, 59.0, 29.0, 30.0, 26.0, 54.0, -5.0, -64.0, 38.0, 8.0, 64.0, 59.0, 5.0, 58.0, 15.0, -64.0, 58.0, 53.0, 24.0, 47.0, -64.0, 23.0, 53.0, 14.0, 47.0, 44.0, 58.0, 64.0, 58.0, -1.0, 30.0, -64.0, 11.0, 59.0, 48.0, 14.0, 47.0, -64.0, 34.0, 54.0, 64.0, 53.0, 54.0, -64.0, 58.0, 39.0, 2.0, 42.0, -64.0, 21.0, 43.0, 0.0, -64.0, 53.0, 64.0, -64.0, -64.0, -11.0, -63.0, 3.0, -64.0, 4.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021868180116574, "mean_inference_ms": 9.722044153516007, "mean_action_processing_ms": 0.4557727161211552, "mean_env_wait_ms": 0.29036865955112456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27150869369506836, "StateBufferConnector_ms": 0.0045108795166015625, "ViewRequirementAgentConnector_ms": 0.19424962997436523}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 58.0, 11.0, 12.0, -64.0, 42.0, 14.0, 58.0, -64.0, 38.0, 31.0, 53.0, 58.0, -63.0, 33.0, -8.0, 42.0, 64.0, 21.0, 53.0, -12.0, 54.0, 17.0, 36.0, -2.0, 9.0, 64.0, 59.0, 26.0, 14.0, 8.0, 58.0, 37.0, 58.0, 36.0, -64.0, 28.0, 59.0, 29.0, 30.0, 26.0, 54.0, -5.0, -64.0, 38.0, 8.0, 64.0, 59.0, 5.0, 58.0, 15.0, -64.0, 58.0, 53.0, 24.0, 47.0, -64.0, 23.0, 53.0, 14.0, 47.0, 44.0, 58.0, 64.0, 58.0, -1.0, 30.0, -64.0, 11.0, 59.0, 48.0, 14.0, 47.0, -64.0, 34.0, 54.0, 64.0, 53.0, 54.0, -64.0, 58.0, 39.0, 2.0, 42.0, -64.0, 21.0, 43.0, 0.0, -64.0, 53.0, 64.0, -64.0, -64.0, -11.0, -63.0, 3.0, -64.0, 4.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021868180116574, "mean_inference_ms": 9.722044153516007, "mean_action_processing_ms": 0.4557727161211552, "mean_env_wait_ms": 0.29036865955112456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27150869369506836, "StateBufferConnector_ms": 0.0045108795166015625, "ViewRequirementAgentConnector_ms": 0.19424962997436523}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90624, "num_agent_steps_trained": 90624, "num_env_steps_sampled": 90624, "num_env_steps_trained": 90624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.118582761754022, "num_agent_steps_trained_throughput_per_sec": 7.118582761754022, "timesteps_total": 90624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 90624, "timers": {"training_iteration_time_ms": 72064.695, "sample_time_ms": 6144.785, "load_time_ms": 0.293, "load_throughput": 1746347.603, "learn_time_ms": 65919.064, "learn_throughput": 7.767, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 90624, "num_env_steps_trained": 90624, "num_agent_steps_sampled": 90624, "num_agent_steps_trained": 90624}, "done": false, "episodes_total": 5664, "training_iteration": 177, "trial_id": "f4e01_00169", "date": "2024-02-27_03-35-30", "timestamp": 1709001330, "time_this_iter_s": 71.92983031272888, "time_total_s": 12749.470362186432, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12749.470362186432, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 51.65686274509803, "ram_util_percent": 19.75294117647059}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.08, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.964304901783665, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.150838585694631, "policy_loss": 0.03324189741785328, "vf_loss": 9.608327754338582, "vf_explained_var": 0.7388458788394928, "kl": 0.0, "entropy": 135.6896598815918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.08, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 37.0, 58.0, 36.0, -64.0, 28.0, 59.0, 29.0, 30.0, 26.0, 54.0, -5.0, -64.0, 38.0, 8.0, 64.0, 59.0, 5.0, 58.0, 15.0, -64.0, 58.0, 53.0, 24.0, 47.0, -64.0, 23.0, 53.0, 14.0, 47.0, 44.0, 58.0, 64.0, 58.0, -1.0, 30.0, -64.0, 11.0, 59.0, 48.0, 14.0, 47.0, -64.0, 34.0, 54.0, 64.0, 53.0, 54.0, -64.0, 58.0, 39.0, 2.0, 42.0, -64.0, 21.0, 43.0, 0.0, -64.0, 53.0, 64.0, -64.0, -64.0, -11.0, -63.0, 3.0, -64.0, 4.0, -64.0, -64.0, -64.0, 47.0, -64.0, -1.0, 64.0, 53.0, 54.0, 58.0, 38.0, 59.0, 59.0, -16.0, 58.0, 64.0, -64.0, -64.0, 51.0, 22.0, 27.0, 42.0, 64.0, 48.0, 59.0, -64.0, 64.0, 53.0, 2.0, 58.0, 44.0, 46.0, -15.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021937929855936, "mean_inference_ms": 9.7226420535924, "mean_action_processing_ms": 0.4557783845523855, "mean_env_wait_ms": 0.2903685128859577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2716042995452881, "StateBufferConnector_ms": 0.0045375823974609375, "ViewRequirementAgentConnector_ms": 0.19362497329711914}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 37.0, 58.0, 36.0, -64.0, 28.0, 59.0, 29.0, 30.0, 26.0, 54.0, -5.0, -64.0, 38.0, 8.0, 64.0, 59.0, 5.0, 58.0, 15.0, -64.0, 58.0, 53.0, 24.0, 47.0, -64.0, 23.0, 53.0, 14.0, 47.0, 44.0, 58.0, 64.0, 58.0, -1.0, 30.0, -64.0, 11.0, 59.0, 48.0, 14.0, 47.0, -64.0, 34.0, 54.0, 64.0, 53.0, 54.0, -64.0, 58.0, 39.0, 2.0, 42.0, -64.0, 21.0, 43.0, 0.0, -64.0, 53.0, 64.0, -64.0, -64.0, -11.0, -63.0, 3.0, -64.0, 4.0, -64.0, -64.0, -64.0, 47.0, -64.0, -1.0, 64.0, 53.0, 54.0, 58.0, 38.0, 59.0, 59.0, -16.0, 58.0, 64.0, -64.0, -64.0, 51.0, 22.0, 27.0, 42.0, 64.0, 48.0, 59.0, -64.0, 64.0, 53.0, 2.0, 58.0, 44.0, 46.0, -15.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021937929855936, "mean_inference_ms": 9.7226420535924, "mean_action_processing_ms": 0.4557783845523855, "mean_env_wait_ms": 0.2903685128859577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2716042995452881, "StateBufferConnector_ms": 0.0045375823974609375, "ViewRequirementAgentConnector_ms": 0.19362497329711914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.124970752145609, "num_agent_steps_trained_throughput_per_sec": 7.124970752145609, "timesteps_total": 91136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 72031.301, "sample_time_ms": 6147.672, "load_time_ms": 0.295, "load_throughput": 1734919.735, "learn_time_ms": 65882.776, "learn_throughput": 7.771, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "done": false, "episodes_total": 5696, "training_iteration": 178, "trial_id": "f4e01_00169", "date": "2024-02-27_03-36-42", "timestamp": 1709001402, "time_this_iter_s": 71.86511063575745, "time_total_s": 12821.33547282219, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12821.33547282219, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 51.52058823529411, "ram_util_percent": 19.7656862745098}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 16.2, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6265625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6265625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.894826474537452, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.182419407367706, "policy_loss": 0.011574428047363956, "vf_loss": 9.691959790388744, "vf_explained_var": 0.8868909632166226, "kl": 0.0, "entropy": 139.36191635131837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 91648, "num_env_steps_trained": 91648, "num_agent_steps_sampled": 91648, "num_agent_steps_trained": 91648}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 16.2, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6265625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6265625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [64.0, 58.0, -1.0, 30.0, -64.0, 11.0, 59.0, 48.0, 14.0, 47.0, -64.0, 34.0, 54.0, 64.0, 53.0, 54.0, -64.0, 58.0, 39.0, 2.0, 42.0, -64.0, 21.0, 43.0, 0.0, -64.0, 53.0, 64.0, -64.0, -64.0, -11.0, -63.0, 3.0, -64.0, 4.0, -64.0, -64.0, -64.0, 47.0, -64.0, -1.0, 64.0, 53.0, 54.0, 58.0, 38.0, 59.0, 59.0, -16.0, 58.0, 64.0, -64.0, -64.0, 51.0, 22.0, 27.0, 42.0, 64.0, 48.0, 59.0, -64.0, 64.0, 53.0, 2.0, 58.0, 44.0, 46.0, -15.0, -9.0, -64.0, -64.0, 64.0, 19.0, -1.0, 46.0, -64.0, 35.0, 59.0, 35.0, 39.0, 59.0, 47.0, 46.0, -64.0, 53.0, -64.0, 22.0, 53.0, 58.0, 46.0, 41.0, 59.0, -64.0, 12.0, 49.0, 39.0, 48.0, 2.0, 43.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021378585668526, "mean_inference_ms": 9.722531368278553, "mean_action_processing_ms": 0.4557721920399211, "mean_env_wait_ms": 0.2903598798554025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2713758945465088, "StateBufferConnector_ms": 0.00450897216796875, "ViewRequirementAgentConnector_ms": 0.19286417961120605}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0, 58.0, -1.0, 30.0, -64.0, 11.0, 59.0, 48.0, 14.0, 47.0, -64.0, 34.0, 54.0, 64.0, 53.0, 54.0, -64.0, 58.0, 39.0, 2.0, 42.0, -64.0, 21.0, 43.0, 0.0, -64.0, 53.0, 64.0, -64.0, -64.0, -11.0, -63.0, 3.0, -64.0, 4.0, -64.0, -64.0, -64.0, 47.0, -64.0, -1.0, 64.0, 53.0, 54.0, 58.0, 38.0, 59.0, 59.0, -16.0, 58.0, 64.0, -64.0, -64.0, 51.0, 22.0, 27.0, 42.0, 64.0, 48.0, 59.0, -64.0, 64.0, 53.0, 2.0, 58.0, 44.0, 46.0, -15.0, -9.0, -64.0, -64.0, 64.0, 19.0, -1.0, 46.0, -64.0, 35.0, 59.0, 35.0, 39.0, 59.0, 47.0, 46.0, -64.0, 53.0, -64.0, 22.0, 53.0, 58.0, 46.0, 41.0, 59.0, -64.0, 12.0, 49.0, 39.0, 48.0, 2.0, 43.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021378585668526, "mean_inference_ms": 9.722531368278553, "mean_action_processing_ms": 0.4557721920399211, "mean_env_wait_ms": 0.2903598798554025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2713758945465088, "StateBufferConnector_ms": 0.00450897216796875, "ViewRequirementAgentConnector_ms": 0.19286417961120605}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91648, "num_agent_steps_trained": 91648, "num_env_steps_sampled": 91648, "num_env_steps_trained": 91648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.080589092616802, "num_agent_steps_trained_throughput_per_sec": 7.080589092616802, "timesteps_total": 91648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 91648, "timers": {"training_iteration_time_ms": 72033.445, "sample_time_ms": 6140.013, "load_time_ms": 0.294, "load_throughput": 1740262.276, "learn_time_ms": 65892.577, "learn_throughput": 7.77, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 91648, "num_env_steps_trained": 91648, "num_agent_steps_sampled": 91648, "num_agent_steps_trained": 91648}, "done": false, "episodes_total": 5728, "training_iteration": 179, "trial_id": "f4e01_00169", "date": "2024-02-27_03-37-55", "timestamp": 1709001475, "time_this_iter_s": 72.31578159332275, "time_total_s": 12893.651254415512, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12893.651254415512, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 51.39117647058822, "ram_util_percent": 19.835294117647067}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 16.36, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6278125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6278125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9945382858316104, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.484367700417836, "policy_loss": 0.05922220665185402, "vf_loss": 8.520760436852774, "vf_explained_var": 0.7183314681053161, "kl": 0.0, "entropy": 142.30710220336914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 16.36, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6278125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6278125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [3.0, -64.0, 4.0, -64.0, -64.0, -64.0, 47.0, -64.0, -1.0, 64.0, 53.0, 54.0, 58.0, 38.0, 59.0, 59.0, -16.0, 58.0, 64.0, -64.0, -64.0, 51.0, 22.0, 27.0, 42.0, 64.0, 48.0, 59.0, -64.0, 64.0, 53.0, 2.0, 58.0, 44.0, 46.0, -15.0, -9.0, -64.0, -64.0, 64.0, 19.0, -1.0, 46.0, -64.0, 35.0, 59.0, 35.0, 39.0, 59.0, 47.0, 46.0, -64.0, 53.0, -64.0, 22.0, 53.0, 58.0, 46.0, 41.0, 59.0, -64.0, 12.0, 49.0, 39.0, 48.0, 2.0, 43.0, 54.0, 10.0, 11.0, 52.0, 38.0, 22.0, -64.0, -64.0, 59.0, -64.0, 59.0, -64.0, 58.0, 20.0, 13.0, 46.0, 58.0, -64.0, 58.0, 13.0, 53.0, 53.0, 4.0, 64.0, -64.0, 15.0, -64.0, -64.0, 9.0, 58.0, 42.0, 54.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022039985537297, "mean_inference_ms": 9.722910003425206, "mean_action_processing_ms": 0.45582103780850114, "mean_env_wait_ms": 0.29038876568753463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27541017532348633, "StateBufferConnector_ms": 0.004561901092529297, "ViewRequirementAgentConnector_ms": 0.19960474967956543}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.0, -64.0, 4.0, -64.0, -64.0, -64.0, 47.0, -64.0, -1.0, 64.0, 53.0, 54.0, 58.0, 38.0, 59.0, 59.0, -16.0, 58.0, 64.0, -64.0, -64.0, 51.0, 22.0, 27.0, 42.0, 64.0, 48.0, 59.0, -64.0, 64.0, 53.0, 2.0, 58.0, 44.0, 46.0, -15.0, -9.0, -64.0, -64.0, 64.0, 19.0, -1.0, 46.0, -64.0, 35.0, 59.0, 35.0, 39.0, 59.0, 47.0, 46.0, -64.0, 53.0, -64.0, 22.0, 53.0, 58.0, 46.0, 41.0, 59.0, -64.0, 12.0, 49.0, 39.0, 48.0, 2.0, 43.0, 54.0, 10.0, 11.0, 52.0, 38.0, 22.0, -64.0, -64.0, 59.0, -64.0, 59.0, -64.0, 58.0, 20.0, 13.0, 46.0, 58.0, -64.0, 58.0, 13.0, 53.0, 53.0, 4.0, 64.0, -64.0, 15.0, -64.0, -64.0, 9.0, 58.0, 42.0, 54.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022039985537297, "mean_inference_ms": 9.722910003425206, "mean_action_processing_ms": 0.45582103780850114, "mean_env_wait_ms": 0.29038876568753463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27541017532348633, "StateBufferConnector_ms": 0.004561901092529297, "ViewRequirementAgentConnector_ms": 0.19960474967956543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.074345933195707, "num_agent_steps_trained_throughput_per_sec": 7.074345933195707, "timesteps_total": 92160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 72133.819, "sample_time_ms": 6134.19, "load_time_ms": 0.296, "load_throughput": 1731004.069, "learn_time_ms": 65998.798, "learn_throughput": 7.758, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "done": false, "episodes_total": 5760, "training_iteration": 180, "trial_id": "f4e01_00169", "date": "2024-02-27_03-39-07", "timestamp": 1709001547, "time_this_iter_s": 72.37935042381287, "time_total_s": 12966.030604839325, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12966.030604839325, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 51.251456310679615, "ram_util_percent": 19.967961165048546}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.05, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.656640625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.656640625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9985273962219556, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.513305521011352, "policy_loss": 0.06682117975627383, "vf_loss": 8.554275238513947, "vf_explained_var": 0.844842558602492, "kl": 0.0, "entropy": 141.2532071431478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 92672, "num_env_steps_trained": 92672, "num_agent_steps_sampled": 92672, "num_agent_steps_trained": 92672}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.05, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.05, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.656640625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.656640625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 44.0, 46.0, -15.0, -9.0, -64.0, -64.0, 64.0, 19.0, -1.0, 46.0, -64.0, 35.0, 59.0, 35.0, 39.0, 59.0, 47.0, 46.0, -64.0, 53.0, -64.0, 22.0, 53.0, 58.0, 46.0, 41.0, 59.0, -64.0, 12.0, 49.0, 39.0, 48.0, 2.0, 43.0, 54.0, 10.0, 11.0, 52.0, 38.0, 22.0, -64.0, -64.0, 59.0, -64.0, 59.0, -64.0, 58.0, 20.0, 13.0, 46.0, 58.0, -64.0, 58.0, 13.0, 53.0, 53.0, 4.0, 64.0, -64.0, 15.0, -64.0, -64.0, 9.0, 58.0, 42.0, 54.0, 48.0, -64.0, -9.0, 53.0, 47.0, 9.0, 53.0, 64.0, 53.0, 59.0, 59.0, 15.0, -64.0, 59.0, 14.0, 58.0, -64.0, 53.0, 48.0, 59.0, 42.0, 59.0, -64.0, 37.0, 49.0, 43.0, 43.0, -64.0, 64.0, 59.0, -10.0, 31.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021269354960048, "mean_inference_ms": 9.722451364667345, "mean_action_processing_ms": 0.4558160707280537, "mean_env_wait_ms": 0.2903825693753339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26995849609375, "StateBufferConnector_ms": 0.004454612731933594, "ViewRequirementAgentConnector_ms": 0.19121432304382324}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.05, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 44.0, 46.0, -15.0, -9.0, -64.0, -64.0, 64.0, 19.0, -1.0, 46.0, -64.0, 35.0, 59.0, 35.0, 39.0, 59.0, 47.0, 46.0, -64.0, 53.0, -64.0, 22.0, 53.0, 58.0, 46.0, 41.0, 59.0, -64.0, 12.0, 49.0, 39.0, 48.0, 2.0, 43.0, 54.0, 10.0, 11.0, 52.0, 38.0, 22.0, -64.0, -64.0, 59.0, -64.0, 59.0, -64.0, 58.0, 20.0, 13.0, 46.0, 58.0, -64.0, 58.0, 13.0, 53.0, 53.0, 4.0, 64.0, -64.0, 15.0, -64.0, -64.0, 9.0, 58.0, 42.0, 54.0, 48.0, -64.0, -9.0, 53.0, 47.0, 9.0, 53.0, 64.0, 53.0, 59.0, 59.0, 15.0, -64.0, 59.0, 14.0, 58.0, -64.0, 53.0, 48.0, 59.0, 42.0, 59.0, -64.0, 37.0, 49.0, 43.0, 43.0, -64.0, 64.0, 59.0, -10.0, 31.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021269354960048, "mean_inference_ms": 9.722451364667345, "mean_action_processing_ms": 0.4558160707280537, "mean_env_wait_ms": 0.2903825693753339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26995849609375, "StateBufferConnector_ms": 0.004454612731933594, "ViewRequirementAgentConnector_ms": 0.19121432304382324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92672, "num_agent_steps_trained": 92672, "num_env_steps_sampled": 92672, "num_env_steps_trained": 92672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.190709212844966, "num_agent_steps_trained_throughput_per_sec": 7.190709212844966, "timesteps_total": 92672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 92672, "timers": {"training_iteration_time_ms": 72047.06, "sample_time_ms": 6101.432, "load_time_ms": 0.29, "load_throughput": 1764426.627, "learn_time_ms": 65944.814, "learn_throughput": 7.764, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 92672, "num_env_steps_trained": 92672, "num_agent_steps_sampled": 92672, "num_agent_steps_trained": 92672}, "done": false, "episodes_total": 5792, "training_iteration": 181, "trial_id": "f4e01_00169", "date": "2024-02-27_03-40-18", "timestamp": 1709001618, "time_this_iter_s": 71.20831894874573, "time_total_s": 13037.23892378807, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13037.23892378807, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 51.931683168316845, "ram_util_percent": 19.889108910891093}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.86, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63953125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63953125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.163399809598923, "policy_loss": 0.00023699930946653088, "vf_loss": 8.109289073944092, "vf_explained_var": 0.47456506341695787, "kl": 0.0, "entropy": 138.8681963602702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.86, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63953125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63953125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, 2.0, 43.0, 54.0, 10.0, 11.0, 52.0, 38.0, 22.0, -64.0, -64.0, 59.0, -64.0, 59.0, -64.0, 58.0, 20.0, 13.0, 46.0, 58.0, -64.0, 58.0, 13.0, 53.0, 53.0, 4.0, 64.0, -64.0, 15.0, -64.0, -64.0, 9.0, 58.0, 42.0, 54.0, 48.0, -64.0, -9.0, 53.0, 47.0, 9.0, 53.0, 64.0, 53.0, 59.0, 59.0, 15.0, -64.0, 59.0, 14.0, 58.0, -64.0, 53.0, 48.0, 59.0, 42.0, 59.0, -64.0, 37.0, 49.0, 43.0, 43.0, -64.0, 64.0, 59.0, -10.0, 31.0, 42.0, -10.0, -64.0, -64.0, 44.0, 43.0, 59.0, -64.0, 64.0, 11.0, 49.0, 20.0, 54.0, 53.0, 4.0, -64.0, 38.0, 58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 59.0, 59.0, -64.0, 58.0, 53.0, 12.0, 48.0, -64.0, 36.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024460785312706, "mean_inference_ms": 9.721527315919086, "mean_action_processing_ms": 0.4557704446216473, "mean_env_wait_ms": 0.2903523933557821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26581740379333496, "StateBufferConnector_ms": 0.004351615905761719, "ViewRequirementAgentConnector_ms": 0.18271470069885254}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, 2.0, 43.0, 54.0, 10.0, 11.0, 52.0, 38.0, 22.0, -64.0, -64.0, 59.0, -64.0, 59.0, -64.0, 58.0, 20.0, 13.0, 46.0, 58.0, -64.0, 58.0, 13.0, 53.0, 53.0, 4.0, 64.0, -64.0, 15.0, -64.0, -64.0, 9.0, 58.0, 42.0, 54.0, 48.0, -64.0, -9.0, 53.0, 47.0, 9.0, 53.0, 64.0, 53.0, 59.0, 59.0, 15.0, -64.0, 59.0, 14.0, 58.0, -64.0, 53.0, 48.0, 59.0, 42.0, 59.0, -64.0, 37.0, 49.0, 43.0, 43.0, -64.0, 64.0, 59.0, -10.0, 31.0, 42.0, -10.0, -64.0, -64.0, 44.0, 43.0, 59.0, -64.0, 64.0, 11.0, 49.0, 20.0, 54.0, 53.0, 4.0, -64.0, 38.0, 58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 59.0, 59.0, -64.0, 58.0, 53.0, 12.0, 48.0, -64.0, 36.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024460785312706, "mean_inference_ms": 9.721527315919086, "mean_action_processing_ms": 0.4557704446216473, "mean_env_wait_ms": 0.2903523933557821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26581740379333496, "StateBufferConnector_ms": 0.004351615905761719, "ViewRequirementAgentConnector_ms": 0.18271470069885254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.063609831890858, "num_agent_steps_trained_throughput_per_sec": 7.063609831890858, "timesteps_total": 93184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 72118.133, "sample_time_ms": 6105.11, "load_time_ms": 0.288, "load_throughput": 1775073.275, "learn_time_ms": 66012.191, "learn_throughput": 7.756, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "done": false, "episodes_total": 5824, "training_iteration": 182, "trial_id": "f4e01_00169", "date": "2024-02-27_03-41-31", "timestamp": 1709001691, "time_this_iter_s": 72.48962211608887, "time_total_s": 13109.72854590416, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13109.72854590416, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 52.94077669902914, "ram_util_percent": 19.718446601941746}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.59, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.653046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.653046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.59465482433637, "policy_loss": -0.02390799652785063, "vf_loss": 7.253937689463298, "vf_explained_var": 0.15384610146284103, "kl": 0.0, "entropy": 142.0380655924479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 93696, "num_env_steps_trained": 93696, "num_agent_steps_sampled": 93696, "num_agent_steps_trained": 93696}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.59, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.59, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.653046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.653046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [58.0, 42.0, 54.0, 48.0, -64.0, -9.0, 53.0, 47.0, 9.0, 53.0, 64.0, 53.0, 59.0, 59.0, 15.0, -64.0, 59.0, 14.0, 58.0, -64.0, 53.0, 48.0, 59.0, 42.0, 59.0, -64.0, 37.0, 49.0, 43.0, 43.0, -64.0, 64.0, 59.0, -10.0, 31.0, 42.0, -10.0, -64.0, -64.0, 44.0, 43.0, 59.0, -64.0, 64.0, 11.0, 49.0, 20.0, 54.0, 53.0, 4.0, -64.0, 38.0, 58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 59.0, 59.0, -64.0, 58.0, 53.0, 12.0, 48.0, -64.0, 36.0, -64.0, 58.0, 19.0, 58.0, -9.0, 49.0, 54.0, -2.0, 58.0, 48.0, -16.0, 58.0, 49.0, 54.0, 11.0, -64.0, -64.0, 59.0, 2.0, -64.0, 54.0, 48.0, 10.0, -64.0, 59.0, -64.0, -11.0, 59.0, 59.0, -64.0, 48.0, 23.0, 8.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3027507909619076, "mean_inference_ms": 9.720591232707305, "mean_action_processing_ms": 0.45572827463080323, "mean_env_wait_ms": 0.29032640313666824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2662625312805176, "StateBufferConnector_ms": 0.004372119903564453, "ViewRequirementAgentConnector_ms": 0.18326210975646973}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.59, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.0, 42.0, 54.0, 48.0, -64.0, -9.0, 53.0, 47.0, 9.0, 53.0, 64.0, 53.0, 59.0, 59.0, 15.0, -64.0, 59.0, 14.0, 58.0, -64.0, 53.0, 48.0, 59.0, 42.0, 59.0, -64.0, 37.0, 49.0, 43.0, 43.0, -64.0, 64.0, 59.0, -10.0, 31.0, 42.0, -10.0, -64.0, -64.0, 44.0, 43.0, 59.0, -64.0, 64.0, 11.0, 49.0, 20.0, 54.0, 53.0, 4.0, -64.0, 38.0, 58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 59.0, 59.0, -64.0, 58.0, 53.0, 12.0, 48.0, -64.0, 36.0, -64.0, 58.0, 19.0, 58.0, -9.0, 49.0, 54.0, -2.0, 58.0, 48.0, -16.0, 58.0, 49.0, 54.0, 11.0, -64.0, -64.0, 59.0, 2.0, -64.0, 54.0, 48.0, 10.0, -64.0, 59.0, -64.0, -11.0, 59.0, 59.0, -64.0, 48.0, 23.0, 8.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3027507909619076, "mean_inference_ms": 9.720591232707305, "mean_action_processing_ms": 0.45572827463080323, "mean_env_wait_ms": 0.29032640313666824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2662625312805176, "StateBufferConnector_ms": 0.004372119903564453, "ViewRequirementAgentConnector_ms": 0.18326210975646973}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93696, "num_agent_steps_trained": 93696, "num_env_steps_sampled": 93696, "num_env_steps_trained": 93696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.199997870326672, "num_agent_steps_trained_throughput_per_sec": 7.199997870326672, "timesteps_total": 93696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 93696, "timers": {"training_iteration_time_ms": 71962.387, "sample_time_ms": 6096.569, "load_time_ms": 0.29, "load_throughput": 1765441.999, "learn_time_ms": 65864.984, "learn_throughput": 7.773, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 93696, "num_env_steps_trained": 93696, "num_agent_steps_sampled": 93696, "num_agent_steps_trained": 93696}, "done": false, "episodes_total": 5856, "training_iteration": 183, "trial_id": "f4e01_00169", "date": "2024-02-27_03-42-42", "timestamp": 1709001762, "time_this_iter_s": 71.11635041236877, "time_total_s": 13180.844896316528, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13180.844896316528, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 51.52574257425743, "ram_util_percent": 19.657425742574254}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 14.38, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.179120951890946, "policy_loss": 0.011132927564904093, "vf_loss": 8.11686757405599, "vf_explained_var": 0.3211791877945264, "kl": 0.0, "entropy": 141.1069300333659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 14.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 14.38, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -10.0, 31.0, 42.0, -10.0, -64.0, -64.0, 44.0, 43.0, 59.0, -64.0, 64.0, 11.0, 49.0, 20.0, 54.0, 53.0, 4.0, -64.0, 38.0, 58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 59.0, 59.0, -64.0, 58.0, 53.0, 12.0, 48.0, -64.0, 36.0, -64.0, 58.0, 19.0, 58.0, -9.0, 49.0, 54.0, -2.0, 58.0, 48.0, -16.0, 58.0, 49.0, 54.0, 11.0, -64.0, -64.0, 59.0, 2.0, -64.0, 54.0, 48.0, 10.0, -64.0, 59.0, -64.0, -11.0, 59.0, 59.0, -64.0, 48.0, 23.0, 8.0, 27.0, 48.0, 58.0, 43.0, -64.0, -64.0, 64.0, 54.0, 4.0, -64.0, 53.0, 39.0, -64.0, 32.0, -64.0, 58.0, 53.0, 64.0, 26.0, -64.0, 42.0, -64.0, 4.0, 54.0, 53.0, 23.0, -64.0, 59.0, 19.0, 49.0, -64.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3036304801944933, "mean_inference_ms": 9.720410171692814, "mean_action_processing_ms": 0.45574220324942616, "mean_env_wait_ms": 0.2903454759119271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.272540807723999, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.19176769256591797}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 14.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -10.0, 31.0, 42.0, -10.0, -64.0, -64.0, 44.0, 43.0, 59.0, -64.0, 64.0, 11.0, 49.0, 20.0, 54.0, 53.0, 4.0, -64.0, 38.0, 58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 59.0, 59.0, -64.0, 58.0, 53.0, 12.0, 48.0, -64.0, 36.0, -64.0, 58.0, 19.0, 58.0, -9.0, 49.0, 54.0, -2.0, 58.0, 48.0, -16.0, 58.0, 49.0, 54.0, 11.0, -64.0, -64.0, 59.0, 2.0, -64.0, 54.0, 48.0, 10.0, -64.0, 59.0, -64.0, -11.0, 59.0, 59.0, -64.0, 48.0, 23.0, 8.0, 27.0, 48.0, 58.0, 43.0, -64.0, -64.0, 64.0, 54.0, 4.0, -64.0, 53.0, 39.0, -64.0, 32.0, -64.0, 58.0, 53.0, 64.0, 26.0, -64.0, 42.0, -64.0, 4.0, 54.0, 53.0, 23.0, -64.0, 59.0, 19.0, 49.0, -64.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3036304801944933, "mean_inference_ms": 9.720410171692814, "mean_action_processing_ms": 0.45574220324942616, "mean_env_wait_ms": 0.2903454759119271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.272540807723999, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.19176769256591797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.147467781324669, "num_agent_steps_trained_throughput_per_sec": 7.147467781324669, "timesteps_total": 94208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 71876.066, "sample_time_ms": 6075.721, "load_time_ms": 0.285, "load_throughput": 1797659.173, "learn_time_ms": 65799.53, "learn_throughput": 7.781, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "done": false, "episodes_total": 5888, "training_iteration": 184, "trial_id": "f4e01_00169", "date": "2024-02-27_03-43-54", "timestamp": 1709001834, "time_this_iter_s": 71.63897442817688, "time_total_s": 13252.483870744705, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13252.483870744705, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 52.356862745098034, "ram_util_percent": 19.7343137254902}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 12.03, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.593984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.593984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.330969087282816, "policy_loss": -0.008706071072568496, "vf_loss": 8.38652031024297, "vf_explained_var": 0.2870428850253423, "kl": 0.0, "entropy": 142.19743893941242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 94720, "num_env_steps_trained": 94720, "num_agent_steps_sampled": 94720, "num_agent_steps_trained": 94720}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.03, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 12.03, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.593984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.593984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [48.0, -64.0, 36.0, -64.0, 58.0, 19.0, 58.0, -9.0, 49.0, 54.0, -2.0, 58.0, 48.0, -16.0, 58.0, 49.0, 54.0, 11.0, -64.0, -64.0, 59.0, 2.0, -64.0, 54.0, 48.0, 10.0, -64.0, 59.0, -64.0, -11.0, 59.0, 59.0, -64.0, 48.0, 23.0, 8.0, 27.0, 48.0, 58.0, 43.0, -64.0, -64.0, 64.0, 54.0, 4.0, -64.0, 53.0, 39.0, -64.0, 32.0, -64.0, 58.0, 53.0, 64.0, 26.0, -64.0, 42.0, -64.0, 4.0, 54.0, 53.0, 23.0, -64.0, 59.0, 19.0, 49.0, -64.0, 42.0, 27.0, -64.0, 21.0, 59.0, 54.0, 14.0, 48.0, 54.0, -64.0, 22.0, 43.0, 33.0, 34.0, 9.0, 34.0, -64.0, 48.0, 38.0, 64.0, 53.0, 53.0, -64.0, -64.0, -64.0, 48.0, 48.0, -64.0, 54.0, -64.0, 29.0, 21.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3041228222087566, "mean_inference_ms": 9.720496643335935, "mean_action_processing_ms": 0.45577716047552613, "mean_env_wait_ms": 0.29037593105246123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739424705505371, "StateBufferConnector_ms": 0.0045392513275146484, "ViewRequirementAgentConnector_ms": 0.19430088996887207}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.03, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.0, -64.0, 36.0, -64.0, 58.0, 19.0, 58.0, -9.0, 49.0, 54.0, -2.0, 58.0, 48.0, -16.0, 58.0, 49.0, 54.0, 11.0, -64.0, -64.0, 59.0, 2.0, -64.0, 54.0, 48.0, 10.0, -64.0, 59.0, -64.0, -11.0, 59.0, 59.0, -64.0, 48.0, 23.0, 8.0, 27.0, 48.0, 58.0, 43.0, -64.0, -64.0, 64.0, 54.0, 4.0, -64.0, 53.0, 39.0, -64.0, 32.0, -64.0, 58.0, 53.0, 64.0, 26.0, -64.0, 42.0, -64.0, 4.0, 54.0, 53.0, 23.0, -64.0, 59.0, 19.0, 49.0, -64.0, 42.0, 27.0, -64.0, 21.0, 59.0, 54.0, 14.0, 48.0, 54.0, -64.0, 22.0, 43.0, 33.0, 34.0, 9.0, 34.0, -64.0, 48.0, 38.0, 64.0, 53.0, 53.0, -64.0, -64.0, -64.0, 48.0, 48.0, -64.0, 54.0, -64.0, 29.0, 21.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3041228222087566, "mean_inference_ms": 9.720496643335935, "mean_action_processing_ms": 0.45577716047552613, "mean_env_wait_ms": 0.29037593105246123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2739424705505371, "StateBufferConnector_ms": 0.0045392513275146484, "ViewRequirementAgentConnector_ms": 0.19430088996887207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94720, "num_agent_steps_trained": 94720, "num_env_steps_sampled": 94720, "num_env_steps_trained": 94720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.182290660803866, "num_agent_steps_trained_throughput_per_sec": 7.182290660803866, "timesteps_total": 94720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 94720, "timers": {"training_iteration_time_ms": 71852.707, "sample_time_ms": 6068.462, "load_time_ms": 0.279, "load_throughput": 1833732.088, "learn_time_ms": 65783.443, "learn_throughput": 7.783, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 94720, "num_env_steps_trained": 94720, "num_agent_steps_sampled": 94720, "num_agent_steps_trained": 94720}, "done": false, "episodes_total": 5920, "training_iteration": 185, "trial_id": "f4e01_00169", "date": "2024-02-27_03-45-05", "timestamp": 1709001905, "time_this_iter_s": 71.29206132888794, "time_total_s": 13323.775932073593, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13323.775932073593, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 51.45643564356435, "ram_util_percent": 19.794059405940594}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 13.24, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6034375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6034375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.185865316788355, "policy_loss": -0.023609587053457896, "vf_loss": 8.182027173042297, "vf_explained_var": 0.9023235658804576, "kl": 0.0, "entropy": 142.46328303019206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 13.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 13.24, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6034375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6034375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 48.0, 23.0, 8.0, 27.0, 48.0, 58.0, 43.0, -64.0, -64.0, 64.0, 54.0, 4.0, -64.0, 53.0, 39.0, -64.0, 32.0, -64.0, 58.0, 53.0, 64.0, 26.0, -64.0, 42.0, -64.0, 4.0, 54.0, 53.0, 23.0, -64.0, 59.0, 19.0, 49.0, -64.0, 42.0, 27.0, -64.0, 21.0, 59.0, 54.0, 14.0, 48.0, 54.0, -64.0, 22.0, 43.0, 33.0, 34.0, 9.0, 34.0, -64.0, 48.0, 38.0, 64.0, 53.0, 53.0, -64.0, -64.0, -64.0, 48.0, 48.0, -64.0, 54.0, -64.0, 29.0, 21.0, -64.0, 9.0, 28.0, 31.0, 43.0, 58.0, -64.0, -64.0, 59.0, 52.0, 53.0, 37.0, 33.0, 47.0, 48.0, 53.0, -64.0, 32.0, 47.0, -64.0, 16.0, 27.0, 53.0, 31.0, -64.0, 58.0, 49.0, 39.0, -64.0, 59.0, -64.0, 54.0, 17.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3045945813430424, "mean_inference_ms": 9.720776697531615, "mean_action_processing_ms": 0.45583268019184314, "mean_env_wait_ms": 0.2904139972127451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.274672269821167, "StateBufferConnector_ms": 0.004530906677246094, "ViewRequirementAgentConnector_ms": 0.19684672355651855}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 13.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 48.0, 23.0, 8.0, 27.0, 48.0, 58.0, 43.0, -64.0, -64.0, 64.0, 54.0, 4.0, -64.0, 53.0, 39.0, -64.0, 32.0, -64.0, 58.0, 53.0, 64.0, 26.0, -64.0, 42.0, -64.0, 4.0, 54.0, 53.0, 23.0, -64.0, 59.0, 19.0, 49.0, -64.0, 42.0, 27.0, -64.0, 21.0, 59.0, 54.0, 14.0, 48.0, 54.0, -64.0, 22.0, 43.0, 33.0, 34.0, 9.0, 34.0, -64.0, 48.0, 38.0, 64.0, 53.0, 53.0, -64.0, -64.0, -64.0, 48.0, 48.0, -64.0, 54.0, -64.0, 29.0, 21.0, -64.0, 9.0, 28.0, 31.0, 43.0, 58.0, -64.0, -64.0, 59.0, 52.0, 53.0, 37.0, 33.0, 47.0, 48.0, 53.0, -64.0, 32.0, 47.0, -64.0, 16.0, 27.0, 53.0, 31.0, -64.0, 58.0, 49.0, 39.0, -64.0, 59.0, -64.0, 54.0, 17.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3045945813430424, "mean_inference_ms": 9.720776697531615, "mean_action_processing_ms": 0.45583268019184314, "mean_env_wait_ms": 0.2904139972127451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.274672269821167, "StateBufferConnector_ms": 0.004530906677246094, "ViewRequirementAgentConnector_ms": 0.19684672355651855}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.196755247060155, "num_agent_steps_trained_throughput_per_sec": 7.196755247060155, "timesteps_total": 95232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 71733.024, "sample_time_ms": 6051.539, "load_time_ms": 0.276, "load_throughput": 1858167.04, "learn_time_ms": 65680.696, "learn_throughput": 7.795, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "done": false, "episodes_total": 5952, "training_iteration": 186, "trial_id": "f4e01_00169", "date": "2024-02-27_03-46-16", "timestamp": 1709001976, "time_this_iter_s": 71.14867615699768, "time_total_s": 13394.92460823059, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13394.92460823059, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 52.291089108910896, "ram_util_percent": 19.745544554455446}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 16.34, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.62765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.62765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.531944370269775, "policy_loss": -0.017230474296957253, "vf_loss": 7.144956545035044, "vf_explained_var": 0.8568070555726687, "kl": 0.0, "entropy": 138.98169797261556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 95744, "num_env_steps_trained": 95744, "num_agent_steps_sampled": 95744, "num_agent_steps_trained": 95744}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 16.34, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.62765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.62765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [19.0, 49.0, -64.0, 42.0, 27.0, -64.0, 21.0, 59.0, 54.0, 14.0, 48.0, 54.0, -64.0, 22.0, 43.0, 33.0, 34.0, 9.0, 34.0, -64.0, 48.0, 38.0, 64.0, 53.0, 53.0, -64.0, -64.0, -64.0, 48.0, 48.0, -64.0, 54.0, -64.0, 29.0, 21.0, -64.0, 9.0, 28.0, 31.0, 43.0, 58.0, -64.0, -64.0, 59.0, 52.0, 53.0, 37.0, 33.0, 47.0, 48.0, 53.0, -64.0, 32.0, 47.0, -64.0, 16.0, 27.0, 53.0, 31.0, -64.0, 58.0, 49.0, 39.0, -64.0, 59.0, -64.0, 54.0, 17.0, 54.0, -64.0, 53.0, -64.0, 37.0, 58.0, 36.0, 49.0, 5.0, 34.0, 47.0, -64.0, 27.0, 49.0, -1.0, 53.0, 43.0, -64.0, 59.0, 42.0, 39.0, 37.0, 43.0, -64.0, 34.0, 37.0, 47.0, -64.0, 53.0, 43.0, 47.0, 30.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3047357331374219, "mean_inference_ms": 9.721378677381104, "mean_action_processing_ms": 0.4559110351373698, "mean_env_wait_ms": 0.2904563758714944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27526235580444336, "StateBufferConnector_ms": 0.004610538482666016, "ViewRequirementAgentConnector_ms": 0.20067596435546875}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 16.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.0, 49.0, -64.0, 42.0, 27.0, -64.0, 21.0, 59.0, 54.0, 14.0, 48.0, 54.0, -64.0, 22.0, 43.0, 33.0, 34.0, 9.0, 34.0, -64.0, 48.0, 38.0, 64.0, 53.0, 53.0, -64.0, -64.0, -64.0, 48.0, 48.0, -64.0, 54.0, -64.0, 29.0, 21.0, -64.0, 9.0, 28.0, 31.0, 43.0, 58.0, -64.0, -64.0, 59.0, 52.0, 53.0, 37.0, 33.0, 47.0, 48.0, 53.0, -64.0, 32.0, 47.0, -64.0, 16.0, 27.0, 53.0, 31.0, -64.0, 58.0, 49.0, 39.0, -64.0, 59.0, -64.0, 54.0, 17.0, 54.0, -64.0, 53.0, -64.0, 37.0, 58.0, 36.0, 49.0, 5.0, 34.0, 47.0, -64.0, 27.0, 49.0, -1.0, 53.0, 43.0, -64.0, 59.0, 42.0, 39.0, 37.0, 43.0, -64.0, 34.0, 37.0, 47.0, -64.0, 53.0, 43.0, 47.0, 30.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3047357331374219, "mean_inference_ms": 9.721378677381104, "mean_action_processing_ms": 0.4559110351373698, "mean_env_wait_ms": 0.2904563758714944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27526235580444336, "StateBufferConnector_ms": 0.004610538482666016, "ViewRequirementAgentConnector_ms": 0.20067596435546875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95744, "num_agent_steps_trained": 95744, "num_env_steps_sampled": 95744, "num_env_steps_trained": 95744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.226189957706698, "num_agent_steps_trained_throughput_per_sec": 7.226189957706698, "timesteps_total": 95744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 95744, "timers": {"training_iteration_time_ms": 71625.921, "sample_time_ms": 6090.51, "load_time_ms": 0.275, "load_throughput": 1860743.131, "learn_time_ms": 65534.628, "learn_throughput": 7.813, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 95744, "num_env_steps_trained": 95744, "num_agent_steps_sampled": 95744, "num_agent_steps_trained": 95744}, "done": false, "episodes_total": 5984, "training_iteration": 187, "trial_id": "f4e01_00169", "date": "2024-02-27_03-47-27", "timestamp": 1709002047, "time_this_iter_s": 70.85851001739502, "time_total_s": 13465.783118247986, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13465.783118247986, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 51.217, "ram_util_percent": 19.756}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.01, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.656328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.656328125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9596979297697544, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.583498831590017, "policy_loss": -0.002903979147473971, "vf_loss": 8.77403206427892, "vf_explained_var": 0.9457983702421189, "kl": 0.0, "entropy": 142.22316449483236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.01, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.01, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.656328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.656328125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 29.0, 21.0, -64.0, 9.0, 28.0, 31.0, 43.0, 58.0, -64.0, -64.0, 59.0, 52.0, 53.0, 37.0, 33.0, 47.0, 48.0, 53.0, -64.0, 32.0, 47.0, -64.0, 16.0, 27.0, 53.0, 31.0, -64.0, 58.0, 49.0, 39.0, -64.0, 59.0, -64.0, 54.0, 17.0, 54.0, -64.0, 53.0, -64.0, 37.0, 58.0, 36.0, 49.0, 5.0, 34.0, 47.0, -64.0, 27.0, 49.0, -1.0, 53.0, 43.0, -64.0, 59.0, 42.0, 39.0, 37.0, 43.0, -64.0, 34.0, 37.0, 47.0, -64.0, 53.0, 43.0, 47.0, 30.0, 33.0, 46.0, 48.0, 16.0, 49.0, -64.0, 34.0, -64.0, 39.0, 43.0, 43.0, 59.0, 48.0, 43.0, 53.0, 23.0, 59.0, -64.0, 48.0, 49.0, 53.0, 53.0, 33.0, 28.0, 44.0, 42.0, 42.0, 53.0, -64.0, 29.0, 33.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30466791660208, "mean_inference_ms": 9.72117692608975, "mean_action_processing_ms": 0.45592140017384836, "mean_env_wait_ms": 0.29044700506199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2706935405731201, "StateBufferConnector_ms": 0.004500627517700195, "ViewRequirementAgentConnector_ms": 0.19449687004089355}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.01, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 29.0, 21.0, -64.0, 9.0, 28.0, 31.0, 43.0, 58.0, -64.0, -64.0, 59.0, 52.0, 53.0, 37.0, 33.0, 47.0, 48.0, 53.0, -64.0, 32.0, 47.0, -64.0, 16.0, 27.0, 53.0, 31.0, -64.0, 58.0, 49.0, 39.0, -64.0, 59.0, -64.0, 54.0, 17.0, 54.0, -64.0, 53.0, -64.0, 37.0, 58.0, 36.0, 49.0, 5.0, 34.0, 47.0, -64.0, 27.0, 49.0, -1.0, 53.0, 43.0, -64.0, 59.0, 42.0, 39.0, 37.0, 43.0, -64.0, 34.0, 37.0, 47.0, -64.0, 53.0, 43.0, 47.0, 30.0, 33.0, 46.0, 48.0, 16.0, 49.0, -64.0, 34.0, -64.0, 39.0, 43.0, 43.0, 59.0, 48.0, 43.0, 53.0, 23.0, 59.0, -64.0, 48.0, 49.0, 53.0, 53.0, 33.0, 28.0, 44.0, 42.0, 42.0, 53.0, -64.0, 29.0, 33.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30466791660208, "mean_inference_ms": 9.72117692608975, "mean_action_processing_ms": 0.45592140017384836, "mean_env_wait_ms": 0.29044700506199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2706935405731201, "StateBufferConnector_ms": 0.004500627517700195, "ViewRequirementAgentConnector_ms": 0.19449687004089355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.270175552632342, "num_agent_steps_trained_throughput_per_sec": 7.270175552632342, "timesteps_total": 96256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 71482.396, "sample_time_ms": 6044.027, "load_time_ms": 0.272, "load_throughput": 1882601.603, "learn_time_ms": 65437.589, "learn_throughput": 7.824, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "done": false, "episodes_total": 6016, "training_iteration": 188, "trial_id": "f4e01_00169", "date": "2024-02-27_03-48-38", "timestamp": 1709002118, "time_this_iter_s": 70.43001770973206, "time_total_s": 13536.213135957718, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13536.213135957718, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 51.442, "ram_util_percent": 19.742}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.06, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.65671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.65671875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.31817133029302, "policy_loss": 0.031832457054406404, "vf_loss": 8.302750074863434, "vf_explained_var": 0.9575700546304385, "kl": 0.0, "entropy": 142.91418685913087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 96768, "num_env_steps_trained": 96768, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 96768}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.06, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.65671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.65671875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -64.0, 54.0, 17.0, 54.0, -64.0, 53.0, -64.0, 37.0, 58.0, 36.0, 49.0, 5.0, 34.0, 47.0, -64.0, 27.0, 49.0, -1.0, 53.0, 43.0, -64.0, 59.0, 42.0, 39.0, 37.0, 43.0, -64.0, 34.0, 37.0, 47.0, -64.0, 53.0, 43.0, 47.0, 30.0, 33.0, 46.0, 48.0, 16.0, 49.0, -64.0, 34.0, -64.0, 39.0, 43.0, 43.0, 59.0, 48.0, 43.0, 53.0, 23.0, 59.0, -64.0, 48.0, 49.0, 53.0, 53.0, 33.0, 28.0, 44.0, 42.0, 42.0, 53.0, -64.0, 29.0, 33.0, -64.0, 58.0, 54.0, -64.0, 58.0, 26.0, -64.0, 38.0, 28.0, 59.0, -64.0, 44.0, 44.0, 18.0, -64.0, 43.0, 26.0, 21.0, 31.0, -64.0, 23.0, 22.0, 47.0, 53.0, 52.0, 34.0, -63.0, -64.0, 39.0, 42.0, 53.0, 42.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3043894365425315, "mean_inference_ms": 9.72000106195187, "mean_action_processing_ms": 0.45583701929124004, "mean_env_wait_ms": 0.2903774420219019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26098084449768066, "StateBufferConnector_ms": 0.004342794418334961, "ViewRequirementAgentConnector_ms": 0.17995119094848633}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -64.0, 54.0, 17.0, 54.0, -64.0, 53.0, -64.0, 37.0, 58.0, 36.0, 49.0, 5.0, 34.0, 47.0, -64.0, 27.0, 49.0, -1.0, 53.0, 43.0, -64.0, 59.0, 42.0, 39.0, 37.0, 43.0, -64.0, 34.0, 37.0, 47.0, -64.0, 53.0, 43.0, 47.0, 30.0, 33.0, 46.0, 48.0, 16.0, 49.0, -64.0, 34.0, -64.0, 39.0, 43.0, 43.0, 59.0, 48.0, 43.0, 53.0, 23.0, 59.0, -64.0, 48.0, 49.0, 53.0, 53.0, 33.0, 28.0, 44.0, 42.0, 42.0, 53.0, -64.0, 29.0, 33.0, -64.0, 58.0, 54.0, -64.0, 58.0, 26.0, -64.0, 38.0, 28.0, 59.0, -64.0, 44.0, 44.0, 18.0, -64.0, 43.0, 26.0, 21.0, 31.0, -64.0, 23.0, 22.0, 47.0, 53.0, 52.0, 34.0, -63.0, -64.0, 39.0, 42.0, 53.0, 42.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3043894365425315, "mean_inference_ms": 9.72000106195187, "mean_action_processing_ms": 0.45583701929124004, "mean_env_wait_ms": 0.2903774420219019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26098084449768066, "StateBufferConnector_ms": 0.004342794418334961, "ViewRequirementAgentConnector_ms": 0.17995119094848633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 96768, "num_env_steps_sampled": 96768, "num_env_steps_trained": 96768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.23237974031164, "num_agent_steps_trained_throughput_per_sec": 7.23237974031164, "timesteps_total": 96768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 71330.634, "sample_time_ms": 6009.729, "load_time_ms": 0.272, "load_throughput": 1880787.921, "learn_time_ms": 65320.138, "learn_throughput": 7.838, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 96768, "num_env_steps_trained": 96768, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 96768}, "done": false, "episodes_total": 6048, "training_iteration": 189, "trial_id": "f4e01_00169", "date": "2024-02-27_03-49-49", "timestamp": 1709002189, "time_this_iter_s": 70.79788017272949, "time_total_s": 13607.011016130447, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13607.011016130447, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 51.27128712871288, "ram_util_percent": 19.723762376237627}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.96, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6559375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.6559375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9901808246970176, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.548588750759761, "policy_loss": 0.005353089111546676, "vf_loss": 8.706233457724254, "vf_explained_var": 0.8004188954830169, "kl": 0.0, "entropy": 140.9740535736084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.96, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6559375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.6559375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 43.0, 47.0, 30.0, 33.0, 46.0, 48.0, 16.0, 49.0, -64.0, 34.0, -64.0, 39.0, 43.0, 43.0, 59.0, 48.0, 43.0, 53.0, 23.0, 59.0, -64.0, 48.0, 49.0, 53.0, 53.0, 33.0, 28.0, 44.0, 42.0, 42.0, 53.0, -64.0, 29.0, 33.0, -64.0, 58.0, 54.0, -64.0, 58.0, 26.0, -64.0, 38.0, 28.0, 59.0, -64.0, 44.0, 44.0, 18.0, -64.0, 43.0, 26.0, 21.0, 31.0, -64.0, 23.0, 22.0, 47.0, 53.0, 52.0, 34.0, -63.0, -64.0, 39.0, 42.0, 53.0, 42.0, -62.0, 54.0, 53.0, 42.0, 48.0, -64.0, 44.0, 49.0, 54.0, 35.0, 5.0, -64.0, 48.0, -64.0, 54.0, 43.0, -64.0, -64.0, 23.0, -64.0, 48.0, 44.0, 42.0, 59.0, 48.0, 48.0, 32.0, -64.0, -64.0, 37.0, 59.0, 58.0, 39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.303906145423573, "mean_inference_ms": 9.717632733634389, "mean_action_processing_ms": 0.45566017468370246, "mean_env_wait_ms": 0.29024828050380674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25221943855285645, "StateBufferConnector_ms": 0.0041582584381103516, "ViewRequirementAgentConnector_ms": 0.1671442985534668}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 43.0, 47.0, 30.0, 33.0, 46.0, 48.0, 16.0, 49.0, -64.0, 34.0, -64.0, 39.0, 43.0, 43.0, 59.0, 48.0, 43.0, 53.0, 23.0, 59.0, -64.0, 48.0, 49.0, 53.0, 53.0, 33.0, 28.0, 44.0, 42.0, 42.0, 53.0, -64.0, 29.0, 33.0, -64.0, 58.0, 54.0, -64.0, 58.0, 26.0, -64.0, 38.0, 28.0, 59.0, -64.0, 44.0, 44.0, 18.0, -64.0, 43.0, 26.0, 21.0, 31.0, -64.0, 23.0, 22.0, 47.0, 53.0, 52.0, 34.0, -63.0, -64.0, 39.0, 42.0, 53.0, 42.0, -62.0, 54.0, 53.0, 42.0, 48.0, -64.0, 44.0, 49.0, 54.0, 35.0, 5.0, -64.0, 48.0, -64.0, 54.0, 43.0, -64.0, -64.0, 23.0, -64.0, 48.0, 44.0, 42.0, 59.0, 48.0, 48.0, 32.0, -64.0, -64.0, 37.0, 59.0, 58.0, 39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.303906145423573, "mean_inference_ms": 9.717632733634389, "mean_action_processing_ms": 0.45566017468370246, "mean_env_wait_ms": 0.29024828050380674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25221943855285645, "StateBufferConnector_ms": 0.0041582584381103516, "ViewRequirementAgentConnector_ms": 0.1671442985534668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.204621860336501, "num_agent_steps_trained_throughput_per_sec": 7.204621860336501, "timesteps_total": 97280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 71199.766, "sample_time_ms": 5973.807, "load_time_ms": 0.266, "load_throughput": 1926685.491, "learn_time_ms": 65225.18, "learn_throughput": 7.85, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "done": false, "episodes_total": 6080, "training_iteration": 190, "trial_id": "f4e01_00169", "date": "2024-02-27_03-51-00", "timestamp": 1709002260, "time_this_iter_s": 71.0706102848053, "time_total_s": 13678.081626415253, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13678.081626415253, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 52.38019801980199, "ram_util_percent": 19.781188118811883}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.02, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.63296875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7071864430482189, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.3427970925966894, "policy_loss": 0.009662300014557939, "vf_loss": 9.946852894624074, "vf_explained_var": 0.9458735436201096, "kl": 0.0, "entropy": 138.5651335398356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 97792, "num_env_steps_trained": 97792, "num_agent_steps_sampled": 97792, "num_agent_steps_trained": 97792}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.02, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.63296875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 29.0, 33.0, -64.0, 58.0, 54.0, -64.0, 58.0, 26.0, -64.0, 38.0, 28.0, 59.0, -64.0, 44.0, 44.0, 18.0, -64.0, 43.0, 26.0, 21.0, 31.0, -64.0, 23.0, 22.0, 47.0, 53.0, 52.0, 34.0, -63.0, -64.0, 39.0, 42.0, 53.0, 42.0, -62.0, 54.0, 53.0, 42.0, 48.0, -64.0, 44.0, 49.0, 54.0, 35.0, 5.0, -64.0, 48.0, -64.0, 54.0, 43.0, -64.0, -64.0, 23.0, -64.0, 48.0, 44.0, 42.0, 59.0, 48.0, 48.0, 32.0, -64.0, -64.0, 37.0, 59.0, 58.0, 39.0, -64.0, -64.0, 44.0, 29.0, 37.0, 20.0, 36.0, 13.0, 59.0, 49.0, 10.0, 39.0, 12.0, 12.0, 43.0, -64.0, 28.0, 49.0, 21.0, 52.0, 9.0, 53.0, 43.0, 44.0, 53.0, 48.0, 59.0, 31.0, -64.0, 44.0, 28.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3035034253208777, "mean_inference_ms": 9.715676949340423, "mean_action_processing_ms": 0.4555191249148675, "mean_env_wait_ms": 0.29014197543758724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.255584716796875, "StateBufferConnector_ms": 0.004190921783447266, "ViewRequirementAgentConnector_ms": 0.17235302925109863}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 29.0, 33.0, -64.0, 58.0, 54.0, -64.0, 58.0, 26.0, -64.0, 38.0, 28.0, 59.0, -64.0, 44.0, 44.0, 18.0, -64.0, 43.0, 26.0, 21.0, 31.0, -64.0, 23.0, 22.0, 47.0, 53.0, 52.0, 34.0, -63.0, -64.0, 39.0, 42.0, 53.0, 42.0, -62.0, 54.0, 53.0, 42.0, 48.0, -64.0, 44.0, 49.0, 54.0, 35.0, 5.0, -64.0, 48.0, -64.0, 54.0, 43.0, -64.0, -64.0, 23.0, -64.0, 48.0, 44.0, 42.0, 59.0, 48.0, 48.0, 32.0, -64.0, -64.0, 37.0, 59.0, 58.0, 39.0, -64.0, -64.0, 44.0, 29.0, 37.0, 20.0, 36.0, 13.0, 59.0, 49.0, 10.0, 39.0, 12.0, 12.0, 43.0, -64.0, 28.0, 49.0, 21.0, 52.0, 9.0, 53.0, 43.0, 44.0, 53.0, 48.0, 59.0, 31.0, -64.0, 44.0, 28.0, 59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3035034253208777, "mean_inference_ms": 9.715676949340423, "mean_action_processing_ms": 0.4555191249148675, "mean_env_wait_ms": 0.29014197543758724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.255584716796875, "StateBufferConnector_ms": 0.004190921783447266, "ViewRequirementAgentConnector_ms": 0.17235302925109863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97792, "num_agent_steps_trained": 97792, "num_env_steps_sampled": 97792, "num_env_steps_trained": 97792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.216833277030963, "num_agent_steps_trained_throughput_per_sec": 7.216833277030963, "timesteps_total": 97792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 97792, "timers": {"training_iteration_time_ms": 71173.993, "sample_time_ms": 5985.249, "load_time_ms": 0.273, "load_throughput": 1876187.007, "learn_time_ms": 65187.959, "learn_throughput": 7.854, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 97792, "num_env_steps_trained": 97792, "num_agent_steps_sampled": 97792, "num_agent_steps_trained": 97792}, "done": false, "episodes_total": 6112, "training_iteration": 191, "trial_id": "f4e01_00169", "date": "2024-02-27_03-52-11", "timestamp": 1709002331, "time_this_iter_s": 70.95029950141907, "time_total_s": 13749.031925916672, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13749.031925916672, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 51.95600000000001, "ram_util_percent": 19.653999999999993}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.82, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.64703125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.925605970621109, "policy_loss": 0.012983560864813625, "vf_loss": 7.715789159138997, "vf_explained_var": 0.8885231330990792, "kl": 0.0, "entropy": 140.09960759480794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.82, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.64703125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [42.0, 53.0, 42.0, -62.0, 54.0, 53.0, 42.0, 48.0, -64.0, 44.0, 49.0, 54.0, 35.0, 5.0, -64.0, 48.0, -64.0, 54.0, 43.0, -64.0, -64.0, 23.0, -64.0, 48.0, 44.0, 42.0, 59.0, 48.0, 48.0, 32.0, -64.0, -64.0, 37.0, 59.0, 58.0, 39.0, -64.0, -64.0, 44.0, 29.0, 37.0, 20.0, 36.0, 13.0, 59.0, 49.0, 10.0, 39.0, 12.0, 12.0, 43.0, -64.0, 28.0, 49.0, 21.0, 52.0, 9.0, 53.0, 43.0, 44.0, 53.0, 48.0, 59.0, 31.0, -64.0, 44.0, 28.0, 59.0, 1.0, 58.0, 47.0, 33.0, 41.0, -64.0, 58.0, 17.0, 59.0, 9.0, 33.0, -64.0, -64.0, 32.0, -64.0, 38.0, 58.0, -64.0, 39.0, 48.0, 53.0, 42.0, 48.0, 54.0, 33.0, -64.0, 29.0, 22.0, 59.0, 12.0, -64.0, 10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3032332079983096, "mean_inference_ms": 9.714322127883424, "mean_action_processing_ms": 0.45543529979549646, "mean_env_wait_ms": 0.29008203072269206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2619774341583252, "StateBufferConnector_ms": 0.004274606704711914, "ViewRequirementAgentConnector_ms": 0.18020844459533691}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, 53.0, 42.0, -62.0, 54.0, 53.0, 42.0, 48.0, -64.0, 44.0, 49.0, 54.0, 35.0, 5.0, -64.0, 48.0, -64.0, 54.0, 43.0, -64.0, -64.0, 23.0, -64.0, 48.0, 44.0, 42.0, 59.0, 48.0, 48.0, 32.0, -64.0, -64.0, 37.0, 59.0, 58.0, 39.0, -64.0, -64.0, 44.0, 29.0, 37.0, 20.0, 36.0, 13.0, 59.0, 49.0, 10.0, 39.0, 12.0, 12.0, 43.0, -64.0, 28.0, 49.0, 21.0, 52.0, 9.0, 53.0, 43.0, 44.0, 53.0, 48.0, 59.0, 31.0, -64.0, 44.0, 28.0, 59.0, 1.0, 58.0, 47.0, 33.0, 41.0, -64.0, 58.0, 17.0, 59.0, 9.0, 33.0, -64.0, -64.0, 32.0, -64.0, 38.0, 58.0, -64.0, 39.0, 48.0, 53.0, 42.0, 48.0, 54.0, 33.0, -64.0, 29.0, 22.0, 59.0, 12.0, -64.0, 10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3032332079983096, "mean_inference_ms": 9.714322127883424, "mean_action_processing_ms": 0.45543529979549646, "mean_env_wait_ms": 0.29008203072269206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2619774341583252, "StateBufferConnector_ms": 0.004274606704711914, "ViewRequirementAgentConnector_ms": 0.18020844459533691}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2661350587565305, "num_agent_steps_trained_throughput_per_sec": 7.2661350587565305, "timesteps_total": 98304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 70971.962, "sample_time_ms": 5978.612, "load_time_ms": 0.272, "load_throughput": 1881282.215, "learn_time_ms": 64992.596, "learn_throughput": 7.878, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "episodes_total": 6144, "training_iteration": 192, "trial_id": "f4e01_00169", "date": "2024-02-27_03-53-21", "timestamp": 1709002401, "time_this_iter_s": 70.46905303001404, "time_total_s": 13819.500978946686, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13819.500978946686, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 51.263366336633666, "ram_util_percent": 19.732673267326735}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 14.59, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.613984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.613984375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.5049289544423425, "policy_loss": -0.02767927340270641, "vf_loss": 8.689541860421498, "vf_explained_var": 0.9495057140787443, "kl": 0.0, "entropy": 142.80421918233236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 98816, "num_env_steps_trained": 98816, "num_agent_steps_sampled": 98816, "num_agent_steps_trained": 98816}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 14.59, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 14.59, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.613984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.613984375, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [37.0, 59.0, 58.0, 39.0, -64.0, -64.0, 44.0, 29.0, 37.0, 20.0, 36.0, 13.0, 59.0, 49.0, 10.0, 39.0, 12.0, 12.0, 43.0, -64.0, 28.0, 49.0, 21.0, 52.0, 9.0, 53.0, 43.0, 44.0, 53.0, 48.0, 59.0, 31.0, -64.0, 44.0, 28.0, 59.0, 1.0, 58.0, 47.0, 33.0, 41.0, -64.0, 58.0, 17.0, 59.0, 9.0, 33.0, -64.0, -64.0, 32.0, -64.0, 38.0, 58.0, -64.0, 39.0, 48.0, 53.0, 42.0, 48.0, 54.0, 33.0, -64.0, 29.0, 22.0, 59.0, 12.0, -64.0, 10.0, 13.0, -64.0, -64.0, 58.0, 11.0, 34.0, -64.0, 53.0, 43.0, 23.0, -64.0, -64.0, 54.0, 7.0, -64.0, -64.0, -64.0, 34.0, 24.0, 33.0, 37.0, -64.0, -64.0, 42.0, 43.0, 24.0, -64.0, 42.0, 52.0, 33.0, 15.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3030143390914202, "mean_inference_ms": 9.713371882541011, "mean_action_processing_ms": 0.4553877963730162, "mean_env_wait_ms": 0.2900461794874575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26643824577331543, "StateBufferConnector_ms": 0.004354238510131836, "ViewRequirementAgentConnector_ms": 0.18621206283569336}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 14.59, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 59.0, 58.0, 39.0, -64.0, -64.0, 44.0, 29.0, 37.0, 20.0, 36.0, 13.0, 59.0, 49.0, 10.0, 39.0, 12.0, 12.0, 43.0, -64.0, 28.0, 49.0, 21.0, 52.0, 9.0, 53.0, 43.0, 44.0, 53.0, 48.0, 59.0, 31.0, -64.0, 44.0, 28.0, 59.0, 1.0, 58.0, 47.0, 33.0, 41.0, -64.0, 58.0, 17.0, 59.0, 9.0, 33.0, -64.0, -64.0, 32.0, -64.0, 38.0, 58.0, -64.0, 39.0, 48.0, 53.0, 42.0, 48.0, 54.0, 33.0, -64.0, 29.0, 22.0, 59.0, 12.0, -64.0, 10.0, 13.0, -64.0, -64.0, 58.0, 11.0, 34.0, -64.0, 53.0, 43.0, 23.0, -64.0, -64.0, 54.0, 7.0, -64.0, -64.0, -64.0, 34.0, 24.0, 33.0, 37.0, -64.0, -64.0, 42.0, 43.0, 24.0, -64.0, 42.0, 52.0, 33.0, 15.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3030143390914202, "mean_inference_ms": 9.713371882541011, "mean_action_processing_ms": 0.4553877963730162, "mean_env_wait_ms": 0.2900461794874575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26643824577331543, "StateBufferConnector_ms": 0.004354238510131836, "ViewRequirementAgentConnector_ms": 0.18621206283569336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98816, "num_agent_steps_trained": 98816, "num_env_steps_sampled": 98816, "num_env_steps_trained": 98816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.200786002541852, "num_agent_steps_trained_throughput_per_sec": 7.200786002541852, "timesteps_total": 98816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 98816, "timers": {"training_iteration_time_ms": 70971.183, "sample_time_ms": 5958.901, "load_time_ms": 0.267, "load_throughput": 1915002.361, "learn_time_ms": 65011.53, "learn_throughput": 7.876, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 98816, "num_env_steps_trained": 98816, "num_agent_steps_sampled": 98816, "num_agent_steps_trained": 98816}, "done": false, "episodes_total": 6176, "training_iteration": 193, "trial_id": "f4e01_00169", "date": "2024-02-27_03-54-33", "timestamp": 1709002473, "time_this_iter_s": 71.10863304138184, "time_total_s": 13890.609611988068, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13890.609611988068, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 51.843, "ram_util_percent": 19.557000000000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 12.19, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.595234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.595234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.95823560555776, "policy_loss": -0.037087341242780285, "vf_loss": 7.845678905646007, "vf_explained_var": 0.9572675923506418, "kl": 0.0, "entropy": 142.18229764302572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.19, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 12.19, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.595234375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.595234375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 44.0, 28.0, 59.0, 1.0, 58.0, 47.0, 33.0, 41.0, -64.0, 58.0, 17.0, 59.0, 9.0, 33.0, -64.0, -64.0, 32.0, -64.0, 38.0, 58.0, -64.0, 39.0, 48.0, 53.0, 42.0, 48.0, 54.0, 33.0, -64.0, 29.0, 22.0, 59.0, 12.0, -64.0, 10.0, 13.0, -64.0, -64.0, 58.0, 11.0, 34.0, -64.0, 53.0, 43.0, 23.0, -64.0, -64.0, 54.0, 7.0, -64.0, -64.0, -64.0, 34.0, 24.0, 33.0, 37.0, -64.0, -64.0, 42.0, 43.0, 24.0, -64.0, 42.0, 52.0, 33.0, 15.0, 42.0, 53.0, 25.0, 28.0, 47.0, 49.0, 54.0, 58.0, 6.0, 48.0, 48.0, 64.0, -64.0, 53.0, 23.0, 31.0, -64.0, -64.0, 54.0, 32.0, 42.0, 59.0, 35.0, -64.0, -64.0, 43.0, 54.0, 36.0, 18.0, 39.0, 41.0, -64.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3028287638195613, "mean_inference_ms": 9.712692139084757, "mean_action_processing_ms": 0.45534796282400825, "mean_env_wait_ms": 0.29001986024519766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.267258882522583, "StateBufferConnector_ms": 0.004376888275146484, "ViewRequirementAgentConnector_ms": 0.18714690208435059}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 12.19, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 44.0, 28.0, 59.0, 1.0, 58.0, 47.0, 33.0, 41.0, -64.0, 58.0, 17.0, 59.0, 9.0, 33.0, -64.0, -64.0, 32.0, -64.0, 38.0, 58.0, -64.0, 39.0, 48.0, 53.0, 42.0, 48.0, 54.0, 33.0, -64.0, 29.0, 22.0, 59.0, 12.0, -64.0, 10.0, 13.0, -64.0, -64.0, 58.0, 11.0, 34.0, -64.0, 53.0, 43.0, 23.0, -64.0, -64.0, 54.0, 7.0, -64.0, -64.0, -64.0, 34.0, 24.0, 33.0, 37.0, -64.0, -64.0, 42.0, 43.0, 24.0, -64.0, 42.0, 52.0, 33.0, 15.0, 42.0, 53.0, 25.0, 28.0, 47.0, 49.0, 54.0, 58.0, 6.0, 48.0, 48.0, 64.0, -64.0, 53.0, 23.0, 31.0, -64.0, -64.0, 54.0, 32.0, 42.0, 59.0, 35.0, -64.0, -64.0, 43.0, 54.0, 36.0, 18.0, 39.0, 41.0, -64.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3028287638195613, "mean_inference_ms": 9.712692139084757, "mean_action_processing_ms": 0.45534796282400825, "mean_env_wait_ms": 0.29001986024519766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.267258882522583, "StateBufferConnector_ms": 0.004376888275146484, "ViewRequirementAgentConnector_ms": 0.18714690208435059}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.225745273079968, "num_agent_steps_trained_throughput_per_sec": 7.225745273079968, "timesteps_total": 99328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 70893.581, "sample_time_ms": 5931.988, "load_time_ms": 0.273, "load_throughput": 1874549.274, "learn_time_ms": 64960.838, "learn_throughput": 7.882, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "done": false, "episodes_total": 6208, "training_iteration": 194, "trial_id": "f4e01_00169", "date": "2024-02-27_03-55-43", "timestamp": 1709002543, "time_this_iter_s": 70.86277318000793, "time_total_s": 13961.472385168076, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13961.472385168076, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 51.965346534653456, "ram_util_percent": 19.587128712871284}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 7.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.558828125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.558828125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9883780824641387, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.391931772232056, "policy_loss": 0.0044693492352962496, "vf_loss": 8.461575202147166, "vf_explained_var": 0.8023760005831718, "kl": 0.0, "entropy": 141.414413579305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 99840, "num_env_steps_trained": 99840, "num_agent_steps_sampled": 99840, "num_agent_steps_trained": 99840}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 7.53, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 7.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.558828125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.558828125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 12.0, -64.0, 10.0, 13.0, -64.0, -64.0, 58.0, 11.0, 34.0, -64.0, 53.0, 43.0, 23.0, -64.0, -64.0, 54.0, 7.0, -64.0, -64.0, -64.0, 34.0, 24.0, 33.0, 37.0, -64.0, -64.0, 42.0, 43.0, 24.0, -64.0, 42.0, 52.0, 33.0, 15.0, 42.0, 53.0, 25.0, 28.0, 47.0, 49.0, 54.0, 58.0, 6.0, 48.0, 48.0, 64.0, -64.0, 53.0, 23.0, 31.0, -64.0, -64.0, 54.0, 32.0, 42.0, 59.0, 35.0, -64.0, -64.0, 43.0, 54.0, 36.0, 18.0, 39.0, 41.0, -64.0, -2.0, 43.0, -64.0, 21.0, -63.0, 52.0, -64.0, 33.0, 44.0, -64.0, 11.0, 32.0, -64.0, 43.0, 23.0, -64.0, 33.0, 39.0, 48.0, 58.0, 44.0, 33.0, -64.0, -64.0, -64.0, 59.0, 2.0, 38.0, -12.0, -8.0, 44.0, 28.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026367811127872, "mean_inference_ms": 9.712001264692951, "mean_action_processing_ms": 0.4553059910684489, "mean_env_wait_ms": 0.2899853125369443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2657043933868408, "StateBufferConnector_ms": 0.0043773651123046875, "ViewRequirementAgentConnector_ms": 0.1856215000152588}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 7.53, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 12.0, -64.0, 10.0, 13.0, -64.0, -64.0, 58.0, 11.0, 34.0, -64.0, 53.0, 43.0, 23.0, -64.0, -64.0, 54.0, 7.0, -64.0, -64.0, -64.0, 34.0, 24.0, 33.0, 37.0, -64.0, -64.0, 42.0, 43.0, 24.0, -64.0, 42.0, 52.0, 33.0, 15.0, 42.0, 53.0, 25.0, 28.0, 47.0, 49.0, 54.0, 58.0, 6.0, 48.0, 48.0, 64.0, -64.0, 53.0, 23.0, 31.0, -64.0, -64.0, 54.0, 32.0, 42.0, 59.0, 35.0, -64.0, -64.0, 43.0, 54.0, 36.0, 18.0, 39.0, 41.0, -64.0, -2.0, 43.0, -64.0, 21.0, -63.0, 52.0, -64.0, 33.0, 44.0, -64.0, 11.0, 32.0, -64.0, 43.0, 23.0, -64.0, 33.0, 39.0, 48.0, 58.0, 44.0, 33.0, -64.0, -64.0, -64.0, 59.0, 2.0, 38.0, -12.0, -8.0, 44.0, 28.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026367811127872, "mean_inference_ms": 9.712001264692951, "mean_action_processing_ms": 0.4553059910684489, "mean_env_wait_ms": 0.2899853125369443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2657043933868408, "StateBufferConnector_ms": 0.0043773651123046875, "ViewRequirementAgentConnector_ms": 0.1856215000152588}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99840, "num_agent_steps_trained": 99840, "num_env_steps_sampled": 99840, "num_env_steps_trained": 99840, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.228858996286745, "num_agent_steps_trained_throughput_per_sec": 7.228858996286745, "timesteps_total": 99840, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 99840, "timers": {"training_iteration_time_ms": 70847.659, "sample_time_ms": 5928.88, "load_time_ms": 0.275, "load_throughput": 1863649.786, "learn_time_ms": 64918.024, "learn_throughput": 7.887, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 99840, "num_env_steps_trained": 99840, "num_agent_steps_sampled": 99840, "num_agent_steps_trained": 99840}, "done": false, "episodes_total": 6240, "training_iteration": 195, "trial_id": "f4e01_00169", "date": "2024-02-27_03-56-56", "timestamp": 1709002616, "time_this_iter_s": 70.83233261108398, "time_total_s": 14032.30471777916, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14032.30471777916, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 52.2757281553398, "ram_util_percent": 19.748543689320382}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.15, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.649609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.649609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.005368538697561, "policy_loss": -0.0242562098428607, "vf_loss": 6.32894854148229, "vf_explained_var": 0.9810804153482119, "kl": 0.0, "entropy": 139.5361306508382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.15, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.649609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.649609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [52.0, 33.0, 15.0, 42.0, 53.0, 25.0, 28.0, 47.0, 49.0, 54.0, 58.0, 6.0, 48.0, 48.0, 64.0, -64.0, 53.0, 23.0, 31.0, -64.0, -64.0, 54.0, 32.0, 42.0, 59.0, 35.0, -64.0, -64.0, 43.0, 54.0, 36.0, 18.0, 39.0, 41.0, -64.0, -2.0, 43.0, -64.0, 21.0, -63.0, 52.0, -64.0, 33.0, 44.0, -64.0, 11.0, 32.0, -64.0, 43.0, 23.0, -64.0, 33.0, 39.0, 48.0, 58.0, 44.0, 33.0, -64.0, -64.0, -64.0, 59.0, 2.0, 38.0, -12.0, -8.0, 44.0, 28.0, -64.0, -64.0, 53.0, 18.0, 49.0, 59.0, 31.0, 34.0, 53.0, 33.0, -64.0, 17.0, 20.0, 59.0, 5.0, 53.0, 53.0, 48.0, 53.0, 48.0, 53.0, 47.0, 58.0, 58.0, 59.0, 54.0, -64.0, 58.0, 44.0, 11.0, 44.0, 23.0, 47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024535834284372, "mean_inference_ms": 9.7112845554748, "mean_action_processing_ms": 0.45526106648151826, "mean_env_wait_ms": 0.2899482531156076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26656174659729004, "StateBufferConnector_ms": 0.004416942596435547, "ViewRequirementAgentConnector_ms": 0.1849210262298584}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.0, 33.0, 15.0, 42.0, 53.0, 25.0, 28.0, 47.0, 49.0, 54.0, 58.0, 6.0, 48.0, 48.0, 64.0, -64.0, 53.0, 23.0, 31.0, -64.0, -64.0, 54.0, 32.0, 42.0, 59.0, 35.0, -64.0, -64.0, 43.0, 54.0, 36.0, 18.0, 39.0, 41.0, -64.0, -2.0, 43.0, -64.0, 21.0, -63.0, 52.0, -64.0, 33.0, 44.0, -64.0, 11.0, 32.0, -64.0, 43.0, 23.0, -64.0, 33.0, 39.0, 48.0, 58.0, 44.0, 33.0, -64.0, -64.0, -64.0, 59.0, 2.0, 38.0, -12.0, -8.0, 44.0, 28.0, -64.0, -64.0, 53.0, 18.0, 49.0, 59.0, 31.0, 34.0, 53.0, 33.0, -64.0, 17.0, 20.0, 59.0, 5.0, 53.0, 53.0, 48.0, 53.0, 48.0, 53.0, 47.0, 58.0, 58.0, 59.0, 54.0, -64.0, 58.0, 44.0, 11.0, 44.0, 23.0, 47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024535834284372, "mean_inference_ms": 9.7112845554748, "mean_action_processing_ms": 0.45526106648151826, "mean_env_wait_ms": 0.2899482531156076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26656174659729004, "StateBufferConnector_ms": 0.004416942596435547, "ViewRequirementAgentConnector_ms": 0.1849210262298584}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2162265692631635, "num_agent_steps_trained_throughput_per_sec": 7.2162265692631635, "timesteps_total": 100352, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 70828.462, "sample_time_ms": 5903.497, "load_time_ms": 0.273, "load_throughput": 1876023.105, "learn_time_ms": 64924.213, "learn_throughput": 7.886, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "done": false, "episodes_total": 6272, "training_iteration": 196, "trial_id": "f4e01_00169", "date": "2024-02-27_03-58-07", "timestamp": 1709002687, "time_this_iter_s": 70.95626044273376, "time_total_s": 14103.260978221893, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14103.260978221893, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 51.89405940594058, "ram_util_percent": 19.720792079207918}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.16, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.641875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.641875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9971546351909637, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.205364229281743, "policy_loss": -0.0028964739292860033, "vf_loss": 8.180120011170706, "vf_explained_var": 0.9330727264285088, "kl": 0.0, "entropy": 142.33246078491212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 100864, "num_env_steps_trained": 100864, "num_agent_steps_sampled": 100864, "num_agent_steps_trained": 100864}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.16, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.641875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.641875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [39.0, 41.0, -64.0, -2.0, 43.0, -64.0, 21.0, -63.0, 52.0, -64.0, 33.0, 44.0, -64.0, 11.0, 32.0, -64.0, 43.0, 23.0, -64.0, 33.0, 39.0, 48.0, 58.0, 44.0, 33.0, -64.0, -64.0, -64.0, 59.0, 2.0, 38.0, -12.0, -8.0, 44.0, 28.0, -64.0, -64.0, 53.0, 18.0, 49.0, 59.0, 31.0, 34.0, 53.0, 33.0, -64.0, 17.0, 20.0, 59.0, 5.0, 53.0, 53.0, 48.0, 53.0, 48.0, 53.0, 47.0, 58.0, 58.0, 59.0, 54.0, -64.0, 58.0, 44.0, 11.0, 44.0, 23.0, 47.0, 42.0, 47.0, -64.0, -64.0, 39.0, 58.0, 59.0, 39.0, 52.0, 19.0, 54.0, -64.0, -64.0, 53.0, 44.0, 21.0, 42.0, 53.0, 53.0, 41.0, -64.0, 30.0, 58.0, 59.0, 64.0, -64.0, 58.0, -64.0, 49.0, 6.0, 48.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022243997695455, "mean_inference_ms": 9.710231184863305, "mean_action_processing_ms": 0.45519974873250413, "mean_env_wait_ms": 0.2898972980871001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26178741455078125, "StateBufferConnector_ms": 0.004327297210693359, "ViewRequirementAgentConnector_ms": 0.17882943153381348}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 41.0, -64.0, -2.0, 43.0, -64.0, 21.0, -63.0, 52.0, -64.0, 33.0, 44.0, -64.0, 11.0, 32.0, -64.0, 43.0, 23.0, -64.0, 33.0, 39.0, 48.0, 58.0, 44.0, 33.0, -64.0, -64.0, -64.0, 59.0, 2.0, 38.0, -12.0, -8.0, 44.0, 28.0, -64.0, -64.0, 53.0, 18.0, 49.0, 59.0, 31.0, 34.0, 53.0, 33.0, -64.0, 17.0, 20.0, 59.0, 5.0, 53.0, 53.0, 48.0, 53.0, 48.0, 53.0, 47.0, 58.0, 58.0, 59.0, 54.0, -64.0, 58.0, 44.0, 11.0, 44.0, 23.0, 47.0, 42.0, 47.0, -64.0, -64.0, 39.0, 58.0, 59.0, 39.0, 52.0, 19.0, 54.0, -64.0, -64.0, 53.0, 44.0, 21.0, 42.0, 53.0, 53.0, 41.0, -64.0, 30.0, 58.0, 59.0, 64.0, -64.0, 58.0, -64.0, 49.0, 6.0, 48.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022243997695455, "mean_inference_ms": 9.710231184863305, "mean_action_processing_ms": 0.45519974873250413, "mean_env_wait_ms": 0.2898972980871001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26178741455078125, "StateBufferConnector_ms": 0.004327297210693359, "ViewRequirementAgentConnector_ms": 0.17882943153381348}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100864, "num_agent_steps_trained": 100864, "num_env_steps_sampled": 100864, "num_env_steps_trained": 100864, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2554808420973504, "num_agent_steps_trained_throughput_per_sec": 7.2554808420973504, "timesteps_total": 100864, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 100864, "timers": {"training_iteration_time_ms": 70799.858, "sample_time_ms": 5862.952, "load_time_ms": 0.272, "load_throughput": 1880623.214, "learn_time_ms": 64936.158, "learn_throughput": 7.885, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 100864, "num_env_steps_trained": 100864, "num_agent_steps_sampled": 100864, "num_agent_steps_trained": 100864}, "done": false, "episodes_total": 6304, "training_iteration": 197, "trial_id": "f4e01_00169", "date": "2024-02-27_03-59-18", "timestamp": 1709002758, "time_this_iter_s": 70.5727686882019, "time_total_s": 14173.833746910095, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14173.833746910095, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 51.38399999999999, "ram_util_percent": 19.609999999999996}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.86, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.820163522164027, "policy_loss": 0.03972604297256718, "vf_loss": 7.508178806304931, "vf_explained_var": 0.9781443446874618, "kl": 0.0, "entropy": 143.0614818572998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.86, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-8.0, 44.0, 28.0, -64.0, -64.0, 53.0, 18.0, 49.0, 59.0, 31.0, 34.0, 53.0, 33.0, -64.0, 17.0, 20.0, 59.0, 5.0, 53.0, 53.0, 48.0, 53.0, 48.0, 53.0, 47.0, 58.0, 58.0, 59.0, 54.0, -64.0, 58.0, 44.0, 11.0, 44.0, 23.0, 47.0, 42.0, 47.0, -64.0, -64.0, 39.0, 58.0, 59.0, 39.0, 52.0, 19.0, 54.0, -64.0, -64.0, 53.0, 44.0, 21.0, 42.0, 53.0, 53.0, 41.0, -64.0, 30.0, 58.0, 59.0, 64.0, -64.0, 58.0, -64.0, 49.0, 6.0, 48.0, 43.0, 17.0, 28.0, 19.0, 43.0, 58.0, -64.0, 53.0, 39.0, 43.0, 24.0, -64.0, 1.0, -12.0, -15.0, 36.0, 53.0, 47.0, 53.0, -64.0, -64.0, 5.0, 53.0, -64.0, -3.0, 64.0, 14.0, 49.0, 53.0, 54.0, 34.0, 43.0, 20.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3020484113197688, "mean_inference_ms": 9.709373775229533, "mean_action_processing_ms": 0.45514893890902075, "mean_env_wait_ms": 0.28985506964234675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26260876655578613, "StateBufferConnector_ms": 0.004331827163696289, "ViewRequirementAgentConnector_ms": 0.18268203735351562}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.0, 44.0, 28.0, -64.0, -64.0, 53.0, 18.0, 49.0, 59.0, 31.0, 34.0, 53.0, 33.0, -64.0, 17.0, 20.0, 59.0, 5.0, 53.0, 53.0, 48.0, 53.0, 48.0, 53.0, 47.0, 58.0, 58.0, 59.0, 54.0, -64.0, 58.0, 44.0, 11.0, 44.0, 23.0, 47.0, 42.0, 47.0, -64.0, -64.0, 39.0, 58.0, 59.0, 39.0, 52.0, 19.0, 54.0, -64.0, -64.0, 53.0, 44.0, 21.0, 42.0, 53.0, 53.0, 41.0, -64.0, 30.0, 58.0, 59.0, 64.0, -64.0, 58.0, -64.0, 49.0, 6.0, 48.0, 43.0, 17.0, 28.0, 19.0, 43.0, 58.0, -64.0, 53.0, 39.0, 43.0, 24.0, -64.0, 1.0, -12.0, -15.0, 36.0, 53.0, 47.0, 53.0, -64.0, -64.0, 5.0, 53.0, -64.0, -3.0, 64.0, 14.0, 49.0, 53.0, 54.0, 34.0, 43.0, 20.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3020484113197688, "mean_inference_ms": 9.709373775229533, "mean_action_processing_ms": 0.45514893890902075, "mean_env_wait_ms": 0.28985506964234675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26260876655578613, "StateBufferConnector_ms": 0.004331827163696289, "ViewRequirementAgentConnector_ms": 0.18268203735351562}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2413158402267275, "num_agent_steps_trained_throughput_per_sec": 7.2413158402267275, "timesteps_total": 101376, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 101376, "timers": {"training_iteration_time_ms": 70827.927, "sample_time_ms": 5899.407, "load_time_ms": 0.278, "load_throughput": 1838913.896, "learn_time_ms": 64927.772, "learn_throughput": 7.886, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "done": false, "episodes_total": 6336, "training_iteration": 198, "trial_id": "f4e01_00169", "date": "2024-02-27_04-00-28", "timestamp": 1709002828, "time_this_iter_s": 70.71048069000244, "time_total_s": 14244.544227600098, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14244.544227600098, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 53.03200000000001, "ram_util_percent": 19.653}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.58, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64515625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64515625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.356547478834788, "policy_loss": 0.042621668179829916, "vf_loss": 8.346078113714855, "vf_explained_var": 0.9597708662350972, "kl": 0.0, "entropy": 144.66768163045248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 101888, "num_env_steps_trained": 101888, "num_agent_steps_sampled": 101888, "num_agent_steps_trained": 101888}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.58, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.64515625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.64515625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [11.0, 44.0, 23.0, 47.0, 42.0, 47.0, -64.0, -64.0, 39.0, 58.0, 59.0, 39.0, 52.0, 19.0, 54.0, -64.0, -64.0, 53.0, 44.0, 21.0, 42.0, 53.0, 53.0, 41.0, -64.0, 30.0, 58.0, 59.0, 64.0, -64.0, 58.0, -64.0, 49.0, 6.0, 48.0, 43.0, 17.0, 28.0, 19.0, 43.0, 58.0, -64.0, 53.0, 39.0, 43.0, 24.0, -64.0, 1.0, -12.0, -15.0, 36.0, 53.0, 47.0, 53.0, -64.0, -64.0, 5.0, 53.0, -64.0, -3.0, 64.0, 14.0, 49.0, 53.0, 54.0, 34.0, 43.0, 20.0, 25.0, -64.0, -63.0, 43.0, 58.0, -64.0, 58.0, 64.0, -21.0, 59.0, 59.0, 52.0, -64.0, 43.0, 16.0, 49.0, -64.0, -1.0, 44.0, 53.0, 26.0, 13.0, 59.0, 53.0, 4.0, -64.0, 27.0, 38.0, 12.0, 58.0, -64.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3018842231341825, "mean_inference_ms": 9.708637798373488, "mean_action_processing_ms": 0.4551050921401888, "mean_env_wait_ms": 0.2898089080781239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26409173011779785, "StateBufferConnector_ms": 0.004388093948364258, "ViewRequirementAgentConnector_ms": 0.18284225463867188}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.0, 44.0, 23.0, 47.0, 42.0, 47.0, -64.0, -64.0, 39.0, 58.0, 59.0, 39.0, 52.0, 19.0, 54.0, -64.0, -64.0, 53.0, 44.0, 21.0, 42.0, 53.0, 53.0, 41.0, -64.0, 30.0, 58.0, 59.0, 64.0, -64.0, 58.0, -64.0, 49.0, 6.0, 48.0, 43.0, 17.0, 28.0, 19.0, 43.0, 58.0, -64.0, 53.0, 39.0, 43.0, 24.0, -64.0, 1.0, -12.0, -15.0, 36.0, 53.0, 47.0, 53.0, -64.0, -64.0, 5.0, 53.0, -64.0, -3.0, 64.0, 14.0, 49.0, 53.0, 54.0, 34.0, 43.0, 20.0, 25.0, -64.0, -63.0, 43.0, 58.0, -64.0, 58.0, 64.0, -21.0, 59.0, 59.0, 52.0, -64.0, 43.0, 16.0, 49.0, -64.0, -1.0, 44.0, 53.0, 26.0, 13.0, 59.0, 53.0, 4.0, -64.0, 27.0, 38.0, 12.0, 58.0, -64.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3018842231341825, "mean_inference_ms": 9.708637798373488, "mean_action_processing_ms": 0.4551050921401888, "mean_env_wait_ms": 0.2898089080781239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26409173011779785, "StateBufferConnector_ms": 0.004388093948364258, "ViewRequirementAgentConnector_ms": 0.18284225463867188}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101888, "num_agent_steps_trained": 101888, "num_env_steps_sampled": 101888, "num_env_steps_trained": 101888, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.188283657128396, "num_agent_steps_trained_throughput_per_sec": 7.188283657128396, "timesteps_total": 101888, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 101888, "timers": {"training_iteration_time_ms": 70871.356, "sample_time_ms": 5921.667, "load_time_ms": 0.281, "load_throughput": 1824850.143, "learn_time_ms": 64948.938, "learn_throughput": 7.883, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 101888, "num_env_steps_trained": 101888, "num_agent_steps_sampled": 101888, "num_agent_steps_trained": 101888}, "done": false, "episodes_total": 6368, "training_iteration": 199, "trial_id": "f4e01_00169", "date": "2024-02-27_04-01-40", "timestamp": 1709002900, "time_this_iter_s": 71.23207116127014, "time_total_s": 14315.776298761368, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14315.776298761368, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 52.30686274509805, "ram_util_percent": 19.663725490196075}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.96, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.648125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.648125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.329812910159429, "policy_loss": -0.019132063103218872, "vf_loss": 6.830474547545115, "vf_explained_var": 0.6715668588876724, "kl": 0.0, "entropy": 142.8011817932129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.96, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.648125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.648125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [49.0, 6.0, 48.0, 43.0, 17.0, 28.0, 19.0, 43.0, 58.0, -64.0, 53.0, 39.0, 43.0, 24.0, -64.0, 1.0, -12.0, -15.0, 36.0, 53.0, 47.0, 53.0, -64.0, -64.0, 5.0, 53.0, -64.0, -3.0, 64.0, 14.0, 49.0, 53.0, 54.0, 34.0, 43.0, 20.0, 25.0, -64.0, -63.0, 43.0, 58.0, -64.0, 58.0, 64.0, -21.0, 59.0, 59.0, 52.0, -64.0, 43.0, 16.0, 49.0, -64.0, -1.0, 44.0, 53.0, 26.0, 13.0, 59.0, 53.0, 4.0, -64.0, 27.0, 38.0, 12.0, 58.0, -64.0, 53.0, 53.0, 21.0, 59.0, -64.0, 42.0, 54.0, 49.0, 42.0, 27.0, 43.0, 52.0, -64.0, -64.0, 49.0, 49.0, 53.0, 26.0, -64.0, 53.0, 59.0, -63.0, 59.0, 58.0, 52.0, -64.0, -64.0, 23.0, 46.0, 39.0, 53.0, 38.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301793298978088, "mean_inference_ms": 9.708381373937357, "mean_action_processing_ms": 0.4550907938793921, "mean_env_wait_ms": 0.2897843453403202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26851749420166016, "StateBufferConnector_ms": 0.004510402679443359, "ViewRequirementAgentConnector_ms": 0.18929791450500488}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 6.0, 48.0, 43.0, 17.0, 28.0, 19.0, 43.0, 58.0, -64.0, 53.0, 39.0, 43.0, 24.0, -64.0, 1.0, -12.0, -15.0, 36.0, 53.0, 47.0, 53.0, -64.0, -64.0, 5.0, 53.0, -64.0, -3.0, 64.0, 14.0, 49.0, 53.0, 54.0, 34.0, 43.0, 20.0, 25.0, -64.0, -63.0, 43.0, 58.0, -64.0, 58.0, 64.0, -21.0, 59.0, 59.0, 52.0, -64.0, 43.0, 16.0, 49.0, -64.0, -1.0, 44.0, 53.0, 26.0, 13.0, 59.0, 53.0, 4.0, -64.0, 27.0, 38.0, 12.0, 58.0, -64.0, 53.0, 53.0, 21.0, 59.0, -64.0, 42.0, 54.0, 49.0, 42.0, 27.0, 43.0, 52.0, -64.0, -64.0, 49.0, 49.0, 53.0, 26.0, -64.0, 53.0, 59.0, -63.0, 59.0, 58.0, 52.0, -64.0, -64.0, 23.0, 46.0, 39.0, 53.0, 38.0, 48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301793298978088, "mean_inference_ms": 9.708381373937357, "mean_action_processing_ms": 0.4550907938793921, "mean_env_wait_ms": 0.2897843453403202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26851749420166016, "StateBufferConnector_ms": 0.004510402679443359, "ViewRequirementAgentConnector_ms": 0.18929791450500488}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1247076554257855, "num_agent_steps_trained_throughput_per_sec": 7.1247076554257855, "timesteps_total": 102400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 70951.064, "sample_time_ms": 5949.689, "load_time_ms": 0.289, "load_throughput": 1774486.571, "learn_time_ms": 65000.617, "learn_throughput": 7.877, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "episodes_total": 6400, "training_iteration": 200, "trial_id": "f4e01_00169", "date": "2024-02-27_04-02-52", "timestamp": 1709002972, "time_this_iter_s": 71.86813616752625, "time_total_s": 14387.644434928894, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14387.644434928894, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 51.51372549019609, "ram_util_percent": 19.663725490196075}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.72, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6696875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6696875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.126770412921905, "policy_loss": -0.015622157525892058, "vf_loss": 6.506062257289886, "vf_explained_var": 0.934729381899039, "kl": 0.0, "entropy": 141.82112681070964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 102912, "num_env_steps_trained": 102912, "num_agent_steps_sampled": 102912, "num_agent_steps_trained": 102912}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.72, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6696875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6696875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 34.0, 43.0, 20.0, 25.0, -64.0, -63.0, 43.0, 58.0, -64.0, 58.0, 64.0, -21.0, 59.0, 59.0, 52.0, -64.0, 43.0, 16.0, 49.0, -64.0, -1.0, 44.0, 53.0, 26.0, 13.0, 59.0, 53.0, 4.0, -64.0, 27.0, 38.0, 12.0, 58.0, -64.0, 53.0, 53.0, 21.0, 59.0, -64.0, 42.0, 54.0, 49.0, 42.0, 27.0, 43.0, 52.0, -64.0, -64.0, 49.0, 49.0, 53.0, 26.0, -64.0, 53.0, 59.0, -63.0, 59.0, 58.0, 52.0, -64.0, -64.0, 23.0, 46.0, 39.0, 53.0, 38.0, 48.0, 58.0, 53.0, 35.0, 54.0, 39.0, 53.0, 46.0, 8.0, 35.0, 53.0, 42.0, 53.0, 64.0, 28.0, 58.0, -64.0, -64.0, 54.0, 48.0, 48.0, -64.0, -64.0, -64.0, 32.0, 53.0, 53.0, 40.0, 64.0, 59.0, 36.0, -64.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3016740474095059, "mean_inference_ms": 9.708366199137396, "mean_action_processing_ms": 0.45506230491281763, "mean_env_wait_ms": 0.28974671132648505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2680051326751709, "StateBufferConnector_ms": 0.004482746124267578, "ViewRequirementAgentConnector_ms": 0.18965673446655273}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 34.0, 43.0, 20.0, 25.0, -64.0, -63.0, 43.0, 58.0, -64.0, 58.0, 64.0, -21.0, 59.0, 59.0, 52.0, -64.0, 43.0, 16.0, 49.0, -64.0, -1.0, 44.0, 53.0, 26.0, 13.0, 59.0, 53.0, 4.0, -64.0, 27.0, 38.0, 12.0, 58.0, -64.0, 53.0, 53.0, 21.0, 59.0, -64.0, 42.0, 54.0, 49.0, 42.0, 27.0, 43.0, 52.0, -64.0, -64.0, 49.0, 49.0, 53.0, 26.0, -64.0, 53.0, 59.0, -63.0, 59.0, 58.0, 52.0, -64.0, -64.0, 23.0, 46.0, 39.0, 53.0, 38.0, 48.0, 58.0, 53.0, 35.0, 54.0, 39.0, 53.0, 46.0, 8.0, 35.0, 53.0, 42.0, 53.0, 64.0, 28.0, 58.0, -64.0, -64.0, 54.0, 48.0, 48.0, -64.0, -64.0, -64.0, 32.0, 53.0, 53.0, 40.0, 64.0, 59.0, 36.0, -64.0, 42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3016740474095059, "mean_inference_ms": 9.708366199137396, "mean_action_processing_ms": 0.45506230491281763, "mean_env_wait_ms": 0.28974671132648505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2680051326751709, "StateBufferConnector_ms": 0.004482746124267578, "ViewRequirementAgentConnector_ms": 0.18965673446655273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102912, "num_agent_steps_trained": 102912, "num_env_steps_sampled": 102912, "num_env_steps_trained": 102912, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.193218687571766, "num_agent_steps_trained_throughput_per_sec": 7.193218687571766, "timesteps_total": 102912, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 102912, "timers": {"training_iteration_time_ms": 70974.355, "sample_time_ms": 5966.194, "load_time_ms": 0.286, "load_throughput": 1791211.651, "learn_time_ms": 65007.41, "learn_throughput": 7.876, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 102912, "num_env_steps_trained": 102912, "num_agent_steps_sampled": 102912, "num_agent_steps_trained": 102912}, "done": false, "episodes_total": 6432, "training_iteration": 201, "trial_id": "f4e01_00169", "date": "2024-02-27_04-04-03", "timestamp": 1709003043, "time_this_iter_s": 71.18322014808655, "time_total_s": 14458.82765507698, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14458.82765507698, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 51.38316831683168, "ram_util_percent": 19.655445544554453}, "checkpoint_dir_name": "checkpoint_000002"}
{"custom_metrics": {"reward_total_mean": 19.93, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.655703125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.655703125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.298421994845072, "policy_loss": -0.005062105297110975, "vf_loss": 8.329678436120352, "vf_explained_var": 0.9012558097640674, "kl": 0.0, "entropy": 146.73431193033855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.93, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.93, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.655703125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.655703125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [12.0, 58.0, -64.0, 53.0, 53.0, 21.0, 59.0, -64.0, 42.0, 54.0, 49.0, 42.0, 27.0, 43.0, 52.0, -64.0, -64.0, 49.0, 49.0, 53.0, 26.0, -64.0, 53.0, 59.0, -63.0, 59.0, 58.0, 52.0, -64.0, -64.0, 23.0, 46.0, 39.0, 53.0, 38.0, 48.0, 58.0, 53.0, 35.0, 54.0, 39.0, 53.0, 46.0, 8.0, 35.0, 53.0, 42.0, 53.0, 64.0, 28.0, 58.0, -64.0, -64.0, 54.0, 48.0, 48.0, -64.0, -64.0, -64.0, 32.0, 53.0, 53.0, 40.0, 64.0, 59.0, 36.0, -64.0, 42.0, 52.0, 53.0, 58.0, 48.0, -64.0, 59.0, 58.0, 31.0, 36.0, 9.0, -64.0, -64.0, 43.0, -64.0, 3.0, 43.0, 43.0, 31.0, 58.0, -64.0, 42.0, 48.0, 53.0, -64.0, 34.0, -64.0, 48.0, 54.0, -64.0, 54.0, 28.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301581880455025, "mean_inference_ms": 9.708744135411585, "mean_action_processing_ms": 0.45502956085715235, "mean_env_wait_ms": 0.28971791730827495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.266448974609375, "StateBufferConnector_ms": 0.00439763069152832, "ViewRequirementAgentConnector_ms": 0.1896355152130127}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.93, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, 58.0, -64.0, 53.0, 53.0, 21.0, 59.0, -64.0, 42.0, 54.0, 49.0, 42.0, 27.0, 43.0, 52.0, -64.0, -64.0, 49.0, 49.0, 53.0, 26.0, -64.0, 53.0, 59.0, -63.0, 59.0, 58.0, 52.0, -64.0, -64.0, 23.0, 46.0, 39.0, 53.0, 38.0, 48.0, 58.0, 53.0, 35.0, 54.0, 39.0, 53.0, 46.0, 8.0, 35.0, 53.0, 42.0, 53.0, 64.0, 28.0, 58.0, -64.0, -64.0, 54.0, 48.0, 48.0, -64.0, -64.0, -64.0, 32.0, 53.0, 53.0, 40.0, 64.0, 59.0, 36.0, -64.0, 42.0, 52.0, 53.0, 58.0, 48.0, -64.0, 59.0, 58.0, 31.0, 36.0, 9.0, -64.0, -64.0, 43.0, -64.0, 3.0, 43.0, 43.0, 31.0, 58.0, -64.0, 42.0, 48.0, 53.0, -64.0, 34.0, -64.0, 48.0, 54.0, -64.0, 54.0, 28.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301581880455025, "mean_inference_ms": 9.708744135411585, "mean_action_processing_ms": 0.45502956085715235, "mean_env_wait_ms": 0.28971791730827495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.266448974609375, "StateBufferConnector_ms": 0.00439763069152832, "ViewRequirementAgentConnector_ms": 0.1896355152130127}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.188775457275463, "num_agent_steps_trained_throughput_per_sec": 7.188775457275463, "timesteps_total": 103424, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 103424, "timers": {"training_iteration_time_ms": 71050.18, "sample_time_ms": 5978.889, "load_time_ms": 0.289, "load_throughput": 1773167.904, "learn_time_ms": 65070.524, "learn_throughput": 7.868, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "done": false, "episodes_total": 6464, "training_iteration": 202, "trial_id": "f4e01_00169", "date": "2024-02-27_04-05-14", "timestamp": 1709003114, "time_this_iter_s": 71.22750902175903, "time_total_s": 14530.05516409874, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14530.05516409874, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 51.55247524752475, "ram_util_percent": 19.66831683168316}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 25.05, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.695703125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.695703125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9950191761056583, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.72336944937706, "policy_loss": 0.0008187605533748865, "vf_loss": 7.417261507113775, "vf_explained_var": 0.988538392384847, "kl": 0.0, "entropy": 143.9129810333252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 103936, "num_env_steps_trained": 103936, "num_agent_steps_sampled": 103936, "num_agent_steps_trained": 103936}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.05, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 25.05, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.695703125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.695703125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [39.0, 53.0, 38.0, 48.0, 58.0, 53.0, 35.0, 54.0, 39.0, 53.0, 46.0, 8.0, 35.0, 53.0, 42.0, 53.0, 64.0, 28.0, 58.0, -64.0, -64.0, 54.0, 48.0, 48.0, -64.0, -64.0, -64.0, 32.0, 53.0, 53.0, 40.0, 64.0, 59.0, 36.0, -64.0, 42.0, 52.0, 53.0, 58.0, 48.0, -64.0, 59.0, 58.0, 31.0, 36.0, 9.0, -64.0, -64.0, 43.0, -64.0, 3.0, 43.0, 43.0, 31.0, 58.0, -64.0, 42.0, 48.0, 53.0, -64.0, 34.0, -64.0, 48.0, 54.0, -64.0, 54.0, 28.0, -64.0, -64.0, 47.0, 59.0, -64.0, 58.0, 49.0, 59.0, 58.0, 18.0, 28.0, 59.0, 34.0, 58.0, 16.0, 59.0, 37.0, 53.0, 43.0, 58.0, 54.0, -64.0, 59.0, 64.0, 38.0, 32.0, 49.0, -64.0, 53.0, 54.0, 42.0, 53.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3014959387479406, "mean_inference_ms": 9.709562170758495, "mean_action_processing_ms": 0.4549963124251403, "mean_env_wait_ms": 0.2896948115611933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2661454677581787, "StateBufferConnector_ms": 0.004315376281738281, "ViewRequirementAgentConnector_ms": 0.1873464584350586}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.05, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.0, 53.0, 38.0, 48.0, 58.0, 53.0, 35.0, 54.0, 39.0, 53.0, 46.0, 8.0, 35.0, 53.0, 42.0, 53.0, 64.0, 28.0, 58.0, -64.0, -64.0, 54.0, 48.0, 48.0, -64.0, -64.0, -64.0, 32.0, 53.0, 53.0, 40.0, 64.0, 59.0, 36.0, -64.0, 42.0, 52.0, 53.0, 58.0, 48.0, -64.0, 59.0, 58.0, 31.0, 36.0, 9.0, -64.0, -64.0, 43.0, -64.0, 3.0, 43.0, 43.0, 31.0, 58.0, -64.0, 42.0, 48.0, 53.0, -64.0, 34.0, -64.0, 48.0, 54.0, -64.0, 54.0, 28.0, -64.0, -64.0, 47.0, 59.0, -64.0, 58.0, 49.0, 59.0, 58.0, 18.0, 28.0, 59.0, 34.0, 58.0, 16.0, 59.0, 37.0, 53.0, 43.0, 58.0, 54.0, -64.0, 59.0, 64.0, 38.0, 32.0, 49.0, -64.0, 53.0, 54.0, 42.0, 53.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3014959387479406, "mean_inference_ms": 9.709562170758495, "mean_action_processing_ms": 0.4549963124251403, "mean_env_wait_ms": 0.2896948115611933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2661454677581787, "StateBufferConnector_ms": 0.004315376281738281, "ViewRequirementAgentConnector_ms": 0.1873464584350586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103936, "num_agent_steps_trained": 103936, "num_env_steps_sampled": 103936, "num_env_steps_trained": 103936, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.187427005642429, "num_agent_steps_trained_throughput_per_sec": 7.187427005642429, "timesteps_total": 103936, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 103936, "timers": {"training_iteration_time_ms": 71063.396, "sample_time_ms": 6005.555, "load_time_ms": 0.294, "load_throughput": 1741250.019, "learn_time_ms": 65057.064, "learn_throughput": 7.87, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 103936, "num_env_steps_trained": 103936, "num_agent_steps_sampled": 103936, "num_agent_steps_trained": 103936}, "done": false, "episodes_total": 6496, "training_iteration": 203, "trial_id": "f4e01_00169", "date": "2024-02-27_04-06-25", "timestamp": 1709003185, "time_this_iter_s": 71.24080467224121, "time_total_s": 14601.29596877098, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14601.29596877098, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 52.232673267326724, "ram_util_percent": 19.642574257425743}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.06, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.65671875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.65671875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.016486624876658, "policy_loss": 0.03412233809940517, "vf_loss": 7.825326045354207, "vf_explained_var": 0.9781456664204597, "kl": 0.0, "entropy": 156.6553052266439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.06, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.65671875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.65671875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 36.0, -64.0, 42.0, 52.0, 53.0, 58.0, 48.0, -64.0, 59.0, 58.0, 31.0, 36.0, 9.0, -64.0, -64.0, 43.0, -64.0, 3.0, 43.0, 43.0, 31.0, 58.0, -64.0, 42.0, 48.0, 53.0, -64.0, 34.0, -64.0, 48.0, 54.0, -64.0, 54.0, 28.0, -64.0, -64.0, 47.0, 59.0, -64.0, 58.0, 49.0, 59.0, 58.0, 18.0, 28.0, 59.0, 34.0, 58.0, 16.0, 59.0, 37.0, 53.0, 43.0, 58.0, 54.0, -64.0, 59.0, 64.0, 38.0, 32.0, 49.0, -64.0, 53.0, 54.0, 42.0, 53.0, 58.0, -7.0, 52.0, 54.0, -64.0, 53.0, 59.0, -10.0, -2.0, 51.0, 41.0, -63.0, 44.0, -64.0, -15.0, 53.0, -64.0, -62.0, 59.0, -3.0, 31.0, 17.0, 59.0, 48.0, 59.0, 32.0, -14.0, 48.0, 26.0, 59.0, 39.0, -64.0, -22.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013532869703834, "mean_inference_ms": 9.710143642475504, "mean_action_processing_ms": 0.4549469685277102, "mean_env_wait_ms": 0.28966954696923447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2647666931152344, "StateBufferConnector_ms": 0.004291057586669922, "ViewRequirementAgentConnector_ms": 0.18083643913269043}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 36.0, -64.0, 42.0, 52.0, 53.0, 58.0, 48.0, -64.0, 59.0, 58.0, 31.0, 36.0, 9.0, -64.0, -64.0, 43.0, -64.0, 3.0, 43.0, 43.0, 31.0, 58.0, -64.0, 42.0, 48.0, 53.0, -64.0, 34.0, -64.0, 48.0, 54.0, -64.0, 54.0, 28.0, -64.0, -64.0, 47.0, 59.0, -64.0, 58.0, 49.0, 59.0, 58.0, 18.0, 28.0, 59.0, 34.0, 58.0, 16.0, 59.0, 37.0, 53.0, 43.0, 58.0, 54.0, -64.0, 59.0, 64.0, 38.0, 32.0, 49.0, -64.0, 53.0, 54.0, 42.0, 53.0, 58.0, -7.0, 52.0, 54.0, -64.0, 53.0, 59.0, -10.0, -2.0, 51.0, 41.0, -63.0, 44.0, -64.0, -15.0, 53.0, -64.0, -62.0, 59.0, -3.0, 31.0, 17.0, 59.0, 48.0, 59.0, 32.0, -14.0, 48.0, 26.0, 59.0, 39.0, -64.0, -22.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013532869703834, "mean_inference_ms": 9.710143642475504, "mean_action_processing_ms": 0.4549469685277102, "mean_env_wait_ms": 0.28966954696923447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2647666931152344, "StateBufferConnector_ms": 0.004291057586669922, "ViewRequirementAgentConnector_ms": 0.18083643913269043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.139811727433034, "num_agent_steps_trained_throughput_per_sec": 7.139811727433034, "timesteps_total": 104448, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 104448, "timers": {"training_iteration_time_ms": 71148.68, "sample_time_ms": 6003.877, "load_time_ms": 0.291, "load_throughput": 1757495.415, "learn_time_ms": 65144.031, "learn_throughput": 7.86, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "done": false, "episodes_total": 6528, "training_iteration": 204, "trial_id": "f4e01_00169", "date": "2024-02-27_04-07-37", "timestamp": 1709003257, "time_this_iter_s": 71.71555161476135, "time_total_s": 14673.011520385742, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14673.011520385742, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 51.312745098039215, "ram_util_percent": 19.685294117647054}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.76, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.8999132712682085, "policy_loss": 0.03769299603300169, "vf_loss": 9.207232296466827, "vf_explained_var": 0.9162048876285553, "kl": 0.0, "entropy": 155.82392692565918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 104960, "num_env_steps_trained": 104960, "num_agent_steps_sampled": 104960, "num_agent_steps_trained": 104960}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.76, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.63875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.63875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 54.0, 28.0, -64.0, -64.0, 47.0, 59.0, -64.0, 58.0, 49.0, 59.0, 58.0, 18.0, 28.0, 59.0, 34.0, 58.0, 16.0, 59.0, 37.0, 53.0, 43.0, 58.0, 54.0, -64.0, 59.0, 64.0, 38.0, 32.0, 49.0, -64.0, 53.0, 54.0, 42.0, 53.0, 58.0, -7.0, 52.0, 54.0, -64.0, 53.0, 59.0, -10.0, -2.0, 51.0, 41.0, -63.0, 44.0, -64.0, -15.0, 53.0, -64.0, -62.0, 59.0, -3.0, 31.0, 17.0, 59.0, 48.0, 59.0, 32.0, -14.0, 48.0, 26.0, 59.0, 39.0, -64.0, -22.0, 8.0, 58.0, 1.0, 47.0, -64.0, -64.0, 49.0, 33.0, -9.0, 59.0, -3.0, 47.0, -25.0, -17.0, 27.0, 54.0, -64.0, -64.0, -20.0, 58.0, -62.0, 52.0, -21.0, -64.0, 48.0, 48.0, -24.0, 32.0, 59.0, 28.0, 64.0, 28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3011860628029128, "mean_inference_ms": 9.710577463463716, "mean_action_processing_ms": 0.45489582539815193, "mean_env_wait_ms": 0.2896418024220608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639634609222412, "StateBufferConnector_ms": 0.004280805587768555, "ViewRequirementAgentConnector_ms": 0.17988967895507812}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 54.0, 28.0, -64.0, -64.0, 47.0, 59.0, -64.0, 58.0, 49.0, 59.0, 58.0, 18.0, 28.0, 59.0, 34.0, 58.0, 16.0, 59.0, 37.0, 53.0, 43.0, 58.0, 54.0, -64.0, 59.0, 64.0, 38.0, 32.0, 49.0, -64.0, 53.0, 54.0, 42.0, 53.0, 58.0, -7.0, 52.0, 54.0, -64.0, 53.0, 59.0, -10.0, -2.0, 51.0, 41.0, -63.0, 44.0, -64.0, -15.0, 53.0, -64.0, -62.0, 59.0, -3.0, 31.0, 17.0, 59.0, 48.0, 59.0, 32.0, -14.0, 48.0, 26.0, 59.0, 39.0, -64.0, -22.0, 8.0, 58.0, 1.0, 47.0, -64.0, -64.0, 49.0, 33.0, -9.0, 59.0, -3.0, 47.0, -25.0, -17.0, 27.0, 54.0, -64.0, -64.0, -20.0, 58.0, -62.0, 52.0, -21.0, -64.0, 48.0, 48.0, -24.0, 32.0, 59.0, 28.0, 64.0, 28.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3011860628029128, "mean_inference_ms": 9.710577463463716, "mean_action_processing_ms": 0.45489582539815193, "mean_env_wait_ms": 0.2896418024220608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639634609222412, "StateBufferConnector_ms": 0.004280805587768555, "ViewRequirementAgentConnector_ms": 0.17988967895507812}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104960, "num_agent_steps_trained": 104960, "num_env_steps_sampled": 104960, "num_env_steps_trained": 104960, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.138341676309457, "num_agent_steps_trained_throughput_per_sec": 7.138341676309457, "timesteps_total": 104960, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 104960, "timers": {"training_iteration_time_ms": 71238.49, "sample_time_ms": 6012.406, "load_time_ms": 0.292, "load_throughput": 1755197.097, "learn_time_ms": 65225.292, "learn_throughput": 7.85, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 104960, "num_env_steps_trained": 104960, "num_agent_steps_sampled": 104960, "num_agent_steps_trained": 104960}, "done": false, "episodes_total": 6560, "training_iteration": 205, "trial_id": "f4e01_00169", "date": "2024-02-27_04-08-49", "timestamp": 1709003329, "time_this_iter_s": 71.73068737983704, "time_total_s": 14744.74220776558, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14744.74220776558, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 51.69019607843137, "ram_util_percent": 19.617647058823522}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.34, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9988161414861679, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.403471799691518, "policy_loss": 0.027645435915716613, "vf_loss": 8.443299587567648, "vf_explained_var": 0.9416849002242088, "kl": 0.0, "entropy": 155.6182072957357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.34, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 42.0, 53.0, 58.0, -7.0, 52.0, 54.0, -64.0, 53.0, 59.0, -10.0, -2.0, 51.0, 41.0, -63.0, 44.0, -64.0, -15.0, 53.0, -64.0, -62.0, 59.0, -3.0, 31.0, 17.0, 59.0, 48.0, 59.0, 32.0, -14.0, 48.0, 26.0, 59.0, 39.0, -64.0, -22.0, 8.0, 58.0, 1.0, 47.0, -64.0, -64.0, 49.0, 33.0, -9.0, 59.0, -3.0, 47.0, -25.0, -17.0, 27.0, 54.0, -64.0, -64.0, -20.0, 58.0, -62.0, 52.0, -21.0, -64.0, 48.0, 48.0, -24.0, 32.0, 59.0, 28.0, 64.0, 28.0, 38.0, 53.0, -10.0, 53.0, 16.0, 5.0, 53.0, -64.0, -64.0, 58.0, 49.0, -64.0, -64.0, 64.0, 22.0, -64.0, 35.0, 43.0, 52.0, 58.0, 19.0, 53.0, 43.0, 44.0, 42.0, 48.0, 36.0, 33.0, -63.0, 43.0, -7.0, 38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3009999816725355, "mean_inference_ms": 9.710789939946956, "mean_action_processing_ms": 0.4548295449084448, "mean_env_wait_ms": 0.28959934469700194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2624375820159912, "StateBufferConnector_ms": 0.0042798519134521484, "ViewRequirementAgentConnector_ms": 0.17991065979003906}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 42.0, 53.0, 58.0, -7.0, 52.0, 54.0, -64.0, 53.0, 59.0, -10.0, -2.0, 51.0, 41.0, -63.0, 44.0, -64.0, -15.0, 53.0, -64.0, -62.0, 59.0, -3.0, 31.0, 17.0, 59.0, 48.0, 59.0, 32.0, -14.0, 48.0, 26.0, 59.0, 39.0, -64.0, -22.0, 8.0, 58.0, 1.0, 47.0, -64.0, -64.0, 49.0, 33.0, -9.0, 59.0, -3.0, 47.0, -25.0, -17.0, 27.0, 54.0, -64.0, -64.0, -20.0, 58.0, -62.0, 52.0, -21.0, -64.0, 48.0, 48.0, -24.0, 32.0, 59.0, 28.0, 64.0, 28.0, 38.0, 53.0, -10.0, 53.0, 16.0, 5.0, 53.0, -64.0, -64.0, 58.0, 49.0, -64.0, -64.0, 64.0, 22.0, -64.0, 35.0, 43.0, 52.0, 58.0, 19.0, 53.0, 43.0, 44.0, 42.0, 48.0, 36.0, 33.0, -63.0, 43.0, -7.0, 38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3009999816725355, "mean_inference_ms": 9.710789939946956, "mean_action_processing_ms": 0.4548295449084448, "mean_env_wait_ms": 0.28959934469700194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2624375820159912, "StateBufferConnector_ms": 0.0042798519134521484, "ViewRequirementAgentConnector_ms": 0.17991065979003906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.060274938437961, "num_agent_steps_trained_throughput_per_sec": 7.060274938437961, "timesteps_total": 105472, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 105472, "timers": {"training_iteration_time_ms": 71395.209, "sample_time_ms": 6029.563, "load_time_ms": 0.296, "load_throughput": 1730725.055, "learn_time_ms": 65364.844, "learn_throughput": 7.833, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "done": false, "episodes_total": 6592, "training_iteration": 206, "trial_id": "f4e01_00169", "date": "2024-02-27_04-10-02", "timestamp": 1709003402, "time_this_iter_s": 72.52382969856262, "time_total_s": 14817.266037464142, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14817.266037464142, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 51.17184466019416, "ram_util_percent": 19.641747572815532}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.23, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.634609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.634609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.819795183340708, "policy_loss": 0.18748552508962651, "vf_loss": 7.275528558095297, "vf_explained_var": 0.8762981538971265, "kl": 0.0, "entropy": 154.14870363871256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 105984, "num_env_steps_trained": 105984, "num_agent_steps_sampled": 105984, "num_agent_steps_trained": 105984}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.23, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.634609375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.634609375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 39.0, -64.0, -22.0, 8.0, 58.0, 1.0, 47.0, -64.0, -64.0, 49.0, 33.0, -9.0, 59.0, -3.0, 47.0, -25.0, -17.0, 27.0, 54.0, -64.0, -64.0, -20.0, 58.0, -62.0, 52.0, -21.0, -64.0, 48.0, 48.0, -24.0, 32.0, 59.0, 28.0, 64.0, 28.0, 38.0, 53.0, -10.0, 53.0, 16.0, 5.0, 53.0, -64.0, -64.0, 58.0, 49.0, -64.0, -64.0, 64.0, 22.0, -64.0, 35.0, 43.0, 52.0, 58.0, 19.0, 53.0, 43.0, 44.0, 42.0, 48.0, 36.0, 33.0, -63.0, 43.0, -7.0, 38.0, 42.0, 58.0, 11.0, 4.0, 11.0, -4.0, 33.0, 48.0, -64.0, 54.0, 42.0, 49.0, -64.0, 35.0, 44.0, 58.0, 54.0, -64.0, 52.0, -23.0, 59.0, 43.0, 58.0, 58.0, -64.0, 59.0, 59.0, 58.0, 9.0, -8.0, 54.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300888765649995, "mean_inference_ms": 9.711323502956816, "mean_action_processing_ms": 0.4547890195945986, "mean_env_wait_ms": 0.28957082233867815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26576733589172363, "StateBufferConnector_ms": 0.004347562789916992, "ViewRequirementAgentConnector_ms": 0.18672847747802734}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 39.0, -64.0, -22.0, 8.0, 58.0, 1.0, 47.0, -64.0, -64.0, 49.0, 33.0, -9.0, 59.0, -3.0, 47.0, -25.0, -17.0, 27.0, 54.0, -64.0, -64.0, -20.0, 58.0, -62.0, 52.0, -21.0, -64.0, 48.0, 48.0, -24.0, 32.0, 59.0, 28.0, 64.0, 28.0, 38.0, 53.0, -10.0, 53.0, 16.0, 5.0, 53.0, -64.0, -64.0, 58.0, 49.0, -64.0, -64.0, 64.0, 22.0, -64.0, 35.0, 43.0, 52.0, 58.0, 19.0, 53.0, 43.0, 44.0, 42.0, 48.0, 36.0, 33.0, -63.0, 43.0, -7.0, 38.0, 42.0, 58.0, 11.0, 4.0, 11.0, -4.0, 33.0, 48.0, -64.0, 54.0, 42.0, 49.0, -64.0, 35.0, 44.0, 58.0, 54.0, -64.0, 52.0, -23.0, 59.0, 43.0, 58.0, 58.0, -64.0, 59.0, 59.0, 58.0, 9.0, -8.0, 54.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300888765649995, "mean_inference_ms": 9.711323502956816, "mean_action_processing_ms": 0.4547890195945986, "mean_env_wait_ms": 0.28957082233867815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26576733589172363, "StateBufferConnector_ms": 0.004347562789916992, "ViewRequirementAgentConnector_ms": 0.18672847747802734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105984, "num_agent_steps_trained": 105984, "num_env_steps_sampled": 105984, "num_env_steps_trained": 105984, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.063833582168566, "num_agent_steps_trained_throughput_per_sec": 7.063833582168566, "timesteps_total": 105984, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 105984, "timers": {"training_iteration_time_ms": 71586.663, "sample_time_ms": 6059.367, "load_time_ms": 0.295, "load_throughput": 1737586.899, "learn_time_ms": 65526.499, "learn_throughput": 7.814, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 105984, "num_env_steps_trained": 105984, "num_agent_steps_sampled": 105984, "num_agent_steps_trained": 105984}, "done": false, "episodes_total": 6624, "training_iteration": 207, "trial_id": "f4e01_00169", "date": "2024-02-27_04-11-14", "timestamp": 1709003474, "time_this_iter_s": 72.48734283447266, "time_total_s": 14889.753380298615, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14889.753380298615, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 53.01862745098038, "ram_util_percent": 19.58725490196078}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.08, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6490625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6490625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.904207237561544, "policy_loss": -0.023734950204379858, "vf_loss": 7.739850342273712, "vf_explained_var": 0.963205662369728, "kl": 0.0, "entropy": 154.3183849334717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.08, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6490625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6490625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, 28.0, 64.0, 28.0, 38.0, 53.0, -10.0, 53.0, 16.0, 5.0, 53.0, -64.0, -64.0, 58.0, 49.0, -64.0, -64.0, 64.0, 22.0, -64.0, 35.0, 43.0, 52.0, 58.0, 19.0, 53.0, 43.0, 44.0, 42.0, 48.0, 36.0, 33.0, -63.0, 43.0, -7.0, 38.0, 42.0, 58.0, 11.0, 4.0, 11.0, -4.0, 33.0, 48.0, -64.0, 54.0, 42.0, 49.0, -64.0, 35.0, 44.0, 58.0, 54.0, -64.0, 52.0, -23.0, 59.0, 43.0, 58.0, 58.0, -64.0, 59.0, 59.0, 58.0, 9.0, -8.0, 54.0, 53.0, 0.0, 36.0, 18.0, 58.0, -64.0, -23.0, 59.0, -64.0, 49.0, 64.0, 59.0, -64.0, 31.0, 53.0, 29.0, -64.0, 64.0, -11.0, 44.0, 5.0, 32.0, -63.0, 54.0, 49.0, -29.0, 48.0, -30.0, 7.0, -64.0, 43.0, -63.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300921166033621, "mean_inference_ms": 9.712283178050354, "mean_action_processing_ms": 0.4548044429783268, "mean_env_wait_ms": 0.28957841840640186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27102136611938477, "StateBufferConnector_ms": 0.004456758499145508, "ViewRequirementAgentConnector_ms": 0.19686436653137207}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, 28.0, 64.0, 28.0, 38.0, 53.0, -10.0, 53.0, 16.0, 5.0, 53.0, -64.0, -64.0, 58.0, 49.0, -64.0, -64.0, 64.0, 22.0, -64.0, 35.0, 43.0, 52.0, 58.0, 19.0, 53.0, 43.0, 44.0, 42.0, 48.0, 36.0, 33.0, -63.0, 43.0, -7.0, 38.0, 42.0, 58.0, 11.0, 4.0, 11.0, -4.0, 33.0, 48.0, -64.0, 54.0, 42.0, 49.0, -64.0, 35.0, 44.0, 58.0, 54.0, -64.0, 52.0, -23.0, 59.0, 43.0, 58.0, 58.0, -64.0, 59.0, 59.0, 58.0, 9.0, -8.0, 54.0, 53.0, 0.0, 36.0, 18.0, 58.0, -64.0, -23.0, 59.0, -64.0, 49.0, 64.0, 59.0, -64.0, 31.0, 53.0, 29.0, -64.0, 64.0, -11.0, 44.0, 5.0, 32.0, -63.0, 54.0, 49.0, -29.0, 48.0, -30.0, 7.0, -64.0, 43.0, -63.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300921166033621, "mean_inference_ms": 9.712283178050354, "mean_action_processing_ms": 0.4548044429783268, "mean_env_wait_ms": 0.28957841840640186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27102136611938477, "StateBufferConnector_ms": 0.004456758499145508, "ViewRequirementAgentConnector_ms": 0.19686436653137207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.067042158121763, "num_agent_steps_trained_throughput_per_sec": 7.067042158121763, "timesteps_total": 106496, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 71761.022, "sample_time_ms": 6080.827, "load_time_ms": 0.295, "load_throughput": 1737868.13, "learn_time_ms": 65679.395, "learn_throughput": 7.795, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "episodes_total": 6656, "training_iteration": 208, "trial_id": "f4e01_00169", "date": "2024-02-27_04-12-27", "timestamp": 1709003547, "time_this_iter_s": 72.45402765274048, "time_total_s": 14962.207407951355, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14962.207407951355, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 51.06213592233009, "ram_util_percent": 19.36504854368932}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.41, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.620390625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.620390625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.970237410068512, "policy_loss": 0.028958326733360688, "vf_loss": 7.7607974171638485, "vf_explained_var": 0.8538510779539744, "kl": 0.0, "entropy": 156.0895746866862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 107008, "num_env_steps_trained": 107008, "num_agent_steps_sampled": 107008, "num_agent_steps_trained": 107008}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.41, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.41, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.620390625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.620390625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, 43.0, -7.0, 38.0, 42.0, 58.0, 11.0, 4.0, 11.0, -4.0, 33.0, 48.0, -64.0, 54.0, 42.0, 49.0, -64.0, 35.0, 44.0, 58.0, 54.0, -64.0, 52.0, -23.0, 59.0, 43.0, 58.0, 58.0, -64.0, 59.0, 59.0, 58.0, 9.0, -8.0, 54.0, 53.0, 0.0, 36.0, 18.0, 58.0, -64.0, -23.0, 59.0, -64.0, 49.0, 64.0, 59.0, -64.0, 31.0, 53.0, 29.0, -64.0, 64.0, -11.0, 44.0, 5.0, 32.0, -63.0, 54.0, 49.0, -29.0, 48.0, -30.0, 7.0, -64.0, 43.0, -63.0, 54.0, -2.0, -64.0, 53.0, 64.0, 64.0, 37.0, 53.0, 16.0, 48.0, 44.0, 59.0, 64.0, 58.0, -34.0, 48.0, 53.0, -64.0, 47.0, -15.0, 58.0, -64.0, -64.0, -64.0, -64.0, 58.0, -64.0, 37.0, -64.0, 53.0, -64.0, 59.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010409208833291, "mean_inference_ms": 9.71340299177238, "mean_action_processing_ms": 0.4548675390160334, "mean_env_wait_ms": 0.28963367399440293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27634692192077637, "StateBufferConnector_ms": 0.00454401969909668, "ViewRequirementAgentConnector_ms": 0.20213842391967773}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.41, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, 43.0, -7.0, 38.0, 42.0, 58.0, 11.0, 4.0, 11.0, -4.0, 33.0, 48.0, -64.0, 54.0, 42.0, 49.0, -64.0, 35.0, 44.0, 58.0, 54.0, -64.0, 52.0, -23.0, 59.0, 43.0, 58.0, 58.0, -64.0, 59.0, 59.0, 58.0, 9.0, -8.0, 54.0, 53.0, 0.0, 36.0, 18.0, 58.0, -64.0, -23.0, 59.0, -64.0, 49.0, 64.0, 59.0, -64.0, 31.0, 53.0, 29.0, -64.0, 64.0, -11.0, 44.0, 5.0, 32.0, -63.0, 54.0, 49.0, -29.0, 48.0, -30.0, 7.0, -64.0, 43.0, -63.0, 54.0, -2.0, -64.0, 53.0, 64.0, 64.0, 37.0, 53.0, 16.0, 48.0, 44.0, 59.0, 64.0, 58.0, -34.0, 48.0, 53.0, -64.0, 47.0, -15.0, 58.0, -64.0, -64.0, -64.0, -64.0, 58.0, -64.0, 37.0, -64.0, 53.0, -64.0, 59.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3010409208833291, "mean_inference_ms": 9.71340299177238, "mean_action_processing_ms": 0.4548675390160334, "mean_env_wait_ms": 0.28963367399440293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27634692192077637, "StateBufferConnector_ms": 0.00454401969909668, "ViewRequirementAgentConnector_ms": 0.20213842391967773}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107008, "num_agent_steps_trained": 107008, "num_env_steps_sampled": 107008, "num_env_steps_trained": 107008, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.1313397391505084, "num_agent_steps_trained_throughput_per_sec": 7.1313397391505084, "timesteps_total": 107008, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 107008, "timers": {"training_iteration_time_ms": 71817.896, "sample_time_ms": 6104.928, "load_time_ms": 0.293, "load_throughput": 1746631.678, "learn_time_ms": 65712.166, "learn_throughput": 7.792, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 107008, "num_env_steps_trained": 107008, "num_agent_steps_sampled": 107008, "num_agent_steps_trained": 107008}, "done": false, "episodes_total": 6688, "training_iteration": 209, "trial_id": "f4e01_00169", "date": "2024-02-27_04-13-39", "timestamp": 1709003619, "time_this_iter_s": 71.80100440979004, "time_total_s": 15034.008412361145, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15034.008412361145, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 50.47156862745098, "ram_util_percent": 18.67941176470588}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 10.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.58171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.58171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.062844276428223, "policy_loss": 0.018493362919737896, "vf_loss": 7.922682535648346, "vf_explained_var": 0.9747443760434786, "kl": 0.0, "entropy": 157.02047233581544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.46, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 10.46, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.58171875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.58171875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [9.0, -8.0, 54.0, 53.0, 0.0, 36.0, 18.0, 58.0, -64.0, -23.0, 59.0, -64.0, 49.0, 64.0, 59.0, -64.0, 31.0, 53.0, 29.0, -64.0, 64.0, -11.0, 44.0, 5.0, 32.0, -63.0, 54.0, 49.0, -29.0, 48.0, -30.0, 7.0, -64.0, 43.0, -63.0, 54.0, -2.0, -64.0, 53.0, 64.0, 64.0, 37.0, 53.0, 16.0, 48.0, 44.0, 59.0, 64.0, 58.0, -34.0, 48.0, 53.0, -64.0, 47.0, -15.0, 58.0, -64.0, -64.0, -64.0, -64.0, 58.0, -64.0, 37.0, -64.0, 53.0, -64.0, 59.0, 53.0, -18.0, 53.0, -64.0, 58.0, -64.0, 64.0, -25.0, 48.0, 58.0, -64.0, -64.0, 64.0, 59.0, 54.0, -64.0, -22.0, 39.0, -64.0, -30.0, 64.0, 53.0, 38.0, 58.0, -13.0, 13.0, 43.0, -64.0, 24.0, 59.0, -30.0, -64.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301565371961656, "mean_inference_ms": 9.714381713489525, "mean_action_processing_ms": 0.4549493987951797, "mean_env_wait_ms": 0.28969878824855066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779090404510498, "StateBufferConnector_ms": 0.004627227783203125, "ViewRequirementAgentConnector_ms": 0.20224308967590332}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.46, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.0, -8.0, 54.0, 53.0, 0.0, 36.0, 18.0, 58.0, -64.0, -23.0, 59.0, -64.0, 49.0, 64.0, 59.0, -64.0, 31.0, 53.0, 29.0, -64.0, 64.0, -11.0, 44.0, 5.0, 32.0, -63.0, 54.0, 49.0, -29.0, 48.0, -30.0, 7.0, -64.0, 43.0, -63.0, 54.0, -2.0, -64.0, 53.0, 64.0, 64.0, 37.0, 53.0, 16.0, 48.0, 44.0, 59.0, 64.0, 58.0, -34.0, 48.0, 53.0, -64.0, 47.0, -15.0, 58.0, -64.0, -64.0, -64.0, -64.0, 58.0, -64.0, 37.0, -64.0, 53.0, -64.0, 59.0, 53.0, -18.0, 53.0, -64.0, 58.0, -64.0, 64.0, -25.0, 48.0, 58.0, -64.0, -64.0, 64.0, 59.0, 54.0, -64.0, -22.0, 39.0, -64.0, -30.0, 64.0, 53.0, 38.0, 58.0, -13.0, 13.0, 43.0, -64.0, 24.0, 59.0, -30.0, -64.0, 23.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301565371961656, "mean_inference_ms": 9.714381713489525, "mean_action_processing_ms": 0.4549493987951797, "mean_env_wait_ms": 0.28969878824855066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2779090404510498, "StateBufferConnector_ms": 0.004627227783203125, "ViewRequirementAgentConnector_ms": 0.20224308967590332}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.028533825944737, "num_agent_steps_trained_throughput_per_sec": 7.028533825944737, "timesteps_total": 107520, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 71916.23, "sample_time_ms": 6124.246, "load_time_ms": 0.284, "load_throughput": 1802185.002, "learn_time_ms": 65791.217, "learn_throughput": 7.782, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "done": false, "episodes_total": 6720, "training_iteration": 210, "trial_id": "f4e01_00169", "date": "2024-02-27_04-14-51", "timestamp": 1709003691, "time_this_iter_s": 72.8511278629303, "time_total_s": 15106.859540224075, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15106.859540224075, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 50.66990291262136, "ram_util_percent": 17.942718446601944}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 5.12, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.54, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.54, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.675116622447968, "policy_loss": 0.09957881449566533, "vf_loss": 8.756967361768087, "vf_explained_var": 0.6660985777775447, "kl": 0.0, "entropy": 152.10322151184081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 108032, "num_env_steps_trained": 108032, "num_agent_steps_sampled": 108032, "num_agent_steps_trained": 108032}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 5.12, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.54, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.54, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 43.0, -63.0, 54.0, -2.0, -64.0, 53.0, 64.0, 64.0, 37.0, 53.0, 16.0, 48.0, 44.0, 59.0, 64.0, 58.0, -34.0, 48.0, 53.0, -64.0, 47.0, -15.0, 58.0, -64.0, -64.0, -64.0, -64.0, 58.0, -64.0, 37.0, -64.0, 53.0, -64.0, 59.0, 53.0, -18.0, 53.0, -64.0, 58.0, -64.0, 64.0, -25.0, 48.0, 58.0, -64.0, -64.0, 64.0, 59.0, 54.0, -64.0, -22.0, 39.0, -64.0, -30.0, 64.0, 53.0, 38.0, 58.0, -13.0, 13.0, 43.0, -64.0, 24.0, 59.0, -30.0, -64.0, 23.0, -64.0, -15.0, -17.0, -23.0, 36.0, -64.0, -64.0, 59.0, 53.0, -25.0, 43.0, -17.0, 64.0, 15.0, -21.0, 0.0, 43.0, -33.0, 38.0, 53.0, -64.0, -64.0, -64.0, 48.0, -64.0, -11.0, 59.0, 31.0, 53.0, -64.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3020034992732976, "mean_inference_ms": 9.714868777121685, "mean_action_processing_ms": 0.4550033155536633, "mean_env_wait_ms": 0.28974442116157784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27532148361206055, "StateBufferConnector_ms": 0.0045931339263916016, "ViewRequirementAgentConnector_ms": 0.196272611618042}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 43.0, -63.0, 54.0, -2.0, -64.0, 53.0, 64.0, 64.0, 37.0, 53.0, 16.0, 48.0, 44.0, 59.0, 64.0, 58.0, -34.0, 48.0, 53.0, -64.0, 47.0, -15.0, 58.0, -64.0, -64.0, -64.0, -64.0, 58.0, -64.0, 37.0, -64.0, 53.0, -64.0, 59.0, 53.0, -18.0, 53.0, -64.0, 58.0, -64.0, 64.0, -25.0, 48.0, 58.0, -64.0, -64.0, 64.0, 59.0, 54.0, -64.0, -22.0, 39.0, -64.0, -30.0, 64.0, 53.0, 38.0, 58.0, -13.0, 13.0, 43.0, -64.0, 24.0, 59.0, -30.0, -64.0, 23.0, -64.0, -15.0, -17.0, -23.0, 36.0, -64.0, -64.0, 59.0, 53.0, -25.0, 43.0, -17.0, 64.0, 15.0, -21.0, 0.0, 43.0, -33.0, 38.0, 53.0, -64.0, -64.0, -64.0, 48.0, -64.0, -11.0, 59.0, 31.0, 53.0, -64.0, -64.0, 64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3020034992732976, "mean_inference_ms": 9.714868777121685, "mean_action_processing_ms": 0.4550033155536633, "mean_env_wait_ms": 0.28974442116157784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27532148361206055, "StateBufferConnector_ms": 0.0045931339263916016, "ViewRequirementAgentConnector_ms": 0.196272611618042}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108032, "num_agent_steps_trained": 108032, "num_env_steps_sampled": 108032, "num_env_steps_trained": 108032, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.093239893386488, "num_agent_steps_trained_throughput_per_sec": 7.093239893386488, "timesteps_total": 108032, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 108032, "timers": {"training_iteration_time_ms": 72016.555, "sample_time_ms": 6120.204, "load_time_ms": 0.282, "load_throughput": 1818206.458, "learn_time_ms": 65895.586, "learn_throughput": 7.77, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 108032, "num_env_steps_trained": 108032, "num_agent_steps_sampled": 108032, "num_agent_steps_trained": 108032}, "done": false, "episodes_total": 6752, "training_iteration": 211, "trial_id": "f4e01_00169", "date": "2024-02-27_04-16-04", "timestamp": 1709003764, "time_this_iter_s": 72.18647360801697, "time_total_s": 15179.046013832092, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15179.046013832092, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 50.1421568627451, "ram_util_percent": 17.726470588235294}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 4.0, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.53125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.53125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.597126748164495, "policy_loss": -0.022417567670345306, "vf_loss": 7.255479180812836, "vf_explained_var": 0.8035267586509387, "kl": 0.0, "entropy": 156.3785806020101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 4.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 4.0, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.53125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.53125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, -64.0, 59.0, 53.0, -18.0, 53.0, -64.0, 58.0, -64.0, 64.0, -25.0, 48.0, 58.0, -64.0, -64.0, 64.0, 59.0, 54.0, -64.0, -22.0, 39.0, -64.0, -30.0, 64.0, 53.0, 38.0, 58.0, -13.0, 13.0, 43.0, -64.0, 24.0, 59.0, -30.0, -64.0, 23.0, -64.0, -15.0, -17.0, -23.0, 36.0, -64.0, -64.0, 59.0, 53.0, -25.0, 43.0, -17.0, 64.0, 15.0, -21.0, 0.0, 43.0, -33.0, 38.0, 53.0, -64.0, -64.0, -64.0, 48.0, -64.0, -11.0, 59.0, 31.0, 53.0, -64.0, -64.0, 64.0, 53.0, 53.0, 59.0, -64.0, 28.0, -64.0, 39.0, 53.0, 38.0, 58.0, -42.0, -44.0, 58.0, 41.0, -56.0, 41.0, -43.0, 64.0, -64.0, 46.0, -37.0, -44.0, 54.0, -42.0, 46.0, -64.0, -64.0, 59.0, 59.0, -64.0, -44.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302473635827313, "mean_inference_ms": 9.715396099886993, "mean_action_processing_ms": 0.4550415262446248, "mean_env_wait_ms": 0.2897953979702749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27555346488952637, "StateBufferConnector_ms": 0.004641294479370117, "ViewRequirementAgentConnector_ms": 0.1991739273071289}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 4.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, -64.0, 59.0, 53.0, -18.0, 53.0, -64.0, 58.0, -64.0, 64.0, -25.0, 48.0, 58.0, -64.0, -64.0, 64.0, 59.0, 54.0, -64.0, -22.0, 39.0, -64.0, -30.0, 64.0, 53.0, 38.0, 58.0, -13.0, 13.0, 43.0, -64.0, 24.0, 59.0, -30.0, -64.0, 23.0, -64.0, -15.0, -17.0, -23.0, 36.0, -64.0, -64.0, 59.0, 53.0, -25.0, 43.0, -17.0, 64.0, 15.0, -21.0, 0.0, 43.0, -33.0, 38.0, 53.0, -64.0, -64.0, -64.0, 48.0, -64.0, -11.0, 59.0, 31.0, 53.0, -64.0, -64.0, 64.0, 53.0, 53.0, 59.0, -64.0, 28.0, -64.0, 39.0, 53.0, 38.0, 58.0, -42.0, -44.0, 58.0, 41.0, -56.0, 41.0, -43.0, 64.0, -64.0, 46.0, -37.0, -44.0, 54.0, -42.0, 46.0, -64.0, -64.0, 59.0, 59.0, -64.0, -44.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302473635827313, "mean_inference_ms": 9.715396099886993, "mean_action_processing_ms": 0.4550415262446248, "mean_env_wait_ms": 0.2897953979702749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27555346488952637, "StateBufferConnector_ms": 0.004641294479370117, "ViewRequirementAgentConnector_ms": 0.1991739273071289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.062456104938946, "num_agent_steps_trained_throughput_per_sec": 7.062456104938946, "timesteps_total": 108544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 108544, "timers": {"training_iteration_time_ms": 72143.944, "sample_time_ms": 6132.779, "load_time_ms": 0.286, "load_throughput": 1792706.944, "learn_time_ms": 66010.392, "learn_throughput": 7.756, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "done": false, "episodes_total": 6784, "training_iteration": 212, "trial_id": "f4e01_00169", "date": "2024-02-27_04-17-16", "timestamp": 1709003836, "time_this_iter_s": 72.50117540359497, "time_total_s": 15251.547189235687, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15251.547189235687, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 49.804854368932034, "ram_util_percent": 17.792233009708738}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 4.23, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.533046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.533046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.706026273965835, "policy_loss": 0.003566275020906081, "vf_loss": 7.385706933339437, "vf_explained_var": 0.8730068410436312, "kl": 0.0, "entropy": 151.8848622639974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 109056, "num_env_steps_trained": 109056, "num_agent_steps_sampled": 109056, "num_agent_steps_trained": 109056}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 4.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 4.23, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.533046875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.533046875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -30.0, -64.0, 23.0, -64.0, -15.0, -17.0, -23.0, 36.0, -64.0, -64.0, 59.0, 53.0, -25.0, 43.0, -17.0, 64.0, 15.0, -21.0, 0.0, 43.0, -33.0, 38.0, 53.0, -64.0, -64.0, -64.0, 48.0, -64.0, -11.0, 59.0, 31.0, 53.0, -64.0, -64.0, 64.0, 53.0, 53.0, 59.0, -64.0, 28.0, -64.0, 39.0, 53.0, 38.0, 58.0, -42.0, -44.0, 58.0, 41.0, -56.0, 41.0, -43.0, 64.0, -64.0, 46.0, -37.0, -44.0, 54.0, -42.0, 46.0, -64.0, -64.0, 59.0, 59.0, -64.0, -44.0, 43.0, 58.0, 33.0, 54.0, -23.0, 58.0, -64.0, 59.0, -64.0, 52.0, 42.0, -64.0, 38.0, 59.0, -64.0, -31.0, 53.0, 33.0, -33.0, 58.0, 47.0, 64.0, -14.0, 53.0, 59.0, -64.0, 57.0, -29.0, 43.0, -64.0, 18.0, -37.0, -29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025654470633419, "mean_inference_ms": 9.715717027119181, "mean_action_processing_ms": 0.45505797664036834, "mean_env_wait_ms": 0.28982938778790557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2740480899810791, "StateBufferConnector_ms": 0.004534006118774414, "ViewRequirementAgentConnector_ms": 0.193983793258667}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 4.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -30.0, -64.0, 23.0, -64.0, -15.0, -17.0, -23.0, 36.0, -64.0, -64.0, 59.0, 53.0, -25.0, 43.0, -17.0, 64.0, 15.0, -21.0, 0.0, 43.0, -33.0, 38.0, 53.0, -64.0, -64.0, -64.0, 48.0, -64.0, -11.0, 59.0, 31.0, 53.0, -64.0, -64.0, 64.0, 53.0, 53.0, 59.0, -64.0, 28.0, -64.0, 39.0, 53.0, 38.0, 58.0, -42.0, -44.0, 58.0, 41.0, -56.0, 41.0, -43.0, 64.0, -64.0, 46.0, -37.0, -44.0, 54.0, -42.0, 46.0, -64.0, -64.0, 59.0, 59.0, -64.0, -44.0, 43.0, 58.0, 33.0, 54.0, -23.0, 58.0, -64.0, 59.0, -64.0, 52.0, 42.0, -64.0, 38.0, 59.0, -64.0, -31.0, 53.0, 33.0, -33.0, 58.0, 47.0, 64.0, -14.0, 53.0, 59.0, -64.0, 57.0, -29.0, 43.0, -64.0, 18.0, -37.0, -29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025654470633419, "mean_inference_ms": 9.715717027119181, "mean_action_processing_ms": 0.45505797664036834, "mean_env_wait_ms": 0.28982938778790557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2740480899810791, "StateBufferConnector_ms": 0.004534006118774414, "ViewRequirementAgentConnector_ms": 0.193983793258667}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109056, "num_agent_steps_trained": 109056, "num_env_steps_sampled": 109056, "num_env_steps_trained": 109056, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.098610720730459, "num_agent_steps_trained_throughput_per_sec": 7.098610720730459, "timesteps_total": 109056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 109056, "timers": {"training_iteration_time_ms": 72233.071, "sample_time_ms": 6117.074, "load_time_ms": 0.287, "load_throughput": 1785403.765, "learn_time_ms": 66115.215, "learn_throughput": 7.744, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 109056, "num_env_steps_trained": 109056, "num_agent_steps_sampled": 109056, "num_agent_steps_trained": 109056}, "done": false, "episodes_total": 6816, "training_iteration": 213, "trial_id": "f4e01_00169", "date": "2024-02-27_04-18-28", "timestamp": 1709003908, "time_this_iter_s": 72.13223004341125, "time_total_s": 15323.679419279099, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15323.679419279099, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 50.259803921568626, "ram_util_percent": 17.801960784313728}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 7.38, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.55765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.55765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.836014360189438, "policy_loss": 0.05645952799047033, "vf_loss": 7.506792531410853, "vf_explained_var": 0.8830354670683543, "kl": 0.0, "entropy": 152.60102005004882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 7.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 7.38, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.55765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.55765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, -64.0, -64.0, 64.0, 53.0, 53.0, 59.0, -64.0, 28.0, -64.0, 39.0, 53.0, 38.0, 58.0, -42.0, -44.0, 58.0, 41.0, -56.0, 41.0, -43.0, 64.0, -64.0, 46.0, -37.0, -44.0, 54.0, -42.0, 46.0, -64.0, -64.0, 59.0, 59.0, -64.0, -44.0, 43.0, 58.0, 33.0, 54.0, -23.0, 58.0, -64.0, 59.0, -64.0, 52.0, 42.0, -64.0, 38.0, 59.0, -64.0, -31.0, 53.0, 33.0, -33.0, 58.0, 47.0, 64.0, -14.0, 53.0, 59.0, -64.0, 57.0, -29.0, 43.0, -64.0, 18.0, -37.0, -29.0, -58.0, 54.0, -60.0, 48.0, 54.0, -64.0, -59.0, -58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 49.0, 53.0, 59.0, 54.0, 51.0, -56.0, 48.0, 48.0, 59.0, 59.0, 64.0, -64.0, -54.0, 43.0, 54.0, 46.0, -56.0, -58.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026098148627725, "mean_inference_ms": 9.71603354182379, "mean_action_processing_ms": 0.4550708478657437, "mean_env_wait_ms": 0.28986106508802795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27414941787719727, "StateBufferConnector_ms": 0.004508018493652344, "ViewRequirementAgentConnector_ms": 0.19364619255065918}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 7.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, -64.0, -64.0, 64.0, 53.0, 53.0, 59.0, -64.0, 28.0, -64.0, 39.0, 53.0, 38.0, 58.0, -42.0, -44.0, 58.0, 41.0, -56.0, 41.0, -43.0, 64.0, -64.0, 46.0, -37.0, -44.0, 54.0, -42.0, 46.0, -64.0, -64.0, 59.0, 59.0, -64.0, -44.0, 43.0, 58.0, 33.0, 54.0, -23.0, 58.0, -64.0, 59.0, -64.0, 52.0, 42.0, -64.0, 38.0, 59.0, -64.0, -31.0, 53.0, 33.0, -33.0, 58.0, 47.0, 64.0, -14.0, 53.0, 59.0, -64.0, 57.0, -29.0, 43.0, -64.0, 18.0, -37.0, -29.0, -58.0, 54.0, -60.0, 48.0, 54.0, -64.0, -59.0, -58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 49.0, 53.0, 59.0, 54.0, 51.0, -56.0, 48.0, 48.0, 59.0, 59.0, 64.0, -64.0, -54.0, 43.0, 54.0, 46.0, -56.0, -58.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026098148627725, "mean_inference_ms": 9.71603354182379, "mean_action_processing_ms": 0.4550708478657437, "mean_env_wait_ms": 0.28986106508802795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27414941787719727, "StateBufferConnector_ms": 0.004508018493652344, "ViewRequirementAgentConnector_ms": 0.19364619255065918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.084687228471521, "num_agent_steps_trained_throughput_per_sec": 7.084687228471521, "timesteps_total": 109568, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 109568, "timers": {"training_iteration_time_ms": 72288.866, "sample_time_ms": 6124.289, "load_time_ms": 0.29, "load_throughput": 1765006.697, "learn_time_ms": 66163.775, "learn_throughput": 7.738, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "done": false, "episodes_total": 6848, "training_iteration": 214, "trial_id": "f4e01_00169", "date": "2024-02-27_04-19-41", "timestamp": 1709003981, "time_this_iter_s": 72.27379608154297, "time_total_s": 15395.953215360641, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15395.953215360641, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 51.11165048543691, "ram_util_percent": 17.826213592233014}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 5.06, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.53953125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.53953125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.576272936662038, "policy_loss": 0.05316379959695041, "vf_loss": 8.67462264696757, "vf_explained_var": 0.9269591073195139, "kl": 0.0, "entropy": 154.84074440002442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 110080, "num_env_steps_trained": 110080, "num_agent_steps_sampled": 110080, "num_agent_steps_trained": 110080}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 5.06, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.53953125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.53953125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [59.0, -64.0, -44.0, 43.0, 58.0, 33.0, 54.0, -23.0, 58.0, -64.0, 59.0, -64.0, 52.0, 42.0, -64.0, 38.0, 59.0, -64.0, -31.0, 53.0, 33.0, -33.0, 58.0, 47.0, 64.0, -14.0, 53.0, 59.0, -64.0, 57.0, -29.0, 43.0, -64.0, 18.0, -37.0, -29.0, -58.0, 54.0, -60.0, 48.0, 54.0, -64.0, -59.0, -58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 49.0, 53.0, 59.0, 54.0, 51.0, -56.0, 48.0, 48.0, 59.0, 59.0, 64.0, -64.0, -54.0, 43.0, 54.0, 46.0, -56.0, -58.0, -58.0, 59.0, -64.0, 58.0, 32.0, -64.0, -60.0, 64.0, 52.0, 58.0, -61.0, 48.0, -64.0, 23.0, -60.0, -64.0, -64.0, -57.0, 43.0, -64.0, -64.0, 59.0, -60.0, -52.0, 47.0, 58.0, 44.0, 42.0, 42.0, 54.0, -64.0, 58.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025087065941796, "mean_inference_ms": 9.715646220830568, "mean_action_processing_ms": 0.45504238080552495, "mean_env_wait_ms": 0.289842066491877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2699427604675293, "StateBufferConnector_ms": 0.004429817199707031, "ViewRequirementAgentConnector_ms": 0.1857752799987793}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 5.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.0, -64.0, -44.0, 43.0, 58.0, 33.0, 54.0, -23.0, 58.0, -64.0, 59.0, -64.0, 52.0, 42.0, -64.0, 38.0, 59.0, -64.0, -31.0, 53.0, 33.0, -33.0, 58.0, 47.0, 64.0, -14.0, 53.0, 59.0, -64.0, 57.0, -29.0, 43.0, -64.0, 18.0, -37.0, -29.0, -58.0, 54.0, -60.0, 48.0, 54.0, -64.0, -59.0, -58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 49.0, 53.0, 59.0, 54.0, 51.0, -56.0, 48.0, 48.0, 59.0, 59.0, 64.0, -64.0, -54.0, 43.0, 54.0, 46.0, -56.0, -58.0, -58.0, 59.0, -64.0, 58.0, 32.0, -64.0, -60.0, 64.0, 52.0, 58.0, -61.0, 48.0, -64.0, 23.0, -60.0, -64.0, -64.0, -57.0, 43.0, -64.0, -64.0, 59.0, -60.0, -52.0, 47.0, 58.0, 44.0, 42.0, 42.0, 54.0, -64.0, 58.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025087065941796, "mean_inference_ms": 9.715646220830568, "mean_action_processing_ms": 0.45504238080552495, "mean_env_wait_ms": 0.289842066491877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2699427604675293, "StateBufferConnector_ms": 0.004429817199707031, "ViewRequirementAgentConnector_ms": 0.1857752799987793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110080, "num_agent_steps_trained": 110080, "num_env_steps_sampled": 110080, "num_env_steps_trained": 110080, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.100747106125106, "num_agent_steps_trained_throughput_per_sec": 7.100747106125106, "timesteps_total": 110080, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 110080, "timers": {"training_iteration_time_ms": 72326.842, "sample_time_ms": 6108.167, "load_time_ms": 0.293, "load_throughput": 1744645.095, "learn_time_ms": 66217.881, "learn_throughput": 7.732, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 110080, "num_env_steps_trained": 110080, "num_agent_steps_sampled": 110080, "num_agent_steps_trained": 110080}, "done": false, "episodes_total": 6880, "training_iteration": 215, "trial_id": "f4e01_00169", "date": "2024-02-27_04-20-53", "timestamp": 1709004053, "time_this_iter_s": 72.11030125617981, "time_total_s": 15468.063516616821, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15468.063516616821, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 51.438235294117646, "ram_util_percent": 17.863725490196085}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 7.64, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.5596875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.5596875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.9497780700524645, "policy_loss": 0.04951963663722078, "vf_loss": 7.696370236078898, "vf_explained_var": 0.9156142974893252, "kl": 0.0, "entropy": 151.0811508178711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 7.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 7.64, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.5596875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.5596875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 18.0, -37.0, -29.0, -58.0, 54.0, -60.0, 48.0, 54.0, -64.0, -59.0, -58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 49.0, 53.0, 59.0, 54.0, 51.0, -56.0, 48.0, 48.0, 59.0, 59.0, 64.0, -64.0, -54.0, 43.0, 54.0, 46.0, -56.0, -58.0, -58.0, 59.0, -64.0, 58.0, 32.0, -64.0, -60.0, 64.0, 52.0, 58.0, -61.0, 48.0, -64.0, 23.0, -60.0, -64.0, -64.0, -57.0, 43.0, -64.0, -64.0, 59.0, -60.0, -52.0, 47.0, 58.0, 44.0, 42.0, 42.0, 54.0, -64.0, 58.0, -60.0, 43.0, -64.0, 58.0, -27.0, 59.0, 48.0, 53.0, -64.0, 32.0, -64.0, -26.0, 59.0, 11.0, 53.0, 7.0, 38.0, 53.0, 28.0, 58.0, -29.0, 53.0, 48.0, 49.0, -64.0, 53.0, 54.0, -64.0, 53.0, 53.0, 59.0, 59.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024468432599923, "mean_inference_ms": 9.715341264309385, "mean_action_processing_ms": 0.4550424084673466, "mean_env_wait_ms": 0.28983825879894987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2722127437591553, "StateBufferConnector_ms": 0.0045032501220703125, "ViewRequirementAgentConnector_ms": 0.19085693359375}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 7.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 18.0, -37.0, -29.0, -58.0, 54.0, -60.0, 48.0, 54.0, -64.0, -59.0, -58.0, 59.0, -64.0, -64.0, 53.0, 53.0, 49.0, 53.0, 59.0, 54.0, 51.0, -56.0, 48.0, 48.0, 59.0, 59.0, 64.0, -64.0, -54.0, 43.0, 54.0, 46.0, -56.0, -58.0, -58.0, 59.0, -64.0, 58.0, 32.0, -64.0, -60.0, 64.0, 52.0, 58.0, -61.0, 48.0, -64.0, 23.0, -60.0, -64.0, -64.0, -57.0, 43.0, -64.0, -64.0, 59.0, -60.0, -52.0, 47.0, 58.0, 44.0, 42.0, 42.0, 54.0, -64.0, 58.0, -60.0, 43.0, -64.0, 58.0, -27.0, 59.0, 48.0, 53.0, -64.0, 32.0, -64.0, -26.0, 59.0, 11.0, 53.0, 7.0, 38.0, 53.0, 28.0, 58.0, -29.0, 53.0, 48.0, 49.0, -64.0, 53.0, 54.0, -64.0, 53.0, 53.0, 59.0, 59.0, 43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024468432599923, "mean_inference_ms": 9.715341264309385, "mean_action_processing_ms": 0.4550424084673466, "mean_env_wait_ms": 0.28983825879894987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2722127437591553, "StateBufferConnector_ms": 0.0045032501220703125, "ViewRequirementAgentConnector_ms": 0.19085693359375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.036487017117319, "num_agent_steps_trained_throughput_per_sec": 7.036487017117319, "timesteps_total": 110592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 110592, "timers": {"training_iteration_time_ms": 72351.359, "sample_time_ms": 6110.519, "load_time_ms": 0.29, "load_throughput": 1767330.794, "learn_time_ms": 66240.043, "learn_throughput": 7.729, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "done": false, "episodes_total": 6912, "training_iteration": 216, "trial_id": "f4e01_00169", "date": "2024-02-27_04-22-06", "timestamp": 1709004126, "time_this_iter_s": 72.76906037330627, "time_total_s": 15540.832576990128, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15540.832576990128, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 52.155339805825236, "ram_util_percent": 17.8126213592233}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 10.76, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.5840625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.5840625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.708504525820414, "policy_loss": 0.1807470423557485, "vf_loss": 8.681923353672028, "vf_explained_var": 0.8981860344608624, "kl": 0.0, "entropy": 157.27405026753743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 111104, "num_env_steps_trained": 111104, "num_agent_steps_sampled": 111104, "num_agent_steps_trained": 111104}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 10.76, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.5840625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.5840625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [46.0, -56.0, -58.0, -58.0, 59.0, -64.0, 58.0, 32.0, -64.0, -60.0, 64.0, 52.0, 58.0, -61.0, 48.0, -64.0, 23.0, -60.0, -64.0, -64.0, -57.0, 43.0, -64.0, -64.0, 59.0, -60.0, -52.0, 47.0, 58.0, 44.0, 42.0, 42.0, 54.0, -64.0, 58.0, -60.0, 43.0, -64.0, 58.0, -27.0, 59.0, 48.0, 53.0, -64.0, 32.0, -64.0, -26.0, 59.0, 11.0, 53.0, 7.0, 38.0, 53.0, 28.0, 58.0, -29.0, 53.0, 48.0, 49.0, -64.0, 53.0, 54.0, -64.0, 53.0, 53.0, 59.0, 59.0, 43.0, 1.0, 43.0, 59.0, -31.0, 48.0, 28.0, -26.0, 43.0, -64.0, 64.0, 59.0, -27.0, 58.0, 3.0, 59.0, 54.0, -1.0, 25.0, -1.0, 58.0, 46.0, -64.0, 58.0, -63.0, 59.0, 48.0, 54.0, -64.0, 53.0, -12.0, -64.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024288779214908, "mean_inference_ms": 9.71520731295048, "mean_action_processing_ms": 0.45506719006273255, "mean_env_wait_ms": 0.28984767045798854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27310919761657715, "StateBufferConnector_ms": 0.004530429840087891, "ViewRequirementAgentConnector_ms": 0.1947920322418213}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 10.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, -56.0, -58.0, -58.0, 59.0, -64.0, 58.0, 32.0, -64.0, -60.0, 64.0, 52.0, 58.0, -61.0, 48.0, -64.0, 23.0, -60.0, -64.0, -64.0, -57.0, 43.0, -64.0, -64.0, 59.0, -60.0, -52.0, 47.0, 58.0, 44.0, 42.0, 42.0, 54.0, -64.0, 58.0, -60.0, 43.0, -64.0, 58.0, -27.0, 59.0, 48.0, 53.0, -64.0, 32.0, -64.0, -26.0, 59.0, 11.0, 53.0, 7.0, 38.0, 53.0, 28.0, 58.0, -29.0, 53.0, 48.0, 49.0, -64.0, 53.0, 54.0, -64.0, 53.0, 53.0, 59.0, 59.0, 43.0, 1.0, 43.0, 59.0, -31.0, 48.0, 28.0, -26.0, 43.0, -64.0, 64.0, 59.0, -27.0, 58.0, 3.0, 59.0, 54.0, -1.0, 25.0, -1.0, 58.0, 46.0, -64.0, 58.0, -63.0, 59.0, 48.0, 54.0, -64.0, 53.0, -12.0, -64.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024288779214908, "mean_inference_ms": 9.71520731295048, "mean_action_processing_ms": 0.45506719006273255, "mean_env_wait_ms": 0.28984767045798854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27310919761657715, "StateBufferConnector_ms": 0.004530429840087891, "ViewRequirementAgentConnector_ms": 0.1947920322418213}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111104, "num_agent_steps_trained": 111104, "num_env_steps_sampled": 111104, "num_env_steps_trained": 111104, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.076597996308713, "num_agent_steps_trained_throughput_per_sec": 7.076597996308713, "timesteps_total": 111104, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 111104, "timers": {"training_iteration_time_ms": 72338.286, "sample_time_ms": 6109.245, "load_time_ms": 0.297, "load_throughput": 1721291.799, "learn_time_ms": 66228.217, "learn_throughput": 7.731, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 111104, "num_env_steps_trained": 111104, "num_agent_steps_sampled": 111104, "num_agent_steps_trained": 111104}, "done": false, "episodes_total": 6944, "training_iteration": 217, "trial_id": "f4e01_00169", "date": "2024-02-27_04-23-18", "timestamp": 1709004198, "time_this_iter_s": 72.35629320144653, "time_total_s": 15613.188870191574, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15613.188870191574, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 51.83106796116504, "ram_util_percent": 17.866019417475734}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 15.69, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.622578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.622578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.934765227635702, "policy_loss": 0.07952039640707274, "vf_loss": 7.625671688715617, "vf_explained_var": 0.9698205987612406, "kl": 0.0, "entropy": 157.76732266743977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.69, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 15.69, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.622578125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.622578125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, -64.0, 58.0, -60.0, 43.0, -64.0, 58.0, -27.0, 59.0, 48.0, 53.0, -64.0, 32.0, -64.0, -26.0, 59.0, 11.0, 53.0, 7.0, 38.0, 53.0, 28.0, 58.0, -29.0, 53.0, 48.0, 49.0, -64.0, 53.0, 54.0, -64.0, 53.0, 53.0, 59.0, 59.0, 43.0, 1.0, 43.0, 59.0, -31.0, 48.0, 28.0, -26.0, 43.0, -64.0, 64.0, 59.0, -27.0, 58.0, 3.0, 59.0, 54.0, -1.0, 25.0, -1.0, 58.0, 46.0, -64.0, 58.0, -63.0, 59.0, 48.0, 54.0, -64.0, 53.0, -12.0, -64.0, 58.0, -16.0, 53.0, 33.0, 54.0, 58.0, 58.0, 58.0, -64.0, 43.0, 53.0, 53.0, 38.0, 37.0, -64.0, 53.0, 54.0, -64.0, 28.0, -64.0, 44.0, -64.0, 58.0, 21.0, 49.0, 48.0, 8.0, -63.0, 15.0, -64.0, -64.0, -27.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302493367522201, "mean_inference_ms": 9.715401313556438, "mean_action_processing_ms": 0.45512253943349007, "mean_env_wait_ms": 0.28987703305524853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27515625953674316, "StateBufferConnector_ms": 0.004575490951538086, "ViewRequirementAgentConnector_ms": 0.19810748100280762}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 15.69, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, -64.0, 58.0, -60.0, 43.0, -64.0, 58.0, -27.0, 59.0, 48.0, 53.0, -64.0, 32.0, -64.0, -26.0, 59.0, 11.0, 53.0, 7.0, 38.0, 53.0, 28.0, 58.0, -29.0, 53.0, 48.0, 49.0, -64.0, 53.0, 54.0, -64.0, 53.0, 53.0, 59.0, 59.0, 43.0, 1.0, 43.0, 59.0, -31.0, 48.0, 28.0, -26.0, 43.0, -64.0, 64.0, 59.0, -27.0, 58.0, 3.0, 59.0, 54.0, -1.0, 25.0, -1.0, 58.0, 46.0, -64.0, 58.0, -63.0, 59.0, 48.0, 54.0, -64.0, 53.0, -12.0, -64.0, 58.0, -16.0, 53.0, 33.0, 54.0, 58.0, 58.0, 58.0, -64.0, 43.0, 53.0, 53.0, 38.0, 37.0, -64.0, 53.0, 54.0, -64.0, 28.0, -64.0, 44.0, -64.0, 58.0, 21.0, 49.0, 48.0, 8.0, -63.0, 15.0, -64.0, -64.0, -27.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302493367522201, "mean_inference_ms": 9.715401313556438, "mean_action_processing_ms": 0.45512253943349007, "mean_env_wait_ms": 0.28987703305524853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27515625953674316, "StateBufferConnector_ms": 0.004575490951538086, "ViewRequirementAgentConnector_ms": 0.19810748100280762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.066852691997434, "num_agent_steps_trained_throughput_per_sec": 7.066852691997434, "timesteps_total": 111616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 111616, "timers": {"training_iteration_time_ms": 72338.48, "sample_time_ms": 6089.715, "load_time_ms": 0.299, "load_throughput": 1713326.67, "learn_time_ms": 66247.929, "learn_throughput": 7.729, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "done": false, "episodes_total": 6976, "training_iteration": 218, "trial_id": "f4e01_00169", "date": "2024-02-27_04-24-31", "timestamp": 1709004271, "time_this_iter_s": 72.45608806610107, "time_total_s": 15685.644958257675, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15685.644958257675, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 51.704854368932025, "ram_util_percent": 17.945631067961173}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.83, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.662734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.662734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.615503631035486, "policy_loss": 0.13829805937130005, "vf_loss": 7.031921255588531, "vf_explained_var": 0.9343782340486845, "kl": 0.0, "entropy": 150.94863039652506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 112128, "num_env_steps_trained": 112128, "num_agent_steps_sampled": 112128, "num_agent_steps_trained": 112128}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.83, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.83, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.662734375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.662734375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 59.0, 59.0, 43.0, 1.0, 43.0, 59.0, -31.0, 48.0, 28.0, -26.0, 43.0, -64.0, 64.0, 59.0, -27.0, 58.0, 3.0, 59.0, 54.0, -1.0, 25.0, -1.0, 58.0, 46.0, -64.0, 58.0, -63.0, 59.0, 48.0, 54.0, -64.0, 53.0, -12.0, -64.0, 58.0, -16.0, 53.0, 33.0, 54.0, 58.0, 58.0, 58.0, -64.0, 43.0, 53.0, 53.0, 38.0, 37.0, -64.0, 53.0, 54.0, -64.0, 28.0, -64.0, 44.0, -64.0, 58.0, 21.0, 49.0, 48.0, 8.0, -63.0, 15.0, -64.0, -64.0, -27.0, -64.0, 7.0, 27.0, 17.0, 58.0, 52.0, 26.0, 33.0, 42.0, 49.0, 28.0, 48.0, 39.0, 58.0, 27.0, 31.0, 58.0, -4.0, -64.0, 58.0, 54.0, 59.0, 53.0, -63.0, 38.0, 58.0, 53.0, 38.0, 38.0, 54.0, 58.0, 44.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025766627670208, "mean_inference_ms": 9.715725098216712, "mean_action_processing_ms": 0.455181947812414, "mean_env_wait_ms": 0.28990967256326305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.275648832321167, "StateBufferConnector_ms": 0.004536867141723633, "ViewRequirementAgentConnector_ms": 0.2008364200592041}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.83, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 59.0, 59.0, 43.0, 1.0, 43.0, 59.0, -31.0, 48.0, 28.0, -26.0, 43.0, -64.0, 64.0, 59.0, -27.0, 58.0, 3.0, 59.0, 54.0, -1.0, 25.0, -1.0, 58.0, 46.0, -64.0, 58.0, -63.0, 59.0, 48.0, 54.0, -64.0, 53.0, -12.0, -64.0, 58.0, -16.0, 53.0, 33.0, 54.0, 58.0, 58.0, 58.0, -64.0, 43.0, 53.0, 53.0, 38.0, 37.0, -64.0, 53.0, 54.0, -64.0, 28.0, -64.0, 44.0, -64.0, 58.0, 21.0, 49.0, 48.0, 8.0, -63.0, 15.0, -64.0, -64.0, -27.0, -64.0, 7.0, 27.0, 17.0, 58.0, 52.0, 26.0, 33.0, 42.0, 49.0, 28.0, 48.0, 39.0, 58.0, 27.0, 31.0, 58.0, -4.0, -64.0, 58.0, 54.0, 59.0, 53.0, -63.0, 38.0, 58.0, 53.0, 38.0, 38.0, 54.0, 58.0, 44.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025766627670208, "mean_inference_ms": 9.715725098216712, "mean_action_processing_ms": 0.455181947812414, "mean_env_wait_ms": 0.28990967256326305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.275648832321167, "StateBufferConnector_ms": 0.004536867141723633, "ViewRequirementAgentConnector_ms": 0.2008364200592041}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112128, "num_agent_steps_trained": 112128, "num_env_steps_sampled": 112128, "num_env_steps_trained": 112128, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.057721817751704, "num_agent_steps_trained_throughput_per_sec": 7.057721817751704, "timesteps_total": 112128, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 112128, "timers": {"training_iteration_time_ms": 72413.369, "sample_time_ms": 6083.375, "load_time_ms": 0.3, "load_throughput": 1709099.6, "learn_time_ms": 66329.144, "learn_throughput": 7.719, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 112128, "num_env_steps_trained": 112128, "num_agent_steps_sampled": 112128, "num_agent_steps_trained": 112128}, "done": false, "episodes_total": 7008, "training_iteration": 219, "trial_id": "f4e01_00169", "date": "2024-02-27_04-25-43", "timestamp": 1709004343, "time_this_iter_s": 72.55063009262085, "time_total_s": 15758.195588350296, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15758.195588350296, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 52.33009708737863, "ram_util_percent": 17.74271844660194}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.2, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.6578125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.291582902272542, "policy_loss": -0.03147749917892118, "vf_loss": 6.789820063114166, "vf_explained_var": 0.7712251241008441, "kl": 0.0, "entropy": 152.1143653869629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.2, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.6578125, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, -12.0, -64.0, 58.0, -16.0, 53.0, 33.0, 54.0, 58.0, 58.0, 58.0, -64.0, 43.0, 53.0, 53.0, 38.0, 37.0, -64.0, 53.0, 54.0, -64.0, 28.0, -64.0, 44.0, -64.0, 58.0, 21.0, 49.0, 48.0, 8.0, -63.0, 15.0, -64.0, -64.0, -27.0, -64.0, 7.0, 27.0, 17.0, 58.0, 52.0, 26.0, 33.0, 42.0, 49.0, 28.0, 48.0, 39.0, 58.0, 27.0, 31.0, 58.0, -4.0, -64.0, 58.0, 54.0, 59.0, 53.0, -63.0, 38.0, 58.0, 53.0, 38.0, 38.0, 54.0, 58.0, 44.0, -64.0, -16.0, -64.0, 52.0, 59.0, -64.0, -63.0, 59.0, 37.0, 38.0, 23.0, 37.0, 43.0, 54.0, 57.0, 17.0, 48.0, 58.0, -64.0, 58.0, 59.0, 20.0, -64.0, -64.0, 52.0, 54.0, 49.0, 58.0, -64.0, 44.0, 53.0, 58.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026928622661922, "mean_inference_ms": 9.716303918397003, "mean_action_processing_ms": 0.45524997065783623, "mean_env_wait_ms": 0.2899498532189938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27789950370788574, "StateBufferConnector_ms": 0.004599332809448242, "ViewRequirementAgentConnector_ms": 0.20357060432434082}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, -12.0, -64.0, 58.0, -16.0, 53.0, 33.0, 54.0, 58.0, 58.0, 58.0, -64.0, 43.0, 53.0, 53.0, 38.0, 37.0, -64.0, 53.0, 54.0, -64.0, 28.0, -64.0, 44.0, -64.0, 58.0, 21.0, 49.0, 48.0, 8.0, -63.0, 15.0, -64.0, -64.0, -27.0, -64.0, 7.0, 27.0, 17.0, 58.0, 52.0, 26.0, 33.0, 42.0, 49.0, 28.0, 48.0, 39.0, 58.0, 27.0, 31.0, 58.0, -4.0, -64.0, 58.0, 54.0, 59.0, 53.0, -63.0, 38.0, 58.0, 53.0, 38.0, 38.0, 54.0, 58.0, 44.0, -64.0, -16.0, -64.0, 52.0, 59.0, -64.0, -63.0, 59.0, 37.0, 38.0, 23.0, 37.0, 43.0, 54.0, 57.0, 17.0, 48.0, 58.0, -64.0, 58.0, 59.0, 20.0, -64.0, -64.0, 52.0, 54.0, 49.0, 58.0, -64.0, 44.0, 53.0, 58.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026928622661922, "mean_inference_ms": 9.716303918397003, "mean_action_processing_ms": 0.45524997065783623, "mean_env_wait_ms": 0.2899498532189938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27789950370788574, "StateBufferConnector_ms": 0.004599332809448242, "ViewRequirementAgentConnector_ms": 0.20357060432434082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.090534793667746, "num_agent_steps_trained_throughput_per_sec": 7.090534793667746, "timesteps_total": 112640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 112640, "timers": {"training_iteration_time_ms": 72349.672, "sample_time_ms": 6083.188, "load_time_ms": 0.306, "load_throughput": 1671844.023, "learn_time_ms": 66265.616, "learn_throughput": 7.726, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "done": false, "episodes_total": 7040, "training_iteration": 220, "trial_id": "f4e01_00169", "date": "2024-02-27_04-26-55", "timestamp": 1709004415, "time_this_iter_s": 72.21439814567566, "time_total_s": 15830.409986495972, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15830.409986495972, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 51.42254901960785, "ram_util_percent": 17.690196078431374}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.71, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.677421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.677421875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.1776995678742725, "policy_loss": -0.03227635893660287, "vf_loss": 6.6122090220451355, "vf_explained_var": 0.9563394223650297, "kl": 0.0, "entropy": 151.28944155375163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 113152, "num_env_steps_trained": 113152, "num_agent_steps_sampled": 113152, "num_agent_steps_trained": 113152}, "sampler_results": {"episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.71, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.71, "reward_total_min": -64, "reward_total_max": 59, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.677421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9609375, "reward_score_mean": 0.677421875, "reward_score_min": 0.0, "reward_score_max": 0.9609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -27.0, -64.0, 7.0, 27.0, 17.0, 58.0, 52.0, 26.0, 33.0, 42.0, 49.0, 28.0, 48.0, 39.0, 58.0, 27.0, 31.0, 58.0, -4.0, -64.0, 58.0, 54.0, 59.0, 53.0, -63.0, 38.0, 58.0, 53.0, 38.0, 38.0, 54.0, 58.0, 44.0, -64.0, -16.0, -64.0, 52.0, 59.0, -64.0, -63.0, 59.0, 37.0, 38.0, 23.0, 37.0, 43.0, 54.0, 57.0, 17.0, 48.0, 58.0, -64.0, 58.0, 59.0, 20.0, -64.0, -64.0, 52.0, 54.0, 49.0, 58.0, -64.0, 44.0, 53.0, 58.0, 53.0, 32.0, -64.0, 52.0, 23.0, 52.0, 53.0, 53.0, -64.0, 48.0, 59.0, 54.0, 52.0, 59.0, 54.0, 48.0, 28.0, 44.0, -64.0, 38.0, 53.0, 58.0, 39.0, 48.0, 24.0, -64.0, -64.0, -64.0, 54.0, 42.0, 15.0, 53.0, 52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3027693454075715, "mean_inference_ms": 9.716838774854345, "mean_action_processing_ms": 0.455311142831704, "mean_env_wait_ms": 0.2899818815594022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27779054641723633, "StateBufferConnector_ms": 0.0048999786376953125, "ViewRequirementAgentConnector_ms": 0.2021033763885498}}, "episode_reward_max": 59.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.71, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -27.0, -64.0, 7.0, 27.0, 17.0, 58.0, 52.0, 26.0, 33.0, 42.0, 49.0, 28.0, 48.0, 39.0, 58.0, 27.0, 31.0, 58.0, -4.0, -64.0, 58.0, 54.0, 59.0, 53.0, -63.0, 38.0, 58.0, 53.0, 38.0, 38.0, 54.0, 58.0, 44.0, -64.0, -16.0, -64.0, 52.0, 59.0, -64.0, -63.0, 59.0, 37.0, 38.0, 23.0, 37.0, 43.0, 54.0, 57.0, 17.0, 48.0, 58.0, -64.0, 58.0, 59.0, 20.0, -64.0, -64.0, 52.0, 54.0, 49.0, 58.0, -64.0, 44.0, 53.0, 58.0, 53.0, 32.0, -64.0, 52.0, 23.0, 52.0, 53.0, 53.0, -64.0, 48.0, 59.0, 54.0, 52.0, 59.0, 54.0, 48.0, 28.0, 44.0, -64.0, 38.0, 53.0, 58.0, 39.0, 48.0, 24.0, -64.0, -64.0, -64.0, 54.0, 42.0, 15.0, 53.0, 52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3027693454075715, "mean_inference_ms": 9.716838774854345, "mean_action_processing_ms": 0.455311142831704, "mean_env_wait_ms": 0.2899818815594022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27779054641723633, "StateBufferConnector_ms": 0.0048999786376953125, "ViewRequirementAgentConnector_ms": 0.2021033763885498}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113152, "num_agent_steps_trained": 113152, "num_env_steps_sampled": 113152, "num_env_steps_trained": 113152, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.130475723263024, "num_agent_steps_trained_throughput_per_sec": 7.130475723263024, "timesteps_total": 113152, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 113152, "timers": {"training_iteration_time_ms": 72311.977, "sample_time_ms": 6083.128, "load_time_ms": 0.306, "load_throughput": 1674059.595, "learn_time_ms": 66227.976, "learn_throughput": 7.731, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 113152, "num_env_steps_trained": 113152, "num_agent_steps_sampled": 113152, "num_agent_steps_trained": 113152}, "done": false, "episodes_total": 7072, "training_iteration": 221, "trial_id": "f4e01_00169", "date": "2024-02-27_04-28-07", "timestamp": 1709004487, "time_this_iter_s": 71.8096661567688, "time_total_s": 15902.21965265274, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15902.21965265274, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 50.62058823529412, "ram_util_percent": 17.478431372549018}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 23.68, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.685, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.685, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.826129202047984, "policy_loss": -0.027438652608543633, "vf_loss": 6.0524328033129375, "vf_explained_var": 0.9849002853035926, "kl": 0.0, "entropy": 154.35675392150878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 23.68, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.685, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.685, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [54.0, 58.0, 44.0, -64.0, -16.0, -64.0, 52.0, 59.0, -64.0, -63.0, 59.0, 37.0, 38.0, 23.0, 37.0, 43.0, 54.0, 57.0, 17.0, 48.0, 58.0, -64.0, 58.0, 59.0, 20.0, -64.0, -64.0, 52.0, 54.0, 49.0, 58.0, -64.0, 44.0, 53.0, 58.0, 53.0, 32.0, -64.0, 52.0, 23.0, 52.0, 53.0, 53.0, -64.0, 48.0, 59.0, 54.0, 52.0, 59.0, 54.0, 48.0, 28.0, 44.0, -64.0, 38.0, 53.0, 58.0, 39.0, 48.0, 24.0, -64.0, -64.0, -64.0, 54.0, 42.0, 15.0, 53.0, 52.0, 64.0, 54.0, 53.0, 59.0, 59.0, 58.0, 58.0, 37.0, 58.0, -62.0, 53.0, 48.0, -64.0, 52.0, 52.0, -64.0, 52.0, 53.0, 58.0, 53.0, 57.0, 35.0, 34.0, -64.0, 43.0, -64.0, -64.0, 25.0, 53.0, 16.0, 58.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3028016131436047, "mean_inference_ms": 9.717087616391453, "mean_action_processing_ms": 0.4553532447708868, "mean_env_wait_ms": 0.2900013859592946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27509307861328125, "StateBufferConnector_ms": 0.00484919548034668, "ViewRequirementAgentConnector_ms": 0.19763445854187012}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 23.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 58.0, 44.0, -64.0, -16.0, -64.0, 52.0, 59.0, -64.0, -63.0, 59.0, 37.0, 38.0, 23.0, 37.0, 43.0, 54.0, 57.0, 17.0, 48.0, 58.0, -64.0, 58.0, 59.0, 20.0, -64.0, -64.0, 52.0, 54.0, 49.0, 58.0, -64.0, 44.0, 53.0, 58.0, 53.0, 32.0, -64.0, 52.0, 23.0, 52.0, 53.0, 53.0, -64.0, 48.0, 59.0, 54.0, 52.0, 59.0, 54.0, 48.0, 28.0, 44.0, -64.0, 38.0, 53.0, 58.0, 39.0, 48.0, 24.0, -64.0, -64.0, -64.0, 54.0, 42.0, 15.0, 53.0, 52.0, 64.0, 54.0, 53.0, 59.0, 59.0, 58.0, 58.0, 37.0, 58.0, -62.0, 53.0, 48.0, -64.0, 52.0, 52.0, -64.0, 52.0, 53.0, 58.0, 53.0, 57.0, 35.0, 34.0, -64.0, 43.0, -64.0, -64.0, 25.0, 53.0, 16.0, 58.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3028016131436047, "mean_inference_ms": 9.717087616391453, "mean_action_processing_ms": 0.4553532447708868, "mean_env_wait_ms": 0.2900013859592946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.27509307861328125, "StateBufferConnector_ms": 0.00484919548034668, "ViewRequirementAgentConnector_ms": 0.19763445854187012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2784651866461285, "num_agent_steps_trained_throughput_per_sec": 7.2784651866461285, "timesteps_total": 113664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 113664, "timers": {"training_iteration_time_ms": 72096.827, "sample_time_ms": 6059.927, "load_time_ms": 0.299, "load_throughput": 1711824.351, "learn_time_ms": 66036.051, "learn_throughput": 7.753, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "done": false, "episodes_total": 7104, "training_iteration": 222, "trial_id": "f4e01_00169", "date": "2024-02-27_04-29-18", "timestamp": 1709004558, "time_this_iter_s": 70.3494234085083, "time_total_s": 15972.569076061249, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15972.569076061249, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 47.89499999999999, "ram_util_percent": 17.166999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.45, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.706640625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.706640625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9914761615296205, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.8459385673205055, "policy_loss": 0.1665794352069497, "vf_loss": 7.349424584706624, "vf_explained_var": 0.9149771978457769, "kl": 0.0, "entropy": 151.91102180480956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 114176, "num_env_steps_trained": 114176, "num_agent_steps_sampled": 114176, "num_agent_steps_trained": 114176}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.45, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.45, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.706640625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.706640625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [44.0, 53.0, 58.0, 53.0, 32.0, -64.0, 52.0, 23.0, 52.0, 53.0, 53.0, -64.0, 48.0, 59.0, 54.0, 52.0, 59.0, 54.0, 48.0, 28.0, 44.0, -64.0, 38.0, 53.0, 58.0, 39.0, 48.0, 24.0, -64.0, -64.0, -64.0, 54.0, 42.0, 15.0, 53.0, 52.0, 64.0, 54.0, 53.0, 59.0, 59.0, 58.0, 58.0, 37.0, 58.0, -62.0, 53.0, 48.0, -64.0, 52.0, 52.0, -64.0, 52.0, 53.0, 58.0, 53.0, 57.0, 35.0, 34.0, -64.0, 43.0, -64.0, -64.0, 25.0, 53.0, 16.0, 58.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, 53.0, 49.0, 48.0, 47.0, -64.0, 39.0, 58.0, 47.0, 58.0, 44.0, 58.0, 54.0, 48.0, 31.0, 40.0, 48.0, 32.0, 58.0, 64.0, 59.0, 7.0, 54.0, 34.0, 33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026582838924012, "mean_inference_ms": 9.716234047056655, "mean_action_processing_ms": 0.4553246125615385, "mean_env_wait_ms": 0.2899680542479037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2663125991821289, "StateBufferConnector_ms": 0.0046846866607666016, "ViewRequirementAgentConnector_ms": 0.18494200706481934}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.45, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 53.0, 58.0, 53.0, 32.0, -64.0, 52.0, 23.0, 52.0, 53.0, 53.0, -64.0, 48.0, 59.0, 54.0, 52.0, 59.0, 54.0, 48.0, 28.0, 44.0, -64.0, 38.0, 53.0, 58.0, 39.0, 48.0, 24.0, -64.0, -64.0, -64.0, 54.0, 42.0, 15.0, 53.0, 52.0, 64.0, 54.0, 53.0, 59.0, 59.0, 58.0, 58.0, 37.0, 58.0, -62.0, 53.0, 48.0, -64.0, 52.0, 52.0, -64.0, 52.0, 53.0, 58.0, 53.0, 57.0, 35.0, 34.0, -64.0, 43.0, -64.0, -64.0, 25.0, 53.0, 16.0, 58.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, 53.0, 49.0, 48.0, 47.0, -64.0, 39.0, 58.0, 47.0, 58.0, 44.0, 58.0, 54.0, 48.0, 31.0, 40.0, 48.0, 32.0, 58.0, 64.0, 59.0, 7.0, 54.0, 34.0, 33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026582838924012, "mean_inference_ms": 9.716234047056655, "mean_action_processing_ms": 0.4553246125615385, "mean_env_wait_ms": 0.2899680542479037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2663125991821289, "StateBufferConnector_ms": 0.0046846866607666016, "ViewRequirementAgentConnector_ms": 0.18494200706481934}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114176, "num_agent_steps_trained": 114176, "num_env_steps_sampled": 114176, "num_env_steps_trained": 114176, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.308628571674001, "num_agent_steps_trained_throughput_per_sec": 7.308628571674001, "timesteps_total": 114176, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 114176, "timers": {"training_iteration_time_ms": 71889.568, "sample_time_ms": 6029.782, "load_time_ms": 0.3, "load_throughput": 1707876.291, "learn_time_ms": 65858.952, "learn_throughput": 7.774, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 114176, "num_env_steps_trained": 114176, "num_agent_steps_sampled": 114176, "num_agent_steps_trained": 114176}, "done": false, "episodes_total": 7136, "training_iteration": 223, "trial_id": "f4e01_00169", "date": "2024-02-27_04-30-28", "timestamp": 1709004628, "time_this_iter_s": 70.05940651893616, "time_total_s": 16042.628482580185, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16042.628482580185, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 48.01717171717171, "ram_util_percent": 17.02323232323232}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.85, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.678515625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.678515625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.154405128955841, "policy_loss": 0.07280337226887544, "vf_loss": 7.981188893318176, "vf_explained_var": 0.9542463858922322, "kl": 0.0, "entropy": 154.588019434611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.85, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.85, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.678515625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.678515625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [42.0, 15.0, 53.0, 52.0, 64.0, 54.0, 53.0, 59.0, 59.0, 58.0, 58.0, 37.0, 58.0, -62.0, 53.0, 48.0, -64.0, 52.0, 52.0, -64.0, 52.0, 53.0, 58.0, 53.0, 57.0, 35.0, 34.0, -64.0, 43.0, -64.0, -64.0, 25.0, 53.0, 16.0, 58.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, 53.0, 49.0, 48.0, 47.0, -64.0, 39.0, 58.0, 47.0, 58.0, 44.0, 58.0, 54.0, 48.0, 31.0, 40.0, 48.0, 32.0, 58.0, 64.0, 59.0, 7.0, 54.0, 34.0, 33.0, 42.0, 53.0, 53.0, 23.0, 27.0, 29.0, 43.0, -64.0, 38.0, 39.0, 49.0, 49.0, 38.0, 59.0, 44.0, -63.0, 15.0, 48.0, 28.0, 29.0, 43.0, 59.0, 43.0, 53.0, -64.0, -64.0, -64.0, -64.0, 53.0, 43.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025147395612038, "mean_inference_ms": 9.71506970204719, "mean_action_processing_ms": 0.4552847771773908, "mean_env_wait_ms": 0.2899288391325757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26409220695495605, "StateBufferConnector_ms": 0.0046405792236328125, "ViewRequirementAgentConnector_ms": 0.1846446990966797}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.85, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, 15.0, 53.0, 52.0, 64.0, 54.0, 53.0, 59.0, 59.0, 58.0, 58.0, 37.0, 58.0, -62.0, 53.0, 48.0, -64.0, 52.0, 52.0, -64.0, 52.0, 53.0, 58.0, 53.0, 57.0, 35.0, 34.0, -64.0, 43.0, -64.0, -64.0, 25.0, 53.0, 16.0, 58.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, 53.0, 49.0, 48.0, 47.0, -64.0, 39.0, 58.0, 47.0, 58.0, 44.0, 58.0, 54.0, 48.0, 31.0, 40.0, 48.0, 32.0, 58.0, 64.0, 59.0, 7.0, 54.0, 34.0, 33.0, 42.0, 53.0, 53.0, 23.0, 27.0, 29.0, 43.0, -64.0, 38.0, 39.0, 49.0, 49.0, 38.0, 59.0, 44.0, -63.0, 15.0, 48.0, 28.0, 29.0, 43.0, 59.0, 43.0, 53.0, -64.0, -64.0, -64.0, -64.0, 53.0, 43.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3025147395612038, "mean_inference_ms": 9.71506970204719, "mean_action_processing_ms": 0.4552847771773908, "mean_env_wait_ms": 0.2899288391325757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26409220695495605, "StateBufferConnector_ms": 0.0046405792236328125, "ViewRequirementAgentConnector_ms": 0.1846446990966797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2304717855297325, "num_agent_steps_trained_throughput_per_sec": 7.2304717855297325, "timesteps_total": 114688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 71743.858, "sample_time_ms": 6019.645, "load_time_ms": 0.296, "load_throughput": 1730864.551, "learn_time_ms": 65723.397, "learn_throughput": 7.79, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "episodes_total": 7168, "training_iteration": 224, "trial_id": "f4e01_00169", "date": "2024-02-27_04-31-39", "timestamp": 1709004699, "time_this_iter_s": 70.81652522087097, "time_total_s": 16113.445007801056, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16113.445007801056, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 49.22178217821783, "ram_util_percent": 16.933663366336635}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 22.74, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.685420874754588, "policy_loss": -0.008223174574474494, "vf_loss": 7.371860627333323, "vf_explained_var": 0.896152279774348, "kl": 0.0, "entropy": 154.83061345418295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 115200, "num_env_steps_trained": 115200, "num_agent_steps_sampled": 115200, "num_agent_steps_trained": 115200}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 22.74, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67765625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67765625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 16.0, 58.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, 53.0, 49.0, 48.0, 47.0, -64.0, 39.0, 58.0, 47.0, 58.0, 44.0, 58.0, 54.0, 48.0, 31.0, 40.0, 48.0, 32.0, 58.0, 64.0, 59.0, 7.0, 54.0, 34.0, 33.0, 42.0, 53.0, 53.0, 23.0, 27.0, 29.0, 43.0, -64.0, 38.0, 39.0, 49.0, 49.0, 38.0, 59.0, 44.0, -63.0, 15.0, 48.0, 28.0, 29.0, 43.0, 59.0, 43.0, 53.0, -64.0, -64.0, -64.0, -64.0, 53.0, 43.0, -64.0, -64.0, 58.0, 48.0, 43.0, 43.0, 48.0, 48.0, 54.0, -64.0, 53.0, -64.0, 49.0, 58.0, 30.0, -64.0, 53.0, -64.0, 51.0, 48.0, 59.0, 37.0, 38.0, 47.0, 58.0, 14.0, 34.0, 37.0, 6.0, 35.0, -64.0, 54.0, 47.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3023502291490496, "mean_inference_ms": 9.713791173872773, "mean_action_processing_ms": 0.45524706944442095, "mean_env_wait_ms": 0.28988565599596144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26349568367004395, "StateBufferConnector_ms": 0.0042896270751953125, "ViewRequirementAgentConnector_ms": 0.18245959281921387}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 22.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 16.0, 58.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, -64.0, 53.0, -64.0, 53.0, 49.0, 48.0, 47.0, -64.0, 39.0, 58.0, 47.0, 58.0, 44.0, 58.0, 54.0, 48.0, 31.0, 40.0, 48.0, 32.0, 58.0, 64.0, 59.0, 7.0, 54.0, 34.0, 33.0, 42.0, 53.0, 53.0, 23.0, 27.0, 29.0, 43.0, -64.0, 38.0, 39.0, 49.0, 49.0, 38.0, 59.0, 44.0, -63.0, 15.0, 48.0, 28.0, 29.0, 43.0, 59.0, 43.0, 53.0, -64.0, -64.0, -64.0, -64.0, 53.0, 43.0, -64.0, -64.0, 58.0, 48.0, 43.0, 43.0, 48.0, 48.0, 54.0, -64.0, 53.0, -64.0, 49.0, 58.0, 30.0, -64.0, 53.0, -64.0, 51.0, 48.0, 59.0, 37.0, 38.0, 47.0, 58.0, 14.0, 34.0, 37.0, 6.0, 35.0, -64.0, 54.0, 47.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3023502291490496, "mean_inference_ms": 9.713791173872773, "mean_action_processing_ms": 0.45524706944442095, "mean_env_wait_ms": 0.28988565599596144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26349568367004395, "StateBufferConnector_ms": 0.0042896270751953125, "ViewRequirementAgentConnector_ms": 0.18245959281921387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115200, "num_agent_steps_trained": 115200, "num_env_steps_sampled": 115200, "num_env_steps_trained": 115200, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.359283198507897, "num_agent_steps_trained_throughput_per_sec": 7.359283198507897, "timesteps_total": 115200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 115200, "timers": {"training_iteration_time_ms": 71490.548, "sample_time_ms": 6026.478, "load_time_ms": 0.291, "load_throughput": 1759655.562, "learn_time_ms": 65463.268, "learn_throughput": 7.821, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 115200, "num_env_steps_trained": 115200, "num_agent_steps_sampled": 115200, "num_agent_steps_trained": 115200}, "done": false, "episodes_total": 7200, "training_iteration": 225, "trial_id": "f4e01_00169", "date": "2024-02-27_04-32-48", "timestamp": 1709004768, "time_this_iter_s": 69.57706594467163, "time_total_s": 16183.022073745728, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16183.022073745728, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 45.29795918367348, "ram_util_percent": 16.73877551020408}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 21.86, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67078125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67078125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.379689806699753, "policy_loss": -0.05093446479489406, "vf_loss": 6.958760420481364, "vf_explained_var": 0.810042808453242, "kl": 0.0, "entropy": 153.82641843159993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 21.86, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.67078125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.67078125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [7.0, 54.0, 34.0, 33.0, 42.0, 53.0, 53.0, 23.0, 27.0, 29.0, 43.0, -64.0, 38.0, 39.0, 49.0, 49.0, 38.0, 59.0, 44.0, -63.0, 15.0, 48.0, 28.0, 29.0, 43.0, 59.0, 43.0, 53.0, -64.0, -64.0, -64.0, -64.0, 53.0, 43.0, -64.0, -64.0, 58.0, 48.0, 43.0, 43.0, 48.0, 48.0, 54.0, -64.0, 53.0, -64.0, 49.0, 58.0, 30.0, -64.0, 53.0, -64.0, 51.0, 48.0, 59.0, 37.0, 38.0, 47.0, 58.0, 14.0, 34.0, 37.0, 6.0, 35.0, -64.0, 54.0, 47.0, 54.0, 58.0, 28.0, 34.0, -64.0, 38.0, 54.0, 46.0, -64.0, 44.0, -64.0, 53.0, -64.0, 58.0, 53.0, 47.0, 33.0, 58.0, 14.0, 27.0, -64.0, 59.0, 48.0, 43.0, 49.0, 54.0, 44.0, 22.0, 64.0, 52.0, -64.0, 53.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022471666668323, "mean_inference_ms": 9.712903453400488, "mean_action_processing_ms": 0.455239945797222, "mean_env_wait_ms": 0.2898676179547101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2680833339691162, "StateBufferConnector_ms": 0.004365682601928711, "ViewRequirementAgentConnector_ms": 0.18942809104919434}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 21.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.0, 54.0, 34.0, 33.0, 42.0, 53.0, 53.0, 23.0, 27.0, 29.0, 43.0, -64.0, 38.0, 39.0, 49.0, 49.0, 38.0, 59.0, 44.0, -63.0, 15.0, 48.0, 28.0, 29.0, 43.0, 59.0, 43.0, 53.0, -64.0, -64.0, -64.0, -64.0, 53.0, 43.0, -64.0, -64.0, 58.0, 48.0, 43.0, 43.0, 48.0, 48.0, 54.0, -64.0, 53.0, -64.0, 49.0, 58.0, 30.0, -64.0, 53.0, -64.0, 51.0, 48.0, 59.0, 37.0, 38.0, 47.0, 58.0, 14.0, 34.0, 37.0, 6.0, 35.0, -64.0, 54.0, 47.0, 54.0, 58.0, 28.0, 34.0, -64.0, 38.0, 54.0, 46.0, -64.0, 44.0, -64.0, 53.0, -64.0, 58.0, 53.0, 47.0, 33.0, 58.0, 14.0, 27.0, -64.0, 59.0, 48.0, 43.0, 49.0, 54.0, 44.0, 22.0, 64.0, 52.0, -64.0, 53.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022471666668323, "mean_inference_ms": 9.712903453400488, "mean_action_processing_ms": 0.455239945797222, "mean_env_wait_ms": 0.2898676179547101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2680833339691162, "StateBufferConnector_ms": 0.004365682601928711, "ViewRequirementAgentConnector_ms": 0.18942809104919434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.340501716841062, "num_agent_steps_trained_throughput_per_sec": 7.340501716841062, "timesteps_total": 115712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 115712, "timers": {"training_iteration_time_ms": 71189.189, "sample_time_ms": 6009.454, "load_time_ms": 0.291, "load_throughput": 1759511.387, "learn_time_ms": 65178.93, "learn_throughput": 7.855, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "done": false, "episodes_total": 7232, "training_iteration": 226, "trial_id": "f4e01_00169", "date": "2024-02-27_04-33-58", "timestamp": 1709004838, "time_this_iter_s": 69.75603604316711, "time_total_s": 16252.778109788895, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16252.778109788895, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 44.83131313131313, "ram_util_percent": 16.643434343434347}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 24.14, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.68859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.68859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 5.196820155779521, "policy_loss": 0.14682351310426991, "vf_loss": 7.9315497279167175, "vf_explained_var": 0.9753468856215477, "kl": 0.0, "entropy": 152.5858959197998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 116224, "num_env_steps_trained": 116224, "num_agent_steps_sampled": 116224, "num_agent_steps_trained": 116224}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 24.14, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.68859375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.68859375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [53.0, 43.0, -64.0, -64.0, 58.0, 48.0, 43.0, 43.0, 48.0, 48.0, 54.0, -64.0, 53.0, -64.0, 49.0, 58.0, 30.0, -64.0, 53.0, -64.0, 51.0, 48.0, 59.0, 37.0, 38.0, 47.0, 58.0, 14.0, 34.0, 37.0, 6.0, 35.0, -64.0, 54.0, 47.0, 54.0, 58.0, 28.0, 34.0, -64.0, 38.0, 54.0, 46.0, -64.0, 44.0, -64.0, 53.0, -64.0, 58.0, 53.0, 47.0, 33.0, 58.0, 14.0, 27.0, -64.0, 59.0, 48.0, 43.0, 49.0, 54.0, 44.0, 22.0, 64.0, 52.0, -64.0, 53.0, -64.0, 38.0, 48.0, 9.0, 43.0, 48.0, 21.0, -64.0, 38.0, 18.0, 58.0, 49.0, 34.0, 48.0, 53.0, 47.0, 38.0, 42.0, 34.0, 52.0, 39.0, 20.0, -64.0, 58.0, -64.0, 54.0, 28.0, 47.0, 49.0, -64.0, 38.0, 48.0, 34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022190935223872, "mean_inference_ms": 9.712588972232524, "mean_action_processing_ms": 0.45527138823964103, "mean_env_wait_ms": 0.2898771060149268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2735576629638672, "StateBufferConnector_ms": 0.0046236515045166016, "ViewRequirementAgentConnector_ms": 0.19676780700683594}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.0, 43.0, -64.0, -64.0, 58.0, 48.0, 43.0, 43.0, 48.0, 48.0, 54.0, -64.0, 53.0, -64.0, 49.0, 58.0, 30.0, -64.0, 53.0, -64.0, 51.0, 48.0, 59.0, 37.0, 38.0, 47.0, 58.0, 14.0, 34.0, 37.0, 6.0, 35.0, -64.0, 54.0, 47.0, 54.0, 58.0, 28.0, 34.0, -64.0, 38.0, 54.0, 46.0, -64.0, 44.0, -64.0, 53.0, -64.0, 58.0, 53.0, 47.0, 33.0, 58.0, 14.0, 27.0, -64.0, 59.0, 48.0, 43.0, 49.0, 54.0, 44.0, 22.0, 64.0, 52.0, -64.0, 53.0, -64.0, 38.0, 48.0, 9.0, 43.0, 48.0, 21.0, -64.0, 38.0, 18.0, 58.0, 49.0, 34.0, 48.0, 53.0, 47.0, 38.0, 42.0, 34.0, 52.0, 39.0, 20.0, -64.0, 58.0, -64.0, 54.0, 28.0, 47.0, 49.0, -64.0, 38.0, 48.0, 34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022190935223872, "mean_inference_ms": 9.712588972232524, "mean_action_processing_ms": 0.45527138823964103, "mean_env_wait_ms": 0.2898771060149268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2735576629638672, "StateBufferConnector_ms": 0.0046236515045166016, "ViewRequirementAgentConnector_ms": 0.19676780700683594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116224, "num_agent_steps_trained": 116224, "num_env_steps_sampled": 116224, "num_env_steps_trained": 116224, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.37633729848745, "num_agent_steps_trained_throughput_per_sec": 7.37633729848745, "timesteps_total": 116224, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 116224, "timers": {"training_iteration_time_ms": 70895.189, "sample_time_ms": 6013.639, "load_time_ms": 0.281, "load_throughput": 1822063.166, "learn_time_ms": 64880.778, "learn_throughput": 7.891, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 116224, "num_env_steps_trained": 116224, "num_agent_steps_sampled": 116224, "num_agent_steps_trained": 116224}, "done": false, "episodes_total": 7264, "training_iteration": 227, "trial_id": "f4e01_00169", "date": "2024-02-27_04-35-08", "timestamp": 1709004908, "time_this_iter_s": 69.41621828079224, "time_total_s": 16322.194328069687, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16322.194328069687, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 46.52525252525252, "ram_util_percent": 16.677777777777774}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.77, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.709140625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.709140625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.5615399072567624, "policy_loss": -0.01748841560911387, "vf_loss": 5.6212396085262295, "vf_explained_var": 0.8720717966556549, "kl": 0.0, "entropy": 153.4619265238444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.77, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.77, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.709140625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.709140625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 54.0, 47.0, 54.0, 58.0, 28.0, 34.0, -64.0, 38.0, 54.0, 46.0, -64.0, 44.0, -64.0, 53.0, -64.0, 58.0, 53.0, 47.0, 33.0, 58.0, 14.0, 27.0, -64.0, 59.0, 48.0, 43.0, 49.0, 54.0, 44.0, 22.0, 64.0, 52.0, -64.0, 53.0, -64.0, 38.0, 48.0, 9.0, 43.0, 48.0, 21.0, -64.0, 38.0, 18.0, 58.0, 49.0, 34.0, 48.0, 53.0, 47.0, 38.0, 42.0, 34.0, 52.0, 39.0, 20.0, -64.0, 58.0, -64.0, 54.0, 28.0, 47.0, 49.0, -64.0, 38.0, 48.0, 34.0, 52.0, 58.0, 59.0, 23.0, 53.0, 58.0, 64.0, 59.0, 38.0, 48.0, -64.0, 54.0, 44.0, 53.0, 29.0, 37.0, 58.0, 64.0, -64.0, -64.0, 48.0, 38.0, 43.0, 47.0, 54.0, 58.0, -64.0, -64.0, 57.0, 58.0, 37.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30248184463819, "mean_inference_ms": 9.711930172687703, "mean_action_processing_ms": 0.45528148694436044, "mean_env_wait_ms": 0.2898755175142957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2708303928375244, "StateBufferConnector_ms": 0.00460505485534668, "ViewRequirementAgentConnector_ms": 0.1948847770690918}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.77, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 54.0, 47.0, 54.0, 58.0, 28.0, 34.0, -64.0, 38.0, 54.0, 46.0, -64.0, 44.0, -64.0, 53.0, -64.0, 58.0, 53.0, 47.0, 33.0, 58.0, 14.0, 27.0, -64.0, 59.0, 48.0, 43.0, 49.0, 54.0, 44.0, 22.0, 64.0, 52.0, -64.0, 53.0, -64.0, 38.0, 48.0, 9.0, 43.0, 48.0, 21.0, -64.0, 38.0, 18.0, 58.0, 49.0, 34.0, 48.0, 53.0, 47.0, 38.0, 42.0, 34.0, 52.0, 39.0, 20.0, -64.0, 58.0, -64.0, 54.0, 28.0, 47.0, 49.0, -64.0, 38.0, 48.0, 34.0, 52.0, 58.0, 59.0, 23.0, 53.0, 58.0, 64.0, 59.0, 38.0, 48.0, -64.0, 54.0, 44.0, 53.0, 29.0, 37.0, 58.0, 64.0, -64.0, -64.0, 48.0, 38.0, 43.0, 47.0, 54.0, 58.0, -64.0, -64.0, 57.0, 58.0, 37.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30248184463819, "mean_inference_ms": 9.711930172687703, "mean_action_processing_ms": 0.45528148694436044, "mean_env_wait_ms": 0.2898755175142957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2708303928375244, "StateBufferConnector_ms": 0.00460505485534668, "ViewRequirementAgentConnector_ms": 0.1948847770690918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.342719496285949, "num_agent_steps_trained_throughput_per_sec": 7.342719496285949, "timesteps_total": 116736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 116736, "timers": {"training_iteration_time_ms": 70622.99, "sample_time_ms": 5998.842, "load_time_ms": 0.274, "load_throughput": 1866890.07, "learn_time_ms": 64623.394, "learn_throughput": 7.923, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "done": false, "episodes_total": 7296, "training_iteration": 228, "trial_id": "f4e01_00169", "date": "2024-02-27_04-36-20", "timestamp": 1709004980, "time_this_iter_s": 69.73392868041992, "time_total_s": 16391.928256750107, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16391.928256750107, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 45.07843137254901, "ram_util_percent": 16.840196078431372}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 26.02, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.70328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.70328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.334014560778936, "policy_loss": 0.18833229650432864, "vf_loss": 6.511229145526886, "vf_explained_var": 0.9958595449725787, "kl": 0.0, "entropy": 154.4168721516927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 117248, "num_env_steps_trained": 117248, "num_agent_steps_sampled": 117248, "num_agent_steps_trained": 117248}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 26.02, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.70328125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.70328125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [52.0, -64.0, 53.0, -64.0, 38.0, 48.0, 9.0, 43.0, 48.0, 21.0, -64.0, 38.0, 18.0, 58.0, 49.0, 34.0, 48.0, 53.0, 47.0, 38.0, 42.0, 34.0, 52.0, 39.0, 20.0, -64.0, 58.0, -64.0, 54.0, 28.0, 47.0, 49.0, -64.0, 38.0, 48.0, 34.0, 52.0, 58.0, 59.0, 23.0, 53.0, 58.0, 64.0, 59.0, 38.0, 48.0, -64.0, 54.0, 44.0, 53.0, 29.0, 37.0, 58.0, 64.0, -64.0, -64.0, 48.0, 38.0, 43.0, 47.0, 54.0, 58.0, -64.0, -64.0, 57.0, 58.0, 37.0, 53.0, 37.0, -64.0, 23.0, 58.0, 43.0, 40.0, 28.0, 26.0, -64.0, -64.0, 59.0, 38.0, 59.0, 54.0, 59.0, 64.0, 58.0, 43.0, 58.0, 39.0, 37.0, 59.0, 17.0, -64.0, 59.0, 48.0, 58.0, 49.0, -64.0, -64.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3027434632028383, "mean_inference_ms": 9.711234195347428, "mean_action_processing_ms": 0.45528410338092756, "mean_env_wait_ms": 0.28987534164182943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2708871364593506, "StateBufferConnector_ms": 0.00457763671875, "ViewRequirementAgentConnector_ms": 0.19568467140197754}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 26.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.0, -64.0, 53.0, -64.0, 38.0, 48.0, 9.0, 43.0, 48.0, 21.0, -64.0, 38.0, 18.0, 58.0, 49.0, 34.0, 48.0, 53.0, 47.0, 38.0, 42.0, 34.0, 52.0, 39.0, 20.0, -64.0, 58.0, -64.0, 54.0, 28.0, 47.0, 49.0, -64.0, 38.0, 48.0, 34.0, 52.0, 58.0, 59.0, 23.0, 53.0, 58.0, 64.0, 59.0, 38.0, 48.0, -64.0, 54.0, 44.0, 53.0, 29.0, 37.0, 58.0, 64.0, -64.0, -64.0, 48.0, 38.0, 43.0, 47.0, 54.0, 58.0, -64.0, -64.0, 57.0, 58.0, 37.0, 53.0, 37.0, -64.0, 23.0, 58.0, 43.0, 40.0, 28.0, 26.0, -64.0, -64.0, 59.0, 38.0, 59.0, 54.0, 59.0, 64.0, 58.0, 43.0, 58.0, 39.0, 37.0, 59.0, 17.0, -64.0, 59.0, 48.0, 58.0, 49.0, -64.0, -64.0, 59.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3027434632028383, "mean_inference_ms": 9.711234195347428, "mean_action_processing_ms": 0.45528410338092756, "mean_env_wait_ms": 0.28987534164182943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2708871364593506, "StateBufferConnector_ms": 0.00457763671875, "ViewRequirementAgentConnector_ms": 0.19568467140197754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117248, "num_agent_steps_trained": 117248, "num_env_steps_sampled": 117248, "num_env_steps_trained": 117248, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.345354074860301, "num_agent_steps_trained_throughput_per_sec": 7.345354074860301, "timesteps_total": 117248, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 117248, "timers": {"training_iteration_time_ms": 70338.917, "sample_time_ms": 5977.316, "load_time_ms": 0.272, "load_throughput": 1882106.615, "learn_time_ms": 64360.864, "learn_throughput": 7.955, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 117248, "num_env_steps_trained": 117248, "num_agent_steps_sampled": 117248, "num_agent_steps_trained": 117248}, "done": false, "episodes_total": 7328, "training_iteration": 229, "trial_id": "f4e01_00169", "date": "2024-02-27_04-37-29", "timestamp": 1709005049, "time_this_iter_s": 69.70894527435303, "time_total_s": 16461.63720202446, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16461.63720202446, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 44.586868686868684, "ram_util_percent": 16.67979797979797}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 25.32, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6978125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6978125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 3.9956394294897715, "policy_loss": 0.004579079857406517, "vf_loss": 6.2683791240056355, "vf_explained_var": 0.9595462992787361, "kl": 0.0, "entropy": 157.08407287597657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 25.32, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6978125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6978125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 38.0, 48.0, 34.0, 52.0, 58.0, 59.0, 23.0, 53.0, 58.0, 64.0, 59.0, 38.0, 48.0, -64.0, 54.0, 44.0, 53.0, 29.0, 37.0, 58.0, 64.0, -64.0, -64.0, 48.0, 38.0, 43.0, 47.0, 54.0, 58.0, -64.0, -64.0, 57.0, 58.0, 37.0, 53.0, 37.0, -64.0, 23.0, 58.0, 43.0, 40.0, 28.0, 26.0, -64.0, -64.0, 59.0, 38.0, 59.0, 54.0, 59.0, 64.0, 58.0, 43.0, 58.0, 39.0, 37.0, 59.0, 17.0, -64.0, 59.0, 48.0, 58.0, 49.0, -64.0, -64.0, 59.0, -64.0, -64.0, 58.0, 17.0, 52.0, 58.0, 53.0, 47.0, 37.0, -64.0, -64.0, 58.0, 23.0, 53.0, 58.0, 54.0, 59.0, -64.0, -64.0, 0.0, 53.0, 34.0, 2.0, 58.0, 54.0, 64.0, -64.0, 48.0, 59.0, 49.0, 64.0, 64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3028228598372604, "mean_inference_ms": 9.709426522976164, "mean_action_processing_ms": 0.4552038348521904, "mean_env_wait_ms": 0.28981948859434753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26098155975341797, "StateBufferConnector_ms": 0.004255533218383789, "ViewRequirementAgentConnector_ms": 0.18201899528503418}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 25.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 38.0, 48.0, 34.0, 52.0, 58.0, 59.0, 23.0, 53.0, 58.0, 64.0, 59.0, 38.0, 48.0, -64.0, 54.0, 44.0, 53.0, 29.0, 37.0, 58.0, 64.0, -64.0, -64.0, 48.0, 38.0, 43.0, 47.0, 54.0, 58.0, -64.0, -64.0, 57.0, 58.0, 37.0, 53.0, 37.0, -64.0, 23.0, 58.0, 43.0, 40.0, 28.0, 26.0, -64.0, -64.0, 59.0, 38.0, 59.0, 54.0, 59.0, 64.0, 58.0, 43.0, 58.0, 39.0, 37.0, 59.0, 17.0, -64.0, 59.0, 48.0, 58.0, 49.0, -64.0, -64.0, 59.0, -64.0, -64.0, 58.0, 17.0, 52.0, 58.0, 53.0, 47.0, 37.0, -64.0, -64.0, 58.0, 23.0, 53.0, 58.0, 54.0, 59.0, -64.0, -64.0, 0.0, 53.0, 34.0, 2.0, 58.0, 54.0, 64.0, -64.0, 48.0, 59.0, 49.0, 64.0, 64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3028228598372604, "mean_inference_ms": 9.709426522976164, "mean_action_processing_ms": 0.4552038348521904, "mean_env_wait_ms": 0.28981948859434753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26098155975341797, "StateBufferConnector_ms": 0.004255533218383789, "ViewRequirementAgentConnector_ms": 0.18201899528503418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.361157403917234, "num_agent_steps_trained_throughput_per_sec": 7.361157403917234, "timesteps_total": 117760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 117760, "timers": {"training_iteration_time_ms": 70073.45, "sample_time_ms": 5914.952, "load_time_ms": 0.272, "load_throughput": 1879306.597, "learn_time_ms": 64157.755, "learn_throughput": 7.98, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "done": false, "episodes_total": 7360, "training_iteration": 230, "trial_id": "f4e01_00169", "date": "2024-02-27_04-38-39", "timestamp": 1709005119, "time_this_iter_s": 69.55972290039062, "time_total_s": 16531.19692492485, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16531.19692492485, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 45.379591836734704, "ram_util_percent": 16.7}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 24.6, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6921875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6921875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.021629997094473, "policy_loss": -0.01320370677858591, "vf_loss": 6.337129811445872, "vf_explained_var": 0.96914142370224, "kl": 0.0, "entropy": 156.10316797892253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 118272, "num_env_steps_trained": 118272, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 118272}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 24.6, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.6921875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.6921875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [57.0, 58.0, 37.0, 53.0, 37.0, -64.0, 23.0, 58.0, 43.0, 40.0, 28.0, 26.0, -64.0, -64.0, 59.0, 38.0, 59.0, 54.0, 59.0, 64.0, 58.0, 43.0, 58.0, 39.0, 37.0, 59.0, 17.0, -64.0, 59.0, 48.0, 58.0, 49.0, -64.0, -64.0, 59.0, -64.0, -64.0, 58.0, 17.0, 52.0, 58.0, 53.0, 47.0, 37.0, -64.0, -64.0, 58.0, 23.0, 53.0, 58.0, 54.0, 59.0, -64.0, -64.0, 0.0, 53.0, 34.0, 2.0, 58.0, 54.0, 64.0, -64.0, 48.0, 59.0, 49.0, 64.0, 64.0, -64.0, -64.0, 39.0, 53.0, 59.0, 58.0, -64.0, 59.0, 49.0, 64.0, 59.0, -63.0, -64.0, 42.0, 38.0, 58.0, 59.0, 59.0, 43.0, -3.0, -64.0, 16.0, 59.0, 53.0, 32.0, 53.0, 48.0, 1.0, -64.0, 37.0, 48.0, 54.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026130118203658, "mean_inference_ms": 9.707764024699722, "mean_action_processing_ms": 0.4551255320133701, "mean_env_wait_ms": 0.28977282167330376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26110267639160156, "StateBufferConnector_ms": 0.0044708251953125, "ViewRequirementAgentConnector_ms": 0.18547940254211426}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 24.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.0, 58.0, 37.0, 53.0, 37.0, -64.0, 23.0, 58.0, 43.0, 40.0, 28.0, 26.0, -64.0, -64.0, 59.0, 38.0, 59.0, 54.0, 59.0, 64.0, 58.0, 43.0, 58.0, 39.0, 37.0, 59.0, 17.0, -64.0, 59.0, 48.0, 58.0, 49.0, -64.0, -64.0, 59.0, -64.0, -64.0, 58.0, 17.0, 52.0, 58.0, 53.0, 47.0, 37.0, -64.0, -64.0, 58.0, 23.0, 53.0, 58.0, 54.0, 59.0, -64.0, -64.0, 0.0, 53.0, 34.0, 2.0, 58.0, 54.0, 64.0, -64.0, 48.0, 59.0, 49.0, 64.0, 64.0, -64.0, -64.0, 39.0, 53.0, 59.0, 58.0, -64.0, 59.0, 49.0, 64.0, 59.0, -63.0, -64.0, 42.0, 38.0, 58.0, 59.0, 59.0, 43.0, -3.0, -64.0, 16.0, 59.0, 53.0, 32.0, 53.0, 48.0, 1.0, -64.0, 37.0, 48.0, 54.0, 49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3026130118203658, "mean_inference_ms": 9.707764024699722, "mean_action_processing_ms": 0.4551255320133701, "mean_env_wait_ms": 0.28977282167330376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26110267639160156, "StateBufferConnector_ms": 0.0044708251953125, "ViewRequirementAgentConnector_ms": 0.18547940254211426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 118272, "num_env_steps_sampled": 118272, "num_env_steps_trained": 118272, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.365507705122282, "num_agent_steps_trained_throughput_per_sec": 7.365507705122282, "timesteps_total": 118272, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 69844.324, "sample_time_ms": 5900.796, "load_time_ms": 0.272, "load_throughput": 1879471.073, "learn_time_ms": 63942.795, "learn_throughput": 8.007, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 118272, "num_env_steps_trained": 118272, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 118272}, "done": false, "episodes_total": 7392, "training_iteration": 231, "trial_id": "f4e01_00169", "date": "2024-02-27_04-39-49", "timestamp": 1709005189, "time_this_iter_s": 69.51804280281067, "time_total_s": 16600.71496772766, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16600.71496772766, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 43.68080808080807, "ram_util_percent": 16.488888888888894}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 19.97, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.656015625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.656015625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.157040828466416, "policy_loss": 0.08658649395996083, "vf_loss": 6.393075772126516, "vf_explained_var": 0.7587932830055555, "kl": 0.0, "entropy": 156.31860682169597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.97, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 19.97, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.656015625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.656015625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 59.0, -64.0, -64.0, 58.0, 17.0, 52.0, 58.0, 53.0, 47.0, 37.0, -64.0, -64.0, 58.0, 23.0, 53.0, 58.0, 54.0, 59.0, -64.0, -64.0, 0.0, 53.0, 34.0, 2.0, 58.0, 54.0, 64.0, -64.0, 48.0, 59.0, 49.0, 64.0, 64.0, -64.0, -64.0, 39.0, 53.0, 59.0, 58.0, -64.0, 59.0, 49.0, 64.0, 59.0, -63.0, -64.0, 42.0, 38.0, 58.0, 59.0, 59.0, 43.0, -3.0, -64.0, 16.0, 59.0, 53.0, 32.0, 53.0, 48.0, 1.0, -64.0, 37.0, 48.0, 54.0, 49.0, -64.0, -7.0, 58.0, 4.0, 49.0, 26.0, 64.0, 6.0, 53.0, 11.0, -64.0, -64.0, 47.0, -63.0, -64.0, 64.0, -64.0, 58.0, 59.0, 64.0, 29.0, 58.0, 54.0, 39.0, 64.0, 58.0, -7.0, 59.0, 52.0, 64.0, -64.0, 20.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3023356396608008, "mean_inference_ms": 9.705995068199483, "mean_action_processing_ms": 0.455042703889896, "mean_env_wait_ms": 0.289721052307532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25806617736816406, "StateBufferConnector_ms": 0.004469156265258789, "ViewRequirementAgentConnector_ms": 0.182755708694458}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 19.97, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 59.0, -64.0, -64.0, 58.0, 17.0, 52.0, 58.0, 53.0, 47.0, 37.0, -64.0, -64.0, 58.0, 23.0, 53.0, 58.0, 54.0, 59.0, -64.0, -64.0, 0.0, 53.0, 34.0, 2.0, 58.0, 54.0, 64.0, -64.0, 48.0, 59.0, 49.0, 64.0, 64.0, -64.0, -64.0, 39.0, 53.0, 59.0, 58.0, -64.0, 59.0, 49.0, 64.0, 59.0, -63.0, -64.0, 42.0, 38.0, 58.0, 59.0, 59.0, 43.0, -3.0, -64.0, 16.0, 59.0, 53.0, 32.0, 53.0, 48.0, 1.0, -64.0, 37.0, 48.0, 54.0, 49.0, -64.0, -7.0, 58.0, 4.0, 49.0, 26.0, 64.0, 6.0, 53.0, 11.0, -64.0, -64.0, 47.0, -63.0, -64.0, 64.0, -64.0, 58.0, 59.0, 64.0, 29.0, 58.0, 54.0, 39.0, 64.0, 58.0, -7.0, 59.0, 52.0, 64.0, -64.0, 20.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3023356396608008, "mean_inference_ms": 9.705995068199483, "mean_action_processing_ms": 0.455042703889896, "mean_env_wait_ms": 0.289721052307532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25806617736816406, "StateBufferConnector_ms": 0.004469156265258789, "ViewRequirementAgentConnector_ms": 0.182755708694458}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.331008255495042, "num_agent_steps_trained_throughput_per_sec": 7.331008255495042, "timesteps_total": 118784, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 118784, "timers": {"training_iteration_time_ms": 69793.906, "sample_time_ms": 5885.502, "load_time_ms": 0.276, "load_throughput": 1854156.146, "learn_time_ms": 63907.654, "learn_throughput": 8.012, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "done": false, "episodes_total": 7424, "training_iteration": 232, "trial_id": "f4e01_00169", "date": "2024-02-27_04-40-58", "timestamp": 1709005258, "time_this_iter_s": 69.84529829025269, "time_total_s": 16670.560266017914, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16670.560266017914, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 43.49191919191918, "ram_util_percent": 16.288888888888884}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 20.5, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.66015625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.66015625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.137022831042608, "policy_loss": 0.01023020410987859, "vf_loss": 6.481560905774434, "vf_explained_var": 0.9344938705364864, "kl": 0.0, "entropy": 158.04758682250977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 119296, "num_env_steps_trained": 119296, "num_agent_steps_sampled": 119296, "num_agent_steps_trained": 119296}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 20.5, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.66015625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.66015625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [49.0, 64.0, 64.0, -64.0, -64.0, 39.0, 53.0, 59.0, 58.0, -64.0, 59.0, 49.0, 64.0, 59.0, -63.0, -64.0, 42.0, 38.0, 58.0, 59.0, 59.0, 43.0, -3.0, -64.0, 16.0, 59.0, 53.0, 32.0, 53.0, 48.0, 1.0, -64.0, 37.0, 48.0, 54.0, 49.0, -64.0, -7.0, 58.0, 4.0, 49.0, 26.0, 64.0, 6.0, 53.0, 11.0, -64.0, -64.0, 47.0, -63.0, -64.0, 64.0, -64.0, 58.0, 59.0, 64.0, 29.0, 58.0, 54.0, 39.0, 64.0, 58.0, -7.0, 59.0, 52.0, 64.0, -64.0, 20.0, 5.0, 34.0, 58.0, -64.0, 47.0, 15.0, -22.0, 53.0, -9.0, 64.0, 58.0, 38.0, 59.0, -64.0, 53.0, 53.0, -64.0, 53.0, 54.0, 27.0, 14.0, 52.0, 19.0, 48.0, 59.0, -64.0, 49.0, 44.0, -64.0, -64.0, -64.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021424372310657, "mean_inference_ms": 9.704574400127203, "mean_action_processing_ms": 0.45499641496741083, "mean_env_wait_ms": 0.2896969440329912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639443874359131, "StateBufferConnector_ms": 0.00455927848815918, "ViewRequirementAgentConnector_ms": 0.19263386726379395}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 20.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.0, 64.0, 64.0, -64.0, -64.0, 39.0, 53.0, 59.0, 58.0, -64.0, 59.0, 49.0, 64.0, 59.0, -63.0, -64.0, 42.0, 38.0, 58.0, 59.0, 59.0, 43.0, -3.0, -64.0, 16.0, 59.0, 53.0, 32.0, 53.0, 48.0, 1.0, -64.0, 37.0, 48.0, 54.0, 49.0, -64.0, -7.0, 58.0, 4.0, 49.0, 26.0, 64.0, 6.0, 53.0, 11.0, -64.0, -64.0, 47.0, -63.0, -64.0, 64.0, -64.0, 58.0, 59.0, 64.0, 29.0, 58.0, 54.0, 39.0, 64.0, 58.0, -7.0, 59.0, 52.0, 64.0, -64.0, 20.0, 5.0, 34.0, 58.0, -64.0, 47.0, 15.0, -22.0, 53.0, -9.0, 64.0, 58.0, 38.0, 59.0, -64.0, 53.0, 53.0, -64.0, 53.0, 54.0, 27.0, 14.0, 52.0, 19.0, 48.0, 59.0, -64.0, 49.0, 44.0, -64.0, -64.0, -64.0, 58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021424372310657, "mean_inference_ms": 9.704574400127203, "mean_action_processing_ms": 0.45499641496741083, "mean_env_wait_ms": 0.2896969440329912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2639443874359131, "StateBufferConnector_ms": 0.00455927848815918, "ViewRequirementAgentConnector_ms": 0.19263386726379395}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119296, "num_agent_steps_trained": 119296, "num_env_steps_sampled": 119296, "num_env_steps_trained": 119296, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.431930844109317, "num_agent_steps_trained_throughput_per_sec": 7.431930844109317, "timesteps_total": 119296, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 119296, "timers": {"training_iteration_time_ms": 69677.678, "sample_time_ms": 5896.268, "load_time_ms": 0.273, "load_throughput": 1877663.415, "learn_time_ms": 63780.66, "learn_throughput": 8.028, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 119296, "num_env_steps_trained": 119296, "num_agent_steps_sampled": 119296, "num_agent_steps_trained": 119296}, "done": false, "episodes_total": 7456, "training_iteration": 233, "trial_id": "f4e01_00169", "date": "2024-02-27_04-42-07", "timestamp": 1709005327, "time_this_iter_s": 68.89698314666748, "time_total_s": 16739.45724916458, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16739.45724916458, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 41.92142857142857, "ram_util_percent": 16.239795918367346}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 18.05, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.641015625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.641015625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.282445951302846, "policy_loss": 0.06536876848743607, "vf_loss": 6.623362398147583, "vf_explained_var": 0.9691564366221428, "kl": 0.0, "entropy": 160.29751485188802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.05, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 18.05, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.641015625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.641015625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [37.0, 48.0, 54.0, 49.0, -64.0, -7.0, 58.0, 4.0, 49.0, 26.0, 64.0, 6.0, 53.0, 11.0, -64.0, -64.0, 47.0, -63.0, -64.0, 64.0, -64.0, 58.0, 59.0, 64.0, 29.0, 58.0, 54.0, 39.0, 64.0, 58.0, -7.0, 59.0, 52.0, 64.0, -64.0, 20.0, 5.0, 34.0, 58.0, -64.0, 47.0, 15.0, -22.0, 53.0, -9.0, 64.0, 58.0, 38.0, 59.0, -64.0, 53.0, 53.0, -64.0, 53.0, 54.0, 27.0, 14.0, 52.0, 19.0, 48.0, 59.0, -64.0, 49.0, 44.0, -64.0, -64.0, -64.0, 58.0, 59.0, 53.0, 59.0, -64.0, 59.0, -64.0, -64.0, -64.0, 54.0, 58.0, -63.0, 58.0, 49.0, 53.0, 59.0, 59.0, 22.0, 59.0, 53.0, 32.0, 53.0, 59.0, 43.0, -21.0, -64.0, -12.0, -64.0, 54.0, -64.0, -64.0, 43.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3019553687554037, "mean_inference_ms": 9.702980786065334, "mean_action_processing_ms": 0.45495330948105733, "mean_env_wait_ms": 0.2896696511436202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2628335952758789, "StateBufferConnector_ms": 0.004335641860961914, "ViewRequirementAgentConnector_ms": 0.191727876663208}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 18.05, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.0, 48.0, 54.0, 49.0, -64.0, -7.0, 58.0, 4.0, 49.0, 26.0, 64.0, 6.0, 53.0, 11.0, -64.0, -64.0, 47.0, -63.0, -64.0, 64.0, -64.0, 58.0, 59.0, 64.0, 29.0, 58.0, 54.0, 39.0, 64.0, 58.0, -7.0, 59.0, 52.0, 64.0, -64.0, 20.0, 5.0, 34.0, 58.0, -64.0, 47.0, 15.0, -22.0, 53.0, -9.0, 64.0, 58.0, 38.0, 59.0, -64.0, 53.0, 53.0, -64.0, 53.0, 54.0, 27.0, 14.0, 52.0, 19.0, 48.0, 59.0, -64.0, 49.0, 44.0, -64.0, -64.0, -64.0, 58.0, 59.0, 53.0, 59.0, -64.0, 59.0, -64.0, -64.0, -64.0, 54.0, 58.0, -63.0, 58.0, 49.0, 53.0, 59.0, 59.0, 22.0, 59.0, 53.0, 32.0, 53.0, 59.0, 43.0, -21.0, -64.0, -12.0, -64.0, 54.0, -64.0, -64.0, 43.0, 53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3019553687554037, "mean_inference_ms": 9.702980786065334, "mean_action_processing_ms": 0.45495330948105733, "mean_env_wait_ms": 0.2896696511436202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2628335952758789, "StateBufferConnector_ms": 0.004335641860961914, "ViewRequirementAgentConnector_ms": 0.191727876663208}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.478478326913999, "num_agent_steps_trained_throughput_per_sec": 7.478478326913999, "timesteps_total": 119808, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 119808, "timers": {"training_iteration_time_ms": 69442.849, "sample_time_ms": 5881.188, "load_time_ms": 0.272, "load_throughput": 1884418.786, "learn_time_ms": 63560.913, "learn_throughput": 8.055, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "done": false, "episodes_total": 7488, "training_iteration": 234, "trial_id": "f4e01_00169", "date": "2024-02-27_04-43-16", "timestamp": 1709005396, "time_this_iter_s": 68.4681465625763, "time_total_s": 16807.925395727158, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16807.925395727158, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 41.705154639175255, "ram_util_percent": 16.24639175257732}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 13.71, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.607109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.607109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.704801221688588, "policy_loss": 0.018782240245491265, "vf_loss": 7.359884631633759, "vf_explained_var": 0.9408729677398999, "kl": 0.0, "entropy": 168.5702387491862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 120320, "num_env_steps_trained": 120320, "num_agent_steps_sampled": 120320, "num_agent_steps_trained": 120320}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 13.71, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 13.71, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.607109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.607109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [52.0, 64.0, -64.0, 20.0, 5.0, 34.0, 58.0, -64.0, 47.0, 15.0, -22.0, 53.0, -9.0, 64.0, 58.0, 38.0, 59.0, -64.0, 53.0, 53.0, -64.0, 53.0, 54.0, 27.0, 14.0, 52.0, 19.0, 48.0, 59.0, -64.0, 49.0, 44.0, -64.0, -64.0, -64.0, 58.0, 59.0, 53.0, 59.0, -64.0, 59.0, -64.0, -64.0, -64.0, 54.0, 58.0, -63.0, 58.0, 49.0, 53.0, 59.0, 59.0, 22.0, 59.0, 53.0, 32.0, 53.0, 59.0, 43.0, -21.0, -64.0, -12.0, -64.0, 54.0, -64.0, -64.0, 43.0, 53.0, -64.0, 53.0, 53.0, -64.0, 2.0, 38.0, -64.0, 58.0, 64.0, 38.0, -64.0, 44.0, 11.0, 58.0, 64.0, 39.0, 53.0, 54.0, -64.0, 53.0, -64.0, -64.0, 45.0, 11.0, -64.0, 34.0, 0.0, 53.0, -64.0, 53.0, 43.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301744043680161, "mean_inference_ms": 9.701133644453828, "mean_action_processing_ms": 0.45489604406766104, "mean_env_wait_ms": 0.2896335846496018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260800838470459, "StateBufferConnector_ms": 0.004287242889404297, "ViewRequirementAgentConnector_ms": 0.18757224082946777}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 13.71, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.0, 64.0, -64.0, 20.0, 5.0, 34.0, 58.0, -64.0, 47.0, 15.0, -22.0, 53.0, -9.0, 64.0, 58.0, 38.0, 59.0, -64.0, 53.0, 53.0, -64.0, 53.0, 54.0, 27.0, 14.0, 52.0, 19.0, 48.0, 59.0, -64.0, 49.0, 44.0, -64.0, -64.0, -64.0, 58.0, 59.0, 53.0, 59.0, -64.0, 59.0, -64.0, -64.0, -64.0, 54.0, 58.0, -63.0, 58.0, 49.0, 53.0, 59.0, 59.0, 22.0, 59.0, 53.0, 32.0, 53.0, 59.0, 43.0, -21.0, -64.0, -12.0, -64.0, 54.0, -64.0, -64.0, 43.0, 53.0, -64.0, 53.0, 53.0, -64.0, 2.0, 38.0, -64.0, 58.0, 64.0, 38.0, -64.0, 44.0, 11.0, 58.0, 64.0, 39.0, 53.0, 54.0, -64.0, 53.0, -64.0, -64.0, 45.0, 11.0, -64.0, 34.0, 0.0, 53.0, -64.0, 53.0, 43.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301744043680161, "mean_inference_ms": 9.701133644453828, "mean_action_processing_ms": 0.45489604406766104, "mean_env_wait_ms": 0.2896335846496018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260800838470459, "StateBufferConnector_ms": 0.004287242889404297, "ViewRequirementAgentConnector_ms": 0.18757224082946777}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120320, "num_agent_steps_trained": 120320, "num_env_steps_sampled": 120320, "num_env_steps_trained": 120320, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.4299888632701, "num_agent_steps_trained_throughput_per_sec": 7.4299888632701, "timesteps_total": 120320, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 120320, "timers": {"training_iteration_time_ms": 69376.643, "sample_time_ms": 5859.279, "load_time_ms": 0.272, "load_throughput": 1884584.158, "learn_time_ms": 63516.616, "learn_throughput": 8.061, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 120320, "num_env_steps_trained": 120320, "num_agent_steps_sampled": 120320, "num_agent_steps_trained": 120320}, "done": false, "episodes_total": 7520, "training_iteration": 235, "trial_id": "f4e01_00169", "date": "2024-02-27_04-44-25", "timestamp": 1709005465, "time_this_iter_s": 68.91477084159851, "time_total_s": 16876.840166568756, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16876.840166568756, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 43.234693877551024, "ram_util_percent": 16.160204081632653}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 14.98, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61703125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61703125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 4.280439847707749, "policy_loss": 0.006955473435421785, "vf_loss": 6.711955694357554, "vf_explained_var": 0.9089621464411418, "kl": 0.0, "entropy": 166.9904894510905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 14.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 14.98, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.61703125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.61703125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, 58.0, 59.0, 53.0, 59.0, -64.0, 59.0, -64.0, -64.0, -64.0, 54.0, 58.0, -63.0, 58.0, 49.0, 53.0, 59.0, 59.0, 22.0, 59.0, 53.0, 32.0, 53.0, 59.0, 43.0, -21.0, -64.0, -12.0, -64.0, 54.0, -64.0, -64.0, 43.0, 53.0, -64.0, 53.0, 53.0, -64.0, 2.0, 38.0, -64.0, 58.0, 64.0, 38.0, -64.0, 44.0, 11.0, 58.0, 64.0, 39.0, 53.0, 54.0, -64.0, 53.0, -64.0, -64.0, 45.0, 11.0, -64.0, 34.0, 0.0, 53.0, -64.0, 53.0, 43.0, -64.0, 53.0, -5.0, 58.0, -15.0, 39.0, 64.0, 58.0, 58.0, 59.0, 53.0, -4.0, 54.0, -64.0, -2.0, -15.0, 64.0, 58.0, -64.0, 59.0, 43.0, 17.0, 64.0, -64.0, 43.0, 59.0, 2.0, 0.0, 64.0, 48.0, -18.0, 48.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301498258149734, "mean_inference_ms": 9.699253554132465, "mean_action_processing_ms": 0.454832406428626, "mean_env_wait_ms": 0.2895958414255345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260176420211792, "StateBufferConnector_ms": 0.004520416259765625, "ViewRequirementAgentConnector_ms": 0.18430018424987793}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 14.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, 58.0, 59.0, 53.0, 59.0, -64.0, 59.0, -64.0, -64.0, -64.0, 54.0, 58.0, -63.0, 58.0, 49.0, 53.0, 59.0, 59.0, 22.0, 59.0, 53.0, 32.0, 53.0, 59.0, 43.0, -21.0, -64.0, -12.0, -64.0, 54.0, -64.0, -64.0, 43.0, 53.0, -64.0, 53.0, 53.0, -64.0, 2.0, 38.0, -64.0, 58.0, 64.0, 38.0, -64.0, 44.0, 11.0, 58.0, 64.0, 39.0, 53.0, 54.0, -64.0, 53.0, -64.0, -64.0, 45.0, 11.0, -64.0, 34.0, 0.0, 53.0, -64.0, 53.0, 43.0, -64.0, 53.0, -5.0, 58.0, -15.0, 39.0, 64.0, 58.0, 58.0, 59.0, 53.0, -4.0, 54.0, -64.0, -2.0, -15.0, 64.0, 58.0, -64.0, 59.0, 43.0, 17.0, 64.0, -64.0, 43.0, 59.0, 2.0, 0.0, 64.0, 48.0, -18.0, 48.0, 54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301498258149734, "mean_inference_ms": 9.699253554132465, "mean_action_processing_ms": 0.454832406428626, "mean_env_wait_ms": 0.2895958414255345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.260176420211792, "StateBufferConnector_ms": 0.004520416259765625, "ViewRequirementAgentConnector_ms": 0.18430018424987793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.439600087565886, "num_agent_steps_trained_throughput_per_sec": 7.439600087565886, "timesteps_total": 120832, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 120832, "timers": {"training_iteration_time_ms": 69283.735, "sample_time_ms": 5845.209, "load_time_ms": 0.273, "load_throughput": 1874058.511, "learn_time_ms": 63437.798, "learn_throughput": 8.071, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "done": false, "episodes_total": 7552, "training_iteration": 236, "trial_id": "f4e01_00169", "date": "2024-02-27_04-45-34", "timestamp": 1709005534, "time_this_iter_s": 68.82576084136963, "time_total_s": 16945.665927410126, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16945.665927410126, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 42.8826530612245, "ram_util_percent": 16.148979591836735}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": 17.21, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.634453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.634453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8758228965103626, "cur_kl_coeff": 0.0, "cur_lr": 0.002527658528325874, "total_loss": 6.220203359921773, "policy_loss": 0.1904128237743862, "vf_loss": 9.470418892304103, "vf_explained_var": 0.9534856230020523, "kl": 0.0, "entropy": 165.7458048502604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 121344, "num_env_steps_trained": 121344, "num_agent_steps_sampled": 121344, "num_agent_steps_trained": 121344}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.21, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": 17.21, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.634453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.634453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 43.0, 53.0, -64.0, 53.0, 53.0, -64.0, 2.0, 38.0, -64.0, 58.0, 64.0, 38.0, -64.0, 44.0, 11.0, 58.0, 64.0, 39.0, 53.0, 54.0, -64.0, 53.0, -64.0, -64.0, 45.0, 11.0, -64.0, 34.0, 0.0, 53.0, -64.0, 53.0, 43.0, -64.0, 53.0, -5.0, 58.0, -15.0, 39.0, 64.0, 58.0, 58.0, 59.0, 53.0, -4.0, 54.0, -64.0, -2.0, -15.0, 64.0, 58.0, -64.0, 59.0, 43.0, 17.0, 64.0, -64.0, 43.0, 59.0, 2.0, 0.0, 64.0, 48.0, -18.0, 48.0, 54.0, 32.0, 53.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 58.0, 48.0, 10.0, 59.0, 4.0, 54.0, 59.0, 64.0, 64.0, -64.0, 2.0, -64.0, 2.0, 64.0, 53.0, 59.0, 11.0, 48.0, 47.0, 59.0, -8.0, -64.0, -64.0, 44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301204904299656, "mean_inference_ms": 9.697273503790779, "mean_action_processing_ms": 0.45475780725984366, "mean_env_wait_ms": 0.2895558643698508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25937509536743164, "StateBufferConnector_ms": 0.004497528076171875, "ViewRequirementAgentConnector_ms": 0.18165302276611328}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": 17.21, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 43.0, 53.0, -64.0, 53.0, 53.0, -64.0, 2.0, 38.0, -64.0, 58.0, 64.0, 38.0, -64.0, 44.0, 11.0, 58.0, 64.0, 39.0, 53.0, 54.0, -64.0, 53.0, -64.0, -64.0, 45.0, 11.0, -64.0, 34.0, 0.0, 53.0, -64.0, 53.0, 43.0, -64.0, 53.0, -5.0, 58.0, -15.0, 39.0, 64.0, 58.0, 58.0, 59.0, 53.0, -4.0, 54.0, -64.0, -2.0, -15.0, 64.0, 58.0, -64.0, 59.0, 43.0, 17.0, 64.0, -64.0, 43.0, 59.0, 2.0, 0.0, 64.0, 48.0, -18.0, 48.0, 54.0, 32.0, 53.0, -64.0, -64.0, -64.0, 58.0, 59.0, 49.0, 58.0, 48.0, 10.0, 59.0, 4.0, 54.0, 59.0, 64.0, 64.0, -64.0, 2.0, -64.0, 2.0, 64.0, 53.0, 59.0, 11.0, 48.0, 47.0, 59.0, -8.0, -64.0, -64.0, 44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.301204904299656, "mean_inference_ms": 9.697273503790779, "mean_action_processing_ms": 0.45475780725984366, "mean_env_wait_ms": 0.2895558643698508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25937509536743164, "StateBufferConnector_ms": 0.004497528076171875, "ViewRequirementAgentConnector_ms": 0.18165302276611328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121344, "num_agent_steps_trained": 121344, "num_env_steps_sampled": 121344, "num_env_steps_trained": 121344, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.54550268084177, "num_agent_steps_trained_throughput_per_sec": 7.54550268084177, "timesteps_total": 121344, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 121344, "timers": {"training_iteration_time_ms": 69128.12, "sample_time_ms": 5800.679, "load_time_ms": 0.274, "load_throughput": 1868514.442, "learn_time_ms": 63326.706, "learn_throughput": 8.085, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 121344, "num_env_steps_trained": 121344, "num_agent_steps_sampled": 121344, "num_agent_steps_trained": 121344}, "done": false, "episodes_total": 7584, "training_iteration": 237, "trial_id": "f4e01_00169", "date": "2024-02-27_04-46-42", "timestamp": 1709005602, "time_this_iter_s": 67.85997128486633, "time_total_s": 17013.525898694992, "pid": 128928, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f391ae8d870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025276585283258747, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GATv2Conv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "GATv2Conv", "rounds": 5, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GATv2_1.yaml", "critic_config": "model_GATv2_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f391cb1b010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02000269157708974, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6366973538333558, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9429121475289335, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17013.525898694992, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 41.78125, "ram_util_percent": 16.039583333333336}, "checkpoint_dir_name": null}
