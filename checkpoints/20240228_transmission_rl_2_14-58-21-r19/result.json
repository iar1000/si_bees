{"custom_metrics": {"reward_total_mean": -50.28125, "reward_total_min": -61, "reward_total_max": -38, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107177734375, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.203125, "reward_score_mean": 0.107177734375, "reward_score_min": 0.0234375, "reward_score_max": 0.203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 7.450771296024323, "policy_loss": -0.006990301981568336, "vf_loss": 8.204180745283763, "vf_explained_var": 0.0018238713343938192, "kl": 0.0, "entropy": 103.20350551605225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": -38.0, "episode_reward_min": -61.0, "episode_reward_mean": -50.28125, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.28125, "reward_total_min": -61, "reward_total_max": -38, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107177734375, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.203125, "reward_score_mean": 0.107177734375, "reward_score_min": 0.0234375, "reward_score_max": 0.203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -39.0, -58.0, -48.0, -41.0, -55.0, -45.0, -53.0, -59.0, -44.0, -61.0, -51.0, -47.0, -40.0, -58.0, -58.0, -59.0, -58.0, -51.0, -39.0, -42.0, -58.0, -45.0, -58.0, -50.0, -59.0, -51.0, -53.0, -47.0, -38.0, -46.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.360186868708501, "mean_inference_ms": 25.894998806959006, "mean_action_processing_ms": 1.211634388676396, "mean_env_wait_ms": 0.6937678562037893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9031102061271667, "StateBufferConnector_ms": 0.010266900062561035, "ViewRequirementAgentConnector_ms": 0.3445439040660858}}, "episode_reward_max": -38.0, "episode_reward_min": -61.0, "episode_reward_mean": -50.28125, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -39.0, -58.0, -48.0, -41.0, -55.0, -45.0, -53.0, -59.0, -44.0, -61.0, -51.0, -47.0, -40.0, -58.0, -58.0, -59.0, -58.0, -51.0, -39.0, -42.0, -58.0, -45.0, -58.0, -50.0, -59.0, -51.0, -53.0, -47.0, -38.0, -46.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.360186868708501, "mean_inference_ms": 25.894998806959006, "mean_action_processing_ms": 1.211634388676396, "mean_env_wait_ms": 0.6937678562037893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9031102061271667, "StateBufferConnector_ms": 0.010266900062561035, "ViewRequirementAgentConnector_ms": 0.3445439040660858}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.067387136234254, "num_agent_steps_trained_throughput_per_sec": 3.067387136234254, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 166917.219, "sample_time_ms": 16030.88, "load_time_ms": 0.803, "load_throughput": 637424.651, "learn_time_ms": 150884.269, "learn_throughput": 3.393, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "6f959_00019", "date": "2024-02-28_15-10-36", "timestamp": 1709129436, "time_this_iter_s": 166.92581176757812, "time_total_s": 166.92581176757812, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 166.92581176757812, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.61470588235295, "ram_util_percent": 17.423529411764708}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"reward_total_mean": -51.015625, "reward_total_min": -61, "reward_total_max": -38, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1014404296875, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.203125, "reward_score_mean": 0.1014404296875, "reward_score_min": 0.0234375, "reward_score_max": 0.203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9950378100077312, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 7.559713196754456, "policy_loss": -0.0302703686679403, "vf_loss": 8.349636363983155, "vf_explained_var": 0.0048724879821141565, "kl": 0.0, "entropy": 102.3584197362264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": -38.0, "episode_reward_min": -61.0, "episode_reward_mean": -51.015625, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.015625, "reward_total_min": -61, "reward_total_max": -38, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1014404296875, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.203125, "reward_score_mean": 0.1014404296875, "reward_score_min": 0.0234375, "reward_score_max": 0.203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -39.0, -58.0, -48.0, -41.0, -55.0, -45.0, -53.0, -59.0, -44.0, -61.0, -51.0, -47.0, -40.0, -58.0, -58.0, -59.0, -58.0, -51.0, -39.0, -42.0, -58.0, -45.0, -58.0, -50.0, -59.0, -51.0, -53.0, -47.0, -38.0, -46.0, -57.0, -45.0, -45.0, -52.0, -60.0, -48.0, -58.0, -51.0, -59.0, -49.0, -60.0, -56.0, -54.0, -55.0, -38.0, -47.0, -52.0, -59.0, -46.0, -47.0, -55.0, -42.0, -54.0, -60.0, -49.0, -59.0, -60.0, -41.0, -46.0, -51.0, -58.0, -47.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0912724186473737, "mean_inference_ms": 23.99337855815003, "mean_action_processing_ms": 1.1020542978701982, "mean_env_wait_ms": 0.6363303634254703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7174015045166016, "StateBufferConnector_ms": 0.008846819400787354, "ViewRequirementAgentConnector_ms": 0.31152330338954926}}, "episode_reward_max": -38.0, "episode_reward_min": -61.0, "episode_reward_mean": -51.015625, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -39.0, -58.0, -48.0, -41.0, -55.0, -45.0, -53.0, -59.0, -44.0, -61.0, -51.0, -47.0, -40.0, -58.0, -58.0, -59.0, -58.0, -51.0, -39.0, -42.0, -58.0, -45.0, -58.0, -50.0, -59.0, -51.0, -53.0, -47.0, -38.0, -46.0, -57.0, -45.0, -45.0, -52.0, -60.0, -48.0, -58.0, -51.0, -59.0, -49.0, -60.0, -56.0, -54.0, -55.0, -38.0, -47.0, -52.0, -59.0, -46.0, -47.0, -55.0, -42.0, -54.0, -60.0, -49.0, -59.0, -60.0, -41.0, -46.0, -51.0, -58.0, -47.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0912724186473737, "mean_inference_ms": 23.99337855815003, "mean_action_processing_ms": 1.1020542978701982, "mean_env_wait_ms": 0.6363303634254703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7174015045166016, "StateBufferConnector_ms": 0.008846819400787354, "ViewRequirementAgentConnector_ms": 0.31152330338954926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0414078546370065, "num_agent_steps_trained_throughput_per_sec": 3.0414078546370065, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 167630.125, "sample_time_ms": 13613.802, "load_time_ms": 0.6, "load_throughput": 853530.862, "learn_time_ms": 154014.729, "learn_throughput": 3.324, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 64, "training_iteration": 2, "trial_id": "6f959_00019", "date": "2024-02-28_15-13-29", "timestamp": 1709129609, "time_this_iter_s": 168.35049700737, "time_total_s": 335.2763087749481, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 335.2763087749481, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.59349593495935, "ram_util_percent": 17.796747967479682}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.78125, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103271484375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.103271484375, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.833842066116631, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.043764901161193, "policy_loss": -0.04578357599675655, "vf_loss": 9.99928704102834, "vf_explained_var": 0.00038915673891703285, "kl": 0.0, "entropy": 102.46834182739258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.78125, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.78125, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103271484375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.103271484375, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -39.0, -58.0, -48.0, -41.0, -55.0, -45.0, -53.0, -59.0, -44.0, -61.0, -51.0, -47.0, -40.0, -58.0, -58.0, -59.0, -58.0, -51.0, -39.0, -42.0, -58.0, -45.0, -58.0, -50.0, -59.0, -51.0, -53.0, -47.0, -38.0, -46.0, -57.0, -45.0, -45.0, -52.0, -60.0, -48.0, -58.0, -51.0, -59.0, -49.0, -60.0, -56.0, -54.0, -55.0, -38.0, -47.0, -52.0, -59.0, -46.0, -47.0, -55.0, -42.0, -54.0, -60.0, -49.0, -59.0, -60.0, -41.0, -46.0, -51.0, -58.0, -47.0, -53.0, -56.0, -42.0, -51.0, -54.0, -57.0, -61.0, -43.0, -56.0, -53.0, -50.0, -60.0, -36.0, -61.0, -37.0, -46.0, -48.0, -62.0, -47.0, -58.0, -62.0, -52.0, -61.0, -50.0, -35.0, -50.0, -32.0, -57.0, -48.0, -38.0, -47.0, -47.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.945293616787992, "mean_inference_ms": 22.95515831113642, "mean_action_processing_ms": 1.0414703270694476, "mean_env_wait_ms": 0.6043803031091313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6609424948692322, "StateBufferConnector_ms": 0.008229662974675497, "ViewRequirementAgentConnector_ms": 0.30218809843063354}}, "episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.78125, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -39.0, -58.0, -48.0, -41.0, -55.0, -45.0, -53.0, -59.0, -44.0, -61.0, -51.0, -47.0, -40.0, -58.0, -58.0, -59.0, -58.0, -51.0, -39.0, -42.0, -58.0, -45.0, -58.0, -50.0, -59.0, -51.0, -53.0, -47.0, -38.0, -46.0, -57.0, -45.0, -45.0, -52.0, -60.0, -48.0, -58.0, -51.0, -59.0, -49.0, -60.0, -56.0, -54.0, -55.0, -38.0, -47.0, -52.0, -59.0, -46.0, -47.0, -55.0, -42.0, -54.0, -60.0, -49.0, -59.0, -60.0, -41.0, -46.0, -51.0, -58.0, -47.0, -53.0, -56.0, -42.0, -51.0, -54.0, -57.0, -61.0, -43.0, -56.0, -53.0, -50.0, -60.0, -36.0, -61.0, -37.0, -46.0, -48.0, -62.0, -47.0, -58.0, -62.0, -52.0, -61.0, -50.0, -35.0, -50.0, -32.0, -57.0, -48.0, -38.0, -47.0, -47.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.945293616787992, "mean_inference_ms": 22.95515831113642, "mean_action_processing_ms": 1.0414703270694476, "mean_env_wait_ms": 0.6043803031091313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6609424948692322, "StateBufferConnector_ms": 0.008229662974675497, "ViewRequirementAgentConnector_ms": 0.30218809843063354}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9039473683516603, "num_agent_steps_trained_throughput_per_sec": 2.9039473683516603, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 170523.966, "sample_time_ms": 12843.191, "load_time_ms": 0.545, "load_throughput": 939954.909, "learn_time_ms": 157679.235, "learn_throughput": 3.247, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "6f959_00019", "date": "2024-02-28_15-16-26", "timestamp": 1709129786, "time_this_iter_s": 176.33288288116455, "time_total_s": 511.60919165611267, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 511.60919165611267, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 56.74360000000001, "ram_util_percent": 17.8}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.74, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10359375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.10359375, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8499876678610842, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.972077933947245, "policy_loss": -0.053377599020799, "vf_loss": 9.928779184818268, "vf_explained_var": 0.0013844971855481467, "kl": 0.0, "entropy": 102.28786322275798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.74, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10359375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.10359375, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -38.0, -46.0, -57.0, -45.0, -45.0, -52.0, -60.0, -48.0, -58.0, -51.0, -59.0, -49.0, -60.0, -56.0, -54.0, -55.0, -38.0, -47.0, -52.0, -59.0, -46.0, -47.0, -55.0, -42.0, -54.0, -60.0, -49.0, -59.0, -60.0, -41.0, -46.0, -51.0, -58.0, -47.0, -53.0, -56.0, -42.0, -51.0, -54.0, -57.0, -61.0, -43.0, -56.0, -53.0, -50.0, -60.0, -36.0, -61.0, -37.0, -46.0, -48.0, -62.0, -47.0, -58.0, -62.0, -52.0, -61.0, -50.0, -35.0, -50.0, -32.0, -57.0, -48.0, -38.0, -47.0, -47.0, -53.0, -51.0, -45.0, -44.0, -50.0, -58.0, -57.0, -46.0, -42.0, -57.0, -49.0, -39.0, -44.0, -50.0, -44.0, -58.0, -40.0, -46.0, -58.0, -58.0, -54.0, -58.0, -54.0, -50.0, -33.0, -58.0, -46.0, -56.0, -50.0, -61.0, -49.0, -59.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7627311679152933, "mean_inference_ms": 21.628873060525276, "mean_action_processing_ms": 0.9625740237204881, "mean_env_wait_ms": 0.5632517838845478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6052229404449463, "StateBufferConnector_ms": 0.007639408111572266, "ViewRequirementAgentConnector_ms": 0.3009965419769287}}, "episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -38.0, -46.0, -57.0, -45.0, -45.0, -52.0, -60.0, -48.0, -58.0, -51.0, -59.0, -49.0, -60.0, -56.0, -54.0, -55.0, -38.0, -47.0, -52.0, -59.0, -46.0, -47.0, -55.0, -42.0, -54.0, -60.0, -49.0, -59.0, -60.0, -41.0, -46.0, -51.0, -58.0, -47.0, -53.0, -56.0, -42.0, -51.0, -54.0, -57.0, -61.0, -43.0, -56.0, -53.0, -50.0, -60.0, -36.0, -61.0, -37.0, -46.0, -48.0, -62.0, -47.0, -58.0, -62.0, -52.0, -61.0, -50.0, -35.0, -50.0, -32.0, -57.0, -48.0, -38.0, -47.0, -47.0, -53.0, -51.0, -45.0, -44.0, -50.0, -58.0, -57.0, -46.0, -42.0, -57.0, -49.0, -39.0, -44.0, -50.0, -44.0, -58.0, -40.0, -46.0, -58.0, -58.0, -54.0, -58.0, -54.0, -50.0, -33.0, -58.0, -46.0, -56.0, -50.0, -61.0, -49.0, -59.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7627311679152933, "mean_inference_ms": 21.628873060525276, "mean_action_processing_ms": 0.9625740237204881, "mean_env_wait_ms": 0.5632517838845478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6052229404449463, "StateBufferConnector_ms": 0.007639408111572266, "ViewRequirementAgentConnector_ms": 0.3009965419769287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.068003881758073, "num_agent_steps_trained_throughput_per_sec": 3.068003881758073, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 169613.904, "sample_time_ms": 13162.894, "load_time_ms": 0.564, "load_throughput": 908122.909, "learn_time_ms": 156449.524, "learn_throughput": 3.273, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "6f959_00019", "date": "2024-02-28_15-19-13", "timestamp": 1709129953, "time_this_iter_s": 166.89448809623718, "time_total_s": 678.5036797523499, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 678.5036797523499, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 56.60801687763713, "ram_util_percent": 17.5873417721519}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.52, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1053125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.1053125, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8464640021324158, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.004889738559722, "policy_loss": -0.051218429456154506, "vf_loss": 9.96249980131785, "vf_explained_var": 0.011142881711324056, "kl": 0.0, "entropy": 102.01030591328939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.52, "reward_total_min": -62, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1053125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.25, "reward_score_mean": 0.1053125, "reward_score_min": 0.015625, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-51.0, -58.0, -47.0, -53.0, -56.0, -42.0, -51.0, -54.0, -57.0, -61.0, -43.0, -56.0, -53.0, -50.0, -60.0, -36.0, -61.0, -37.0, -46.0, -48.0, -62.0, -47.0, -58.0, -62.0, -52.0, -61.0, -50.0, -35.0, -50.0, -32.0, -57.0, -48.0, -38.0, -47.0, -47.0, -53.0, -51.0, -45.0, -44.0, -50.0, -58.0, -57.0, -46.0, -42.0, -57.0, -49.0, -39.0, -44.0, -50.0, -44.0, -58.0, -40.0, -46.0, -58.0, -58.0, -54.0, -58.0, -54.0, -50.0, -33.0, -58.0, -46.0, -56.0, -50.0, -61.0, -49.0, -59.0, -56.0, -52.0, -54.0, -48.0, -56.0, -60.0, -56.0, -41.0, -52.0, -57.0, -58.0, -59.0, -37.0, -53.0, -48.0, -59.0, -44.0, -32.0, -47.0, -59.0, -59.0, -51.0, -51.0, -43.0, -51.0, -52.0, -57.0, -48.0, -53.0, -49.0, -47.0, -44.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6938793389872364, "mean_inference_ms": 21.097783037868307, "mean_action_processing_ms": 0.9296964539613899, "mean_env_wait_ms": 0.5460514838933441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6127712726593018, "StateBufferConnector_ms": 0.007468223571777344, "ViewRequirementAgentConnector_ms": 0.3021714687347412}}, "episode_reward_max": -32.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.0, -58.0, -47.0, -53.0, -56.0, -42.0, -51.0, -54.0, -57.0, -61.0, -43.0, -56.0, -53.0, -50.0, -60.0, -36.0, -61.0, -37.0, -46.0, -48.0, -62.0, -47.0, -58.0, -62.0, -52.0, -61.0, -50.0, -35.0, -50.0, -32.0, -57.0, -48.0, -38.0, -47.0, -47.0, -53.0, -51.0, -45.0, -44.0, -50.0, -58.0, -57.0, -46.0, -42.0, -57.0, -49.0, -39.0, -44.0, -50.0, -44.0, -58.0, -40.0, -46.0, -58.0, -58.0, -54.0, -58.0, -54.0, -50.0, -33.0, -58.0, -46.0, -56.0, -50.0, -61.0, -49.0, -59.0, -56.0, -52.0, -54.0, -48.0, -56.0, -60.0, -56.0, -41.0, -52.0, -57.0, -58.0, -59.0, -37.0, -53.0, -48.0, -59.0, -44.0, -32.0, -47.0, -59.0, -59.0, -51.0, -51.0, -43.0, -51.0, -52.0, -57.0, -48.0, -53.0, -49.0, -47.0, -44.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6938793389872364, "mean_inference_ms": 21.097783037868307, "mean_action_processing_ms": 0.9296964539613899, "mean_env_wait_ms": 0.5460514838933441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6127712726593018, "StateBufferConnector_ms": 0.007468223571777344, "ViewRequirementAgentConnector_ms": 0.3021714687347412}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2100031005353347, "num_agent_steps_trained_throughput_per_sec": 3.2100031005353347, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 167591.397, "sample_time_ms": 12863.757, "load_time_ms": 0.551, "load_throughput": 929888.13, "learn_time_ms": 154726.244, "learn_throughput": 3.309, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 160, "training_iteration": 5, "trial_id": "6f959_00019", "date": "2024-02-28_15-21-53", "timestamp": 1709130113, "time_this_iter_s": 159.51191067695618, "time_total_s": 838.015590429306, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 838.015590429306, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.76431718061674, "ram_util_percent": 17.617621145374443}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.98, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10171875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.10171875, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4416395058312143, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.040646441777547, "policy_loss": -0.03572092953448494, "vf_loss": 9.984786629676819, "vf_explained_var": 0.07519622743129731, "kl": 0.0, "entropy": 101.24043509165446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.98, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10171875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.10171875, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -47.0, -47.0, -53.0, -51.0, -45.0, -44.0, -50.0, -58.0, -57.0, -46.0, -42.0, -57.0, -49.0, -39.0, -44.0, -50.0, -44.0, -58.0, -40.0, -46.0, -58.0, -58.0, -54.0, -58.0, -54.0, -50.0, -33.0, -58.0, -46.0, -56.0, -50.0, -61.0, -49.0, -59.0, -56.0, -52.0, -54.0, -48.0, -56.0, -60.0, -56.0, -41.0, -52.0, -57.0, -58.0, -59.0, -37.0, -53.0, -48.0, -59.0, -44.0, -32.0, -47.0, -59.0, -59.0, -51.0, -51.0, -43.0, -51.0, -52.0, -57.0, -48.0, -53.0, -49.0, -47.0, -44.0, -36.0, -61.0, -56.0, -59.0, -46.0, -42.0, -49.0, -56.0, -52.0, -47.0, -57.0, -44.0, -51.0, -50.0, -58.0, -48.0, -48.0, -59.0, -50.0, -43.0, -63.0, -48.0, -63.0, -57.0, -57.0, -53.0, -39.0, -56.0, -58.0, -46.0, -58.0, -46.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6772446860044385, "mean_inference_ms": 20.95398658424052, "mean_action_processing_ms": 0.9200735687539223, "mean_env_wait_ms": 0.5409750648708516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6223382949829102, "StateBufferConnector_ms": 0.00758814811706543, "ViewRequirementAgentConnector_ms": 0.306018590927124}}, "episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -47.0, -47.0, -53.0, -51.0, -45.0, -44.0, -50.0, -58.0, -57.0, -46.0, -42.0, -57.0, -49.0, -39.0, -44.0, -50.0, -44.0, -58.0, -40.0, -46.0, -58.0, -58.0, -54.0, -58.0, -54.0, -50.0, -33.0, -58.0, -46.0, -56.0, -50.0, -61.0, -49.0, -59.0, -56.0, -52.0, -54.0, -48.0, -56.0, -60.0, -56.0, -41.0, -52.0, -57.0, -58.0, -59.0, -37.0, -53.0, -48.0, -59.0, -44.0, -32.0, -47.0, -59.0, -59.0, -51.0, -51.0, -43.0, -51.0, -52.0, -57.0, -48.0, -53.0, -49.0, -47.0, -44.0, -36.0, -61.0, -56.0, -59.0, -46.0, -42.0, -49.0, -56.0, -52.0, -47.0, -57.0, -44.0, -51.0, -50.0, -58.0, -48.0, -48.0, -59.0, -50.0, -43.0, -63.0, -48.0, -63.0, -57.0, -57.0, -53.0, -39.0, -56.0, -58.0, -46.0, -58.0, -46.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6772446860044385, "mean_inference_ms": 20.95398658424052, "mean_action_processing_ms": 0.9200735687539223, "mean_env_wait_ms": 0.5409750648708516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6223382949829102, "StateBufferConnector_ms": 0.00758814811706543, "ViewRequirementAgentConnector_ms": 0.306018590927124}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.176156538064709, "num_agent_steps_trained_throughput_per_sec": 3.176156538064709, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 166526.341, "sample_time_ms": 12653.948, "load_time_ms": 0.519, "load_throughput": 986668.343, "learn_time_ms": 153871.047, "learn_throughput": 3.327, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 192, "training_iteration": 6, "trial_id": "6f959_00019", "date": "2024-02-28_15-24-34", "timestamp": 1709130274, "time_this_iter_s": 161.2120909690857, "time_total_s": 999.2276813983917, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 999.2276813983917, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.02270742358079, "ram_util_percent": 17.800000000000008}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.17, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.100234375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.100234375, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33810522632556966, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.055524969100953, "policy_loss": -0.030661795055493712, "vf_loss": 9.995588874816894, "vf_explained_var": 0.004041502873102824, "kl": 0.0, "entropy": 101.71811822255452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.17, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.17, "reward_total_min": -63, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.100234375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.25, "reward_score_mean": 0.100234375, "reward_score_min": 0.0078125, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -49.0, -59.0, -56.0, -52.0, -54.0, -48.0, -56.0, -60.0, -56.0, -41.0, -52.0, -57.0, -58.0, -59.0, -37.0, -53.0, -48.0, -59.0, -44.0, -32.0, -47.0, -59.0, -59.0, -51.0, -51.0, -43.0, -51.0, -52.0, -57.0, -48.0, -53.0, -49.0, -47.0, -44.0, -36.0, -61.0, -56.0, -59.0, -46.0, -42.0, -49.0, -56.0, -52.0, -47.0, -57.0, -44.0, -51.0, -50.0, -58.0, -48.0, -48.0, -59.0, -50.0, -43.0, -63.0, -48.0, -63.0, -57.0, -57.0, -53.0, -39.0, -56.0, -58.0, -46.0, -58.0, -46.0, -60.0, -57.0, -59.0, -47.0, -42.0, -50.0, -58.0, -45.0, -45.0, -46.0, -48.0, -54.0, -50.0, -61.0, -52.0, -45.0, -47.0, -38.0, -61.0, -53.0, -45.0, -50.0, -37.0, -56.0, -51.0, -54.0, -58.0, -39.0, -47.0, -58.0, -39.0, -57.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.627398262823748, "mean_inference_ms": 20.604391341704087, "mean_action_processing_ms": 0.9007701419857236, "mean_env_wait_ms": 0.5301147513334085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5587832927703857, "StateBufferConnector_ms": 0.007075786590576172, "ViewRequirementAgentConnector_ms": 0.2860293388366699}}, "episode_reward_max": -32.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.17, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -49.0, -59.0, -56.0, -52.0, -54.0, -48.0, -56.0, -60.0, -56.0, -41.0, -52.0, -57.0, -58.0, -59.0, -37.0, -53.0, -48.0, -59.0, -44.0, -32.0, -47.0, -59.0, -59.0, -51.0, -51.0, -43.0, -51.0, -52.0, -57.0, -48.0, -53.0, -49.0, -47.0, -44.0, -36.0, -61.0, -56.0, -59.0, -46.0, -42.0, -49.0, -56.0, -52.0, -47.0, -57.0, -44.0, -51.0, -50.0, -58.0, -48.0, -48.0, -59.0, -50.0, -43.0, -63.0, -48.0, -63.0, -57.0, -57.0, -53.0, -39.0, -56.0, -58.0, -46.0, -58.0, -46.0, -60.0, -57.0, -59.0, -47.0, -42.0, -50.0, -58.0, -45.0, -45.0, -46.0, -48.0, -54.0, -50.0, -61.0, -52.0, -45.0, -47.0, -38.0, -61.0, -53.0, -45.0, -50.0, -37.0, -56.0, -51.0, -54.0, -58.0, -39.0, -47.0, -58.0, -39.0, -57.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.627398262823748, "mean_inference_ms": 20.604391341704087, "mean_action_processing_ms": 0.9007701419857236, "mean_env_wait_ms": 0.5301147513334085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5587832927703857, "StateBufferConnector_ms": 0.007075786590576172, "ViewRequirementAgentConnector_ms": 0.2860293388366699}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.217953781608193, "num_agent_steps_trained_throughput_per_sec": 3.217953781608193, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 165466.474, "sample_time_ms": 12430.525, "load_time_ms": 0.53, "load_throughput": 965781.274, "learn_time_ms": 153034.597, "learn_throughput": 3.346, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 224, "training_iteration": 7, "trial_id": "6f959_00019", "date": "2024-02-28_15-27-13", "timestamp": 1709130433, "time_this_iter_s": 159.11795663833618, "time_total_s": 1158.345638036728, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1158.345638036728, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 56.86681415929203, "ram_util_percent": 17.47522123893805}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.65, "reward_total_min": -63, "reward_total_max": -36, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.096484375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.21875, "reward_score_mean": 0.096484375, "reward_score_min": 0.0078125, "reward_score_max": 0.21875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2947519584170853, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.014802499612172, "policy_loss": -0.02400353013848265, "vf_loss": 9.943465940157573, "vf_explained_var": 0.0015815943479537964, "kl": 0.0, "entropy": 101.50623817443848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": -36.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.65, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.65, "reward_total_min": -63, "reward_total_max": -36, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.096484375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.21875, "reward_score_mean": 0.096484375, "reward_score_min": 0.0078125, "reward_score_max": 0.21875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -47.0, -44.0, -36.0, -61.0, -56.0, -59.0, -46.0, -42.0, -49.0, -56.0, -52.0, -47.0, -57.0, -44.0, -51.0, -50.0, -58.0, -48.0, -48.0, -59.0, -50.0, -43.0, -63.0, -48.0, -63.0, -57.0, -57.0, -53.0, -39.0, -56.0, -58.0, -46.0, -58.0, -46.0, -60.0, -57.0, -59.0, -47.0, -42.0, -50.0, -58.0, -45.0, -45.0, -46.0, -48.0, -54.0, -50.0, -61.0, -52.0, -45.0, -47.0, -38.0, -61.0, -53.0, -45.0, -50.0, -37.0, -56.0, -51.0, -54.0, -58.0, -39.0, -47.0, -58.0, -39.0, -57.0, -50.0, -56.0, -43.0, -61.0, -59.0, -58.0, -60.0, -49.0, -56.0, -50.0, -50.0, -47.0, -46.0, -55.0, -48.0, -47.0, -47.0, -44.0, -59.0, -59.0, -47.0, -60.0, -59.0, -57.0, -55.0, -48.0, -50.0, -59.0, -59.0, -60.0, -55.0, -59.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5834435846892796, "mean_inference_ms": 20.31421344391127, "mean_action_processing_ms": 0.8852497421926842, "mean_env_wait_ms": 0.5211838975164708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5497314929962158, "StateBufferConnector_ms": 0.00705265998840332, "ViewRequirementAgentConnector_ms": 0.2854597568511963}}, "episode_reward_max": -36.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.65, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -47.0, -44.0, -36.0, -61.0, -56.0, -59.0, -46.0, -42.0, -49.0, -56.0, -52.0, -47.0, -57.0, -44.0, -51.0, -50.0, -58.0, -48.0, -48.0, -59.0, -50.0, -43.0, -63.0, -48.0, -63.0, -57.0, -57.0, -53.0, -39.0, -56.0, -58.0, -46.0, -58.0, -46.0, -60.0, -57.0, -59.0, -47.0, -42.0, -50.0, -58.0, -45.0, -45.0, -46.0, -48.0, -54.0, -50.0, -61.0, -52.0, -45.0, -47.0, -38.0, -61.0, -53.0, -45.0, -50.0, -37.0, -56.0, -51.0, -54.0, -58.0, -39.0, -47.0, -58.0, -39.0, -57.0, -50.0, -56.0, -43.0, -61.0, -59.0, -58.0, -60.0, -49.0, -56.0, -50.0, -50.0, -47.0, -46.0, -55.0, -48.0, -47.0, -47.0, -44.0, -59.0, -59.0, -47.0, -60.0, -59.0, -57.0, -55.0, -48.0, -50.0, -59.0, -59.0, -60.0, -55.0, -59.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5834435846892796, "mean_inference_ms": 20.31421344391127, "mean_action_processing_ms": 0.8852497421926842, "mean_env_wait_ms": 0.5211838975164708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5497314929962158, "StateBufferConnector_ms": 0.00705265998840332, "ViewRequirementAgentConnector_ms": 0.2854597568511963}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1899998443089967, "num_agent_steps_trained_throughput_per_sec": 3.1899998443089967, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 164845.857, "sample_time_ms": 12323.554, "load_time_ms": 0.511, "load_throughput": 1001741.643, "learn_time_ms": 152520.999, "learn_throughput": 3.357, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 256, "training_iteration": 8, "trial_id": "6f959_00019", "date": "2024-02-28_15-29-54", "timestamp": 1709130594, "time_this_iter_s": 160.5123200416565, "time_total_s": 1318.8579580783844, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1318.8579580783844, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.08552631578947, "ram_util_percent": 17.745175438596494}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.08, "reward_total_min": -61, "reward_total_max": -37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1009375, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.2109375, "reward_score_mean": 0.1009375, "reward_score_min": 0.0234375, "reward_score_max": 0.2109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7392973056683938, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.016716488202412, "policy_loss": -0.04868828045825164, "vf_loss": 9.972726945082346, "vf_explained_var": 0.003920306265354156, "kl": 0.0, "entropy": 101.44092807769775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": -37.0, "episode_reward_min": -61.0, "episode_reward_mean": -51.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.08, "reward_total_min": -61, "reward_total_max": -37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1009375, "reward_percentile_min": 0.0234375, "reward_percentile_max": 0.2109375, "reward_score_mean": 0.1009375, "reward_score_min": 0.0234375, "reward_score_max": 0.2109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -58.0, -46.0, -60.0, -57.0, -59.0, -47.0, -42.0, -50.0, -58.0, -45.0, -45.0, -46.0, -48.0, -54.0, -50.0, -61.0, -52.0, -45.0, -47.0, -38.0, -61.0, -53.0, -45.0, -50.0, -37.0, -56.0, -51.0, -54.0, -58.0, -39.0, -47.0, -58.0, -39.0, -57.0, -50.0, -56.0, -43.0, -61.0, -59.0, -58.0, -60.0, -49.0, -56.0, -50.0, -50.0, -47.0, -46.0, -55.0, -48.0, -47.0, -47.0, -44.0, -59.0, -59.0, -47.0, -60.0, -59.0, -57.0, -55.0, -48.0, -50.0, -59.0, -59.0, -60.0, -55.0, -59.0, -48.0, -55.0, -52.0, -51.0, -47.0, -53.0, -45.0, -46.0, -56.0, -56.0, -59.0, -43.0, -54.0, -48.0, -48.0, -56.0, -55.0, -40.0, -59.0, -52.0, -51.0, -51.0, -60.0, -44.0, -42.0, -57.0, -40.0, -47.0, -51.0, -37.0, -46.0, -42.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5453605265469936, "mean_inference_ms": 20.060621505255373, "mean_action_processing_ms": 0.8721694971268207, "mean_env_wait_ms": 0.5135082686216051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5368762016296387, "StateBufferConnector_ms": 0.006948232650756836, "ViewRequirementAgentConnector_ms": 0.28272056579589844}}, "episode_reward_max": -37.0, "episode_reward_min": -61.0, "episode_reward_mean": -51.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -58.0, -46.0, -60.0, -57.0, -59.0, -47.0, -42.0, -50.0, -58.0, -45.0, -45.0, -46.0, -48.0, -54.0, -50.0, -61.0, -52.0, -45.0, -47.0, -38.0, -61.0, -53.0, -45.0, -50.0, -37.0, -56.0, -51.0, -54.0, -58.0, -39.0, -47.0, -58.0, -39.0, -57.0, -50.0, -56.0, -43.0, -61.0, -59.0, -58.0, -60.0, -49.0, -56.0, -50.0, -50.0, -47.0, -46.0, -55.0, -48.0, -47.0, -47.0, -44.0, -59.0, -59.0, -47.0, -60.0, -59.0, -57.0, -55.0, -48.0, -50.0, -59.0, -59.0, -60.0, -55.0, -59.0, -48.0, -55.0, -52.0, -51.0, -47.0, -53.0, -45.0, -46.0, -56.0, -56.0, -59.0, -43.0, -54.0, -48.0, -48.0, -56.0, -55.0, -40.0, -59.0, -52.0, -51.0, -51.0, -60.0, -44.0, -42.0, -57.0, -40.0, -47.0, -51.0, -37.0, -46.0, -42.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5453605265469936, "mean_inference_ms": 20.060621505255373, "mean_action_processing_ms": 0.8721694971268207, "mean_env_wait_ms": 0.5135082686216051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5368762016296387, "StateBufferConnector_ms": 0.006948232650756836, "ViewRequirementAgentConnector_ms": 0.28272056579589844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.277075988243132, "num_agent_steps_trained_throughput_per_sec": 3.277075988243132, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 163889.297, "sample_time_ms": 12177.348, "load_time_ms": 0.494, "load_throughput": 1035597.323, "learn_time_ms": 151710.685, "learn_throughput": 3.375, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 288, "training_iteration": 9, "trial_id": "6f959_00019", "date": "2024-02-28_15-32-30", "timestamp": 1709130750, "time_this_iter_s": 156.24752283096313, "time_total_s": 1475.1054809093475, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1475.1054809093475, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.218468468468465, "ram_util_percent": 17.380630630630634}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.49, "reward_total_min": -63, "reward_total_max": -37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.097734375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2109375, "reward_score_mean": 0.097734375, "reward_score_min": 0.0078125, "reward_score_max": 0.2109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7640979358305534, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.022158857186636, "policy_loss": -0.03931846679188311, "vf_loss": 9.968406208356221, "vf_explained_var": 0.0016404961546262105, "kl": 0.0, "entropy": 100.50688546498617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": -37.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.49, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.49, "reward_total_min": -63, "reward_total_max": -37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.097734375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2109375, "reward_score_mean": 0.097734375, "reward_score_min": 0.0078125, "reward_score_max": 0.2109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -39.0, -57.0, -50.0, -56.0, -43.0, -61.0, -59.0, -58.0, -60.0, -49.0, -56.0, -50.0, -50.0, -47.0, -46.0, -55.0, -48.0, -47.0, -47.0, -44.0, -59.0, -59.0, -47.0, -60.0, -59.0, -57.0, -55.0, -48.0, -50.0, -59.0, -59.0, -60.0, -55.0, -59.0, -48.0, -55.0, -52.0, -51.0, -47.0, -53.0, -45.0, -46.0, -56.0, -56.0, -59.0, -43.0, -54.0, -48.0, -48.0, -56.0, -55.0, -40.0, -59.0, -52.0, -51.0, -51.0, -60.0, -44.0, -42.0, -57.0, -40.0, -47.0, -51.0, -37.0, -46.0, -42.0, -46.0, -55.0, -54.0, -58.0, -52.0, -50.0, -47.0, -46.0, -55.0, -38.0, -39.0, -58.0, -59.0, -63.0, -49.0, -45.0, -62.0, -54.0, -49.0, -54.0, -44.0, -51.0, -58.0, -60.0, -51.0, -55.0, -53.0, -43.0, -45.0, -47.0, -55.0, -53.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5181835351301625, "mean_inference_ms": 19.87741725957306, "mean_action_processing_ms": 0.862879497038589, "mean_env_wait_ms": 0.5080260486838049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5430035591125488, "StateBufferConnector_ms": 0.006978511810302734, "ViewRequirementAgentConnector_ms": 0.28414273262023926}}, "episode_reward_max": -37.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.49, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -39.0, -57.0, -50.0, -56.0, -43.0, -61.0, -59.0, -58.0, -60.0, -49.0, -56.0, -50.0, -50.0, -47.0, -46.0, -55.0, -48.0, -47.0, -47.0, -44.0, -59.0, -59.0, -47.0, -60.0, -59.0, -57.0, -55.0, -48.0, -50.0, -59.0, -59.0, -60.0, -55.0, -59.0, -48.0, -55.0, -52.0, -51.0, -47.0, -53.0, -45.0, -46.0, -56.0, -56.0, -59.0, -43.0, -54.0, -48.0, -48.0, -56.0, -55.0, -40.0, -59.0, -52.0, -51.0, -51.0, -60.0, -44.0, -42.0, -57.0, -40.0, -47.0, -51.0, -37.0, -46.0, -42.0, -46.0, -55.0, -54.0, -58.0, -52.0, -50.0, -47.0, -46.0, -55.0, -38.0, -39.0, -58.0, -59.0, -63.0, -49.0, -45.0, -62.0, -54.0, -49.0, -54.0, -44.0, -51.0, -58.0, -60.0, -51.0, -55.0, -53.0, -43.0, -45.0, -47.0, -55.0, -53.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5181835351301625, "mean_inference_ms": 19.87741725957306, "mean_action_processing_ms": 0.862879497038589, "mean_env_wait_ms": 0.5080260486838049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5430035591125488, "StateBufferConnector_ms": 0.006978511810302734, "ViewRequirementAgentConnector_ms": 0.28414273262023926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2727530143778294, "num_agent_steps_trained_throughput_per_sec": 3.2727530143778294, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 163144.686, "sample_time_ms": 12095.91, "load_time_ms": 0.483, "load_throughput": 1060642.884, "learn_time_ms": 151047.543, "learn_throughput": 3.39, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 320, "training_iteration": 10, "trial_id": "6f959_00019", "date": "2024-02-28_15-35-07", "timestamp": 1709130907, "time_this_iter_s": 156.45394849777222, "time_total_s": 1631.5594294071198, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1631.5594294071198, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.51569506726457, "ram_util_percent": 17.65515695067265}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.7, "reward_total_min": -63, "reward_total_max": -37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10390625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2109375, "reward_score_mean": 0.10390625, "reward_score_min": 0.0078125, "reward_score_max": 0.2109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7584203328937292, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.024257989724477, "policy_loss": -0.04066194699456294, "vf_loss": 9.972193574905395, "vf_explained_var": 0.0018123631676038106, "kl": 0.0, "entropy": 100.6090508143107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": -37.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.7, "reward_total_min": -63, "reward_total_max": -37, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10390625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2109375, "reward_score_mean": 0.10390625, "reward_score_min": 0.0078125, "reward_score_max": 0.2109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -55.0, -59.0, -48.0, -55.0, -52.0, -51.0, -47.0, -53.0, -45.0, -46.0, -56.0, -56.0, -59.0, -43.0, -54.0, -48.0, -48.0, -56.0, -55.0, -40.0, -59.0, -52.0, -51.0, -51.0, -60.0, -44.0, -42.0, -57.0, -40.0, -47.0, -51.0, -37.0, -46.0, -42.0, -46.0, -55.0, -54.0, -58.0, -52.0, -50.0, -47.0, -46.0, -55.0, -38.0, -39.0, -58.0, -59.0, -63.0, -49.0, -45.0, -62.0, -54.0, -49.0, -54.0, -44.0, -51.0, -58.0, -60.0, -51.0, -55.0, -53.0, -43.0, -45.0, -47.0, -55.0, -53.0, -44.0, -58.0, -50.0, -58.0, -50.0, -44.0, -47.0, -56.0, -62.0, -41.0, -42.0, -52.0, -43.0, -45.0, -47.0, -61.0, -60.0, -38.0, -61.0, -55.0, -39.0, -49.0, -59.0, -44.0, -40.0, -55.0, -61.0, -51.0, -50.0, -39.0, -52.0, -59.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4936410699550966, "mean_inference_ms": 19.70482050058342, "mean_action_processing_ms": 0.8544833593182617, "mean_env_wait_ms": 0.5030552526789467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5282557010650635, "StateBufferConnector_ms": 0.006817340850830078, "ViewRequirementAgentConnector_ms": 0.2784562110900879}}, "episode_reward_max": -37.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -55.0, -59.0, -48.0, -55.0, -52.0, -51.0, -47.0, -53.0, -45.0, -46.0, -56.0, -56.0, -59.0, -43.0, -54.0, -48.0, -48.0, -56.0, -55.0, -40.0, -59.0, -52.0, -51.0, -51.0, -60.0, -44.0, -42.0, -57.0, -40.0, -47.0, -51.0, -37.0, -46.0, -42.0, -46.0, -55.0, -54.0, -58.0, -52.0, -50.0, -47.0, -46.0, -55.0, -38.0, -39.0, -58.0, -59.0, -63.0, -49.0, -45.0, -62.0, -54.0, -49.0, -54.0, -44.0, -51.0, -58.0, -60.0, -51.0, -55.0, -53.0, -43.0, -45.0, -47.0, -55.0, -53.0, -44.0, -58.0, -50.0, -58.0, -50.0, -44.0, -47.0, -56.0, -62.0, -41.0, -42.0, -52.0, -43.0, -45.0, -47.0, -61.0, -60.0, -38.0, -61.0, -55.0, -39.0, -49.0, -59.0, -44.0, -40.0, -55.0, -61.0, -51.0, -50.0, -39.0, -52.0, -59.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4936410699550966, "mean_inference_ms": 19.70482050058342, "mean_action_processing_ms": 0.8544833593182617, "mean_env_wait_ms": 0.5030552526789467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5282557010650635, "StateBufferConnector_ms": 0.006817340850830078, "ViewRequirementAgentConnector_ms": 0.2784562110900879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.268954902288824, "num_agent_steps_trained_throughput_per_sec": 3.268954902288824, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 162115.459, "sample_time_ms": 11594.902, "load_time_ms": 0.456, "load_throughput": 1123395.924, "learn_time_ms": 150519.421, "learn_throughput": 3.402, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 352, "training_iteration": 11, "trial_id": "6f959_00019", "date": "2024-02-28_15-37-43", "timestamp": 1709131063, "time_this_iter_s": 156.63559865951538, "time_total_s": 1788.1950280666351, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1788.1950280666351, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 56.78288288288288, "ram_util_percent": 17.800000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.45, "reward_total_min": -63, "reward_total_max": -36, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.105859375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.21875, "reward_score_mean": 0.105859375, "reward_score_min": 0.0078125, "reward_score_max": 0.21875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.661187327777346, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.019362767537435, "policy_loss": -0.02886863856886824, "vf_loss": 9.953834676742554, "vf_explained_var": 0.0013150046269098917, "kl": 0.0, "entropy": 99.81045265197754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": -36.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.45, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.45, "reward_total_min": -63, "reward_total_max": -36, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.105859375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.21875, "reward_score_mean": 0.105859375, "reward_score_min": 0.0078125, "reward_score_max": 0.21875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-37.0, -46.0, -42.0, -46.0, -55.0, -54.0, -58.0, -52.0, -50.0, -47.0, -46.0, -55.0, -38.0, -39.0, -58.0, -59.0, -63.0, -49.0, -45.0, -62.0, -54.0, -49.0, -54.0, -44.0, -51.0, -58.0, -60.0, -51.0, -55.0, -53.0, -43.0, -45.0, -47.0, -55.0, -53.0, -44.0, -58.0, -50.0, -58.0, -50.0, -44.0, -47.0, -56.0, -62.0, -41.0, -42.0, -52.0, -43.0, -45.0, -47.0, -61.0, -60.0, -38.0, -61.0, -55.0, -39.0, -49.0, -59.0, -44.0, -40.0, -55.0, -61.0, -51.0, -50.0, -39.0, -52.0, -59.0, -45.0, -57.0, -50.0, -40.0, -47.0, -39.0, -58.0, -63.0, -53.0, -53.0, -45.0, -58.0, -47.0, -43.0, -54.0, -60.0, -48.0, -56.0, -55.0, -43.0, -61.0, -50.0, -59.0, -40.0, -49.0, -59.0, -50.0, -39.0, -52.0, -46.0, -36.0, -57.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.475553570900506, "mean_inference_ms": 19.571066418238686, "mean_action_processing_ms": 0.8482302510964655, "mean_env_wait_ms": 0.49921004412557607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5308270454406738, "StateBufferConnector_ms": 0.006829261779785156, "ViewRequirementAgentConnector_ms": 0.2792623043060303}}, "episode_reward_max": -36.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.45, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.0, -46.0, -42.0, -46.0, -55.0, -54.0, -58.0, -52.0, -50.0, -47.0, -46.0, -55.0, -38.0, -39.0, -58.0, -59.0, -63.0, -49.0, -45.0, -62.0, -54.0, -49.0, -54.0, -44.0, -51.0, -58.0, -60.0, -51.0, -55.0, -53.0, -43.0, -45.0, -47.0, -55.0, -53.0, -44.0, -58.0, -50.0, -58.0, -50.0, -44.0, -47.0, -56.0, -62.0, -41.0, -42.0, -52.0, -43.0, -45.0, -47.0, -61.0, -60.0, -38.0, -61.0, -55.0, -39.0, -49.0, -59.0, -44.0, -40.0, -55.0, -61.0, -51.0, -50.0, -39.0, -52.0, -59.0, -45.0, -57.0, -50.0, -40.0, -47.0, -39.0, -58.0, -63.0, -53.0, -53.0, -45.0, -58.0, -47.0, -43.0, -54.0, -60.0, -48.0, -56.0, -55.0, -43.0, -61.0, -50.0, -59.0, -40.0, -49.0, -59.0, -50.0, -39.0, -52.0, -46.0, -36.0, -57.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.475553570900506, "mean_inference_ms": 19.571066418238686, "mean_action_processing_ms": 0.8482302510964655, "mean_env_wait_ms": 0.49921004412557607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5308270454406738, "StateBufferConnector_ms": 0.006829261779785156, "ViewRequirementAgentConnector_ms": 0.2792623043060303}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3071460524433736, "num_agent_steps_trained_throughput_per_sec": 3.3071460524433736, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 160762.779, "sample_time_ms": 11599.214, "load_time_ms": 0.452, "load_throughput": 1131743.688, "learn_time_ms": 149162.454, "learn_throughput": 3.432, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "6f959_00019", "date": "2024-02-28_15-40-18", "timestamp": 1709131218, "time_this_iter_s": 154.8268847465515, "time_total_s": 1943.0219128131866, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1943.0219128131866, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.88227272727272, "ram_util_percent": 17.800000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.93, "reward_total_min": -63, "reward_total_max": -34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102109375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.234375, "reward_score_mean": 0.102109375, "reward_score_min": 0.0078125, "reward_score_max": 0.234375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7756759914259116, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.015819331010183, "policy_loss": -0.04824896501377225, "vf_loss": 9.971256677309672, "vf_explained_var": 0.0005760371685028076, "kl": 0.0, "entropy": 99.89389273325602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": -34.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.93, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.93, "reward_total_min": -63, "reward_total_max": -34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102109375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.234375, "reward_score_mean": 0.102109375, "reward_score_min": 0.0078125, "reward_score_max": 0.234375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -55.0, -53.0, -44.0, -58.0, -50.0, -58.0, -50.0, -44.0, -47.0, -56.0, -62.0, -41.0, -42.0, -52.0, -43.0, -45.0, -47.0, -61.0, -60.0, -38.0, -61.0, -55.0, -39.0, -49.0, -59.0, -44.0, -40.0, -55.0, -61.0, -51.0, -50.0, -39.0, -52.0, -59.0, -45.0, -57.0, -50.0, -40.0, -47.0, -39.0, -58.0, -63.0, -53.0, -53.0, -45.0, -58.0, -47.0, -43.0, -54.0, -60.0, -48.0, -56.0, -55.0, -43.0, -61.0, -50.0, -59.0, -40.0, -49.0, -59.0, -50.0, -39.0, -52.0, -46.0, -36.0, -57.0, -48.0, -48.0, -47.0, -45.0, -57.0, -57.0, -55.0, -58.0, -50.0, -60.0, -60.0, -51.0, -52.0, -52.0, -44.0, -44.0, -59.0, -62.0, -61.0, -57.0, -47.0, -57.0, -58.0, -49.0, -61.0, -62.0, -49.0, -34.0, -46.0, -35.0, -57.0, -49.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.460413438399878, "mean_inference_ms": 19.46457456363525, "mean_action_processing_ms": 0.8435087004502898, "mean_env_wait_ms": 0.4961876109737328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5336692333221436, "StateBufferConnector_ms": 0.006891727447509766, "ViewRequirementAgentConnector_ms": 0.282379150390625}}, "episode_reward_max": -34.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.93, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -55.0, -53.0, -44.0, -58.0, -50.0, -58.0, -50.0, -44.0, -47.0, -56.0, -62.0, -41.0, -42.0, -52.0, -43.0, -45.0, -47.0, -61.0, -60.0, -38.0, -61.0, -55.0, -39.0, -49.0, -59.0, -44.0, -40.0, -55.0, -61.0, -51.0, -50.0, -39.0, -52.0, -59.0, -45.0, -57.0, -50.0, -40.0, -47.0, -39.0, -58.0, -63.0, -53.0, -53.0, -45.0, -58.0, -47.0, -43.0, -54.0, -60.0, -48.0, -56.0, -55.0, -43.0, -61.0, -50.0, -59.0, -40.0, -49.0, -59.0, -50.0, -39.0, -52.0, -46.0, -36.0, -57.0, -48.0, -48.0, -47.0, -45.0, -57.0, -57.0, -55.0, -58.0, -50.0, -60.0, -60.0, -51.0, -52.0, -52.0, -44.0, -44.0, -59.0, -62.0, -61.0, -57.0, -47.0, -57.0, -58.0, -49.0, -61.0, -62.0, -49.0, -34.0, -46.0, -35.0, -57.0, -49.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.460413438399878, "mean_inference_ms": 19.46457456363525, "mean_action_processing_ms": 0.8435087004502898, "mean_env_wait_ms": 0.4961876109737328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5336692333221436, "StateBufferConnector_ms": 0.006891727447509766, "ViewRequirementAgentConnector_ms": 0.282379150390625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.321732971820645, "num_agent_steps_trained_throughput_per_sec": 3.321732971820645, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 158545.252, "sample_time_ms": 11614.179, "load_time_ms": 0.443, "load_throughput": 1155617.31, "learn_time_ms": 146930.022, "learn_throughput": 3.485, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 416, "training_iteration": 13, "trial_id": "6f959_00019", "date": "2024-02-28_15-42-53", "timestamp": 1709131373, "time_this_iter_s": 154.14699268341064, "time_total_s": 2097.1689054965973, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2097.1689054965973, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 56.85068493150685, "ram_util_percent": 17.800000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.84, "reward_total_min": -63, "reward_total_max": -34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.234375, "reward_score_mean": 0.095, "reward_score_min": 0.0078125, "reward_score_max": 0.234375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.699393551175793, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.030245010058085, "policy_loss": -0.037871432459602755, "vf_loss": 9.975709875424704, "vf_explained_var": 0.00038918107748031616, "kl": 0.0, "entropy": 99.44318936665853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": -34.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.84, "reward_total_min": -63, "reward_total_max": -34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.234375, "reward_score_mean": 0.095, "reward_score_min": 0.0078125, "reward_score_max": 0.234375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-39.0, -52.0, -59.0, -45.0, -57.0, -50.0, -40.0, -47.0, -39.0, -58.0, -63.0, -53.0, -53.0, -45.0, -58.0, -47.0, -43.0, -54.0, -60.0, -48.0, -56.0, -55.0, -43.0, -61.0, -50.0, -59.0, -40.0, -49.0, -59.0, -50.0, -39.0, -52.0, -46.0, -36.0, -57.0, -48.0, -48.0, -47.0, -45.0, -57.0, -57.0, -55.0, -58.0, -50.0, -60.0, -60.0, -51.0, -52.0, -52.0, -44.0, -44.0, -59.0, -62.0, -61.0, -57.0, -47.0, -57.0, -58.0, -49.0, -61.0, -62.0, -49.0, -34.0, -46.0, -35.0, -57.0, -49.0, -43.0, -58.0, -46.0, -37.0, -63.0, -42.0, -56.0, -44.0, -52.0, -53.0, -57.0, -60.0, -47.0, -62.0, -61.0, -45.0, -59.0, -43.0, -52.0, -56.0, -58.0, -50.0, -52.0, -58.0, -62.0, -59.0, -59.0, -59.0, -58.0, -62.0, -48.0, -49.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451054939086413, "mean_inference_ms": 19.408199897488963, "mean_action_processing_ms": 0.8411597373118188, "mean_env_wait_ms": 0.49446858866166266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5502941608428955, "StateBufferConnector_ms": 0.00704503059387207, "ViewRequirementAgentConnector_ms": 0.287855863571167}}, "episode_reward_max": -34.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.0, -52.0, -59.0, -45.0, -57.0, -50.0, -40.0, -47.0, -39.0, -58.0, -63.0, -53.0, -53.0, -45.0, -58.0, -47.0, -43.0, -54.0, -60.0, -48.0, -56.0, -55.0, -43.0, -61.0, -50.0, -59.0, -40.0, -49.0, -59.0, -50.0, -39.0, -52.0, -46.0, -36.0, -57.0, -48.0, -48.0, -47.0, -45.0, -57.0, -57.0, -55.0, -58.0, -50.0, -60.0, -60.0, -51.0, -52.0, -52.0, -44.0, -44.0, -59.0, -62.0, -61.0, -57.0, -47.0, -57.0, -58.0, -49.0, -61.0, -62.0, -49.0, -34.0, -46.0, -35.0, -57.0, -49.0, -43.0, -58.0, -46.0, -37.0, -63.0, -42.0, -56.0, -44.0, -52.0, -53.0, -57.0, -60.0, -47.0, -62.0, -61.0, -45.0, -59.0, -43.0, -52.0, -56.0, -58.0, -50.0, -52.0, -58.0, -62.0, -59.0, -59.0, -59.0, -58.0, -62.0, -48.0, -49.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451054939086413, "mean_inference_ms": 19.408199897488963, "mean_action_processing_ms": 0.8411597373118188, "mean_env_wait_ms": 0.49446858866166266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5502941608428955, "StateBufferConnector_ms": 0.00704503059387207, "ViewRequirementAgentConnector_ms": 0.287855863571167}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.271827437360429, "num_agent_steps_trained_throughput_per_sec": 3.271827437360429, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 157505.624, "sample_time_ms": 11391.646, "load_time_ms": 0.418, "load_throughput": 1225173.236, "learn_time_ms": 146112.968, "learn_throughput": 3.504, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 448, "training_iteration": 14, "trial_id": "6f959_00019", "date": "2024-02-28_15-45-29", "timestamp": 1709131529, "time_this_iter_s": 156.4985167980194, "time_total_s": 2253.6674222946167, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2253.6674222946167, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 56.820720720720715, "ram_util_percent": 17.66216216216216}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.91, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.094453125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.094453125, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8789491559068362, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.880979025363922, "policy_loss": -0.03152577917401989, "vf_loss": 9.804523646831512, "vf_explained_var": 0.002252682050069173, "kl": 0.0, "entropy": 99.15767033894856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.91, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.91, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.094453125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.094453125, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -36.0, -57.0, -48.0, -48.0, -47.0, -45.0, -57.0, -57.0, -55.0, -58.0, -50.0, -60.0, -60.0, -51.0, -52.0, -52.0, -44.0, -44.0, -59.0, -62.0, -61.0, -57.0, -47.0, -57.0, -58.0, -49.0, -61.0, -62.0, -49.0, -34.0, -46.0, -35.0, -57.0, -49.0, -43.0, -58.0, -46.0, -37.0, -63.0, -42.0, -56.0, -44.0, -52.0, -53.0, -57.0, -60.0, -47.0, -62.0, -61.0, -45.0, -59.0, -43.0, -52.0, -56.0, -58.0, -50.0, -52.0, -58.0, -62.0, -59.0, -59.0, -59.0, -58.0, -62.0, -48.0, -49.0, -41.0, -57.0, -61.0, -58.0, -34.0, -46.0, -48.0, -59.0, -52.0, -37.0, -42.0, -61.0, -60.0, -59.0, -43.0, -44.0, -60.0, -56.0, -59.0, -58.0, -39.0, -58.0, -49.0, -40.0, -59.0, -60.0, -45.0, -25.0, -47.0, -44.0, -59.0, -61.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.441749819056302, "mean_inference_ms": 19.356306787663808, "mean_action_processing_ms": 0.838905590567171, "mean_env_wait_ms": 0.4928272618061604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5460855960845947, "StateBufferConnector_ms": 0.007015228271484375, "ViewRequirementAgentConnector_ms": 0.28773045539855957}}, "episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.91, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -36.0, -57.0, -48.0, -48.0, -47.0, -45.0, -57.0, -57.0, -55.0, -58.0, -50.0, -60.0, -60.0, -51.0, -52.0, -52.0, -44.0, -44.0, -59.0, -62.0, -61.0, -57.0, -47.0, -57.0, -58.0, -49.0, -61.0, -62.0, -49.0, -34.0, -46.0, -35.0, -57.0, -49.0, -43.0, -58.0, -46.0, -37.0, -63.0, -42.0, -56.0, -44.0, -52.0, -53.0, -57.0, -60.0, -47.0, -62.0, -61.0, -45.0, -59.0, -43.0, -52.0, -56.0, -58.0, -50.0, -52.0, -58.0, -62.0, -59.0, -59.0, -59.0, -58.0, -62.0, -48.0, -49.0, -41.0, -57.0, -61.0, -58.0, -34.0, -46.0, -48.0, -59.0, -52.0, -37.0, -42.0, -61.0, -60.0, -59.0, -43.0, -44.0, -60.0, -56.0, -59.0, -58.0, -39.0, -58.0, -49.0, -40.0, -59.0, -60.0, -45.0, -25.0, -47.0, -44.0, -59.0, -61.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.441749819056302, "mean_inference_ms": 19.356306787663808, "mean_action_processing_ms": 0.838905590567171, "mean_env_wait_ms": 0.4928272618061604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5460855960845947, "StateBufferConnector_ms": 0.007015228271484375, "ViewRequirementAgentConnector_ms": 0.28773045539855957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3198275300368687, "num_agent_steps_trained_throughput_per_sec": 3.3198275300368687, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 156977.969, "sample_time_ms": 11324.99, "load_time_ms": 0.42, "load_throughput": 1219606.797, "learn_time_ms": 145651.951, "learn_throughput": 3.515, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 480, "training_iteration": 15, "trial_id": "6f959_00019", "date": "2024-02-28_15-48-03", "timestamp": 1709131683, "time_this_iter_s": 154.23561263084412, "time_total_s": 2407.903034925461, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2407.903034925461, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 56.77681818181818, "ram_util_percent": 17.604545454545452}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.15, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108203125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.108203125, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5976504690945148, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.033953396479289, "policy_loss": -0.03332511734527846, "vf_loss": 9.974788097540538, "vf_explained_var": 0.0387866551677386, "kl": 0.0, "entropy": 99.44796098073324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.15, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108203125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.108203125, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-35.0, -57.0, -49.0, -43.0, -58.0, -46.0, -37.0, -63.0, -42.0, -56.0, -44.0, -52.0, -53.0, -57.0, -60.0, -47.0, -62.0, -61.0, -45.0, -59.0, -43.0, -52.0, -56.0, -58.0, -50.0, -52.0, -58.0, -62.0, -59.0, -59.0, -59.0, -58.0, -62.0, -48.0, -49.0, -41.0, -57.0, -61.0, -58.0, -34.0, -46.0, -48.0, -59.0, -52.0, -37.0, -42.0, -61.0, -60.0, -59.0, -43.0, -44.0, -60.0, -56.0, -59.0, -58.0, -39.0, -58.0, -49.0, -40.0, -59.0, -60.0, -45.0, -25.0, -47.0, -44.0, -59.0, -61.0, -50.0, -46.0, -48.0, -40.0, -50.0, -60.0, -48.0, -40.0, -40.0, -58.0, -57.0, -34.0, -56.0, -45.0, -45.0, -38.0, -46.0, -29.0, -39.0, -52.0, -59.0, -53.0, -52.0, -35.0, -43.0, -54.0, -37.0, -42.0, -43.0, -51.0, -43.0, -62.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4320789526501874, "mean_inference_ms": 19.30002580349437, "mean_action_processing_ms": 0.8362991772629155, "mean_env_wait_ms": 0.49101942269899723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5363900661468506, "StateBufferConnector_ms": 0.006933689117431641, "ViewRequirementAgentConnector_ms": 0.28386569023132324}}, "episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35.0, -57.0, -49.0, -43.0, -58.0, -46.0, -37.0, -63.0, -42.0, -56.0, -44.0, -52.0, -53.0, -57.0, -60.0, -47.0, -62.0, -61.0, -45.0, -59.0, -43.0, -52.0, -56.0, -58.0, -50.0, -52.0, -58.0, -62.0, -59.0, -59.0, -59.0, -58.0, -62.0, -48.0, -49.0, -41.0, -57.0, -61.0, -58.0, -34.0, -46.0, -48.0, -59.0, -52.0, -37.0, -42.0, -61.0, -60.0, -59.0, -43.0, -44.0, -60.0, -56.0, -59.0, -58.0, -39.0, -58.0, -49.0, -40.0, -59.0, -60.0, -45.0, -25.0, -47.0, -44.0, -59.0, -61.0, -50.0, -46.0, -48.0, -40.0, -50.0, -60.0, -48.0, -40.0, -40.0, -58.0, -57.0, -34.0, -56.0, -45.0, -45.0, -38.0, -46.0, -29.0, -39.0, -52.0, -59.0, -53.0, -52.0, -35.0, -43.0, -54.0, -37.0, -42.0, -43.0, -51.0, -43.0, -62.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4320789526501874, "mean_inference_ms": 19.30002580349437, "mean_action_processing_ms": 0.8362991772629155, "mean_env_wait_ms": 0.49101942269899723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5363900661468506, "StateBufferConnector_ms": 0.006933689117431641, "ViewRequirementAgentConnector_ms": 0.28386569023132324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.216513695973922, "num_agent_steps_trained_throughput_per_sec": 3.216513695973922, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 156775.712, "sample_time_ms": 11270.39, "load_time_ms": 0.44, "load_throughput": 1162876.292, "learn_time_ms": 145504.26, "learn_throughput": 3.519, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 512, "training_iteration": 16, "trial_id": "6f959_00019", "date": "2024-02-28_15-50-46", "timestamp": 1709131846, "time_this_iter_s": 159.1896665096283, "time_total_s": 2567.092701435089, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2567.092701435089, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.02510822510822, "ram_util_percent": 17.66363636363636}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.59, "reward_total_min": -62, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112578125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.112578125, "reward_score_min": 0.015625, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47161594333204754, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.06102790037791, "policy_loss": -0.02452183364269634, "vf_loss": 9.994888138771056, "vf_explained_var": 0.0002809628844261169, "kl": 0.0, "entropy": 99.3524044672648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.59, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.59, "reward_total_min": -62, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112578125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.112578125, "reward_score_min": 0.015625, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -48.0, -49.0, -41.0, -57.0, -61.0, -58.0, -34.0, -46.0, -48.0, -59.0, -52.0, -37.0, -42.0, -61.0, -60.0, -59.0, -43.0, -44.0, -60.0, -56.0, -59.0, -58.0, -39.0, -58.0, -49.0, -40.0, -59.0, -60.0, -45.0, -25.0, -47.0, -44.0, -59.0, -61.0, -50.0, -46.0, -48.0, -40.0, -50.0, -60.0, -48.0, -40.0, -40.0, -58.0, -57.0, -34.0, -56.0, -45.0, -45.0, -38.0, -46.0, -29.0, -39.0, -52.0, -59.0, -53.0, -52.0, -35.0, -43.0, -54.0, -37.0, -42.0, -43.0, -51.0, -43.0, -62.0, -48.0, -47.0, -48.0, -58.0, -60.0, -62.0, -46.0, -34.0, -58.0, -57.0, -58.0, -45.0, -47.0, -48.0, -41.0, -58.0, -61.0, -52.0, -43.0, -55.0, -45.0, -62.0, -47.0, -43.0, -46.0, -60.0, -49.0, -42.0, -57.0, -57.0, -52.0, -43.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4210354454959786, "mean_inference_ms": 19.22554200163594, "mean_action_processing_ms": 0.8327478101020961, "mean_env_wait_ms": 0.4887523512117125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5209403038024902, "StateBufferConnector_ms": 0.006800413131713867, "ViewRequirementAgentConnector_ms": 0.2794802188873291}}, "episode_reward_max": -25.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.59, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -48.0, -49.0, -41.0, -57.0, -61.0, -58.0, -34.0, -46.0, -48.0, -59.0, -52.0, -37.0, -42.0, -61.0, -60.0, -59.0, -43.0, -44.0, -60.0, -56.0, -59.0, -58.0, -39.0, -58.0, -49.0, -40.0, -59.0, -60.0, -45.0, -25.0, -47.0, -44.0, -59.0, -61.0, -50.0, -46.0, -48.0, -40.0, -50.0, -60.0, -48.0, -40.0, -40.0, -58.0, -57.0, -34.0, -56.0, -45.0, -45.0, -38.0, -46.0, -29.0, -39.0, -52.0, -59.0, -53.0, -52.0, -35.0, -43.0, -54.0, -37.0, -42.0, -43.0, -51.0, -43.0, -62.0, -48.0, -47.0, -48.0, -58.0, -60.0, -62.0, -46.0, -34.0, -58.0, -57.0, -58.0, -45.0, -47.0, -48.0, -41.0, -58.0, -61.0, -52.0, -43.0, -55.0, -45.0, -62.0, -47.0, -43.0, -46.0, -60.0, -49.0, -42.0, -57.0, -57.0, -52.0, -43.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4210354454959786, "mean_inference_ms": 19.22554200163594, "mean_action_processing_ms": 0.8327478101020961, "mean_env_wait_ms": 0.4887523512117125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5209403038024902, "StateBufferConnector_ms": 0.006800413131713867, "ViewRequirementAgentConnector_ms": 0.2794802188873291}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.196385836652482, "num_agent_steps_trained_throughput_per_sec": 3.196385836652482, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 156883.071, "sample_time_ms": 11275.363, "load_time_ms": 0.421, "load_throughput": 1215465.049, "learn_time_ms": 145606.672, "learn_throughput": 3.516, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 544, "training_iteration": 17, "trial_id": "6f959_00019", "date": "2024-02-28_15-53-27", "timestamp": 1709132007, "time_this_iter_s": 160.1939926147461, "time_total_s": 2727.286694049835, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2727.286694049835, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.93684210526316, "ram_util_percent": 17.635964912280702}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.03, "reward_total_min": -62, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109140625, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.109140625, "reward_score_min": 0.015625, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35774547467396284, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.053138256072998, "policy_loss": -0.025499480838576952, "vf_loss": 9.987284286816914, "vf_explained_var": 0.004237775504589081, "kl": 0.0, "entropy": 99.04719098409016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "sampler_results": {"episode_reward_max": -29.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.03, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.03, "reward_total_min": -62, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109140625, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.109140625, "reward_score_min": 0.015625, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -59.0, -61.0, -50.0, -46.0, -48.0, -40.0, -50.0, -60.0, -48.0, -40.0, -40.0, -58.0, -57.0, -34.0, -56.0, -45.0, -45.0, -38.0, -46.0, -29.0, -39.0, -52.0, -59.0, -53.0, -52.0, -35.0, -43.0, -54.0, -37.0, -42.0, -43.0, -51.0, -43.0, -62.0, -48.0, -47.0, -48.0, -58.0, -60.0, -62.0, -46.0, -34.0, -58.0, -57.0, -58.0, -45.0, -47.0, -48.0, -41.0, -58.0, -61.0, -52.0, -43.0, -55.0, -45.0, -62.0, -47.0, -43.0, -46.0, -60.0, -49.0, -42.0, -57.0, -57.0, -52.0, -43.0, -55.0, -47.0, -58.0, -60.0, -58.0, -48.0, -41.0, -47.0, -58.0, -57.0, -62.0, -62.0, -44.0, -51.0, -59.0, -51.0, -58.0, -49.0, -44.0, -57.0, -50.0, -58.0, -58.0, -55.0, -53.0, -52.0, -38.0, -59.0, -35.0, -59.0, -41.0, -47.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.414316652678873, "mean_inference_ms": 19.175539304865648, "mean_action_processing_ms": 0.8303840226260982, "mean_env_wait_ms": 0.48729899202376376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5351657867431641, "StateBufferConnector_ms": 0.006915092468261719, "ViewRequirementAgentConnector_ms": 0.28496265411376953}}, "episode_reward_max": -29.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.03, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -59.0, -61.0, -50.0, -46.0, -48.0, -40.0, -50.0, -60.0, -48.0, -40.0, -40.0, -58.0, -57.0, -34.0, -56.0, -45.0, -45.0, -38.0, -46.0, -29.0, -39.0, -52.0, -59.0, -53.0, -52.0, -35.0, -43.0, -54.0, -37.0, -42.0, -43.0, -51.0, -43.0, -62.0, -48.0, -47.0, -48.0, -58.0, -60.0, -62.0, -46.0, -34.0, -58.0, -57.0, -58.0, -45.0, -47.0, -48.0, -41.0, -58.0, -61.0, -52.0, -43.0, -55.0, -45.0, -62.0, -47.0, -43.0, -46.0, -60.0, -49.0, -42.0, -57.0, -57.0, -52.0, -43.0, -55.0, -47.0, -58.0, -60.0, -58.0, -48.0, -41.0, -47.0, -58.0, -57.0, -62.0, -62.0, -44.0, -51.0, -59.0, -51.0, -58.0, -49.0, -44.0, -57.0, -50.0, -58.0, -58.0, -55.0, -53.0, -52.0, -38.0, -59.0, -35.0, -59.0, -41.0, -47.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.414316652678873, "mean_inference_ms": 19.175539304865648, "mean_action_processing_ms": 0.8303840226260982, "mean_env_wait_ms": 0.48729899202376376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5351657867431641, "StateBufferConnector_ms": 0.006915092468261719, "ViewRequirementAgentConnector_ms": 0.28496265411376953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0900679429599647, "num_agent_steps_trained_throughput_per_sec": 3.0900679429599647, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 157402.128, "sample_time_ms": 11287.856, "load_time_ms": 0.422, "load_throughput": 1214708.778, "learn_time_ms": 146113.226, "learn_throughput": 3.504, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "episodes_total": 576, "training_iteration": 18, "trial_id": "6f959_00019", "date": "2024-02-28_15-56-12", "timestamp": 1709132172, "time_this_iter_s": 165.70293974876404, "time_total_s": 2892.9896337985992, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2892.9896337985992, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.174893617021276, "ram_util_percent": 17.5131914893617}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.52, "reward_total_min": -62, "reward_total_max": -34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0975, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.234375, "reward_score_mean": 0.0975, "reward_score_min": 0.015625, "reward_score_max": 0.234375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47992927428955834, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.063253593444824, "policy_loss": -0.022069663476819792, "vf_loss": 9.994638911883037, "vf_explained_var": 3.0907988548278806e-05, "kl": 0.0, "entropy": 99.16787026723226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "sampler_results": {"episode_reward_max": -34.0, "episode_reward_min": -62.0, "episode_reward_mean": -51.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.52, "reward_total_min": -62, "reward_total_max": -34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0975, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.234375, "reward_score_mean": 0.0975, "reward_score_min": 0.015625, "reward_score_max": 0.234375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-51.0, -43.0, -62.0, -48.0, -47.0, -48.0, -58.0, -60.0, -62.0, -46.0, -34.0, -58.0, -57.0, -58.0, -45.0, -47.0, -48.0, -41.0, -58.0, -61.0, -52.0, -43.0, -55.0, -45.0, -62.0, -47.0, -43.0, -46.0, -60.0, -49.0, -42.0, -57.0, -57.0, -52.0, -43.0, -55.0, -47.0, -58.0, -60.0, -58.0, -48.0, -41.0, -47.0, -58.0, -57.0, -62.0, -62.0, -44.0, -51.0, -59.0, -51.0, -58.0, -49.0, -44.0, -57.0, -50.0, -58.0, -58.0, -55.0, -53.0, -52.0, -38.0, -59.0, -35.0, -59.0, -41.0, -47.0, -44.0, -60.0, -54.0, -62.0, -43.0, -58.0, -46.0, -41.0, -52.0, -49.0, -51.0, -57.0, -50.0, -62.0, -47.0, -61.0, -43.0, -49.0, -54.0, -42.0, -60.0, -38.0, -46.0, -58.0, -44.0, -61.0, -61.0, -40.0, -62.0, -61.0, -41.0, -55.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4099791885838764, "mean_inference_ms": 19.141780720455916, "mean_action_processing_ms": 0.828905350302151, "mean_env_wait_ms": 0.4863492859013669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.545722484588623, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.2884964942932129}}, "episode_reward_max": -34.0, "episode_reward_min": -62.0, "episode_reward_mean": -51.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.0, -43.0, -62.0, -48.0, -47.0, -48.0, -58.0, -60.0, -62.0, -46.0, -34.0, -58.0, -57.0, -58.0, -45.0, -47.0, -48.0, -41.0, -58.0, -61.0, -52.0, -43.0, -55.0, -45.0, -62.0, -47.0, -43.0, -46.0, -60.0, -49.0, -42.0, -57.0, -57.0, -52.0, -43.0, -55.0, -47.0, -58.0, -60.0, -58.0, -48.0, -41.0, -47.0, -58.0, -57.0, -62.0, -62.0, -44.0, -51.0, -59.0, -51.0, -58.0, -49.0, -44.0, -57.0, -50.0, -58.0, -58.0, -55.0, -53.0, -52.0, -38.0, -59.0, -35.0, -59.0, -41.0, -47.0, -44.0, -60.0, -54.0, -62.0, -43.0, -58.0, -46.0, -41.0, -52.0, -49.0, -51.0, -57.0, -50.0, -62.0, -47.0, -61.0, -43.0, -49.0, -54.0, -42.0, -60.0, -38.0, -46.0, -58.0, -44.0, -61.0, -61.0, -40.0, -62.0, -61.0, -41.0, -55.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4099791885838764, "mean_inference_ms": 19.141780720455916, "mean_action_processing_ms": 0.828905350302151, "mean_env_wait_ms": 0.4863492859013669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.545722484588623, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.2884964942932129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1733804483014536, "num_agent_steps_trained_throughput_per_sec": 3.1733804483014536, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 157912.654, "sample_time_ms": 11327.59, "load_time_ms": 0.429, "load_throughput": 1194639.324, "learn_time_ms": 146583.968, "learn_throughput": 3.493, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "done": false, "episodes_total": 608, "training_iteration": 19, "trial_id": "6f959_00019", "date": "2024-02-28_15-58-54", "timestamp": 1709132334, "time_this_iter_s": 161.35793161392212, "time_total_s": 3054.3475654125214, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3054.3475654125214, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 57.13668122270742, "ram_util_percent": 17.531877729257637}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.39, "reward_total_min": -63, "reward_total_max": -35, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098515625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2265625, "reward_score_mean": 0.098515625, "reward_score_min": 0.0078125, "reward_score_max": 0.2265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4912135086526784, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.974518724282582, "policy_loss": -0.015596899312610428, "vf_loss": 9.889902305603027, "vf_explained_var": -0.002237240473429362, "kl": 0.0, "entropy": 99.54310366312663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": -35.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.39, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.39, "reward_total_min": -63, "reward_total_max": -35, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098515625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2265625, "reward_score_mean": 0.098515625, "reward_score_min": 0.0078125, "reward_score_max": 0.2265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -52.0, -43.0, -55.0, -47.0, -58.0, -60.0, -58.0, -48.0, -41.0, -47.0, -58.0, -57.0, -62.0, -62.0, -44.0, -51.0, -59.0, -51.0, -58.0, -49.0, -44.0, -57.0, -50.0, -58.0, -58.0, -55.0, -53.0, -52.0, -38.0, -59.0, -35.0, -59.0, -41.0, -47.0, -44.0, -60.0, -54.0, -62.0, -43.0, -58.0, -46.0, -41.0, -52.0, -49.0, -51.0, -57.0, -50.0, -62.0, -47.0, -61.0, -43.0, -49.0, -54.0, -42.0, -60.0, -38.0, -46.0, -58.0, -44.0, -61.0, -61.0, -40.0, -62.0, -61.0, -41.0, -55.0, -44.0, -51.0, -44.0, -45.0, -39.0, -56.0, -44.0, -60.0, -58.0, -59.0, -41.0, -37.0, -59.0, -37.0, -58.0, -48.0, -46.0, -52.0, -43.0, -42.0, -44.0, -45.0, -58.0, -59.0, -44.0, -59.0, -54.0, -59.0, -63.0, -62.0, -51.0, -44.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4055173883153858, "mean_inference_ms": 19.109538522087878, "mean_action_processing_ms": 0.8274520946447401, "mean_env_wait_ms": 0.4854443110996852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5411741733551025, "StateBufferConnector_ms": 0.006968498229980469, "ViewRequirementAgentConnector_ms": 0.2870173454284668}}, "episode_reward_max": -35.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.39, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -52.0, -43.0, -55.0, -47.0, -58.0, -60.0, -58.0, -48.0, -41.0, -47.0, -58.0, -57.0, -62.0, -62.0, -44.0, -51.0, -59.0, -51.0, -58.0, -49.0, -44.0, -57.0, -50.0, -58.0, -58.0, -55.0, -53.0, -52.0, -38.0, -59.0, -35.0, -59.0, -41.0, -47.0, -44.0, -60.0, -54.0, -62.0, -43.0, -58.0, -46.0, -41.0, -52.0, -49.0, -51.0, -57.0, -50.0, -62.0, -47.0, -61.0, -43.0, -49.0, -54.0, -42.0, -60.0, -38.0, -46.0, -58.0, -44.0, -61.0, -61.0, -40.0, -62.0, -61.0, -41.0, -55.0, -44.0, -51.0, -44.0, -45.0, -39.0, -56.0, -44.0, -60.0, -58.0, -59.0, -41.0, -37.0, -59.0, -37.0, -58.0, -48.0, -46.0, -52.0, -43.0, -42.0, -44.0, -45.0, -58.0, -59.0, -44.0, -59.0, -54.0, -59.0, -63.0, -62.0, -51.0, -44.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4055173883153858, "mean_inference_ms": 19.109538522087878, "mean_action_processing_ms": 0.8274520946447401, "mean_env_wait_ms": 0.4854443110996852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5411741733551025, "StateBufferConnector_ms": 0.006968498229980469, "ViewRequirementAgentConnector_ms": 0.2870173454284668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2232397357524265, "num_agent_steps_trained_throughput_per_sec": 3.2232397357524265, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 158152.972, "sample_time_ms": 11289.797, "load_time_ms": 0.427, "load_throughput": 1199979.687, "learn_time_ms": 146862.081, "learn_throughput": 3.486, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 640, "training_iteration": 20, "trial_id": "6f959_00019", "date": "2024-02-28_16-01-33", "timestamp": 1709132493, "time_this_iter_s": 158.85696983337402, "time_total_s": 3213.2045352458954, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3213.2045352458954, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.00353982300884, "ram_util_percent": 17.720353982300885}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.43, "reward_total_min": -63, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.106015625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.106015625, "reward_score_min": 0.0078125, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4932929280679673, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.057849836349487, "policy_loss": -0.03234683267461757, "vf_loss": 10.0, "vf_explained_var": 3.860245148340861e-05, "kl": 0.0, "entropy": 99.46202557881674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.43, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.43, "reward_total_min": -63, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.106015625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.106015625, "reward_score_min": 0.0078125, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -41.0, -47.0, -44.0, -60.0, -54.0, -62.0, -43.0, -58.0, -46.0, -41.0, -52.0, -49.0, -51.0, -57.0, -50.0, -62.0, -47.0, -61.0, -43.0, -49.0, -54.0, -42.0, -60.0, -38.0, -46.0, -58.0, -44.0, -61.0, -61.0, -40.0, -62.0, -61.0, -41.0, -55.0, -44.0, -51.0, -44.0, -45.0, -39.0, -56.0, -44.0, -60.0, -58.0, -59.0, -41.0, -37.0, -59.0, -37.0, -58.0, -48.0, -46.0, -52.0, -43.0, -42.0, -44.0, -45.0, -58.0, -59.0, -44.0, -59.0, -54.0, -59.0, -63.0, -62.0, -51.0, -44.0, -59.0, -39.0, -61.0, -33.0, -46.0, -59.0, -56.0, -39.0, -37.0, -41.0, -33.0, -48.0, -56.0, -57.0, -53.0, -48.0, -57.0, -57.0, -61.0, -62.0, -57.0, -35.0, -61.0, -47.0, -31.0, -47.0, -60.0, -45.0, -45.0, -44.0, -49.0, -56.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4063216309457265, "mean_inference_ms": 19.086279033891127, "mean_action_processing_ms": 0.8264582030619292, "mean_env_wait_ms": 0.48477429674433703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5493593215942383, "StateBufferConnector_ms": 0.007035255432128906, "ViewRequirementAgentConnector_ms": 0.2895345687866211}}, "episode_reward_max": -31.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.43, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -41.0, -47.0, -44.0, -60.0, -54.0, -62.0, -43.0, -58.0, -46.0, -41.0, -52.0, -49.0, -51.0, -57.0, -50.0, -62.0, -47.0, -61.0, -43.0, -49.0, -54.0, -42.0, -60.0, -38.0, -46.0, -58.0, -44.0, -61.0, -61.0, -40.0, -62.0, -61.0, -41.0, -55.0, -44.0, -51.0, -44.0, -45.0, -39.0, -56.0, -44.0, -60.0, -58.0, -59.0, -41.0, -37.0, -59.0, -37.0, -58.0, -48.0, -46.0, -52.0, -43.0, -42.0, -44.0, -45.0, -58.0, -59.0, -44.0, -59.0, -54.0, -59.0, -63.0, -62.0, -51.0, -44.0, -59.0, -39.0, -61.0, -33.0, -46.0, -59.0, -56.0, -39.0, -37.0, -41.0, -33.0, -48.0, -56.0, -57.0, -53.0, -48.0, -57.0, -57.0, -61.0, -62.0, -57.0, -35.0, -61.0, -47.0, -31.0, -47.0, -60.0, -45.0, -45.0, -44.0, -49.0, -56.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4063216309457265, "mean_inference_ms": 19.086279033891127, "mean_action_processing_ms": 0.8264582030619292, "mean_env_wait_ms": 0.48477429674433703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5493593215942383, "StateBufferConnector_ms": 0.007035255432128906, "ViewRequirementAgentConnector_ms": 0.2895345687866211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1719555904874923, "num_agent_steps_trained_throughput_per_sec": 3.1719555904874923, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 158631.935, "sample_time_ms": 11392.121, "load_time_ms": 0.414, "load_throughput": 1236887.253, "learn_time_ms": 147238.731, "learn_throughput": 3.477, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 672, "training_iteration": 21, "trial_id": "6f959_00019", "date": "2024-02-28_16-04-14", "timestamp": 1709132654, "time_this_iter_s": 161.42505431175232, "time_total_s": 3374.6295895576477, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3374.6295895576477, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.4764192139738, "ram_util_percent": 17.655895196506545}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.58, "reward_total_min": -63, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10484375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.10484375, "reward_score_min": 0.0078125, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8861507156863808, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.037608710924784, "policy_loss": -0.05193825764581561, "vf_loss": 9.99928530852, "vf_explained_var": 9.552141030629475e-06, "kl": 0.0, "entropy": 98.93118813832601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.58, "reward_total_min": -63, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10484375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.10484375, "reward_score_min": 0.0078125, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -41.0, -55.0, -44.0, -51.0, -44.0, -45.0, -39.0, -56.0, -44.0, -60.0, -58.0, -59.0, -41.0, -37.0, -59.0, -37.0, -58.0, -48.0, -46.0, -52.0, -43.0, -42.0, -44.0, -45.0, -58.0, -59.0, -44.0, -59.0, -54.0, -59.0, -63.0, -62.0, -51.0, -44.0, -59.0, -39.0, -61.0, -33.0, -46.0, -59.0, -56.0, -39.0, -37.0, -41.0, -33.0, -48.0, -56.0, -57.0, -53.0, -48.0, -57.0, -57.0, -61.0, -62.0, -57.0, -35.0, -61.0, -47.0, -31.0, -47.0, -60.0, -45.0, -45.0, -44.0, -49.0, -56.0, -60.0, -40.0, -61.0, -46.0, -59.0, -61.0, -46.0, -42.0, -33.0, -59.0, -50.0, -56.0, -58.0, -49.0, -46.0, -56.0, -42.0, -61.0, -59.0, -41.0, -58.0, -62.0, -40.0, -52.0, -59.0, -41.0, -42.0, -43.0, -61.0, -56.0, -59.0, -60.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4076591213495315, "mean_inference_ms": 19.06532165344999, "mean_action_processing_ms": 0.8254260384046052, "mean_env_wait_ms": 0.48430584384627123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.54844069480896, "StateBufferConnector_ms": 0.007069110870361328, "ViewRequirementAgentConnector_ms": 0.2910795211791992}}, "episode_reward_max": -31.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -41.0, -55.0, -44.0, -51.0, -44.0, -45.0, -39.0, -56.0, -44.0, -60.0, -58.0, -59.0, -41.0, -37.0, -59.0, -37.0, -58.0, -48.0, -46.0, -52.0, -43.0, -42.0, -44.0, -45.0, -58.0, -59.0, -44.0, -59.0, -54.0, -59.0, -63.0, -62.0, -51.0, -44.0, -59.0, -39.0, -61.0, -33.0, -46.0, -59.0, -56.0, -39.0, -37.0, -41.0, -33.0, -48.0, -56.0, -57.0, -53.0, -48.0, -57.0, -57.0, -61.0, -62.0, -57.0, -35.0, -61.0, -47.0, -31.0, -47.0, -60.0, -45.0, -45.0, -44.0, -49.0, -56.0, -60.0, -40.0, -61.0, -46.0, -59.0, -61.0, -46.0, -42.0, -33.0, -59.0, -50.0, -56.0, -58.0, -49.0, -46.0, -56.0, -42.0, -61.0, -59.0, -41.0, -58.0, -62.0, -40.0, -52.0, -59.0, -41.0, -42.0, -43.0, -61.0, -56.0, -59.0, -60.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4076591213495315, "mean_inference_ms": 19.06532165344999, "mean_action_processing_ms": 0.8254260384046052, "mean_env_wait_ms": 0.48430584384627123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.54844069480896, "StateBufferConnector_ms": 0.007069110870361328, "ViewRequirementAgentConnector_ms": 0.2910795211791992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.106661620898627, "num_agent_steps_trained_throughput_per_sec": 3.106661620898627, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 159631.019, "sample_time_ms": 11414.522, "load_time_ms": 0.438, "load_throughput": 1169653.403, "learn_time_ms": 148215.356, "learn_throughput": 3.454, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "episodes_total": 704, "training_iteration": 22, "trial_id": "6f959_00019", "date": "2024-02-28_16-06-59", "timestamp": 1709132819, "time_this_iter_s": 164.817973613739, "time_total_s": 3539.4475631713867, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3539.4475631713867, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.62521367521367, "ram_util_percent": 17.647863247863242}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.25, "reward_total_min": -62, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107421875, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.107421875, "reward_score_min": 0.015625, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19526800613966772, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.034880379835764, "policy_loss": -0.015360572782810777, "vf_loss": 9.956045281887054, "vf_explained_var": 0.0003134941061337789, "kl": 0.0, "entropy": 98.462473042806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.25, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.25, "reward_total_min": -62, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107421875, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.107421875, "reward_score_min": 0.015625, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -51.0, -44.0, -59.0, -39.0, -61.0, -33.0, -46.0, -59.0, -56.0, -39.0, -37.0, -41.0, -33.0, -48.0, -56.0, -57.0, -53.0, -48.0, -57.0, -57.0, -61.0, -62.0, -57.0, -35.0, -61.0, -47.0, -31.0, -47.0, -60.0, -45.0, -45.0, -44.0, -49.0, -56.0, -60.0, -40.0, -61.0, -46.0, -59.0, -61.0, -46.0, -42.0, -33.0, -59.0, -50.0, -56.0, -58.0, -49.0, -46.0, -56.0, -42.0, -61.0, -59.0, -41.0, -58.0, -62.0, -40.0, -52.0, -59.0, -41.0, -42.0, -43.0, -61.0, -56.0, -59.0, -60.0, -59.0, -57.0, -58.0, -42.0, -46.0, -58.0, -43.0, -35.0, -58.0, -45.0, -45.0, -50.0, -48.0, -47.0, -51.0, -49.0, -37.0, -44.0, -56.0, -55.0, -41.0, -60.0, -43.0, -58.0, -61.0, -39.0, -42.0, -49.0, -59.0, -47.0, -60.0, -44.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4110759431595796, "mean_inference_ms": 19.05792288135108, "mean_action_processing_ms": 0.8249819703692651, "mean_env_wait_ms": 0.48420764791160736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5653893947601318, "StateBufferConnector_ms": 0.007230520248413086, "ViewRequirementAgentConnector_ms": 0.29503417015075684}}, "episode_reward_max": -31.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.25, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -51.0, -44.0, -59.0, -39.0, -61.0, -33.0, -46.0, -59.0, -56.0, -39.0, -37.0, -41.0, -33.0, -48.0, -56.0, -57.0, -53.0, -48.0, -57.0, -57.0, -61.0, -62.0, -57.0, -35.0, -61.0, -47.0, -31.0, -47.0, -60.0, -45.0, -45.0, -44.0, -49.0, -56.0, -60.0, -40.0, -61.0, -46.0, -59.0, -61.0, -46.0, -42.0, -33.0, -59.0, -50.0, -56.0, -58.0, -49.0, -46.0, -56.0, -42.0, -61.0, -59.0, -41.0, -58.0, -62.0, -40.0, -52.0, -59.0, -41.0, -42.0, -43.0, -61.0, -56.0, -59.0, -60.0, -59.0, -57.0, -58.0, -42.0, -46.0, -58.0, -43.0, -35.0, -58.0, -45.0, -45.0, -50.0, -48.0, -47.0, -51.0, -49.0, -37.0, -44.0, -56.0, -55.0, -41.0, -60.0, -43.0, -58.0, -61.0, -39.0, -42.0, -49.0, -59.0, -47.0, -60.0, -44.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4110759431595796, "mean_inference_ms": 19.05792288135108, "mean_action_processing_ms": 0.8249819703692651, "mean_env_wait_ms": 0.48420764791160736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5653893947601318, "StateBufferConnector_ms": 0.007230520248413086, "ViewRequirementAgentConnector_ms": 0.29503417015075684}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1582698334020787, "num_agent_steps_trained_throughput_per_sec": 3.1582698334020787, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 160428.784, "sample_time_ms": 11420.399, "load_time_ms": 0.445, "load_throughput": 1150725.35, "learn_time_ms": 149007.229, "learn_throughput": 3.436, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "done": false, "episodes_total": 736, "training_iteration": 23, "trial_id": "6f959_00019", "date": "2024-02-28_16-09-41", "timestamp": 1709132981, "time_this_iter_s": 162.12464213371277, "time_total_s": 3701.5722053050995, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3701.5722053050995, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 57.35956521739129, "ram_util_percent": 17.567826086956522}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.62, "reward_total_min": -62, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10453125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.10453125, "reward_score_min": 0.015625, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5337454377557151, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.028980457782746, "policy_loss": -0.02586246207356453, "vf_loss": 9.961107885837555, "vf_explained_var": 0.001294917861620585, "kl": 0.0, "entropy": 98.99110476175944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": -33.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.62, "reward_total_min": -62, "reward_total_max": -33, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10453125, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.2421875, "reward_score_mean": 0.10453125, "reward_score_min": 0.015625, "reward_score_max": 0.2421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -49.0, -56.0, -60.0, -40.0, -61.0, -46.0, -59.0, -61.0, -46.0, -42.0, -33.0, -59.0, -50.0, -56.0, -58.0, -49.0, -46.0, -56.0, -42.0, -61.0, -59.0, -41.0, -58.0, -62.0, -40.0, -52.0, -59.0, -41.0, -42.0, -43.0, -61.0, -56.0, -59.0, -60.0, -59.0, -57.0, -58.0, -42.0, -46.0, -58.0, -43.0, -35.0, -58.0, -45.0, -45.0, -50.0, -48.0, -47.0, -51.0, -49.0, -37.0, -44.0, -56.0, -55.0, -41.0, -60.0, -43.0, -58.0, -61.0, -39.0, -42.0, -49.0, -59.0, -47.0, -60.0, -44.0, -45.0, -59.0, -43.0, -58.0, -56.0, -49.0, -51.0, -46.0, -46.0, -60.0, -48.0, -60.0, -44.0, -57.0, -59.0, -46.0, -60.0, -40.0, -59.0, -58.0, -61.0, -46.0, -42.0, -48.0, -58.0, -44.0, -46.0, -42.0, -46.0, -49.0, -45.0, -59.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.408308177358571, "mean_inference_ms": 19.033644490725127, "mean_action_processing_ms": 0.8235809837187921, "mean_env_wait_ms": 0.483599956662331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5462026596069336, "StateBufferConnector_ms": 0.007077455520629883, "ViewRequirementAgentConnector_ms": 0.286602258682251}}, "episode_reward_max": -33.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -49.0, -56.0, -60.0, -40.0, -61.0, -46.0, -59.0, -61.0, -46.0, -42.0, -33.0, -59.0, -50.0, -56.0, -58.0, -49.0, -46.0, -56.0, -42.0, -61.0, -59.0, -41.0, -58.0, -62.0, -40.0, -52.0, -59.0, -41.0, -42.0, -43.0, -61.0, -56.0, -59.0, -60.0, -59.0, -57.0, -58.0, -42.0, -46.0, -58.0, -43.0, -35.0, -58.0, -45.0, -45.0, -50.0, -48.0, -47.0, -51.0, -49.0, -37.0, -44.0, -56.0, -55.0, -41.0, -60.0, -43.0, -58.0, -61.0, -39.0, -42.0, -49.0, -59.0, -47.0, -60.0, -44.0, -45.0, -59.0, -43.0, -58.0, -56.0, -49.0, -51.0, -46.0, -46.0, -60.0, -48.0, -60.0, -44.0, -57.0, -59.0, -46.0, -60.0, -40.0, -59.0, -58.0, -61.0, -46.0, -42.0, -48.0, -58.0, -44.0, -46.0, -42.0, -46.0, -49.0, -45.0, -59.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.408308177358571, "mean_inference_ms": 19.033644490725127, "mean_action_processing_ms": 0.8235809837187921, "mean_env_wait_ms": 0.483599956662331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5462026596069336, "StateBufferConnector_ms": 0.007077455520629883, "ViewRequirementAgentConnector_ms": 0.286602258682251}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1876636989101157, "num_agent_steps_trained_throughput_per_sec": 3.1876636989101157, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 160841.957, "sample_time_ms": 11329.153, "load_time_ms": 0.444, "load_throughput": 1153816.703, "learn_time_ms": 149511.631, "learn_throughput": 3.424, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 768, "training_iteration": 24, "trial_id": "6f959_00019", "date": "2024-02-28_16-12-22", "timestamp": 1709133142, "time_this_iter_s": 160.63486504554749, "time_total_s": 3862.207070350647, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3862.207070350647, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 57.1578947368421, "ram_util_percent": 17.532894736842106}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.79, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.103203125, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47422323826079565, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.02186291217804, "policy_loss": -0.025631192761162918, "vf_loss": 9.953023521105449, "vf_explained_var": 0.00012049277623494466, "kl": 0.0, "entropy": 99.93819255828858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.79, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.79, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.103203125, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-56.0, -59.0, -60.0, -59.0, -57.0, -58.0, -42.0, -46.0, -58.0, -43.0, -35.0, -58.0, -45.0, -45.0, -50.0, -48.0, -47.0, -51.0, -49.0, -37.0, -44.0, -56.0, -55.0, -41.0, -60.0, -43.0, -58.0, -61.0, -39.0, -42.0, -49.0, -59.0, -47.0, -60.0, -44.0, -45.0, -59.0, -43.0, -58.0, -56.0, -49.0, -51.0, -46.0, -46.0, -60.0, -48.0, -60.0, -44.0, -57.0, -59.0, -46.0, -60.0, -40.0, -59.0, -58.0, -61.0, -46.0, -42.0, -48.0, -58.0, -44.0, -46.0, -42.0, -46.0, -49.0, -45.0, -59.0, -39.0, -48.0, -31.0, -51.0, -57.0, -46.0, -36.0, -46.0, -58.0, -47.0, -60.0, -43.0, -61.0, -64.0, -45.0, -59.0, -57.0, -60.0, -55.0, -62.0, -59.0, -44.0, -60.0, -36.0, -63.0, -47.0, -38.0, -48.0, -41.0, -58.0, -57.0, -57.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4045151818060697, "mean_inference_ms": 19.007305136741007, "mean_action_processing_ms": 0.8220696776194998, "mean_env_wait_ms": 0.48281809418090715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5425143241882324, "StateBufferConnector_ms": 0.007005453109741211, "ViewRequirementAgentConnector_ms": 0.28476881980895996}}, "episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.79, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -59.0, -60.0, -59.0, -57.0, -58.0, -42.0, -46.0, -58.0, -43.0, -35.0, -58.0, -45.0, -45.0, -50.0, -48.0, -47.0, -51.0, -49.0, -37.0, -44.0, -56.0, -55.0, -41.0, -60.0, -43.0, -58.0, -61.0, -39.0, -42.0, -49.0, -59.0, -47.0, -60.0, -44.0, -45.0, -59.0, -43.0, -58.0, -56.0, -49.0, -51.0, -46.0, -46.0, -60.0, -48.0, -60.0, -44.0, -57.0, -59.0, -46.0, -60.0, -40.0, -59.0, -58.0, -61.0, -46.0, -42.0, -48.0, -58.0, -44.0, -46.0, -42.0, -46.0, -49.0, -45.0, -59.0, -39.0, -48.0, -31.0, -51.0, -57.0, -46.0, -36.0, -46.0, -58.0, -47.0, -60.0, -43.0, -61.0, -64.0, -45.0, -59.0, -57.0, -60.0, -55.0, -62.0, -59.0, -44.0, -60.0, -36.0, -63.0, -47.0, -38.0, -48.0, -41.0, -58.0, -57.0, -57.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4045151818060697, "mean_inference_ms": 19.007305136741007, "mean_action_processing_ms": 0.8220696776194998, "mean_env_wait_ms": 0.48281809418090715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5425143241882324, "StateBufferConnector_ms": 0.007005453109741211, "ViewRequirementAgentConnector_ms": 0.28476881980895996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.183659561051586, "num_agent_steps_trained_throughput_per_sec": 3.183659561051586, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 161501.593, "sample_time_ms": 11362.203, "load_time_ms": 0.434, "load_throughput": 1180844.412, "learn_time_ms": 150138.236, "learn_throughput": 3.41, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 800, "training_iteration": 25, "trial_id": "6f959_00019", "date": "2024-02-28_16-15-03", "timestamp": 1709133303, "time_this_iter_s": 160.83159732818604, "time_total_s": 4023.038667678833, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4023.038667678833, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 57.34366812227074, "ram_util_percent": 17.634061135371173}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.79, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.103203125, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5725474014723052, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.052675143877666, "policy_loss": -0.020263415637115638, "vf_loss": 9.981014736493428, "vf_explained_var": 0.002500830094019572, "kl": 0.0, "entropy": 98.60426979064941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.79, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.79, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.103203125, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -60.0, -44.0, -45.0, -59.0, -43.0, -58.0, -56.0, -49.0, -51.0, -46.0, -46.0, -60.0, -48.0, -60.0, -44.0, -57.0, -59.0, -46.0, -60.0, -40.0, -59.0, -58.0, -61.0, -46.0, -42.0, -48.0, -58.0, -44.0, -46.0, -42.0, -46.0, -49.0, -45.0, -59.0, -39.0, -48.0, -31.0, -51.0, -57.0, -46.0, -36.0, -46.0, -58.0, -47.0, -60.0, -43.0, -61.0, -64.0, -45.0, -59.0, -57.0, -60.0, -55.0, -62.0, -59.0, -44.0, -60.0, -36.0, -63.0, -47.0, -38.0, -48.0, -41.0, -58.0, -57.0, -57.0, -55.0, -47.0, -45.0, -62.0, -42.0, -62.0, -49.0, -47.0, -44.0, -47.0, -59.0, -39.0, -61.0, -48.0, -49.0, -40.0, -60.0, -47.0, -36.0, -47.0, -60.0, -42.0, -59.0, -60.0, -46.0, -61.0, -48.0, -47.0, -46.0, -61.0, -63.0, -43.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4027929847320206, "mean_inference_ms": 19.001160656395363, "mean_action_processing_ms": 0.821764948870038, "mean_env_wait_ms": 0.48264593686776736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5589957237243652, "StateBufferConnector_ms": 0.007159233093261719, "ViewRequirementAgentConnector_ms": 0.2924079895019531}}, "episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.79, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -60.0, -44.0, -45.0, -59.0, -43.0, -58.0, -56.0, -49.0, -51.0, -46.0, -46.0, -60.0, -48.0, -60.0, -44.0, -57.0, -59.0, -46.0, -60.0, -40.0, -59.0, -58.0, -61.0, -46.0, -42.0, -48.0, -58.0, -44.0, -46.0, -42.0, -46.0, -49.0, -45.0, -59.0, -39.0, -48.0, -31.0, -51.0, -57.0, -46.0, -36.0, -46.0, -58.0, -47.0, -60.0, -43.0, -61.0, -64.0, -45.0, -59.0, -57.0, -60.0, -55.0, -62.0, -59.0, -44.0, -60.0, -36.0, -63.0, -47.0, -38.0, -48.0, -41.0, -58.0, -57.0, -57.0, -55.0, -47.0, -45.0, -62.0, -42.0, -62.0, -49.0, -47.0, -44.0, -47.0, -59.0, -39.0, -61.0, -48.0, -49.0, -40.0, -60.0, -47.0, -36.0, -47.0, -60.0, -42.0, -59.0, -60.0, -46.0, -61.0, -48.0, -47.0, -46.0, -61.0, -63.0, -43.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4027929847320206, "mean_inference_ms": 19.001160656395363, "mean_action_processing_ms": 0.821764948870038, "mean_env_wait_ms": 0.48264593686776736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5589957237243652, "StateBufferConnector_ms": 0.007159233093261719, "ViewRequirementAgentConnector_ms": 0.2924079895019531}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1023968728664673, "num_agent_steps_trained_throughput_per_sec": 3.1023968728664673, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 162087.108, "sample_time_ms": 11499.264, "load_time_ms": 0.418, "load_throughput": 1226152.591, "learn_time_ms": 150586.713, "learn_throughput": 3.4, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "episodes_total": 832, "training_iteration": 26, "trial_id": "6f959_00019", "date": "2024-02-28_16-17-48", "timestamp": 1709133468, "time_this_iter_s": 165.0447380542755, "time_total_s": 4188.0834057331085, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4188.0834057331085, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 56.7508547008547, "ram_util_percent": 17.612393162393158}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.0, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.109375, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6890381857442359, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.067058817545574, "policy_loss": -0.022944054178272683, "vf_loss": 9.999786853790283, "vf_explained_var": -3.215968608856201e-05, "kl": 0.0, "entropy": 98.31470177968343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.0, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.109375, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -45.0, -59.0, -39.0, -48.0, -31.0, -51.0, -57.0, -46.0, -36.0, -46.0, -58.0, -47.0, -60.0, -43.0, -61.0, -64.0, -45.0, -59.0, -57.0, -60.0, -55.0, -62.0, -59.0, -44.0, -60.0, -36.0, -63.0, -47.0, -38.0, -48.0, -41.0, -58.0, -57.0, -57.0, -55.0, -47.0, -45.0, -62.0, -42.0, -62.0, -49.0, -47.0, -44.0, -47.0, -59.0, -39.0, -61.0, -48.0, -49.0, -40.0, -60.0, -47.0, -36.0, -47.0, -60.0, -42.0, -59.0, -60.0, -46.0, -61.0, -48.0, -47.0, -46.0, -61.0, -63.0, -43.0, -43.0, -45.0, -45.0, -41.0, -31.0, -61.0, -45.0, -50.0, -49.0, -61.0, -37.0, -48.0, -24.0, -34.0, -60.0, -44.0, -60.0, -48.0, -43.0, -45.0, -58.0, -50.0, -60.0, -31.0, -46.0, -56.0, -40.0, -50.0, -47.0, -61.0, -59.0, -64.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4041348656844774, "mean_inference_ms": 19.01499489936495, "mean_action_processing_ms": 0.8226140113558799, "mean_env_wait_ms": 0.48306458778864164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5800800323486328, "StateBufferConnector_ms": 0.00727391242980957, "ViewRequirementAgentConnector_ms": 0.29956483840942383}}, "episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -45.0, -59.0, -39.0, -48.0, -31.0, -51.0, -57.0, -46.0, -36.0, -46.0, -58.0, -47.0, -60.0, -43.0, -61.0, -64.0, -45.0, -59.0, -57.0, -60.0, -55.0, -62.0, -59.0, -44.0, -60.0, -36.0, -63.0, -47.0, -38.0, -48.0, -41.0, -58.0, -57.0, -57.0, -55.0, -47.0, -45.0, -62.0, -42.0, -62.0, -49.0, -47.0, -44.0, -47.0, -59.0, -39.0, -61.0, -48.0, -49.0, -40.0, -60.0, -47.0, -36.0, -47.0, -60.0, -42.0, -59.0, -60.0, -46.0, -61.0, -48.0, -47.0, -46.0, -61.0, -63.0, -43.0, -43.0, -45.0, -45.0, -41.0, -31.0, -61.0, -45.0, -50.0, -49.0, -61.0, -37.0, -48.0, -24.0, -34.0, -60.0, -44.0, -60.0, -48.0, -43.0, -45.0, -58.0, -50.0, -60.0, -31.0, -46.0, -56.0, -40.0, -50.0, -47.0, -61.0, -59.0, -64.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4041348656844774, "mean_inference_ms": 19.01499489936495, "mean_action_processing_ms": 0.8226140113558799, "mean_env_wait_ms": 0.48306458778864164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5800800323486328, "StateBufferConnector_ms": 0.00727391242980957, "ViewRequirementAgentConnector_ms": 0.29956483840942383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9124768938971406, "num_agent_steps_trained_throughput_per_sec": 2.9124768938971406, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 163648.557, "sample_time_ms": 11588.531, "load_time_ms": 0.438, "load_throughput": 1168762.19, "learn_time_ms": 152058.874, "learn_throughput": 3.367, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "done": false, "episodes_total": 864, "training_iteration": 27, "trial_id": "6f959_00019", "date": "2024-02-28_16-20-44", "timestamp": 1709133644, "time_this_iter_s": 175.80598735809326, "time_total_s": 4363.889393091202, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4363.889393091202, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 56.934400000000004, "ram_util_percent": 17.7576}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.6, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.1046875, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1917654611665057, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.039664483070373, "policy_loss": -0.010658513902065654, "vf_loss": 9.956135523319244, "vf_explained_var": 0.0002033586303393046, "kl": 0.0, "entropy": 98.53955370585123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.6, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.1046875, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -57.0, -57.0, -55.0, -47.0, -45.0, -62.0, -42.0, -62.0, -49.0, -47.0, -44.0, -47.0, -59.0, -39.0, -61.0, -48.0, -49.0, -40.0, -60.0, -47.0, -36.0, -47.0, -60.0, -42.0, -59.0, -60.0, -46.0, -61.0, -48.0, -47.0, -46.0, -61.0, -63.0, -43.0, -43.0, -45.0, -45.0, -41.0, -31.0, -61.0, -45.0, -50.0, -49.0, -61.0, -37.0, -48.0, -24.0, -34.0, -60.0, -44.0, -60.0, -48.0, -43.0, -45.0, -58.0, -50.0, -60.0, -31.0, -46.0, -56.0, -40.0, -50.0, -47.0, -61.0, -59.0, -64.0, -56.0, -34.0, -57.0, -42.0, -61.0, -62.0, -63.0, -59.0, -60.0, -55.0, -59.0, -37.0, -45.0, -44.0, -59.0, -61.0, -60.0, -42.0, -59.0, -47.0, -61.0, -59.0, -43.0, -45.0, -42.0, -49.0, -45.0, -60.0, -40.0, -63.0, -59.0, -61.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.409430607746714, "mean_inference_ms": 19.053979154227015, "mean_action_processing_ms": 0.8248585015251502, "mean_env_wait_ms": 0.48424047196556286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.612734317779541, "StateBufferConnector_ms": 0.007491588592529297, "ViewRequirementAgentConnector_ms": 0.3070824146270752}}, "episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -57.0, -57.0, -55.0, -47.0, -45.0, -62.0, -42.0, -62.0, -49.0, -47.0, -44.0, -47.0, -59.0, -39.0, -61.0, -48.0, -49.0, -40.0, -60.0, -47.0, -36.0, -47.0, -60.0, -42.0, -59.0, -60.0, -46.0, -61.0, -48.0, -47.0, -46.0, -61.0, -63.0, -43.0, -43.0, -45.0, -45.0, -41.0, -31.0, -61.0, -45.0, -50.0, -49.0, -61.0, -37.0, -48.0, -24.0, -34.0, -60.0, -44.0, -60.0, -48.0, -43.0, -45.0, -58.0, -50.0, -60.0, -31.0, -46.0, -56.0, -40.0, -50.0, -47.0, -61.0, -59.0, -64.0, -56.0, -34.0, -57.0, -42.0, -61.0, -62.0, -63.0, -59.0, -60.0, -55.0, -59.0, -37.0, -45.0, -44.0, -59.0, -61.0, -60.0, -42.0, -59.0, -47.0, -61.0, -59.0, -43.0, -45.0, -42.0, -49.0, -45.0, -60.0, -40.0, -63.0, -59.0, -61.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.409430607746714, "mean_inference_ms": 19.053979154227015, "mean_action_processing_ms": 0.8248585015251502, "mean_env_wait_ms": 0.48424047196556286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.612734317779541, "StateBufferConnector_ms": 0.007491588592529297, "ViewRequirementAgentConnector_ms": 0.3070824146270752}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0693465936366526, "num_agent_steps_trained_throughput_per_sec": 3.0693465936366526, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 163760.417, "sample_time_ms": 11685.403, "load_time_ms": 0.435, "load_throughput": 1177477.601, "learn_time_ms": 152073.885, "learn_throughput": 3.367, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "episodes_total": 896, "training_iteration": 28, "trial_id": "6f959_00019", "date": "2024-02-28_16-23-31", "timestamp": 1709133811, "time_this_iter_s": 166.82129740715027, "time_total_s": 4530.710690498352, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4530.710690498352, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.03502109704641, "ram_util_percent": 17.730379746835435}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.61, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.104609375, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7054638496910532, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.989851951599121, "policy_loss": -0.024211697094142438, "vf_loss": 9.916247137387593, "vf_explained_var": -7.2677930196126304e-06, "kl": 0.0, "entropy": 98.17887064615886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.61, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.61, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.104609375, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -63.0, -43.0, -43.0, -45.0, -45.0, -41.0, -31.0, -61.0, -45.0, -50.0, -49.0, -61.0, -37.0, -48.0, -24.0, -34.0, -60.0, -44.0, -60.0, -48.0, -43.0, -45.0, -58.0, -50.0, -60.0, -31.0, -46.0, -56.0, -40.0, -50.0, -47.0, -61.0, -59.0, -64.0, -56.0, -34.0, -57.0, -42.0, -61.0, -62.0, -63.0, -59.0, -60.0, -55.0, -59.0, -37.0, -45.0, -44.0, -59.0, -61.0, -60.0, -42.0, -59.0, -47.0, -61.0, -59.0, -43.0, -45.0, -42.0, -49.0, -45.0, -60.0, -40.0, -63.0, -59.0, -61.0, -41.0, -54.0, -59.0, -60.0, -57.0, -60.0, -43.0, -38.0, -61.0, -60.0, -61.0, -41.0, -37.0, -60.0, -57.0, -44.0, -64.0, -32.0, -38.0, -31.0, -38.0, -46.0, -49.0, -60.0, -61.0, -59.0, -62.0, -60.0, -45.0, -60.0, -52.0, -44.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4137267257628547, "mean_inference_ms": 19.080236041111153, "mean_action_processing_ms": 0.8264863898839949, "mean_env_wait_ms": 0.4850494592961081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5997593402862549, "StateBufferConnector_ms": 0.007345438003540039, "ViewRequirementAgentConnector_ms": 0.30134057998657227}}, "episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.61, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -63.0, -43.0, -43.0, -45.0, -45.0, -41.0, -31.0, -61.0, -45.0, -50.0, -49.0, -61.0, -37.0, -48.0, -24.0, -34.0, -60.0, -44.0, -60.0, -48.0, -43.0, -45.0, -58.0, -50.0, -60.0, -31.0, -46.0, -56.0, -40.0, -50.0, -47.0, -61.0, -59.0, -64.0, -56.0, -34.0, -57.0, -42.0, -61.0, -62.0, -63.0, -59.0, -60.0, -55.0, -59.0, -37.0, -45.0, -44.0, -59.0, -61.0, -60.0, -42.0, -59.0, -47.0, -61.0, -59.0, -43.0, -45.0, -42.0, -49.0, -45.0, -60.0, -40.0, -63.0, -59.0, -61.0, -41.0, -54.0, -59.0, -60.0, -57.0, -60.0, -43.0, -38.0, -61.0, -60.0, -61.0, -41.0, -37.0, -60.0, -57.0, -44.0, -64.0, -32.0, -38.0, -31.0, -38.0, -46.0, -49.0, -60.0, -61.0, -59.0, -62.0, -60.0, -45.0, -60.0, -52.0, -44.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4137267257628547, "mean_inference_ms": 19.080236041111153, "mean_action_processing_ms": 0.8264863898839949, "mean_env_wait_ms": 0.4850494592961081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5997593402862549, "StateBufferConnector_ms": 0.007345438003540039, "ViewRequirementAgentConnector_ms": 0.30134057998657227}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.180415912738829, "num_agent_steps_trained_throughput_per_sec": 3.180415912738829, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 163724.73, "sample_time_ms": 11720.501, "load_time_ms": 0.429, "load_throughput": 1193975.118, "learn_time_ms": 152003.144, "learn_throughput": 3.368, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "done": false, "episodes_total": 928, "training_iteration": 29, "trial_id": "6f959_00019", "date": "2024-02-28_16-26-12", "timestamp": 1709133972, "time_this_iter_s": 161.00059986114502, "time_total_s": 4691.711290359497, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4691.711290359497, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 56.791228070175436, "ram_util_percent": 17.737280701754383}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.93, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.102109375, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.985515798876683, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 7.7126728336016335, "policy_loss": -0.03371122783670823, "vf_loss": 8.521690253416697, "vf_explained_var": 3.49581241607666e-06, "kl": 0.0, "entropy": 98.36157760620117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.93, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.93, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.102109375, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -59.0, -64.0, -56.0, -34.0, -57.0, -42.0, -61.0, -62.0, -63.0, -59.0, -60.0, -55.0, -59.0, -37.0, -45.0, -44.0, -59.0, -61.0, -60.0, -42.0, -59.0, -47.0, -61.0, -59.0, -43.0, -45.0, -42.0, -49.0, -45.0, -60.0, -40.0, -63.0, -59.0, -61.0, -41.0, -54.0, -59.0, -60.0, -57.0, -60.0, -43.0, -38.0, -61.0, -60.0, -61.0, -41.0, -37.0, -60.0, -57.0, -44.0, -64.0, -32.0, -38.0, -31.0, -38.0, -46.0, -49.0, -60.0, -61.0, -59.0, -62.0, -60.0, -45.0, -60.0, -52.0, -44.0, -35.0, -34.0, -42.0, -48.0, -43.0, -37.0, -60.0, -58.0, -57.0, -41.0, -44.0, -43.0, -58.0, -36.0, -45.0, -59.0, -63.0, -45.0, -46.0, -43.0, -48.0, -48.0, -47.0, -35.0, -58.0, -60.0, -48.0, -43.0, -62.0, -59.0, -32.0, -64.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.415172717288279, "mean_inference_ms": 19.08619729152305, "mean_action_processing_ms": 0.826900751552505, "mean_env_wait_ms": 0.4852592867916481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.574305534362793, "StateBufferConnector_ms": 0.007158756256103516, "ViewRequirementAgentConnector_ms": 0.29154419898986816}}, "episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.93, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -59.0, -64.0, -56.0, -34.0, -57.0, -42.0, -61.0, -62.0, -63.0, -59.0, -60.0, -55.0, -59.0, -37.0, -45.0, -44.0, -59.0, -61.0, -60.0, -42.0, -59.0, -47.0, -61.0, -59.0, -43.0, -45.0, -42.0, -49.0, -45.0, -60.0, -40.0, -63.0, -59.0, -61.0, -41.0, -54.0, -59.0, -60.0, -57.0, -60.0, -43.0, -38.0, -61.0, -60.0, -61.0, -41.0, -37.0, -60.0, -57.0, -44.0, -64.0, -32.0, -38.0, -31.0, -38.0, -46.0, -49.0, -60.0, -61.0, -59.0, -62.0, -60.0, -45.0, -60.0, -52.0, -44.0, -35.0, -34.0, -42.0, -48.0, -43.0, -37.0, -60.0, -58.0, -57.0, -41.0, -44.0, -43.0, -58.0, -36.0, -45.0, -59.0, -63.0, -45.0, -46.0, -43.0, -48.0, -48.0, -47.0, -35.0, -58.0, -60.0, -48.0, -43.0, -62.0, -59.0, -32.0, -64.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.415172717288279, "mean_inference_ms": 19.08619729152305, "mean_action_processing_ms": 0.826900751552505, "mean_env_wait_ms": 0.4852592867916481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.574305534362793, "StateBufferConnector_ms": 0.007158756256103516, "ViewRequirementAgentConnector_ms": 0.29154419898986816}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2041273449235765, "num_agent_steps_trained_throughput_per_sec": 3.2041273449235765, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 163819.477, "sample_time_ms": 11720.071, "load_time_ms": 0.428, "load_throughput": 1196769.755, "learn_time_ms": 152098.314, "learn_throughput": 3.366, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 960, "training_iteration": 30, "trial_id": "6f959_00019", "date": "2024-02-28_16-28-52", "timestamp": 1709134132, "time_this_iter_s": 159.80523014068604, "time_total_s": 4851.516520500183, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4851.516520500183, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.19295154185023, "ram_util_percent": 17.839207048458157}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.24, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1075, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.1075, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9275405526161193, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.03305025100708, "policy_loss": -0.020876898802816866, "vf_loss": 9.960100491841635, "vf_explained_var": -8.298605680465699e-05, "kl": 0.0, "entropy": 98.52864074707031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "sampler_results": {"episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.24, "reward_total_min": -64, "reward_total_max": -31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1075, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2578125, "reward_score_mean": 0.1075, "reward_score_min": 0.0, "reward_score_max": 0.2578125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -59.0, -61.0, -41.0, -54.0, -59.0, -60.0, -57.0, -60.0, -43.0, -38.0, -61.0, -60.0, -61.0, -41.0, -37.0, -60.0, -57.0, -44.0, -64.0, -32.0, -38.0, -31.0, -38.0, -46.0, -49.0, -60.0, -61.0, -59.0, -62.0, -60.0, -45.0, -60.0, -52.0, -44.0, -35.0, -34.0, -42.0, -48.0, -43.0, -37.0, -60.0, -58.0, -57.0, -41.0, -44.0, -43.0, -58.0, -36.0, -45.0, -59.0, -63.0, -45.0, -46.0, -43.0, -48.0, -48.0, -47.0, -35.0, -58.0, -60.0, -48.0, -43.0, -62.0, -59.0, -32.0, -64.0, -45.0, -62.0, -56.0, -46.0, -33.0, -42.0, -59.0, -59.0, -44.0, -57.0, -61.0, -47.0, -63.0, -43.0, -44.0, -46.0, -33.0, -44.0, -61.0, -63.0, -60.0, -57.0, -44.0, -38.0, -47.0, -37.0, -58.0, -42.0, -61.0, -41.0, -47.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4157940284969506, "mean_inference_ms": 19.085412713352618, "mean_action_processing_ms": 0.8270430153654419, "mean_env_wait_ms": 0.48531665705183685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5683393478393555, "StateBufferConnector_ms": 0.007151603698730469, "ViewRequirementAgentConnector_ms": 0.2928617000579834}}, "episode_reward_max": -31.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -59.0, -61.0, -41.0, -54.0, -59.0, -60.0, -57.0, -60.0, -43.0, -38.0, -61.0, -60.0, -61.0, -41.0, -37.0, -60.0, -57.0, -44.0, -64.0, -32.0, -38.0, -31.0, -38.0, -46.0, -49.0, -60.0, -61.0, -59.0, -62.0, -60.0, -45.0, -60.0, -52.0, -44.0, -35.0, -34.0, -42.0, -48.0, -43.0, -37.0, -60.0, -58.0, -57.0, -41.0, -44.0, -43.0, -58.0, -36.0, -45.0, -59.0, -63.0, -45.0, -46.0, -43.0, -48.0, -48.0, -47.0, -35.0, -58.0, -60.0, -48.0, -43.0, -62.0, -59.0, -32.0, -64.0, -45.0, -62.0, -56.0, -46.0, -33.0, -42.0, -59.0, -59.0, -44.0, -57.0, -61.0, -47.0, -63.0, -43.0, -44.0, -46.0, -33.0, -44.0, -61.0, -63.0, -60.0, -57.0, -44.0, -38.0, -47.0, -37.0, -58.0, -42.0, -61.0, -41.0, -47.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4157940284969506, "mean_inference_ms": 19.085412713352618, "mean_action_processing_ms": 0.8270430153654419, "mean_env_wait_ms": 0.48531665705183685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5683393478393555, "StateBufferConnector_ms": 0.007151603698730469, "ViewRequirementAgentConnector_ms": 0.2928617000579834}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.189827775512599, "num_agent_steps_trained_throughput_per_sec": 3.189827775512599, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 163729.038, "sample_time_ms": 11745.946, "load_time_ms": 0.442, "load_throughput": 1157236.433, "learn_time_ms": 151981.978, "learn_throughput": 3.369, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "done": false, "episodes_total": 992, "training_iteration": 31, "trial_id": "6f959_00019", "date": "2024-02-28_16-31-32", "timestamp": 1709134292, "time_this_iter_s": 160.52082896232605, "time_total_s": 5012.037349462509, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5012.037349462509, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 57.17136563876651, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.36, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.114375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5612827702968691, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.032402483622233, "policy_loss": -0.021078647517909607, "vf_loss": 9.959609842300415, "vf_explained_var": -1.5596052010854087e-05, "kl": 0.0, "entropy": 96.55737190246582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.36, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.114375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -52.0, -44.0, -35.0, -34.0, -42.0, -48.0, -43.0, -37.0, -60.0, -58.0, -57.0, -41.0, -44.0, -43.0, -58.0, -36.0, -45.0, -59.0, -63.0, -45.0, -46.0, -43.0, -48.0, -48.0, -47.0, -35.0, -58.0, -60.0, -48.0, -43.0, -62.0, -59.0, -32.0, -64.0, -45.0, -62.0, -56.0, -46.0, -33.0, -42.0, -59.0, -59.0, -44.0, -57.0, -61.0, -47.0, -63.0, -43.0, -44.0, -46.0, -33.0, -44.0, -61.0, -63.0, -60.0, -57.0, -44.0, -38.0, -47.0, -37.0, -58.0, -42.0, -61.0, -41.0, -47.0, -62.0, -64.0, -39.0, -53.0, -60.0, -57.0, -48.0, -42.0, -58.0, -43.0, -36.0, -59.0, -50.0, -45.0, -61.0, -58.0, -48.0, -50.0, -44.0, -58.0, -58.0, -47.0, -44.0, -44.0, -59.0, -63.0, -32.0, -61.0, -45.0, -42.0, -37.0, -45.0, -46.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4171840445988306, "mean_inference_ms": 19.076689623582933, "mean_action_processing_ms": 0.8267512055255861, "mean_env_wait_ms": 0.4851529063746024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5598421096801758, "StateBufferConnector_ms": 0.007103443145751953, "ViewRequirementAgentConnector_ms": 0.29152584075927734}}, "episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -52.0, -44.0, -35.0, -34.0, -42.0, -48.0, -43.0, -37.0, -60.0, -58.0, -57.0, -41.0, -44.0, -43.0, -58.0, -36.0, -45.0, -59.0, -63.0, -45.0, -46.0, -43.0, -48.0, -48.0, -47.0, -35.0, -58.0, -60.0, -48.0, -43.0, -62.0, -59.0, -32.0, -64.0, -45.0, -62.0, -56.0, -46.0, -33.0, -42.0, -59.0, -59.0, -44.0, -57.0, -61.0, -47.0, -63.0, -43.0, -44.0, -46.0, -33.0, -44.0, -61.0, -63.0, -60.0, -57.0, -44.0, -38.0, -47.0, -37.0, -58.0, -42.0, -61.0, -41.0, -47.0, -62.0, -64.0, -39.0, -53.0, -60.0, -57.0, -48.0, -42.0, -58.0, -43.0, -36.0, -59.0, -50.0, -45.0, -61.0, -58.0, -48.0, -50.0, -44.0, -58.0, -58.0, -47.0, -44.0, -44.0, -59.0, -63.0, -32.0, -61.0, -45.0, -42.0, -37.0, -45.0, -46.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4171840445988306, "mean_inference_ms": 19.076689623582933, "mean_action_processing_ms": 0.8267512055255861, "mean_env_wait_ms": 0.4851529063746024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5598421096801758, "StateBufferConnector_ms": 0.007103443145751953, "ViewRequirementAgentConnector_ms": 0.29152584075927734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.215648099193474, "num_agent_steps_trained_throughput_per_sec": 3.215648099193474, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 163170.468, "sample_time_ms": 11748.535, "load_time_ms": 0.432, "load_throughput": 1185080.099, "learn_time_ms": 151420.854, "learn_throughput": 3.381, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 1024, "training_iteration": 32, "trial_id": "6f959_00019", "date": "2024-02-28_16-34-12", "timestamp": 1709134452, "time_this_iter_s": 159.23667359352112, "time_total_s": 5171.27402305603, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5171.27402305603, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 57.18451327433629, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.53, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.113046875, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6659006039301555, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.060043327013652, "policy_loss": -0.0301533210867395, "vf_loss": 10.0, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 96.03117014567057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.53, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.53, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.113046875, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -32.0, -64.0, -45.0, -62.0, -56.0, -46.0, -33.0, -42.0, -59.0, -59.0, -44.0, -57.0, -61.0, -47.0, -63.0, -43.0, -44.0, -46.0, -33.0, -44.0, -61.0, -63.0, -60.0, -57.0, -44.0, -38.0, -47.0, -37.0, -58.0, -42.0, -61.0, -41.0, -47.0, -62.0, -64.0, -39.0, -53.0, -60.0, -57.0, -48.0, -42.0, -58.0, -43.0, -36.0, -59.0, -50.0, -45.0, -61.0, -58.0, -48.0, -50.0, -44.0, -58.0, -58.0, -47.0, -44.0, -44.0, -59.0, -63.0, -32.0, -61.0, -45.0, -42.0, -37.0, -45.0, -46.0, -41.0, -45.0, -44.0, -46.0, -38.0, -61.0, -52.0, -44.0, -41.0, -42.0, -59.0, -43.0, -59.0, -43.0, -63.0, -49.0, -42.0, -59.0, -61.0, -42.0, -39.0, -43.0, -60.0, -40.0, -60.0, -44.0, -35.0, -45.0, -61.0, -58.0, -40.0, -60.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4194280848496623, "mean_inference_ms": 19.075907643491583, "mean_action_processing_ms": 0.8269587196093964, "mean_env_wait_ms": 0.4852211353693697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5687754154205322, "StateBufferConnector_ms": 0.007202863693237305, "ViewRequirementAgentConnector_ms": 0.29621005058288574}}, "episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.53, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -32.0, -64.0, -45.0, -62.0, -56.0, -46.0, -33.0, -42.0, -59.0, -59.0, -44.0, -57.0, -61.0, -47.0, -63.0, -43.0, -44.0, -46.0, -33.0, -44.0, -61.0, -63.0, -60.0, -57.0, -44.0, -38.0, -47.0, -37.0, -58.0, -42.0, -61.0, -41.0, -47.0, -62.0, -64.0, -39.0, -53.0, -60.0, -57.0, -48.0, -42.0, -58.0, -43.0, -36.0, -59.0, -50.0, -45.0, -61.0, -58.0, -48.0, -50.0, -44.0, -58.0, -58.0, -47.0, -44.0, -44.0, -59.0, -63.0, -32.0, -61.0, -45.0, -42.0, -37.0, -45.0, -46.0, -41.0, -45.0, -44.0, -46.0, -38.0, -61.0, -52.0, -44.0, -41.0, -42.0, -59.0, -43.0, -59.0, -43.0, -63.0, -49.0, -42.0, -59.0, -61.0, -42.0, -39.0, -43.0, -60.0, -40.0, -60.0, -44.0, -35.0, -45.0, -61.0, -58.0, -40.0, -60.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4194280848496623, "mean_inference_ms": 19.075907643491583, "mean_action_processing_ms": 0.8269587196093964, "mean_env_wait_ms": 0.4852211353693697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5687754154205322, "StateBufferConnector_ms": 0.007202863693237305, "ViewRequirementAgentConnector_ms": 0.29621005058288574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1572820458974125, "num_agent_steps_trained_throughput_per_sec": 3.1572820458974125, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 163175.537, "sample_time_ms": 11748.057, "load_time_ms": 0.438, "load_throughput": 1168571.393, "learn_time_ms": 151426.372, "learn_throughput": 3.381, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "done": false, "episodes_total": 1056, "training_iteration": 33, "trial_id": "6f959_00019", "date": "2024-02-28_16-36-54", "timestamp": 1709134614, "time_this_iter_s": 162.17630696296692, "time_total_s": 5333.450330018997, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5333.450330018997, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.48181818181818, "ram_util_percent": 17.496536796536795}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.51, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.113203125, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9279402318100135, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.05903507868449, "policy_loss": -0.031161500761906307, "vf_loss": 10.0, "vf_explained_var": -1.1444091796875e-06, "kl": 0.0, "entropy": 96.06692028045654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "sampler_results": {"episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.51, "reward_total_min": -64, "reward_total_max": -32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.113203125, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -47.0, -62.0, -64.0, -39.0, -53.0, -60.0, -57.0, -48.0, -42.0, -58.0, -43.0, -36.0, -59.0, -50.0, -45.0, -61.0, -58.0, -48.0, -50.0, -44.0, -58.0, -58.0, -47.0, -44.0, -44.0, -59.0, -63.0, -32.0, -61.0, -45.0, -42.0, -37.0, -45.0, -46.0, -41.0, -45.0, -44.0, -46.0, -38.0, -61.0, -52.0, -44.0, -41.0, -42.0, -59.0, -43.0, -59.0, -43.0, -63.0, -49.0, -42.0, -59.0, -61.0, -42.0, -39.0, -43.0, -60.0, -40.0, -60.0, -44.0, -35.0, -45.0, -61.0, -58.0, -40.0, -60.0, -41.0, -42.0, -46.0, -44.0, -63.0, -62.0, -45.0, -57.0, -43.0, -48.0, -52.0, -32.0, -57.0, -36.0, -46.0, -42.0, -59.0, -59.0, -60.0, -33.0, -62.0, -46.0, -61.0, -46.0, -41.0, -62.0, -49.0, -47.0, -58.0, -60.0, -43.0, -45.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.420394947337064, "mean_inference_ms": 19.06745930381879, "mean_action_processing_ms": 0.8267403960845392, "mean_env_wait_ms": 0.48501399032234926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5515635013580322, "StateBufferConnector_ms": 0.007079601287841797, "ViewRequirementAgentConnector_ms": 0.2909979820251465}}, "episode_reward_max": -32.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -47.0, -62.0, -64.0, -39.0, -53.0, -60.0, -57.0, -48.0, -42.0, -58.0, -43.0, -36.0, -59.0, -50.0, -45.0, -61.0, -58.0, -48.0, -50.0, -44.0, -58.0, -58.0, -47.0, -44.0, -44.0, -59.0, -63.0, -32.0, -61.0, -45.0, -42.0, -37.0, -45.0, -46.0, -41.0, -45.0, -44.0, -46.0, -38.0, -61.0, -52.0, -44.0, -41.0, -42.0, -59.0, -43.0, -59.0, -43.0, -63.0, -49.0, -42.0, -59.0, -61.0, -42.0, -39.0, -43.0, -60.0, -40.0, -60.0, -44.0, -35.0, -45.0, -61.0, -58.0, -40.0, -60.0, -41.0, -42.0, -46.0, -44.0, -63.0, -62.0, -45.0, -57.0, -43.0, -48.0, -52.0, -32.0, -57.0, -36.0, -46.0, -42.0, -59.0, -59.0, -60.0, -33.0, -62.0, -46.0, -61.0, -46.0, -41.0, -62.0, -49.0, -47.0, -58.0, -60.0, -43.0, -45.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.420394947337064, "mean_inference_ms": 19.06745930381879, "mean_action_processing_ms": 0.8267403960845392, "mean_env_wait_ms": 0.48501399032234926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5515635013580322, "StateBufferConnector_ms": 0.007079601287841797, "ViewRequirementAgentConnector_ms": 0.2909979820251465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2099805682066416, "num_agent_steps_trained_throughput_per_sec": 3.2099805682066416, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 163063.87, "sample_time_ms": 11815.016, "load_time_ms": 0.457, "load_throughput": 1120933.108, "learn_time_ms": 151247.738, "learn_throughput": 3.385, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "episodes_total": 1088, "training_iteration": 34, "trial_id": "6f959_00019", "date": "2024-02-28_16-39-33", "timestamp": 1709134773, "time_this_iter_s": 159.51285552978516, "time_total_s": 5492.963185548782, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5492.963185548782, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.94778761061947, "ram_util_percent": 17.727433628318586}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.16, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1159375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.1159375, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9269561945150296, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.048181915283203, "policy_loss": -0.04193150472516815, "vf_loss": 9.999908447265625, "vf_explained_var": -1.9063552220662435e-06, "kl": 0.0, "entropy": 95.73028322855632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.16, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1159375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.1159375, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-37.0, -45.0, -46.0, -41.0, -45.0, -44.0, -46.0, -38.0, -61.0, -52.0, -44.0, -41.0, -42.0, -59.0, -43.0, -59.0, -43.0, -63.0, -49.0, -42.0, -59.0, -61.0, -42.0, -39.0, -43.0, -60.0, -40.0, -60.0, -44.0, -35.0, -45.0, -61.0, -58.0, -40.0, -60.0, -41.0, -42.0, -46.0, -44.0, -63.0, -62.0, -45.0, -57.0, -43.0, -48.0, -52.0, -32.0, -57.0, -36.0, -46.0, -42.0, -59.0, -59.0, -60.0, -33.0, -62.0, -46.0, -61.0, -46.0, -41.0, -62.0, -49.0, -47.0, -58.0, -60.0, -43.0, -45.0, -59.0, -49.0, -60.0, -30.0, -61.0, -45.0, -59.0, -46.0, -46.0, -62.0, -63.0, -46.0, -44.0, -49.0, -61.0, -49.0, -58.0, -56.0, -45.0, -61.0, -59.0, -49.0, -39.0, -59.0, -41.0, -38.0, -45.0, -34.0, -59.0, -36.0, -46.0, -43.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.419645070018936, "mean_inference_ms": 19.060935900452954, "mean_action_processing_ms": 0.8265848529320098, "mean_env_wait_ms": 0.484844976518832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5621485710144043, "StateBufferConnector_ms": 0.007130146026611328, "ViewRequirementAgentConnector_ms": 0.2931835651397705}}, "episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.0, -45.0, -46.0, -41.0, -45.0, -44.0, -46.0, -38.0, -61.0, -52.0, -44.0, -41.0, -42.0, -59.0, -43.0, -59.0, -43.0, -63.0, -49.0, -42.0, -59.0, -61.0, -42.0, -39.0, -43.0, -60.0, -40.0, -60.0, -44.0, -35.0, -45.0, -61.0, -58.0, -40.0, -60.0, -41.0, -42.0, -46.0, -44.0, -63.0, -62.0, -45.0, -57.0, -43.0, -48.0, -52.0, -32.0, -57.0, -36.0, -46.0, -42.0, -59.0, -59.0, -60.0, -33.0, -62.0, -46.0, -61.0, -46.0, -41.0, -62.0, -49.0, -47.0, -58.0, -60.0, -43.0, -45.0, -59.0, -49.0, -60.0, -30.0, -61.0, -45.0, -59.0, -46.0, -46.0, -62.0, -63.0, -46.0, -44.0, -49.0, -61.0, -49.0, -58.0, -56.0, -45.0, -61.0, -59.0, -49.0, -39.0, -59.0, -41.0, -38.0, -45.0, -34.0, -59.0, -36.0, -46.0, -43.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.419645070018936, "mean_inference_ms": 19.060935900452954, "mean_action_processing_ms": 0.8265848529320098, "mean_env_wait_ms": 0.484844976518832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5621485710144043, "StateBufferConnector_ms": 0.007130146026611328, "ViewRequirementAgentConnector_ms": 0.2931835651397705}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1695320773316573, "num_agent_steps_trained_throughput_per_sec": 3.1695320773316573, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 163135.553, "sample_time_ms": 11840.505, "load_time_ms": 0.452, "load_throughput": 1133176.955, "learn_time_ms": 151293.938, "learn_throughput": 3.384, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 1120, "training_iteration": 35, "trial_id": "6f959_00019", "date": "2024-02-28_16-42-15", "timestamp": 1709134935, "time_this_iter_s": 161.54860186576843, "time_total_s": 5654.511787414551, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5654.511787414551, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 57.18826086956521, "ram_util_percent": 17.8904347826087}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.38, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10640625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.10640625, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19246400367701427, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.032373865445456, "policy_loss": -0.010571890758971374, "vf_loss": 9.948020009199778, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 95.42157281239828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "sampler_results": {"episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.38, "reward_total_min": -63, "reward_total_max": -30, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10640625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.265625, "reward_score_mean": 0.10640625, "reward_score_min": 0.0078125, "reward_score_max": 0.265625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -40.0, -60.0, -41.0, -42.0, -46.0, -44.0, -63.0, -62.0, -45.0, -57.0, -43.0, -48.0, -52.0, -32.0, -57.0, -36.0, -46.0, -42.0, -59.0, -59.0, -60.0, -33.0, -62.0, -46.0, -61.0, -46.0, -41.0, -62.0, -49.0, -47.0, -58.0, -60.0, -43.0, -45.0, -59.0, -49.0, -60.0, -30.0, -61.0, -45.0, -59.0, -46.0, -46.0, -62.0, -63.0, -46.0, -44.0, -49.0, -61.0, -49.0, -58.0, -56.0, -45.0, -61.0, -59.0, -49.0, -39.0, -59.0, -41.0, -38.0, -45.0, -34.0, -59.0, -36.0, -46.0, -43.0, -45.0, -43.0, -42.0, -61.0, -62.0, -43.0, -49.0, -42.0, -44.0, -48.0, -63.0, -38.0, -44.0, -47.0, -49.0, -46.0, -61.0, -48.0, -45.0, -58.0, -61.0, -51.0, -59.0, -60.0, -59.0, -42.0, -42.0, -58.0, -59.0, -60.0, -60.0, -61.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417838306420597, "mean_inference_ms": 19.049807467316203, "mean_action_processing_ms": 0.8261112483031599, "mean_env_wait_ms": 0.4845208139755856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5532293319702148, "StateBufferConnector_ms": 0.007069587707519531, "ViewRequirementAgentConnector_ms": 0.2898848056793213}}, "episode_reward_max": -30.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -40.0, -60.0, -41.0, -42.0, -46.0, -44.0, -63.0, -62.0, -45.0, -57.0, -43.0, -48.0, -52.0, -32.0, -57.0, -36.0, -46.0, -42.0, -59.0, -59.0, -60.0, -33.0, -62.0, -46.0, -61.0, -46.0, -41.0, -62.0, -49.0, -47.0, -58.0, -60.0, -43.0, -45.0, -59.0, -49.0, -60.0, -30.0, -61.0, -45.0, -59.0, -46.0, -46.0, -62.0, -63.0, -46.0, -44.0, -49.0, -61.0, -49.0, -58.0, -56.0, -45.0, -61.0, -59.0, -49.0, -39.0, -59.0, -41.0, -38.0, -45.0, -34.0, -59.0, -36.0, -46.0, -43.0, -45.0, -43.0, -42.0, -61.0, -62.0, -43.0, -49.0, -42.0, -44.0, -48.0, -63.0, -38.0, -44.0, -47.0, -49.0, -46.0, -61.0, -48.0, -45.0, -58.0, -61.0, -51.0, -59.0, -60.0, -59.0, -42.0, -42.0, -58.0, -59.0, -60.0, -60.0, -61.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417838306420597, "mean_inference_ms": 19.049807467316203, "mean_action_processing_ms": 0.8261112483031599, "mean_env_wait_ms": 0.4845208139755856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5532293319702148, "StateBufferConnector_ms": 0.007069587707519531, "ViewRequirementAgentConnector_ms": 0.2898848056793213}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2044062453829527, "num_agent_steps_trained_throughput_per_sec": 3.2044062453829527, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 162610.186, "sample_time_ms": 11709.12, "load_time_ms": 0.462, "load_throughput": 1107978.355, "learn_time_ms": 150899.96, "learn_throughput": 3.393, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "episodes_total": 1152, "training_iteration": 36, "trial_id": "6f959_00019", "date": "2024-02-28_16-44-55", "timestamp": 1709135095, "time_this_iter_s": 159.79535746574402, "time_total_s": 5814.307144880295, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5814.307144880295, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.36725663716814, "ram_util_percent": 17.37433628318584}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.66, "reward_total_min": -63, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10421875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.10421875, "reward_score_min": 0.0078125, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6273130525213977, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.060363833109538, "policy_loss": -0.027912338854124148, "vf_loss": 9.997887285550435, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 95.80669110616049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "sampler_results": {"episode_reward_max": -29.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.66, "reward_total_min": -63, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10421875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.10421875, "reward_score_min": 0.0078125, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -43.0, -45.0, -59.0, -49.0, -60.0, -30.0, -61.0, -45.0, -59.0, -46.0, -46.0, -62.0, -63.0, -46.0, -44.0, -49.0, -61.0, -49.0, -58.0, -56.0, -45.0, -61.0, -59.0, -49.0, -39.0, -59.0, -41.0, -38.0, -45.0, -34.0, -59.0, -36.0, -46.0, -43.0, -45.0, -43.0, -42.0, -61.0, -62.0, -43.0, -49.0, -42.0, -44.0, -48.0, -63.0, -38.0, -44.0, -47.0, -49.0, -46.0, -61.0, -48.0, -45.0, -58.0, -61.0, -51.0, -59.0, -60.0, -59.0, -42.0, -42.0, -58.0, -59.0, -60.0, -60.0, -61.0, -46.0, -49.0, -59.0, -43.0, -61.0, -52.0, -62.0, -48.0, -40.0, -57.0, -61.0, -59.0, -58.0, -46.0, -45.0, -60.0, -45.0, -63.0, -62.0, -60.0, -36.0, -29.0, -48.0, -37.0, -44.0, -48.0, -46.0, -57.0, -45.0, -62.0, -48.0, -34.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4155609804970752, "mean_inference_ms": 19.03878364538316, "mean_action_processing_ms": 0.8256246564885424, "mean_env_wait_ms": 0.4841948634551616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5510745048522949, "StateBufferConnector_ms": 0.007075071334838867, "ViewRequirementAgentConnector_ms": 0.2912886142730713}}, "episode_reward_max": -29.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -43.0, -45.0, -59.0, -49.0, -60.0, -30.0, -61.0, -45.0, -59.0, -46.0, -46.0, -62.0, -63.0, -46.0, -44.0, -49.0, -61.0, -49.0, -58.0, -56.0, -45.0, -61.0, -59.0, -49.0, -39.0, -59.0, -41.0, -38.0, -45.0, -34.0, -59.0, -36.0, -46.0, -43.0, -45.0, -43.0, -42.0, -61.0, -62.0, -43.0, -49.0, -42.0, -44.0, -48.0, -63.0, -38.0, -44.0, -47.0, -49.0, -46.0, -61.0, -48.0, -45.0, -58.0, -61.0, -51.0, -59.0, -60.0, -59.0, -42.0, -42.0, -58.0, -59.0, -60.0, -60.0, -61.0, -46.0, -49.0, -59.0, -43.0, -61.0, -52.0, -62.0, -48.0, -40.0, -57.0, -61.0, -59.0, -58.0, -46.0, -45.0, -60.0, -45.0, -63.0, -62.0, -60.0, -36.0, -29.0, -48.0, -37.0, -44.0, -48.0, -46.0, -57.0, -45.0, -62.0, -48.0, -34.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4155609804970752, "mean_inference_ms": 19.03878364538316, "mean_action_processing_ms": 0.8256246564885424, "mean_env_wait_ms": 0.4841948634551616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5510745048522949, "StateBufferConnector_ms": 0.007075071334838867, "ViewRequirementAgentConnector_ms": 0.2912886142730713}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.190287262486133, "num_agent_steps_trained_throughput_per_sec": 3.190287262486133, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 161079.358, "sample_time_ms": 11664.196, "load_time_ms": 0.445, "load_throughput": 1149616.514, "learn_time_ms": 149414.075, "learn_throughput": 3.427, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "done": false, "episodes_total": 1184, "training_iteration": 37, "trial_id": "6f959_00019", "date": "2024-02-28_16-47-35", "timestamp": 1709135255, "time_this_iter_s": 160.49808311462402, "time_total_s": 5974.805227994919, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5974.805227994919, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.12061403508772, "ram_util_percent": 17.51973684210526}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.94, "reward_total_min": -63, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10203125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.10203125, "reward_score_min": 0.0078125, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.219511892599985, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.025682377815247, "policy_loss": -0.017409433948341758, "vf_loss": 9.94818060596784, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 96.59817097981771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "sampler_results": {"episode_reward_max": -29.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.94, "reward_total_min": -63, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10203125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.10203125, "reward_score_min": 0.0078125, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-36.0, -46.0, -43.0, -45.0, -43.0, -42.0, -61.0, -62.0, -43.0, -49.0, -42.0, -44.0, -48.0, -63.0, -38.0, -44.0, -47.0, -49.0, -46.0, -61.0, -48.0, -45.0, -58.0, -61.0, -51.0, -59.0, -60.0, -59.0, -42.0, -42.0, -58.0, -59.0, -60.0, -60.0, -61.0, -46.0, -49.0, -59.0, -43.0, -61.0, -52.0, -62.0, -48.0, -40.0, -57.0, -61.0, -59.0, -58.0, -46.0, -45.0, -60.0, -45.0, -63.0, -62.0, -60.0, -36.0, -29.0, -48.0, -37.0, -44.0, -48.0, -46.0, -57.0, -45.0, -62.0, -48.0, -34.0, -61.0, -44.0, -35.0, -44.0, -46.0, -43.0, -52.0, -61.0, -41.0, -47.0, -47.0, -47.0, -62.0, -59.0, -59.0, -59.0, -60.0, -60.0, -55.0, -46.0, -59.0, -61.0, -57.0, -56.0, -57.0, -63.0, -47.0, -45.0, -61.0, -45.0, -43.0, -48.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.412035678320508, "mean_inference_ms": 19.020811231913374, "mean_action_processing_ms": 0.8247495167263632, "mean_env_wait_ms": 0.48363965354108573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5355772972106934, "StateBufferConnector_ms": 0.006947994232177734, "ViewRequirementAgentConnector_ms": 0.28545045852661133}}, "episode_reward_max": -29.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.0, -46.0, -43.0, -45.0, -43.0, -42.0, -61.0, -62.0, -43.0, -49.0, -42.0, -44.0, -48.0, -63.0, -38.0, -44.0, -47.0, -49.0, -46.0, -61.0, -48.0, -45.0, -58.0, -61.0, -51.0, -59.0, -60.0, -59.0, -42.0, -42.0, -58.0, -59.0, -60.0, -60.0, -61.0, -46.0, -49.0, -59.0, -43.0, -61.0, -52.0, -62.0, -48.0, -40.0, -57.0, -61.0, -59.0, -58.0, -46.0, -45.0, -60.0, -45.0, -63.0, -62.0, -60.0, -36.0, -29.0, -48.0, -37.0, -44.0, -48.0, -46.0, -57.0, -45.0, -62.0, -48.0, -34.0, -61.0, -44.0, -35.0, -44.0, -46.0, -43.0, -52.0, -61.0, -41.0, -47.0, -47.0, -47.0, -62.0, -59.0, -59.0, -59.0, -60.0, -60.0, -55.0, -46.0, -59.0, -61.0, -57.0, -56.0, -57.0, -63.0, -47.0, -45.0, -61.0, -45.0, -43.0, -48.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.412035678320508, "mean_inference_ms": 19.020811231913374, "mean_action_processing_ms": 0.8247495167263632, "mean_env_wait_ms": 0.48363965354108573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5355772972106934, "StateBufferConnector_ms": 0.006947994232177734, "ViewRequirementAgentConnector_ms": 0.28545045852661133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1953704531133638, "num_agent_steps_trained_throughput_per_sec": 3.1953704531133638, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 160421.464, "sample_time_ms": 11499.749, "load_time_ms": 0.447, "load_throughput": 1145569.0, "learn_time_ms": 148920.62, "learn_throughput": 3.438, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "episodes_total": 1216, "training_iteration": 38, "trial_id": "6f959_00019", "date": "2024-02-28_16-50-16", "timestamp": 1709135416, "time_this_iter_s": 160.24234890937805, "time_total_s": 6135.047576904297, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6135.047576904297, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.22149122807018, "ram_util_percent": 17.52017543859649}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.39, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098515625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.098515625, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7240880841389299, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.060039981206257, "policy_loss": -0.027925470968087514, "vf_loss": 9.99754556020101, "vf_explained_var": -1.7851591110229492e-06, "kl": 0.0, "entropy": 95.55120118459065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.39, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.39, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098515625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.098515625, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -60.0, -61.0, -46.0, -49.0, -59.0, -43.0, -61.0, -52.0, -62.0, -48.0, -40.0, -57.0, -61.0, -59.0, -58.0, -46.0, -45.0, -60.0, -45.0, -63.0, -62.0, -60.0, -36.0, -29.0, -48.0, -37.0, -44.0, -48.0, -46.0, -57.0, -45.0, -62.0, -48.0, -34.0, -61.0, -44.0, -35.0, -44.0, -46.0, -43.0, -52.0, -61.0, -41.0, -47.0, -47.0, -47.0, -62.0, -59.0, -59.0, -59.0, -60.0, -60.0, -55.0, -46.0, -59.0, -61.0, -57.0, -56.0, -57.0, -63.0, -47.0, -45.0, -61.0, -45.0, -43.0, -48.0, -39.0, -60.0, -45.0, -63.0, -63.0, -63.0, -60.0, -60.0, -48.0, -62.0, -49.0, -45.0, -61.0, -46.0, -40.0, -59.0, -46.0, -62.0, -60.0, -48.0, -28.0, -47.0, -44.0, -62.0, -60.0, -45.0, -44.0, -58.0, -60.0, -28.0, -44.0, -44.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.414312574959805, "mean_inference_ms": 19.04253490660367, "mean_action_processing_ms": 0.8259729260161748, "mean_env_wait_ms": 0.4843556697743186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5980157852172852, "StateBufferConnector_ms": 0.0074918270111083984, "ViewRequirementAgentConnector_ms": 0.31052708625793457}}, "episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.39, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -60.0, -61.0, -46.0, -49.0, -59.0, -43.0, -61.0, -52.0, -62.0, -48.0, -40.0, -57.0, -61.0, -59.0, -58.0, -46.0, -45.0, -60.0, -45.0, -63.0, -62.0, -60.0, -36.0, -29.0, -48.0, -37.0, -44.0, -48.0, -46.0, -57.0, -45.0, -62.0, -48.0, -34.0, -61.0, -44.0, -35.0, -44.0, -46.0, -43.0, -52.0, -61.0, -41.0, -47.0, -47.0, -47.0, -62.0, -59.0, -59.0, -59.0, -60.0, -60.0, -55.0, -46.0, -59.0, -61.0, -57.0, -56.0, -57.0, -63.0, -47.0, -45.0, -61.0, -45.0, -43.0, -48.0, -39.0, -60.0, -45.0, -63.0, -63.0, -63.0, -60.0, -60.0, -48.0, -62.0, -49.0, -45.0, -61.0, -46.0, -40.0, -59.0, -46.0, -62.0, -60.0, -48.0, -28.0, -47.0, -44.0, -62.0, -60.0, -45.0, -44.0, -58.0, -60.0, -28.0, -44.0, -44.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.414312574959805, "mean_inference_ms": 19.04253490660367, "mean_action_processing_ms": 0.8259729260161748, "mean_env_wait_ms": 0.4843556697743186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5980157852172852, "StateBufferConnector_ms": 0.0074918270111083984, "ViewRequirementAgentConnector_ms": 0.31052708625793457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.932672099846699, "num_agent_steps_trained_throughput_per_sec": 2.932672099846699, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 161781.422, "sample_time_ms": 11739.828, "load_time_ms": 0.455, "load_throughput": 1125692.534, "learn_time_ms": 150040.479, "learn_throughput": 3.412, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 1248, "training_iteration": 39, "trial_id": "6f959_00019", "date": "2024-02-28_16-53-10", "timestamp": 1709135590, "time_this_iter_s": 174.5955126285553, "time_total_s": 6309.643089532852, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6309.643089532852, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 55.31209677419355, "ram_util_percent": 17.561693548387094}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.69, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.111796875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.111796875, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2655496564383308, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.028708597024282, "policy_loss": -0.01640151790343225, "vf_loss": 9.950401000181834, "vf_explained_var": -1.006325085957845e-06, "kl": 0.0, "entropy": 95.84844430287679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.69, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.69, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.111796875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.111796875, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -48.0, -34.0, -61.0, -44.0, -35.0, -44.0, -46.0, -43.0, -52.0, -61.0, -41.0, -47.0, -47.0, -47.0, -62.0, -59.0, -59.0, -59.0, -60.0, -60.0, -55.0, -46.0, -59.0, -61.0, -57.0, -56.0, -57.0, -63.0, -47.0, -45.0, -61.0, -45.0, -43.0, -48.0, -39.0, -60.0, -45.0, -63.0, -63.0, -63.0, -60.0, -60.0, -48.0, -62.0, -49.0, -45.0, -61.0, -46.0, -40.0, -59.0, -46.0, -62.0, -60.0, -48.0, -28.0, -47.0, -44.0, -62.0, -60.0, -45.0, -44.0, -58.0, -60.0, -28.0, -44.0, -44.0, -35.0, -42.0, -41.0, -57.0, -63.0, -49.0, -46.0, -46.0, -40.0, -56.0, -44.0, -38.0, -46.0, -36.0, -61.0, -49.0, -41.0, -41.0, -46.0, -50.0, -46.0, -63.0, -35.0, -43.0, -47.0, -38.0, -58.0, -53.0, -37.0, -41.0, -43.0, -44.0, -37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41664260586244, "mean_inference_ms": 19.06250610732262, "mean_action_processing_ms": 0.8271240880159002, "mean_env_wait_ms": 0.48503433627140696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.600358247756958, "StateBufferConnector_ms": 0.007453203201293945, "ViewRequirementAgentConnector_ms": 0.3077390193939209}}, "episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.69, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -48.0, -34.0, -61.0, -44.0, -35.0, -44.0, -46.0, -43.0, -52.0, -61.0, -41.0, -47.0, -47.0, -47.0, -62.0, -59.0, -59.0, -59.0, -60.0, -60.0, -55.0, -46.0, -59.0, -61.0, -57.0, -56.0, -57.0, -63.0, -47.0, -45.0, -61.0, -45.0, -43.0, -48.0, -39.0, -60.0, -45.0, -63.0, -63.0, -63.0, -60.0, -60.0, -48.0, -62.0, -49.0, -45.0, -61.0, -46.0, -40.0, -59.0, -46.0, -62.0, -60.0, -48.0, -28.0, -47.0, -44.0, -62.0, -60.0, -45.0, -44.0, -58.0, -60.0, -28.0, -44.0, -44.0, -35.0, -42.0, -41.0, -57.0, -63.0, -49.0, -46.0, -46.0, -40.0, -56.0, -44.0, -38.0, -46.0, -36.0, -61.0, -49.0, -41.0, -41.0, -46.0, -50.0, -46.0, -63.0, -35.0, -43.0, -47.0, -38.0, -58.0, -53.0, -37.0, -41.0, -43.0, -44.0, -37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41664260586244, "mean_inference_ms": 19.06250610732262, "mean_action_processing_ms": 0.8271240880159002, "mean_env_wait_ms": 0.48503433627140696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.600358247756958, "StateBufferConnector_ms": 0.007453203201293945, "ViewRequirementAgentConnector_ms": 0.3077390193939209}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0868677533898086, "num_agent_steps_trained_throughput_per_sec": 3.0868677533898086, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 162388.424, "sample_time_ms": 11785.168, "load_time_ms": 0.455, "load_throughput": 1125338.599, "learn_time_ms": 150602.128, "learn_throughput": 3.4, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 1280, "training_iteration": 40, "trial_id": "6f959_00019", "date": "2024-02-28_16-55-56", "timestamp": 1709135756, "time_this_iter_s": 165.87999415397644, "time_total_s": 6475.523083686829, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6475.523083686829, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 56.961440677966095, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.3, "reward_total_min": -64, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12265625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.28125, "reward_score_mean": 0.12265625, "reward_score_min": 0.0, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7752333783855041, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.06589035987854, "policy_loss": -0.020381865122665963, "vf_loss": 9.995682772000631, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 94.61038494110107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.3, "reward_total_min": -64, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12265625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.28125, "reward_score_mean": 0.12265625, "reward_score_min": 0.0, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -43.0, -48.0, -39.0, -60.0, -45.0, -63.0, -63.0, -63.0, -60.0, -60.0, -48.0, -62.0, -49.0, -45.0, -61.0, -46.0, -40.0, -59.0, -46.0, -62.0, -60.0, -48.0, -28.0, -47.0, -44.0, -62.0, -60.0, -45.0, -44.0, -58.0, -60.0, -28.0, -44.0, -44.0, -35.0, -42.0, -41.0, -57.0, -63.0, -49.0, -46.0, -46.0, -40.0, -56.0, -44.0, -38.0, -46.0, -36.0, -61.0, -49.0, -41.0, -41.0, -46.0, -50.0, -46.0, -63.0, -35.0, -43.0, -47.0, -38.0, -58.0, -53.0, -37.0, -41.0, -43.0, -44.0, -37.0, -38.0, -38.0, -50.0, -62.0, -49.0, -63.0, -47.0, -41.0, -40.0, -48.0, -58.0, -46.0, -64.0, -39.0, -40.0, -47.0, -47.0, -45.0, -45.0, -39.0, -62.0, -60.0, -48.0, -50.0, -50.0, -47.0, -37.0, -43.0, -63.0, -58.0, -43.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4202702425380123, "mean_inference_ms": 19.088612335960498, "mean_action_processing_ms": 0.8285389539050041, "mean_env_wait_ms": 0.48588007237297615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6026749610900879, "StateBufferConnector_ms": 0.007538318634033203, "ViewRequirementAgentConnector_ms": 0.3109090328216553}}, "episode_reward_max": -28.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -43.0, -48.0, -39.0, -60.0, -45.0, -63.0, -63.0, -63.0, -60.0, -60.0, -48.0, -62.0, -49.0, -45.0, -61.0, -46.0, -40.0, -59.0, -46.0, -62.0, -60.0, -48.0, -28.0, -47.0, -44.0, -62.0, -60.0, -45.0, -44.0, -58.0, -60.0, -28.0, -44.0, -44.0, -35.0, -42.0, -41.0, -57.0, -63.0, -49.0, -46.0, -46.0, -40.0, -56.0, -44.0, -38.0, -46.0, -36.0, -61.0, -49.0, -41.0, -41.0, -46.0, -50.0, -46.0, -63.0, -35.0, -43.0, -47.0, -38.0, -58.0, -53.0, -37.0, -41.0, -43.0, -44.0, -37.0, -38.0, -38.0, -50.0, -62.0, -49.0, -63.0, -47.0, -41.0, -40.0, -48.0, -58.0, -46.0, -64.0, -39.0, -40.0, -47.0, -47.0, -45.0, -45.0, -39.0, -62.0, -60.0, -48.0, -50.0, -50.0, -47.0, -37.0, -43.0, -63.0, -58.0, -43.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4202702425380123, "mean_inference_ms": 19.088612335960498, "mean_action_processing_ms": 0.8285389539050041, "mean_env_wait_ms": 0.48588007237297615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6026749610900879, "StateBufferConnector_ms": 0.007538318634033203, "ViewRequirementAgentConnector_ms": 0.3109090328216553}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.222023544677852, "num_agent_steps_trained_throughput_per_sec": 3.222023544677852, "timesteps_total": 20992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 162228.033, "sample_time_ms": 11715.247, "load_time_ms": 0.44, "load_throughput": 1164958.038, "learn_time_ms": 150511.668, "learn_throughput": 3.402, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "done": false, "episodes_total": 1312, "training_iteration": 41, "trial_id": "6f959_00019", "date": "2024-02-28_16-58-35", "timestamp": 1709135915, "time_this_iter_s": 158.91728401184082, "time_total_s": 6634.440367698669, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6634.440367698669, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 57.31466666666666, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.85, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.133984375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5548783652794858, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.04522002140681, "policy_loss": -0.02109392510416607, "vf_loss": 9.973726960023244, "vf_explained_var": -1.3669331868489583e-06, "kl": 0.0, "entropy": 93.52881050109863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.85, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.85, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.133984375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-28.0, -44.0, -44.0, -35.0, -42.0, -41.0, -57.0, -63.0, -49.0, -46.0, -46.0, -40.0, -56.0, -44.0, -38.0, -46.0, -36.0, -61.0, -49.0, -41.0, -41.0, -46.0, -50.0, -46.0, -63.0, -35.0, -43.0, -47.0, -38.0, -58.0, -53.0, -37.0, -41.0, -43.0, -44.0, -37.0, -38.0, -38.0, -50.0, -62.0, -49.0, -63.0, -47.0, -41.0, -40.0, -48.0, -58.0, -46.0, -64.0, -39.0, -40.0, -47.0, -47.0, -45.0, -45.0, -39.0, -62.0, -60.0, -48.0, -50.0, -50.0, -47.0, -37.0, -43.0, -63.0, -58.0, -43.0, -32.0, -40.0, -61.0, -45.0, -38.0, -47.0, -63.0, -37.0, -61.0, -45.0, -61.0, -61.0, -42.0, -41.0, -37.0, -61.0, -32.0, -60.0, -63.0, -46.0, -63.0, -44.0, -27.0, -39.0, -59.0, -38.0, -44.0, -40.0, -50.0, -45.0, -36.0, -59.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4188774327642695, "mean_inference_ms": 19.080688936683735, "mean_action_processing_ms": 0.82817273571922, "mean_env_wait_ms": 0.48563598954391496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.541740894317627, "StateBufferConnector_ms": 0.007019996643066406, "ViewRequirementAgentConnector_ms": 0.2847776412963867}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.85, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28.0, -44.0, -44.0, -35.0, -42.0, -41.0, -57.0, -63.0, -49.0, -46.0, -46.0, -40.0, -56.0, -44.0, -38.0, -46.0, -36.0, -61.0, -49.0, -41.0, -41.0, -46.0, -50.0, -46.0, -63.0, -35.0, -43.0, -47.0, -38.0, -58.0, -53.0, -37.0, -41.0, -43.0, -44.0, -37.0, -38.0, -38.0, -50.0, -62.0, -49.0, -63.0, -47.0, -41.0, -40.0, -48.0, -58.0, -46.0, -64.0, -39.0, -40.0, -47.0, -47.0, -45.0, -45.0, -39.0, -62.0, -60.0, -48.0, -50.0, -50.0, -47.0, -37.0, -43.0, -63.0, -58.0, -43.0, -32.0, -40.0, -61.0, -45.0, -38.0, -47.0, -63.0, -37.0, -61.0, -45.0, -61.0, -61.0, -42.0, -41.0, -37.0, -61.0, -32.0, -60.0, -63.0, -46.0, -63.0, -44.0, -27.0, -39.0, -59.0, -38.0, -44.0, -40.0, -50.0, -45.0, -36.0, -59.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4188774327642695, "mean_inference_ms": 19.080688936683735, "mean_action_processing_ms": 0.82817273571922, "mean_env_wait_ms": 0.48563598954391496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.541740894317627, "StateBufferConnector_ms": 0.007019996643066406, "ViewRequirementAgentConnector_ms": 0.2847776412963867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2105644812153695, "num_agent_steps_trained_throughput_per_sec": 3.2105644812153695, "timesteps_total": 21504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 162253.24, "sample_time_ms": 11680.866, "load_time_ms": 0.428, "load_throughput": 1196903.159, "learn_time_ms": 150571.267, "learn_throughput": 3.4, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 1344, "training_iteration": 42, "trial_id": "6f959_00019", "date": "2024-02-28_17-01-15", "timestamp": 1709136075, "time_this_iter_s": 159.4841091632843, "time_total_s": 6793.924476861954, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6793.924476861954, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 57.16651982378854, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.13, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.123984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.123984375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.79298152923584, "policy_loss": -0.049795236252248284, "vf_loss": 7.527644371986389, "vf_explained_var": -9.675820668538412e-07, "kl": 0.0, "entropy": 92.95118929545085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.13, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.123984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.123984375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -43.0, -44.0, -37.0, -38.0, -38.0, -50.0, -62.0, -49.0, -63.0, -47.0, -41.0, -40.0, -48.0, -58.0, -46.0, -64.0, -39.0, -40.0, -47.0, -47.0, -45.0, -45.0, -39.0, -62.0, -60.0, -48.0, -50.0, -50.0, -47.0, -37.0, -43.0, -63.0, -58.0, -43.0, -32.0, -40.0, -61.0, -45.0, -38.0, -47.0, -63.0, -37.0, -61.0, -45.0, -61.0, -61.0, -42.0, -41.0, -37.0, -61.0, -32.0, -60.0, -63.0, -46.0, -63.0, -44.0, -27.0, -39.0, -59.0, -38.0, -44.0, -40.0, -50.0, -45.0, -36.0, -59.0, -33.0, -43.0, -37.0, -59.0, -48.0, -61.0, -48.0, -40.0, -60.0, -41.0, -64.0, -57.0, -40.0, -43.0, -39.0, -59.0, -48.0, -33.0, -33.0, -63.0, -61.0, -38.0, -62.0, -61.0, -62.0, -44.0, -45.0, -61.0, -41.0, -62.0, -36.0, -64.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416218636846917, "mean_inference_ms": 19.0652727267179, "mean_action_processing_ms": 0.8274745638271461, "mean_env_wait_ms": 0.4852116321642801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5356988906860352, "StateBufferConnector_ms": 0.006989479064941406, "ViewRequirementAgentConnector_ms": 0.2769911289215088}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -43.0, -44.0, -37.0, -38.0, -38.0, -50.0, -62.0, -49.0, -63.0, -47.0, -41.0, -40.0, -48.0, -58.0, -46.0, -64.0, -39.0, -40.0, -47.0, -47.0, -45.0, -45.0, -39.0, -62.0, -60.0, -48.0, -50.0, -50.0, -47.0, -37.0, -43.0, -63.0, -58.0, -43.0, -32.0, -40.0, -61.0, -45.0, -38.0, -47.0, -63.0, -37.0, -61.0, -45.0, -61.0, -61.0, -42.0, -41.0, -37.0, -61.0, -32.0, -60.0, -63.0, -46.0, -63.0, -44.0, -27.0, -39.0, -59.0, -38.0, -44.0, -40.0, -50.0, -45.0, -36.0, -59.0, -33.0, -43.0, -37.0, -59.0, -48.0, -61.0, -48.0, -40.0, -60.0, -41.0, -64.0, -57.0, -40.0, -43.0, -39.0, -59.0, -48.0, -33.0, -33.0, -63.0, -61.0, -38.0, -62.0, -61.0, -62.0, -44.0, -45.0, -61.0, -41.0, -62.0, -36.0, -64.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416218636846917, "mean_inference_ms": 19.0652727267179, "mean_action_processing_ms": 0.8274745638271461, "mean_env_wait_ms": 0.4852116321642801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5356988906860352, "StateBufferConnector_ms": 0.006989479064941406, "ViewRequirementAgentConnector_ms": 0.2769911289215088}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3522587584577335, "num_agent_steps_trained_throughput_per_sec": 3.3522587584577335, "timesteps_total": 22016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 161310.048, "sample_time_ms": 11643.126, "load_time_ms": 0.416, "load_throughput": 1231355.303, "learn_time_ms": 149665.842, "learn_throughput": 3.421, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "done": false, "episodes_total": 1376, "training_iteration": 43, "trial_id": "6f959_00019", "date": "2024-02-28_17-03-48", "timestamp": 1709136228, "time_this_iter_s": 152.75368976593018, "time_total_s": 6946.678166627884, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6946.678166627884, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.1889400921659, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.14, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.11609375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9767318767805894, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.91549391746521, "policy_loss": -0.03684781693542997, "vf_loss": 9.848347687721253, "vf_explained_var": -1.6215940316518148e-05, "kl": 0.0, "entropy": 93.21576296488443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.14, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.11609375, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -58.0, -43.0, -32.0, -40.0, -61.0, -45.0, -38.0, -47.0, -63.0, -37.0, -61.0, -45.0, -61.0, -61.0, -42.0, -41.0, -37.0, -61.0, -32.0, -60.0, -63.0, -46.0, -63.0, -44.0, -27.0, -39.0, -59.0, -38.0, -44.0, -40.0, -50.0, -45.0, -36.0, -59.0, -33.0, -43.0, -37.0, -59.0, -48.0, -61.0, -48.0, -40.0, -60.0, -41.0, -64.0, -57.0, -40.0, -43.0, -39.0, -59.0, -48.0, -33.0, -33.0, -63.0, -61.0, -38.0, -62.0, -61.0, -62.0, -44.0, -45.0, -61.0, -41.0, -62.0, -36.0, -64.0, -38.0, -32.0, -62.0, -61.0, -60.0, -62.0, -58.0, -46.0, -64.0, -48.0, -31.0, -64.0, -61.0, -39.0, -43.0, -45.0, -63.0, -42.0, -35.0, -37.0, -50.0, -63.0, -35.0, -60.0, -42.0, -57.0, -37.0, -35.0, -62.0, -60.0, -46.0, -63.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.412869230089929, "mean_inference_ms": 19.045159239877222, "mean_action_processing_ms": 0.8266861737112738, "mean_env_wait_ms": 0.4847268219266644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5345017910003662, "StateBufferConnector_ms": 0.006913185119628906, "ViewRequirementAgentConnector_ms": 0.26792359352111816}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -58.0, -43.0, -32.0, -40.0, -61.0, -45.0, -38.0, -47.0, -63.0, -37.0, -61.0, -45.0, -61.0, -61.0, -42.0, -41.0, -37.0, -61.0, -32.0, -60.0, -63.0, -46.0, -63.0, -44.0, -27.0, -39.0, -59.0, -38.0, -44.0, -40.0, -50.0, -45.0, -36.0, -59.0, -33.0, -43.0, -37.0, -59.0, -48.0, -61.0, -48.0, -40.0, -60.0, -41.0, -64.0, -57.0, -40.0, -43.0, -39.0, -59.0, -48.0, -33.0, -33.0, -63.0, -61.0, -38.0, -62.0, -61.0, -62.0, -44.0, -45.0, -61.0, -41.0, -62.0, -36.0, -64.0, -38.0, -32.0, -62.0, -61.0, -60.0, -62.0, -58.0, -46.0, -64.0, -48.0, -31.0, -64.0, -61.0, -39.0, -43.0, -45.0, -63.0, -42.0, -35.0, -37.0, -50.0, -63.0, -35.0, -60.0, -42.0, -57.0, -37.0, -35.0, -62.0, -60.0, -46.0, -63.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.412869230089929, "mean_inference_ms": 19.045159239877222, "mean_action_processing_ms": 0.8266861737112738, "mean_env_wait_ms": 0.4847268219266644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5345017910003662, "StateBufferConnector_ms": 0.006913185119628906, "ViewRequirementAgentConnector_ms": 0.26792359352111816}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3094894038180596, "num_agent_steps_trained_throughput_per_sec": 3.3094894038180596, "timesteps_total": 22528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 160830.459, "sample_time_ms": 11592.439, "load_time_ms": 0.397, "load_throughput": 1289237.947, "learn_time_ms": 149236.959, "learn_throughput": 3.431, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "episodes_total": 1408, "training_iteration": 44, "trial_id": "6f959_00019", "date": "2024-02-28_17-06-22", "timestamp": 1709136382, "time_this_iter_s": 154.72165250778198, "time_total_s": 7101.399819135666, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7101.399819135666, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.12181818181818, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.37, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.114296875, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8660432927310466, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.99105989933014, "policy_loss": 0.0017959228483960033, "vf_loss": 9.888965400060018, "vf_explained_var": -1.4990568161010741e-06, "kl": 0.0, "entropy": 92.81817468007405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.37, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.37, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.114296875, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -36.0, -59.0, -33.0, -43.0, -37.0, -59.0, -48.0, -61.0, -48.0, -40.0, -60.0, -41.0, -64.0, -57.0, -40.0, -43.0, -39.0, -59.0, -48.0, -33.0, -33.0, -63.0, -61.0, -38.0, -62.0, -61.0, -62.0, -44.0, -45.0, -61.0, -41.0, -62.0, -36.0, -64.0, -38.0, -32.0, -62.0, -61.0, -60.0, -62.0, -58.0, -46.0, -64.0, -48.0, -31.0, -64.0, -61.0, -39.0, -43.0, -45.0, -63.0, -42.0, -35.0, -37.0, -50.0, -63.0, -35.0, -60.0, -42.0, -57.0, -37.0, -35.0, -62.0, -60.0, -46.0, -63.0, -46.0, -44.0, -43.0, -40.0, -64.0, -59.0, -43.0, -36.0, -46.0, -44.0, -61.0, -42.0, -54.0, -44.0, -35.0, -61.0, -62.0, -42.0, -50.0, -40.0, -35.0, -62.0, -61.0, -64.0, -43.0, -60.0, -62.0, -22.0, -35.0, -47.0, -41.0, -61.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4103964762905865, "mean_inference_ms": 19.029974037804603, "mean_action_processing_ms": 0.8262171262201217, "mean_env_wait_ms": 0.4844440389867481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5513291358947754, "StateBufferConnector_ms": 0.006976127624511719, "ViewRequirementAgentConnector_ms": 0.2653810977935791}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.37, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -36.0, -59.0, -33.0, -43.0, -37.0, -59.0, -48.0, -61.0, -48.0, -40.0, -60.0, -41.0, -64.0, -57.0, -40.0, -43.0, -39.0, -59.0, -48.0, -33.0, -33.0, -63.0, -61.0, -38.0, -62.0, -61.0, -62.0, -44.0, -45.0, -61.0, -41.0, -62.0, -36.0, -64.0, -38.0, -32.0, -62.0, -61.0, -60.0, -62.0, -58.0, -46.0, -64.0, -48.0, -31.0, -64.0, -61.0, -39.0, -43.0, -45.0, -63.0, -42.0, -35.0, -37.0, -50.0, -63.0, -35.0, -60.0, -42.0, -57.0, -37.0, -35.0, -62.0, -60.0, -46.0, -63.0, -46.0, -44.0, -43.0, -40.0, -64.0, -59.0, -43.0, -36.0, -46.0, -44.0, -61.0, -42.0, -54.0, -44.0, -35.0, -61.0, -62.0, -42.0, -50.0, -40.0, -35.0, -62.0, -61.0, -64.0, -43.0, -60.0, -62.0, -22.0, -35.0, -47.0, -41.0, -61.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4103964762905865, "mean_inference_ms": 19.029974037804603, "mean_action_processing_ms": 0.8262171262201217, "mean_env_wait_ms": 0.4844440389867481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5513291358947754, "StateBufferConnector_ms": 0.006976127624511719, "ViewRequirementAgentConnector_ms": 0.2653810977935791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3892845174584045, "num_agent_steps_trained_throughput_per_sec": 3.3892845174584045, "timesteps_total": 23040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 159783.085, "sample_time_ms": 11591.936, "load_time_ms": 0.459, "load_throughput": 1116213.757, "learn_time_ms": 148190.018, "learn_throughput": 3.455, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 1440, "training_iteration": 45, "trial_id": "6f959_00019", "date": "2024-02-28_17-08-54", "timestamp": 1709136534, "time_this_iter_s": 151.07485556602478, "time_total_s": 7252.474674701691, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7252.474674701691, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.36046511627907, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.38, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.12203125, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.741515294710795, "policy_loss": 0.0711213035043329, "vf_loss": 7.3380084991455075, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.1500836054484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.38, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.12203125, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -36.0, -64.0, -38.0, -32.0, -62.0, -61.0, -60.0, -62.0, -58.0, -46.0, -64.0, -48.0, -31.0, -64.0, -61.0, -39.0, -43.0, -45.0, -63.0, -42.0, -35.0, -37.0, -50.0, -63.0, -35.0, -60.0, -42.0, -57.0, -37.0, -35.0, -62.0, -60.0, -46.0, -63.0, -46.0, -44.0, -43.0, -40.0, -64.0, -59.0, -43.0, -36.0, -46.0, -44.0, -61.0, -42.0, -54.0, -44.0, -35.0, -61.0, -62.0, -42.0, -50.0, -40.0, -35.0, -62.0, -61.0, -64.0, -43.0, -60.0, -62.0, -22.0, -35.0, -47.0, -41.0, -61.0, -61.0, -44.0, -40.0, -32.0, -43.0, -30.0, -35.0, -64.0, -61.0, -41.0, -31.0, -63.0, -36.0, -46.0, -61.0, -35.0, -62.0, -37.0, -42.0, -44.0, -59.0, -47.0, -37.0, -47.0, -44.0, -44.0, -46.0, -57.0, -62.0, -42.0, -47.0, -43.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4085081290554173, "mean_inference_ms": 19.015949838362513, "mean_action_processing_ms": 0.825791905621391, "mean_env_wait_ms": 0.4842110929355248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5590775012969971, "StateBufferConnector_ms": 0.006971836090087891, "ViewRequirementAgentConnector_ms": 0.2634725570678711}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -36.0, -64.0, -38.0, -32.0, -62.0, -61.0, -60.0, -62.0, -58.0, -46.0, -64.0, -48.0, -31.0, -64.0, -61.0, -39.0, -43.0, -45.0, -63.0, -42.0, -35.0, -37.0, -50.0, -63.0, -35.0, -60.0, -42.0, -57.0, -37.0, -35.0, -62.0, -60.0, -46.0, -63.0, -46.0, -44.0, -43.0, -40.0, -64.0, -59.0, -43.0, -36.0, -46.0, -44.0, -61.0, -42.0, -54.0, -44.0, -35.0, -61.0, -62.0, -42.0, -50.0, -40.0, -35.0, -62.0, -61.0, -64.0, -43.0, -60.0, -62.0, -22.0, -35.0, -47.0, -41.0, -61.0, -61.0, -44.0, -40.0, -32.0, -43.0, -30.0, -35.0, -64.0, -61.0, -41.0, -31.0, -63.0, -36.0, -46.0, -61.0, -35.0, -62.0, -37.0, -42.0, -44.0, -59.0, -47.0, -37.0, -47.0, -44.0, -44.0, -46.0, -57.0, -62.0, -42.0, -47.0, -43.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4085081290554173, "mean_inference_ms": 19.015949838362513, "mean_action_processing_ms": 0.825791905621391, "mean_env_wait_ms": 0.4842110929355248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5590775012969971, "StateBufferConnector_ms": 0.006971836090087891, "ViewRequirementAgentConnector_ms": 0.2634725570678711}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4193008390005937, "num_agent_steps_trained_throughput_per_sec": 3.4193008390005937, "timesteps_total": 23552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 158778.908, "sample_time_ms": 11599.879, "load_time_ms": 0.459, "load_throughput": 1116271.779, "learn_time_ms": 147177.908, "learn_throughput": 3.479, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "episodes_total": 1472, "training_iteration": 46, "trial_id": "6f959_00019", "date": "2024-02-28_17-11-23", "timestamp": 1709136683, "time_this_iter_s": 149.74860882759094, "time_total_s": 7402.223283529282, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7402.223283529282, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.223113207547165, "ram_util_percent": 17.631603773584903}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.59, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.120390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.120390625, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9675823288659254, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.020455133914947, "policy_loss": -0.021379986219108103, "vf_loss": 9.9467982172966, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.16995226542154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.59, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.59, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.120390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.120390625, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -46.0, -63.0, -46.0, -44.0, -43.0, -40.0, -64.0, -59.0, -43.0, -36.0, -46.0, -44.0, -61.0, -42.0, -54.0, -44.0, -35.0, -61.0, -62.0, -42.0, -50.0, -40.0, -35.0, -62.0, -61.0, -64.0, -43.0, -60.0, -62.0, -22.0, -35.0, -47.0, -41.0, -61.0, -61.0, -44.0, -40.0, -32.0, -43.0, -30.0, -35.0, -64.0, -61.0, -41.0, -31.0, -63.0, -36.0, -46.0, -61.0, -35.0, -62.0, -37.0, -42.0, -44.0, -59.0, -47.0, -37.0, -47.0, -44.0, -44.0, -46.0, -57.0, -62.0, -42.0, -47.0, -43.0, -43.0, -47.0, -58.0, -61.0, -63.0, -64.0, -62.0, -64.0, -45.0, -63.0, -45.0, -33.0, -41.0, -63.0, -38.0, -36.0, -61.0, -43.0, -38.0, -35.0, -63.0, -61.0, -42.0, -35.0, -49.0, -38.0, -64.0, -62.0, -61.0, -35.0, -43.0, -43.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4056587445768867, "mean_inference_ms": 18.99557790270143, "mean_action_processing_ms": 0.8249606999606826, "mean_env_wait_ms": 0.48374931463096016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5438997745513916, "StateBufferConnector_ms": 0.006863117218017578, "ViewRequirementAgentConnector_ms": 0.2574949264526367}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.59, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -46.0, -63.0, -46.0, -44.0, -43.0, -40.0, -64.0, -59.0, -43.0, -36.0, -46.0, -44.0, -61.0, -42.0, -54.0, -44.0, -35.0, -61.0, -62.0, -42.0, -50.0, -40.0, -35.0, -62.0, -61.0, -64.0, -43.0, -60.0, -62.0, -22.0, -35.0, -47.0, -41.0, -61.0, -61.0, -44.0, -40.0, -32.0, -43.0, -30.0, -35.0, -64.0, -61.0, -41.0, -31.0, -63.0, -36.0, -46.0, -61.0, -35.0, -62.0, -37.0, -42.0, -44.0, -59.0, -47.0, -37.0, -47.0, -44.0, -44.0, -46.0, -57.0, -62.0, -42.0, -47.0, -43.0, -43.0, -47.0, -58.0, -61.0, -63.0, -64.0, -62.0, -64.0, -45.0, -63.0, -45.0, -33.0, -41.0, -63.0, -38.0, -36.0, -61.0, -43.0, -38.0, -35.0, -63.0, -61.0, -42.0, -35.0, -49.0, -38.0, -64.0, -62.0, -61.0, -35.0, -43.0, -43.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4056587445768867, "mean_inference_ms": 18.99557790270143, "mean_action_processing_ms": 0.8249606999606826, "mean_env_wait_ms": 0.48374931463096016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5438997745513916, "StateBufferConnector_ms": 0.006863117218017578, "ViewRequirementAgentConnector_ms": 0.2574949264526367}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4453024700675696, "num_agent_steps_trained_throughput_per_sec": 3.4453024700675696, "timesteps_total": 24064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 157591.009, "sample_time_ms": 11489.557, "load_time_ms": 0.447, "load_throughput": 1144470.075, "learn_time_ms": 146100.358, "learn_throughput": 3.504, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "done": false, "episodes_total": 1504, "training_iteration": 47, "trial_id": "6f959_00019", "date": "2024-02-28_17-13-52", "timestamp": 1709136832, "time_this_iter_s": 148.61865711212158, "time_total_s": 7550.841940641403, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7550.841940641403, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 56.24218009478674, "ram_util_percent": 17.577251184834118}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -47.73, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.127109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.127109375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.266823806365331, "policy_loss": 0.18363538132980467, "vf_loss": 6.692031880219777, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.14273173014323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.73, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -47.73, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.127109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.127109375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -41.0, -61.0, -61.0, -44.0, -40.0, -32.0, -43.0, -30.0, -35.0, -64.0, -61.0, -41.0, -31.0, -63.0, -36.0, -46.0, -61.0, -35.0, -62.0, -37.0, -42.0, -44.0, -59.0, -47.0, -37.0, -47.0, -44.0, -44.0, -46.0, -57.0, -62.0, -42.0, -47.0, -43.0, -43.0, -47.0, -58.0, -61.0, -63.0, -64.0, -62.0, -64.0, -45.0, -63.0, -45.0, -33.0, -41.0, -63.0, -38.0, -36.0, -61.0, -43.0, -38.0, -35.0, -63.0, -61.0, -42.0, -35.0, -49.0, -38.0, -64.0, -62.0, -61.0, -35.0, -43.0, -43.0, -59.0, -32.0, -60.0, -46.0, -41.0, -37.0, -44.0, -63.0, -63.0, -42.0, -60.0, -45.0, -36.0, -47.0, -41.0, -37.0, -45.0, -63.0, -43.0, -39.0, -38.0, -46.0, -19.0, -60.0, -41.0, -63.0, -43.0, -44.0, -39.0, -61.0, -44.0, -37.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.402000687486813, "mean_inference_ms": 18.969695349495467, "mean_action_processing_ms": 0.8238552019071256, "mean_env_wait_ms": 0.4830989503861753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5308418273925781, "StateBufferConnector_ms": 0.006776332855224609, "ViewRequirementAgentConnector_ms": 0.25378894805908203}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.73, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -41.0, -61.0, -61.0, -44.0, -40.0, -32.0, -43.0, -30.0, -35.0, -64.0, -61.0, -41.0, -31.0, -63.0, -36.0, -46.0, -61.0, -35.0, -62.0, -37.0, -42.0, -44.0, -59.0, -47.0, -37.0, -47.0, -44.0, -44.0, -46.0, -57.0, -62.0, -42.0, -47.0, -43.0, -43.0, -47.0, -58.0, -61.0, -63.0, -64.0, -62.0, -64.0, -45.0, -63.0, -45.0, -33.0, -41.0, -63.0, -38.0, -36.0, -61.0, -43.0, -38.0, -35.0, -63.0, -61.0, -42.0, -35.0, -49.0, -38.0, -64.0, -62.0, -61.0, -35.0, -43.0, -43.0, -59.0, -32.0, -60.0, -46.0, -41.0, -37.0, -44.0, -63.0, -63.0, -42.0, -60.0, -45.0, -36.0, -47.0, -41.0, -37.0, -45.0, -63.0, -43.0, -39.0, -38.0, -46.0, -19.0, -60.0, -41.0, -63.0, -43.0, -44.0, -39.0, -61.0, -44.0, -37.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.402000687486813, "mean_inference_ms": 18.969695349495467, "mean_action_processing_ms": 0.8238552019071256, "mean_env_wait_ms": 0.4830989503861753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5308418273925781, "StateBufferConnector_ms": 0.006776332855224609, "ViewRequirementAgentConnector_ms": 0.25378894805908203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3771169243178294, "num_agent_steps_trained_throughput_per_sec": 3.3771169243178294, "timesteps_total": 24576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 156728.687, "sample_time_ms": 11482.414, "load_time_ms": 0.447, "load_throughput": 1144470.075, "learn_time_ms": 145245.173, "learn_throughput": 3.525, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 1536, "training_iteration": 48, "trial_id": "6f959_00019", "date": "2024-02-28_17-16-24", "timestamp": 1709136984, "time_this_iter_s": 151.61918425559998, "time_total_s": 7702.461124897003, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7702.461124897003, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 57.013888888888886, "ram_util_percent": 17.802314814814817}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.26, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.10734375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9456163009007772, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.752842203776042, "policy_loss": -0.032545896262551346, "vf_loss": 9.6646843791008, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.78925806681315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.26, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.10734375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -47.0, -43.0, -43.0, -47.0, -58.0, -61.0, -63.0, -64.0, -62.0, -64.0, -45.0, -63.0, -45.0, -33.0, -41.0, -63.0, -38.0, -36.0, -61.0, -43.0, -38.0, -35.0, -63.0, -61.0, -42.0, -35.0, -49.0, -38.0, -64.0, -62.0, -61.0, -35.0, -43.0, -43.0, -59.0, -32.0, -60.0, -46.0, -41.0, -37.0, -44.0, -63.0, -63.0, -42.0, -60.0, -45.0, -36.0, -47.0, -41.0, -37.0, -45.0, -63.0, -43.0, -39.0, -38.0, -46.0, -19.0, -60.0, -41.0, -63.0, -43.0, -44.0, -39.0, -61.0, -44.0, -37.0, -64.0, -48.0, -64.0, -64.0, -64.0, -62.0, -46.0, -61.0, -62.0, -61.0, -45.0, -43.0, -38.0, -39.0, -37.0, -42.0, -63.0, -62.0, -42.0, -64.0, -63.0, -62.0, -40.0, -62.0, -49.0, -47.0, -63.0, -62.0, -63.0, -63.0, -44.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3971134571497426, "mean_inference_ms": 18.93736129408596, "mean_action_processing_ms": 0.8223802834214918, "mean_env_wait_ms": 0.4822015434753154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5132606029510498, "StateBufferConnector_ms": 0.0066547393798828125, "ViewRequirementAgentConnector_ms": 0.24853110313415527}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -47.0, -43.0, -43.0, -47.0, -58.0, -61.0, -63.0, -64.0, -62.0, -64.0, -45.0, -63.0, -45.0, -33.0, -41.0, -63.0, -38.0, -36.0, -61.0, -43.0, -38.0, -35.0, -63.0, -61.0, -42.0, -35.0, -49.0, -38.0, -64.0, -62.0, -61.0, -35.0, -43.0, -43.0, -59.0, -32.0, -60.0, -46.0, -41.0, -37.0, -44.0, -63.0, -63.0, -42.0, -60.0, -45.0, -36.0, -47.0, -41.0, -37.0, -45.0, -63.0, -43.0, -39.0, -38.0, -46.0, -19.0, -60.0, -41.0, -63.0, -43.0, -44.0, -39.0, -61.0, -44.0, -37.0, -64.0, -48.0, -64.0, -64.0, -64.0, -62.0, -46.0, -61.0, -62.0, -61.0, -45.0, -43.0, -38.0, -39.0, -37.0, -42.0, -63.0, -62.0, -42.0, -64.0, -63.0, -62.0, -40.0, -62.0, -49.0, -47.0, -63.0, -62.0, -63.0, -63.0, -44.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3971134571497426, "mean_inference_ms": 18.93736129408596, "mean_action_processing_ms": 0.8223802834214918, "mean_env_wait_ms": 0.4822015434753154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5132606029510498, "StateBufferConnector_ms": 0.0066547393798828125, "ViewRequirementAgentConnector_ms": 0.24853110313415527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.338400545242766, "num_agent_steps_trained_throughput_per_sec": 3.338400545242766, "timesteps_total": 25088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 154606.893, "sample_time_ms": 11117.821, "load_time_ms": 0.437, "load_throughput": 1172399.218, "learn_time_ms": 143488.004, "learn_throughput": 3.568, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "done": false, "episodes_total": 1568, "training_iteration": 49, "trial_id": "6f959_00019", "date": "2024-02-28_17-18-57", "timestamp": 1709137137, "time_this_iter_s": 153.3771800994873, "time_total_s": 7855.8383049964905, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7855.8383049964905, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.37752293577982, "ram_util_percent": 17.743119266055047}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.16, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1159375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.1159375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8425407254913201, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.017851797739665, "policy_loss": -0.014942504667366545, "vf_loss": 9.936852558453877, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.29916229248047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.16, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1159375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.1159375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-35.0, -43.0, -43.0, -59.0, -32.0, -60.0, -46.0, -41.0, -37.0, -44.0, -63.0, -63.0, -42.0, -60.0, -45.0, -36.0, -47.0, -41.0, -37.0, -45.0, -63.0, -43.0, -39.0, -38.0, -46.0, -19.0, -60.0, -41.0, -63.0, -43.0, -44.0, -39.0, -61.0, -44.0, -37.0, -64.0, -48.0, -64.0, -64.0, -64.0, -62.0, -46.0, -61.0, -62.0, -61.0, -45.0, -43.0, -38.0, -39.0, -37.0, -42.0, -63.0, -62.0, -42.0, -64.0, -63.0, -62.0, -40.0, -62.0, -49.0, -47.0, -63.0, -62.0, -63.0, -63.0, -44.0, -64.0, -64.0, -60.0, -63.0, -59.0, -41.0, -37.0, -62.0, -45.0, -36.0, -42.0, -22.0, -58.0, -41.0, -40.0, -46.0, -63.0, -62.0, -43.0, -34.0, -59.0, -62.0, -45.0, -39.0, -41.0, -40.0, -45.0, -62.0, -24.0, -58.0, -47.0, -41.0, -48.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3926783819250104, "mean_inference_ms": 18.909252010162337, "mean_action_processing_ms": 0.8211564287290806, "mean_env_wait_ms": 0.48143791985010453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.518465518951416, "StateBufferConnector_ms": 0.006712436676025391, "ViewRequirementAgentConnector_ms": 0.25174903869628906}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35.0, -43.0, -43.0, -59.0, -32.0, -60.0, -46.0, -41.0, -37.0, -44.0, -63.0, -63.0, -42.0, -60.0, -45.0, -36.0, -47.0, -41.0, -37.0, -45.0, -63.0, -43.0, -39.0, -38.0, -46.0, -19.0, -60.0, -41.0, -63.0, -43.0, -44.0, -39.0, -61.0, -44.0, -37.0, -64.0, -48.0, -64.0, -64.0, -64.0, -62.0, -46.0, -61.0, -62.0, -61.0, -45.0, -43.0, -38.0, -39.0, -37.0, -42.0, -63.0, -62.0, -42.0, -64.0, -63.0, -62.0, -40.0, -62.0, -49.0, -47.0, -63.0, -62.0, -63.0, -63.0, -44.0, -64.0, -64.0, -60.0, -63.0, -59.0, -41.0, -37.0, -62.0, -45.0, -36.0, -42.0, -22.0, -58.0, -41.0, -40.0, -46.0, -63.0, -62.0, -43.0, -34.0, -59.0, -62.0, -45.0, -39.0, -41.0, -40.0, -45.0, -62.0, -24.0, -58.0, -47.0, -41.0, -48.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3926783819250104, "mean_inference_ms": 18.909252010162337, "mean_action_processing_ms": 0.8211564287290806, "mean_env_wait_ms": 0.48143791985010453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.518465518951416, "StateBufferConnector_ms": 0.006712436676025391, "ViewRequirementAgentConnector_ms": 0.25174903869628906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4011979213240466, "num_agent_steps_trained_throughput_per_sec": 3.4011979213240466, "timesteps_total": 25600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 153074.022, "sample_time_ms": 11058.494, "load_time_ms": 0.451, "load_throughput": 1136054.408, "learn_time_ms": 142014.459, "learn_throughput": 3.605, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 1600, "training_iteration": 50, "trial_id": "6f959_00019", "date": "2024-02-28_17-21-28", "timestamp": 1709137288, "time_this_iter_s": 150.54598951339722, "time_total_s": 8006.384294509888, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8006.384294509888, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 57.09205607476636, "ram_util_percent": 17.868224299065425}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.18, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.11578125, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.227366352081299, "policy_loss": 0.08800514362131556, "vf_loss": 6.753826638062795, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.85283832550049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.18, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.11578125, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -44.0, -37.0, -64.0, -48.0, -64.0, -64.0, -64.0, -62.0, -46.0, -61.0, -62.0, -61.0, -45.0, -43.0, -38.0, -39.0, -37.0, -42.0, -63.0, -62.0, -42.0, -64.0, -63.0, -62.0, -40.0, -62.0, -49.0, -47.0, -63.0, -62.0, -63.0, -63.0, -44.0, -64.0, -64.0, -60.0, -63.0, -59.0, -41.0, -37.0, -62.0, -45.0, -36.0, -42.0, -22.0, -58.0, -41.0, -40.0, -46.0, -63.0, -62.0, -43.0, -34.0, -59.0, -62.0, -45.0, -39.0, -41.0, -40.0, -45.0, -62.0, -24.0, -58.0, -47.0, -41.0, -48.0, -35.0, -22.0, -44.0, -47.0, -61.0, -41.0, -38.0, -32.0, -62.0, -48.0, -63.0, -39.0, -41.0, -41.0, -48.0, -63.0, -43.0, -38.0, -62.0, -32.0, -42.0, -39.0, -62.0, -52.0, -41.0, -61.0, -45.0, -37.0, -40.0, -62.0, -43.0, -37.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3876386445711995, "mean_inference_ms": 18.879168015899296, "mean_action_processing_ms": 0.8197503695949935, "mean_env_wait_ms": 0.4805597121139029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5075573921203613, "StateBufferConnector_ms": 0.0066378116607666016, "ViewRequirementAgentConnector_ms": 0.24869298934936523}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -44.0, -37.0, -64.0, -48.0, -64.0, -64.0, -64.0, -62.0, -46.0, -61.0, -62.0, -61.0, -45.0, -43.0, -38.0, -39.0, -37.0, -42.0, -63.0, -62.0, -42.0, -64.0, -63.0, -62.0, -40.0, -62.0, -49.0, -47.0, -63.0, -62.0, -63.0, -63.0, -44.0, -64.0, -64.0, -60.0, -63.0, -59.0, -41.0, -37.0, -62.0, -45.0, -36.0, -42.0, -22.0, -58.0, -41.0, -40.0, -46.0, -63.0, -62.0, -43.0, -34.0, -59.0, -62.0, -45.0, -39.0, -41.0, -40.0, -45.0, -62.0, -24.0, -58.0, -47.0, -41.0, -48.0, -35.0, -22.0, -44.0, -47.0, -61.0, -41.0, -38.0, -32.0, -62.0, -48.0, -63.0, -39.0, -41.0, -41.0, -48.0, -63.0, -43.0, -38.0, -62.0, -32.0, -42.0, -39.0, -62.0, -52.0, -41.0, -61.0, -45.0, -37.0, -40.0, -62.0, -43.0, -37.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3876386445711995, "mean_inference_ms": 18.879168015899296, "mean_action_processing_ms": 0.8197503695949935, "mean_env_wait_ms": 0.4805597121139029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5075573921203613, "StateBufferConnector_ms": 0.0066378116607666016, "ViewRequirementAgentConnector_ms": 0.24869298934936523}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.413373003933278, "num_agent_steps_trained_throughput_per_sec": 3.413373003933278, "timesteps_total": 26112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26112, "timers": {"training_iteration_time_ms": 152183.216, "sample_time_ms": 10953.335, "load_time_ms": 0.445, "load_throughput": 1150478.757, "learn_time_ms": 141228.843, "learn_throughput": 3.625, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "done": false, "episodes_total": 1632, "training_iteration": 51, "trial_id": "6f959_00019", "date": "2024-02-28_17-23-58", "timestamp": 1709137438, "time_this_iter_s": 150.00868391990662, "time_total_s": 8156.392978429794, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8156.392978429794, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 57.1981220657277, "ram_util_percent": 17.900938967136156}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.91, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.133515625, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8964209954875211, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.024535250663757, "policy_loss": -0.03295486743251483, "vf_loss": 9.964020037651062, "vf_explained_var": -8.56320063273112e-07, "kl": 0.0, "entropy": 90.88337128957113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.91, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.91, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.133515625, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -44.0, -64.0, -64.0, -60.0, -63.0, -59.0, -41.0, -37.0, -62.0, -45.0, -36.0, -42.0, -22.0, -58.0, -41.0, -40.0, -46.0, -63.0, -62.0, -43.0, -34.0, -59.0, -62.0, -45.0, -39.0, -41.0, -40.0, -45.0, -62.0, -24.0, -58.0, -47.0, -41.0, -48.0, -35.0, -22.0, -44.0, -47.0, -61.0, -41.0, -38.0, -32.0, -62.0, -48.0, -63.0, -39.0, -41.0, -41.0, -48.0, -63.0, -43.0, -38.0, -62.0, -32.0, -42.0, -39.0, -62.0, -52.0, -41.0, -61.0, -45.0, -37.0, -40.0, -62.0, -43.0, -37.0, -33.0, -60.0, -47.0, -32.0, -34.0, -37.0, -21.0, -37.0, -28.0, -63.0, -64.0, -34.0, -63.0, -49.0, -34.0, -63.0, -63.0, -62.0, -31.0, -45.0, -34.0, -47.0, -42.0, -34.0, -40.0, -61.0, -60.0, -42.0, -42.0, -62.0, -61.0, -62.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3829238978002416, "mean_inference_ms": 18.851505256829157, "mean_action_processing_ms": 0.8184968110370212, "mean_env_wait_ms": 0.4797706941992557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5074031352996826, "StateBufferConnector_ms": 0.006649017333984375, "ViewRequirementAgentConnector_ms": 0.24994540214538574}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.91, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -44.0, -64.0, -64.0, -60.0, -63.0, -59.0, -41.0, -37.0, -62.0, -45.0, -36.0, -42.0, -22.0, -58.0, -41.0, -40.0, -46.0, -63.0, -62.0, -43.0, -34.0, -59.0, -62.0, -45.0, -39.0, -41.0, -40.0, -45.0, -62.0, -24.0, -58.0, -47.0, -41.0, -48.0, -35.0, -22.0, -44.0, -47.0, -61.0, -41.0, -38.0, -32.0, -62.0, -48.0, -63.0, -39.0, -41.0, -41.0, -48.0, -63.0, -43.0, -38.0, -62.0, -32.0, -42.0, -39.0, -62.0, -52.0, -41.0, -61.0, -45.0, -37.0, -40.0, -62.0, -43.0, -37.0, -33.0, -60.0, -47.0, -32.0, -34.0, -37.0, -21.0, -37.0, -28.0, -63.0, -64.0, -34.0, -63.0, -49.0, -34.0, -63.0, -63.0, -62.0, -31.0, -45.0, -34.0, -47.0, -42.0, -34.0, -40.0, -61.0, -60.0, -42.0, -42.0, -62.0, -61.0, -62.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3829238978002416, "mean_inference_ms": 18.851505256829157, "mean_action_processing_ms": 0.8184968110370212, "mean_env_wait_ms": 0.4797706941992557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5074031352996826, "StateBufferConnector_ms": 0.006649017333984375, "ViewRequirementAgentConnector_ms": 0.24994540214538574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3795089153272837, "num_agent_steps_trained_throughput_per_sec": 3.3795089153272837, "timesteps_total": 26624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 151385.998, "sample_time_ms": 10907.628, "load_time_ms": 0.44, "load_throughput": 1164010.867, "learn_time_ms": 140477.353, "learn_throughput": 3.645, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "episodes_total": 1664, "training_iteration": 52, "trial_id": "6f959_00019", "date": "2024-02-28_17-26-29", "timestamp": 1709137589, "time_this_iter_s": 151.51179194450378, "time_total_s": 8307.904770374298, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8307.904770374298, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.350462962962965, "ram_util_percent": 17.775462962962965}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -47.57, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.128359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.128359375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9446044941743215, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.958669877052307, "policy_loss": -0.01505069462582469, "vf_loss": 9.871866277853648, "vf_explained_var": 4.394749800364177e-05, "kl": 0.0, "entropy": 90.11284758249919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.57, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -47.57, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.128359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.128359375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -41.0, -48.0, -35.0, -22.0, -44.0, -47.0, -61.0, -41.0, -38.0, -32.0, -62.0, -48.0, -63.0, -39.0, -41.0, -41.0, -48.0, -63.0, -43.0, -38.0, -62.0, -32.0, -42.0, -39.0, -62.0, -52.0, -41.0, -61.0, -45.0, -37.0, -40.0, -62.0, -43.0, -37.0, -33.0, -60.0, -47.0, -32.0, -34.0, -37.0, -21.0, -37.0, -28.0, -63.0, -64.0, -34.0, -63.0, -49.0, -34.0, -63.0, -63.0, -62.0, -31.0, -45.0, -34.0, -47.0, -42.0, -34.0, -40.0, -61.0, -60.0, -42.0, -42.0, -62.0, -61.0, -62.0, -43.0, -63.0, -62.0, -64.0, -58.0, -62.0, -34.0, -61.0, -42.0, -39.0, -34.0, -33.0, -64.0, -39.0, -62.0, -48.0, -63.0, -37.0, -37.0, -48.0, -63.0, -62.0, -62.0, -41.0, -63.0, -43.0, -63.0, -62.0, -62.0, -27.0, -45.0, -47.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3785613864397788, "mean_inference_ms": 18.825508874486495, "mean_action_processing_ms": 0.8173390341361322, "mean_env_wait_ms": 0.47903892682354055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5112278461456299, "StateBufferConnector_ms": 0.006667375564575195, "ViewRequirementAgentConnector_ms": 0.24968314170837402}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.57, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -41.0, -48.0, -35.0, -22.0, -44.0, -47.0, -61.0, -41.0, -38.0, -32.0, -62.0, -48.0, -63.0, -39.0, -41.0, -41.0, -48.0, -63.0, -43.0, -38.0, -62.0, -32.0, -42.0, -39.0, -62.0, -52.0, -41.0, -61.0, -45.0, -37.0, -40.0, -62.0, -43.0, -37.0, -33.0, -60.0, -47.0, -32.0, -34.0, -37.0, -21.0, -37.0, -28.0, -63.0, -64.0, -34.0, -63.0, -49.0, -34.0, -63.0, -63.0, -62.0, -31.0, -45.0, -34.0, -47.0, -42.0, -34.0, -40.0, -61.0, -60.0, -42.0, -42.0, -62.0, -61.0, -62.0, -43.0, -63.0, -62.0, -64.0, -58.0, -62.0, -34.0, -61.0, -42.0, -39.0, -34.0, -33.0, -64.0, -39.0, -62.0, -48.0, -63.0, -37.0, -37.0, -48.0, -63.0, -62.0, -62.0, -41.0, -63.0, -43.0, -63.0, -62.0, -62.0, -27.0, -45.0, -47.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3785613864397788, "mean_inference_ms": 18.825508874486495, "mean_action_processing_ms": 0.8173390341361322, "mean_env_wait_ms": 0.47903892682354055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5112278461456299, "StateBufferConnector_ms": 0.006667375564575195, "ViewRequirementAgentConnector_ms": 0.24968314170837402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.37058913185965, "num_agent_steps_trained_throughput_per_sec": 3.37058913185965, "timesteps_total": 27136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27136, "timers": {"training_iteration_time_ms": 151302.937, "sample_time_ms": 10882.506, "load_time_ms": 0.437, "load_throughput": 1170609.784, "learn_time_ms": 140419.429, "learn_throughput": 3.646, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "done": false, "episodes_total": 1696, "training_iteration": 53, "trial_id": "6f959_00019", "date": "2024-02-28_17-29-01", "timestamp": 1709137741, "time_this_iter_s": 151.91277432441711, "time_total_s": 8459.817544698715, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8459.817544698715, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 57.09395348837208, "ram_util_percent": 17.856279069767442}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.44, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1215625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.1215625, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 7.991136074066162, "policy_loss": 0.06861075662697355, "vf_loss": 8.715460884571076, "vf_explained_var": 1.6969939072926838e-05, "kl": 0.0, "entropy": 89.19706001281739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.44, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1215625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.1215625, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -43.0, -37.0, -33.0, -60.0, -47.0, -32.0, -34.0, -37.0, -21.0, -37.0, -28.0, -63.0, -64.0, -34.0, -63.0, -49.0, -34.0, -63.0, -63.0, -62.0, -31.0, -45.0, -34.0, -47.0, -42.0, -34.0, -40.0, -61.0, -60.0, -42.0, -42.0, -62.0, -61.0, -62.0, -43.0, -63.0, -62.0, -64.0, -58.0, -62.0, -34.0, -61.0, -42.0, -39.0, -34.0, -33.0, -64.0, -39.0, -62.0, -48.0, -63.0, -37.0, -37.0, -48.0, -63.0, -62.0, -62.0, -41.0, -63.0, -43.0, -63.0, -62.0, -62.0, -27.0, -45.0, -47.0, -40.0, -41.0, -62.0, -30.0, -34.0, -35.0, -43.0, -47.0, -41.0, -50.0, -44.0, -29.0, -63.0, -62.0, -64.0, -40.0, -48.0, -62.0, -64.0, -35.0, -62.0, -60.0, -42.0, -62.0, -31.0, -43.0, -63.0, -63.0, -40.0, -36.0, -61.0, -41.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3760911666991964, "mean_inference_ms": 18.810837111941737, "mean_action_processing_ms": 0.8168427506267772, "mean_env_wait_ms": 0.4786999179618817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5409579277038574, "StateBufferConnector_ms": 0.006860971450805664, "ViewRequirementAgentConnector_ms": 0.2586514949798584}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -43.0, -37.0, -33.0, -60.0, -47.0, -32.0, -34.0, -37.0, -21.0, -37.0, -28.0, -63.0, -64.0, -34.0, -63.0, -49.0, -34.0, -63.0, -63.0, -62.0, -31.0, -45.0, -34.0, -47.0, -42.0, -34.0, -40.0, -61.0, -60.0, -42.0, -42.0, -62.0, -61.0, -62.0, -43.0, -63.0, -62.0, -64.0, -58.0, -62.0, -34.0, -61.0, -42.0, -39.0, -34.0, -33.0, -64.0, -39.0, -62.0, -48.0, -63.0, -37.0, -37.0, -48.0, -63.0, -62.0, -62.0, -41.0, -63.0, -43.0, -63.0, -62.0, -62.0, -27.0, -45.0, -47.0, -40.0, -41.0, -62.0, -30.0, -34.0, -35.0, -43.0, -47.0, -41.0, -50.0, -44.0, -29.0, -63.0, -62.0, -64.0, -40.0, -48.0, -62.0, -64.0, -35.0, -62.0, -60.0, -42.0, -62.0, -31.0, -43.0, -63.0, -63.0, -40.0, -36.0, -61.0, -41.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3760911666991964, "mean_inference_ms": 18.810837111941737, "mean_action_processing_ms": 0.8168427506267772, "mean_env_wait_ms": 0.4786999179618817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5409579277038574, "StateBufferConnector_ms": 0.006860971450805664, "ViewRequirementAgentConnector_ms": 0.2586514949798584}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.334128765996012, "num_agent_steps_trained_throughput_per_sec": 3.334128765996012, "timesteps_total": 27648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 151188.606, "sample_time_ms": 10939.0, "load_time_ms": 0.435, "load_throughput": 1177025.842, "learn_time_ms": 140248.611, "learn_throughput": 3.651, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "episodes_total": 1728, "training_iteration": 54, "trial_id": "6f959_00019", "date": "2024-02-28_17-31-35", "timestamp": 1709137895, "time_this_iter_s": 153.5739722251892, "time_total_s": 8613.391516923904, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8613.391516923904, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.22831050228311, "ram_util_percent": 17.957534246575346}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.03, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109140625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.109140625, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.746223489443461, "policy_loss": 0.10194892518532774, "vf_loss": 7.309274927775065, "vf_explained_var": 3.1686325867970785e-05, "kl": 0.0, "entropy": 88.66504173278808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.03, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.03, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109140625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.109140625, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -61.0, -62.0, -43.0, -63.0, -62.0, -64.0, -58.0, -62.0, -34.0, -61.0, -42.0, -39.0, -34.0, -33.0, -64.0, -39.0, -62.0, -48.0, -63.0, -37.0, -37.0, -48.0, -63.0, -62.0, -62.0, -41.0, -63.0, -43.0, -63.0, -62.0, -62.0, -27.0, -45.0, -47.0, -40.0, -41.0, -62.0, -30.0, -34.0, -35.0, -43.0, -47.0, -41.0, -50.0, -44.0, -29.0, -63.0, -62.0, -64.0, -40.0, -48.0, -62.0, -64.0, -35.0, -62.0, -60.0, -42.0, -62.0, -31.0, -43.0, -63.0, -63.0, -40.0, -36.0, -61.0, -41.0, -44.0, -34.0, -54.0, -33.0, -46.0, -62.0, -60.0, -43.0, -40.0, -61.0, -61.0, -63.0, -63.0, -62.0, -47.0, -36.0, -41.0, -37.0, -63.0, -61.0, -42.0, -40.0, -22.0, -45.0, -60.0, -63.0, -62.0, -61.0, -40.0, -62.0, -63.0, -37.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3739693149508456, "mean_inference_ms": 18.797139880226197, "mean_action_processing_ms": 0.8164014716614579, "mean_env_wait_ms": 0.4784079665239278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5453343391418457, "StateBufferConnector_ms": 0.006876468658447266, "ViewRequirementAgentConnector_ms": 0.25922679901123047}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.03, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -61.0, -62.0, -43.0, -63.0, -62.0, -64.0, -58.0, -62.0, -34.0, -61.0, -42.0, -39.0, -34.0, -33.0, -64.0, -39.0, -62.0, -48.0, -63.0, -37.0, -37.0, -48.0, -63.0, -62.0, -62.0, -41.0, -63.0, -43.0, -63.0, -62.0, -62.0, -27.0, -45.0, -47.0, -40.0, -41.0, -62.0, -30.0, -34.0, -35.0, -43.0, -47.0, -41.0, -50.0, -44.0, -29.0, -63.0, -62.0, -64.0, -40.0, -48.0, -62.0, -64.0, -35.0, -62.0, -60.0, -42.0, -62.0, -31.0, -43.0, -63.0, -63.0, -40.0, -36.0, -61.0, -41.0, -44.0, -34.0, -54.0, -33.0, -46.0, -62.0, -60.0, -43.0, -40.0, -61.0, -61.0, -63.0, -63.0, -62.0, -47.0, -36.0, -41.0, -37.0, -63.0, -61.0, -42.0, -40.0, -22.0, -45.0, -60.0, -63.0, -62.0, -61.0, -40.0, -62.0, -63.0, -37.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3739693149508456, "mean_inference_ms": 18.797139880226197, "mean_action_processing_ms": 0.8164014716614579, "mean_env_wait_ms": 0.4784079665239278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5453343391418457, "StateBufferConnector_ms": 0.006876468658447266, "ViewRequirementAgentConnector_ms": 0.25922679901123047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3268308278522687, "num_agent_steps_trained_throughput_per_sec": 3.3268308278522687, "timesteps_total": 28160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 151472.197, "sample_time_ms": 10852.329, "load_time_ms": 0.37, "load_throughput": 1381996.041, "learn_time_ms": 140618.953, "learn_throughput": 3.641, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 1760, "training_iteration": 55, "trial_id": "6f959_00019", "date": "2024-02-28_17-34-09", "timestamp": 1709138049, "time_this_iter_s": 153.9152591228485, "time_total_s": 8767.306776046753, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8767.306776046753, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 57.26009174311927, "ram_util_percent": 17.91146788990826}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.11, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.108515625, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9906774734457334, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.726148609320322, "policy_loss": -0.03489142243439953, "vf_loss": 9.637899367014567, "vf_explained_var": 1.2785196304321289e-06, "kl": 0.0, "entropy": 88.8308765411377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.11, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.108515625, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-27.0, -45.0, -47.0, -40.0, -41.0, -62.0, -30.0, -34.0, -35.0, -43.0, -47.0, -41.0, -50.0, -44.0, -29.0, -63.0, -62.0, -64.0, -40.0, -48.0, -62.0, -64.0, -35.0, -62.0, -60.0, -42.0, -62.0, -31.0, -43.0, -63.0, -63.0, -40.0, -36.0, -61.0, -41.0, -44.0, -34.0, -54.0, -33.0, -46.0, -62.0, -60.0, -43.0, -40.0, -61.0, -61.0, -63.0, -63.0, -62.0, -47.0, -36.0, -41.0, -37.0, -63.0, -61.0, -42.0, -40.0, -22.0, -45.0, -60.0, -63.0, -62.0, -61.0, -40.0, -62.0, -63.0, -37.0, -39.0, -64.0, -41.0, -61.0, -40.0, -64.0, -62.0, -47.0, -64.0, -64.0, -62.0, -62.0, -62.0, -43.0, -36.0, -63.0, -63.0, -45.0, -63.0, -62.0, -32.0, -34.0, -64.0, -37.0, -46.0, -61.0, -63.0, -38.0, -39.0, -63.0, -37.0, -61.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37212865619984, "mean_inference_ms": 18.786263286395958, "mean_action_processing_ms": 0.8160092076180533, "mean_env_wait_ms": 0.4781832152014937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5513064861297607, "StateBufferConnector_ms": 0.006918430328369141, "ViewRequirementAgentConnector_ms": 0.261976957321167}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.0, -45.0, -47.0, -40.0, -41.0, -62.0, -30.0, -34.0, -35.0, -43.0, -47.0, -41.0, -50.0, -44.0, -29.0, -63.0, -62.0, -64.0, -40.0, -48.0, -62.0, -64.0, -35.0, -62.0, -60.0, -42.0, -62.0, -31.0, -43.0, -63.0, -63.0, -40.0, -36.0, -61.0, -41.0, -44.0, -34.0, -54.0, -33.0, -46.0, -62.0, -60.0, -43.0, -40.0, -61.0, -61.0, -63.0, -63.0, -62.0, -47.0, -36.0, -41.0, -37.0, -63.0, -61.0, -42.0, -40.0, -22.0, -45.0, -60.0, -63.0, -62.0, -61.0, -40.0, -62.0, -63.0, -37.0, -39.0, -64.0, -41.0, -61.0, -40.0, -64.0, -62.0, -47.0, -64.0, -64.0, -62.0, -62.0, -62.0, -43.0, -36.0, -63.0, -63.0, -45.0, -63.0, -62.0, -32.0, -34.0, -64.0, -37.0, -46.0, -61.0, -63.0, -38.0, -39.0, -63.0, -37.0, -61.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37212865619984, "mean_inference_ms": 18.786263286395958, "mean_action_processing_ms": 0.8160092076180533, "mean_env_wait_ms": 0.4781832152014937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5513064861297607, "StateBufferConnector_ms": 0.006918430328369141, "ViewRequirementAgentConnector_ms": 0.261976957321167}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.333146496697365, "num_agent_steps_trained_throughput_per_sec": 3.333146496697365, "timesteps_total": 28672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 151859.237, "sample_time_ms": 10840.198, "load_time_ms": 0.356, "load_throughput": 1438464.497, "learn_time_ms": 141018.136, "learn_throughput": 3.631, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 1792, "training_iteration": 56, "trial_id": "6f959_00019", "date": "2024-02-28_17-36-43", "timestamp": 1709138203, "time_this_iter_s": 153.6189045906067, "time_total_s": 8920.92568063736, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8920.92568063736, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.45022831050229, "ram_util_percent": 17.735616438356168}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.09, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.108671875, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.364851053555807, "policy_loss": 0.15982905186247082, "vf_loss": 6.826059106985728, "vf_explained_var": -1.9649664560953777e-06, "kl": 0.0, "entropy": 88.63708566029867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.09, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.108671875, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-36.0, -61.0, -41.0, -44.0, -34.0, -54.0, -33.0, -46.0, -62.0, -60.0, -43.0, -40.0, -61.0, -61.0, -63.0, -63.0, -62.0, -47.0, -36.0, -41.0, -37.0, -63.0, -61.0, -42.0, -40.0, -22.0, -45.0, -60.0, -63.0, -62.0, -61.0, -40.0, -62.0, -63.0, -37.0, -39.0, -64.0, -41.0, -61.0, -40.0, -64.0, -62.0, -47.0, -64.0, -64.0, -62.0, -62.0, -62.0, -43.0, -36.0, -63.0, -63.0, -45.0, -63.0, -62.0, -32.0, -34.0, -64.0, -37.0, -46.0, -61.0, -63.0, -38.0, -39.0, -63.0, -37.0, -61.0, -64.0, -26.0, -29.0, -62.0, -35.0, -44.0, -36.0, -37.0, -47.0, -64.0, -63.0, -36.0, -63.0, -42.0, -64.0, -63.0, -35.0, -62.0, -36.0, -61.0, -44.0, -38.0, -47.0, -39.0, -38.0, -64.0, -44.0, -63.0, -44.0, -28.0, -63.0, -40.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.36972872595694, "mean_inference_ms": 18.771604122674752, "mean_action_processing_ms": 0.8153829674550134, "mean_env_wait_ms": 0.4778360012914233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5383310317993164, "StateBufferConnector_ms": 0.006824016571044922, "ViewRequirementAgentConnector_ms": 0.25845885276794434}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.0, -61.0, -41.0, -44.0, -34.0, -54.0, -33.0, -46.0, -62.0, -60.0, -43.0, -40.0, -61.0, -61.0, -63.0, -63.0, -62.0, -47.0, -36.0, -41.0, -37.0, -63.0, -61.0, -42.0, -40.0, -22.0, -45.0, -60.0, -63.0, -62.0, -61.0, -40.0, -62.0, -63.0, -37.0, -39.0, -64.0, -41.0, -61.0, -40.0, -64.0, -62.0, -47.0, -64.0, -64.0, -62.0, -62.0, -62.0, -43.0, -36.0, -63.0, -63.0, -45.0, -63.0, -62.0, -32.0, -34.0, -64.0, -37.0, -46.0, -61.0, -63.0, -38.0, -39.0, -63.0, -37.0, -61.0, -64.0, -26.0, -29.0, -62.0, -35.0, -44.0, -36.0, -37.0, -47.0, -64.0, -63.0, -36.0, -63.0, -42.0, -64.0, -63.0, -35.0, -62.0, -36.0, -61.0, -44.0, -38.0, -47.0, -39.0, -38.0, -64.0, -44.0, -63.0, -44.0, -28.0, -63.0, -40.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.36972872595694, "mean_inference_ms": 18.771604122674752, "mean_action_processing_ms": 0.8153829674550134, "mean_env_wait_ms": 0.4778360012914233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5383310317993164, "StateBufferConnector_ms": 0.006824016571044922, "ViewRequirementAgentConnector_ms": 0.25845885276794434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3443218666525634, "num_agent_steps_trained_throughput_per_sec": 3.3443218666525634, "timesteps_total": 29184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29184, "timers": {"training_iteration_time_ms": 152307.956, "sample_time_ms": 10908.23, "load_time_ms": 0.373, "load_throughput": 1373861.972, "learn_time_ms": 141398.809, "learn_throughput": 3.621, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "done": false, "episodes_total": 1824, "training_iteration": 57, "trial_id": "6f959_00019", "date": "2024-02-28_17-39-16", "timestamp": 1709138356, "time_this_iter_s": 153.1060197353363, "time_total_s": 9074.031700372696, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9074.031700372696, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 57.16743119266055, "ram_util_percent": 17.937614678899084}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.23, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.107578125, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9468629817167918, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.793263343969981, "policy_loss": -0.007912055014943083, "vf_loss": 9.682051781813303, "vf_explained_var": 2.3345152537027994e-07, "kl": 0.0, "entropy": 88.37358671824137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.23, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.107578125, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -63.0, -37.0, -39.0, -64.0, -41.0, -61.0, -40.0, -64.0, -62.0, -47.0, -64.0, -64.0, -62.0, -62.0, -62.0, -43.0, -36.0, -63.0, -63.0, -45.0, -63.0, -62.0, -32.0, -34.0, -64.0, -37.0, -46.0, -61.0, -63.0, -38.0, -39.0, -63.0, -37.0, -61.0, -64.0, -26.0, -29.0, -62.0, -35.0, -44.0, -36.0, -37.0, -47.0, -64.0, -63.0, -36.0, -63.0, -42.0, -64.0, -63.0, -35.0, -62.0, -36.0, -61.0, -44.0, -38.0, -47.0, -39.0, -38.0, -64.0, -44.0, -63.0, -44.0, -28.0, -63.0, -40.0, -60.0, -44.0, -45.0, -64.0, -64.0, -44.0, -62.0, -63.0, -37.0, -41.0, -64.0, -43.0, -39.0, -30.0, -38.0, -49.0, -48.0, -61.0, -38.0, -57.0, -45.0, -63.0, -63.0, -40.0, -64.0, -37.0, -63.0, -64.0, -29.0, -64.0, -47.0, -44.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3676116026261234, "mean_inference_ms": 18.758512610229147, "mean_action_processing_ms": 0.8148070658382768, "mean_env_wait_ms": 0.4775239375932616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5377202033996582, "StateBufferConnector_ms": 0.0068051815032958984, "ViewRequirementAgentConnector_ms": 0.2583043575286865}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -63.0, -37.0, -39.0, -64.0, -41.0, -61.0, -40.0, -64.0, -62.0, -47.0, -64.0, -64.0, -62.0, -62.0, -62.0, -43.0, -36.0, -63.0, -63.0, -45.0, -63.0, -62.0, -32.0, -34.0, -64.0, -37.0, -46.0, -61.0, -63.0, -38.0, -39.0, -63.0, -37.0, -61.0, -64.0, -26.0, -29.0, -62.0, -35.0, -44.0, -36.0, -37.0, -47.0, -64.0, -63.0, -36.0, -63.0, -42.0, -64.0, -63.0, -35.0, -62.0, -36.0, -61.0, -44.0, -38.0, -47.0, -39.0, -38.0, -64.0, -44.0, -63.0, -44.0, -28.0, -63.0, -40.0, -60.0, -44.0, -45.0, -64.0, -64.0, -44.0, -62.0, -63.0, -37.0, -41.0, -64.0, -43.0, -39.0, -30.0, -38.0, -49.0, -48.0, -61.0, -38.0, -57.0, -45.0, -63.0, -63.0, -40.0, -64.0, -37.0, -63.0, -64.0, -29.0, -64.0, -47.0, -44.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3676116026261234, "mean_inference_ms": 18.758512610229147, "mean_action_processing_ms": 0.8148070658382768, "mean_env_wait_ms": 0.4775239375932616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5377202033996582, "StateBufferConnector_ms": 0.0068051815032958984, "ViewRequirementAgentConnector_ms": 0.2583043575286865}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.380509631378253, "num_agent_steps_trained_throughput_per_sec": 3.380509631378253, "timesteps_total": 29696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 152292.742, "sample_time_ms": 10908.307, "load_time_ms": 0.385, "load_throughput": 1329875.928, "learn_time_ms": 141383.505, "learn_throughput": 3.621, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "episodes_total": 1856, "training_iteration": 58, "trial_id": "6f959_00019", "date": "2024-02-28_17-41-48", "timestamp": 1709138508, "time_this_iter_s": 151.4715931415558, "time_total_s": 9225.503293514252, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9225.503293514252, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 57.382710280373836, "ram_util_percent": 17.704672897196264}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.35, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.114453125, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9493939536313216, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.88198226292928, "policy_loss": 0.01525950850918889, "vf_loss": 9.754159526030223, "vf_explained_var": -3.3040841420491534e-06, "kl": 0.0, "entropy": 87.77039661407471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.35, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.35, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.114453125, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -37.0, -61.0, -64.0, -26.0, -29.0, -62.0, -35.0, -44.0, -36.0, -37.0, -47.0, -64.0, -63.0, -36.0, -63.0, -42.0, -64.0, -63.0, -35.0, -62.0, -36.0, -61.0, -44.0, -38.0, -47.0, -39.0, -38.0, -64.0, -44.0, -63.0, -44.0, -28.0, -63.0, -40.0, -60.0, -44.0, -45.0, -64.0, -64.0, -44.0, -62.0, -63.0, -37.0, -41.0, -64.0, -43.0, -39.0, -30.0, -38.0, -49.0, -48.0, -61.0, -38.0, -57.0, -45.0, -63.0, -63.0, -40.0, -64.0, -37.0, -63.0, -64.0, -29.0, -64.0, -47.0, -44.0, -44.0, -37.0, -63.0, -34.0, -46.0, -60.0, -39.0, -63.0, -49.0, -36.0, -63.0, -63.0, -64.0, -29.0, -62.0, -57.0, -43.0, -41.0, -62.0, -41.0, -63.0, -42.0, -59.0, -44.0, -33.0, -63.0, -39.0, -45.0, -62.0, -60.0, -45.0, -24.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.366731341332155, "mean_inference_ms": 18.75356598282653, "mean_action_processing_ms": 0.8147271016318766, "mean_env_wait_ms": 0.4774569375220999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5590505599975586, "StateBufferConnector_ms": 0.006951093673706055, "ViewRequirementAgentConnector_ms": 0.2641141414642334}}, "episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.35, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -37.0, -61.0, -64.0, -26.0, -29.0, -62.0, -35.0, -44.0, -36.0, -37.0, -47.0, -64.0, -63.0, -36.0, -63.0, -42.0, -64.0, -63.0, -35.0, -62.0, -36.0, -61.0, -44.0, -38.0, -47.0, -39.0, -38.0, -64.0, -44.0, -63.0, -44.0, -28.0, -63.0, -40.0, -60.0, -44.0, -45.0, -64.0, -64.0, -44.0, -62.0, -63.0, -37.0, -41.0, -64.0, -43.0, -39.0, -30.0, -38.0, -49.0, -48.0, -61.0, -38.0, -57.0, -45.0, -63.0, -63.0, -40.0, -64.0, -37.0, -63.0, -64.0, -29.0, -64.0, -47.0, -44.0, -44.0, -37.0, -63.0, -34.0, -46.0, -60.0, -39.0, -63.0, -49.0, -36.0, -63.0, -63.0, -64.0, -29.0, -62.0, -57.0, -43.0, -41.0, -62.0, -41.0, -63.0, -42.0, -59.0, -44.0, -33.0, -63.0, -39.0, -45.0, -62.0, -60.0, -45.0, -24.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.366731341332155, "mean_inference_ms": 18.75356598282653, "mean_action_processing_ms": 0.8147271016318766, "mean_env_wait_ms": 0.4774569375220999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5590505599975586, "StateBufferConnector_ms": 0.006951093673706055, "ViewRequirementAgentConnector_ms": 0.2641141414642334}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.29599905366734, "num_agent_steps_trained_throughput_per_sec": 3.29599905366734, "timesteps_total": 30208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30208, "timers": {"training_iteration_time_ms": 152490.041, "sample_time_ms": 11050.594, "load_time_ms": 0.399, "load_throughput": 1282769.039, "learn_time_ms": 141438.493, "learn_throughput": 3.62, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "done": false, "episodes_total": 1888, "training_iteration": 59, "trial_id": "6f959_00019", "date": "2024-02-28_17-44-23", "timestamp": 1709138663, "time_this_iter_s": 155.35508036613464, "time_total_s": 9380.858373880386, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9380.858373880386, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 57.130316742081455, "ram_util_percent": 17.82081447963801}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.16, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.12375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8373107651248575, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.004225099086762, "policy_loss": -0.01751763146991531, "vf_loss": 9.924694859981537, "vf_explained_var": -1.0689099629720052e-06, "kl": 0.0, "entropy": 87.45288721720378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.16, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.12375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.12375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-28.0, -63.0, -40.0, -60.0, -44.0, -45.0, -64.0, -64.0, -44.0, -62.0, -63.0, -37.0, -41.0, -64.0, -43.0, -39.0, -30.0, -38.0, -49.0, -48.0, -61.0, -38.0, -57.0, -45.0, -63.0, -63.0, -40.0, -64.0, -37.0, -63.0, -64.0, -29.0, -64.0, -47.0, -44.0, -44.0, -37.0, -63.0, -34.0, -46.0, -60.0, -39.0, -63.0, -49.0, -36.0, -63.0, -63.0, -64.0, -29.0, -62.0, -57.0, -43.0, -41.0, -62.0, -41.0, -63.0, -42.0, -59.0, -44.0, -33.0, -63.0, -39.0, -45.0, -62.0, -60.0, -45.0, -24.0, -64.0, -63.0, -24.0, -32.0, -21.0, -64.0, -25.0, -45.0, -40.0, -40.0, -43.0, -51.0, -34.0, -39.0, -35.0, -61.0, -41.0, -63.0, -40.0, -41.0, -41.0, -41.0, -35.0, -33.0, -62.0, -63.0, -63.0, -43.0, -50.0, -42.0, -32.0, -62.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3653393432157404, "mean_inference_ms": 18.74558044983781, "mean_action_processing_ms": 0.8144542996875908, "mean_env_wait_ms": 0.4772808031800416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.544792652130127, "StateBufferConnector_ms": 0.006827592849731445, "ViewRequirementAgentConnector_ms": 0.25943851470947266}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28.0, -63.0, -40.0, -60.0, -44.0, -45.0, -64.0, -64.0, -44.0, -62.0, -63.0, -37.0, -41.0, -64.0, -43.0, -39.0, -30.0, -38.0, -49.0, -48.0, -61.0, -38.0, -57.0, -45.0, -63.0, -63.0, -40.0, -64.0, -37.0, -63.0, -64.0, -29.0, -64.0, -47.0, -44.0, -44.0, -37.0, -63.0, -34.0, -46.0, -60.0, -39.0, -63.0, -49.0, -36.0, -63.0, -63.0, -64.0, -29.0, -62.0, -57.0, -43.0, -41.0, -62.0, -41.0, -63.0, -42.0, -59.0, -44.0, -33.0, -63.0, -39.0, -45.0, -62.0, -60.0, -45.0, -24.0, -64.0, -63.0, -24.0, -32.0, -21.0, -64.0, -25.0, -45.0, -40.0, -40.0, -43.0, -51.0, -34.0, -39.0, -35.0, -61.0, -41.0, -63.0, -40.0, -41.0, -41.0, -41.0, -35.0, -33.0, -62.0, -63.0, -63.0, -43.0, -50.0, -42.0, -32.0, -62.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3653393432157404, "mean_inference_ms": 18.74558044983781, "mean_action_processing_ms": 0.8144542996875908, "mean_env_wait_ms": 0.4772808031800416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.544792652130127, "StateBufferConnector_ms": 0.006827592849731445, "ViewRequirementAgentConnector_ms": 0.25943851470947266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3392372502997527, "num_agent_steps_trained_throughput_per_sec": 3.3392372502997527, "timesteps_total": 30720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 152769.367, "sample_time_ms": 11041.299, "load_time_ms": 0.384, "load_throughput": 1334006.49, "learn_time_ms": 141727.152, "learn_throughput": 3.613, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 1920, "training_iteration": 60, "trial_id": "6f959_00019", "date": "2024-02-28_17-46-56", "timestamp": 1709138816, "time_this_iter_s": 153.33885312080383, "time_total_s": 9534.19722700119, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9534.19722700119, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 57.198623853211004, "ram_util_percent": 17.650917431192664}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.1, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.13984375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9566247932612896, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.831221493085225, "policy_loss": 0.012251370136315625, "vf_loss": 9.701627643903096, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.11926333109538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.1, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.13984375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -47.0, -44.0, -44.0, -37.0, -63.0, -34.0, -46.0, -60.0, -39.0, -63.0, -49.0, -36.0, -63.0, -63.0, -64.0, -29.0, -62.0, -57.0, -43.0, -41.0, -62.0, -41.0, -63.0, -42.0, -59.0, -44.0, -33.0, -63.0, -39.0, -45.0, -62.0, -60.0, -45.0, -24.0, -64.0, -63.0, -24.0, -32.0, -21.0, -64.0, -25.0, -45.0, -40.0, -40.0, -43.0, -51.0, -34.0, -39.0, -35.0, -61.0, -41.0, -63.0, -40.0, -41.0, -41.0, -41.0, -35.0, -33.0, -62.0, -63.0, -63.0, -43.0, -50.0, -42.0, -32.0, -62.0, -63.0, -36.0, -41.0, -63.0, -34.0, -64.0, -44.0, -64.0, -35.0, -31.0, -39.0, -27.0, -40.0, -62.0, -26.0, -35.0, -34.0, -37.0, -38.0, -41.0, -42.0, -38.0, -37.0, -36.0, -64.0, -63.0, -43.0, -64.0, -61.0, -38.0, -34.0, -41.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.363324431545319, "mean_inference_ms": 18.734127574324205, "mean_action_processing_ms": 0.8139948749610437, "mean_env_wait_ms": 0.4769866503009531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5398297309875488, "StateBufferConnector_ms": 0.006805419921875, "ViewRequirementAgentConnector_ms": 0.25881075859069824}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -47.0, -44.0, -44.0, -37.0, -63.0, -34.0, -46.0, -60.0, -39.0, -63.0, -49.0, -36.0, -63.0, -63.0, -64.0, -29.0, -62.0, -57.0, -43.0, -41.0, -62.0, -41.0, -63.0, -42.0, -59.0, -44.0, -33.0, -63.0, -39.0, -45.0, -62.0, -60.0, -45.0, -24.0, -64.0, -63.0, -24.0, -32.0, -21.0, -64.0, -25.0, -45.0, -40.0, -40.0, -43.0, -51.0, -34.0, -39.0, -35.0, -61.0, -41.0, -63.0, -40.0, -41.0, -41.0, -41.0, -35.0, -33.0, -62.0, -63.0, -63.0, -43.0, -50.0, -42.0, -32.0, -62.0, -63.0, -36.0, -41.0, -63.0, -34.0, -64.0, -44.0, -64.0, -35.0, -31.0, -39.0, -27.0, -40.0, -62.0, -26.0, -35.0, -34.0, -37.0, -38.0, -41.0, -42.0, -38.0, -37.0, -36.0, -64.0, -63.0, -43.0, -64.0, -61.0, -38.0, -34.0, -41.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.363324431545319, "mean_inference_ms": 18.734127574324205, "mean_action_processing_ms": 0.8139948749610437, "mean_env_wait_ms": 0.4769866503009531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5398297309875488, "StateBufferConnector_ms": 0.006805419921875, "ViewRequirementAgentConnector_ms": 0.25881075859069824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.403995008416626, "num_agent_steps_trained_throughput_per_sec": 3.403995008416626, "timesteps_total": 31232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31232, "timers": {"training_iteration_time_ms": 152810.691, "sample_time_ms": 11036.486, "load_time_ms": 0.382, "load_throughput": 1339080.656, "learn_time_ms": 141773.292, "learn_throughput": 3.611, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "done": false, "episodes_total": 1952, "training_iteration": 61, "trial_id": "6f959_00019", "date": "2024-02-28_17-49-27", "timestamp": 1709138967, "time_this_iter_s": 150.4217450618744, "time_total_s": 9684.618972063065, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9684.618972063065, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 57.262149532710275, "ram_util_percent": 17.625700934579438}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.57, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.143984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.143984375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9682140493144592, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.910565932591757, "policy_loss": 0.0010358342279990515, "vf_loss": 9.80125126838684, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.26248741149902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.57, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.57, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.143984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.143984375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -45.0, -24.0, -64.0, -63.0, -24.0, -32.0, -21.0, -64.0, -25.0, -45.0, -40.0, -40.0, -43.0, -51.0, -34.0, -39.0, -35.0, -61.0, -41.0, -63.0, -40.0, -41.0, -41.0, -41.0, -35.0, -33.0, -62.0, -63.0, -63.0, -43.0, -50.0, -42.0, -32.0, -62.0, -63.0, -36.0, -41.0, -63.0, -34.0, -64.0, -44.0, -64.0, -35.0, -31.0, -39.0, -27.0, -40.0, -62.0, -26.0, -35.0, -34.0, -37.0, -38.0, -41.0, -42.0, -38.0, -37.0, -36.0, -64.0, -63.0, -43.0, -64.0, -61.0, -38.0, -34.0, -41.0, -32.0, -37.0, -27.0, -42.0, -44.0, -39.0, -64.0, -64.0, -64.0, -64.0, -64.0, -61.0, -33.0, -47.0, -62.0, -63.0, -36.0, -40.0, -30.0, -64.0, -32.0, -63.0, -63.0, -34.0, -38.0, -64.0, -38.0, -33.0, -36.0, -38.0, -62.0, -63.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3603206119187967, "mean_inference_ms": 18.715249750530432, "mean_action_processing_ms": 0.8130539324357926, "mean_env_wait_ms": 0.47645324455367716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.514840841293335, "StateBufferConnector_ms": 0.0066525936126708984, "ViewRequirementAgentConnector_ms": 0.2501349449157715}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.57, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -45.0, -24.0, -64.0, -63.0, -24.0, -32.0, -21.0, -64.0, -25.0, -45.0, -40.0, -40.0, -43.0, -51.0, -34.0, -39.0, -35.0, -61.0, -41.0, -63.0, -40.0, -41.0, -41.0, -41.0, -35.0, -33.0, -62.0, -63.0, -63.0, -43.0, -50.0, -42.0, -32.0, -62.0, -63.0, -36.0, -41.0, -63.0, -34.0, -64.0, -44.0, -64.0, -35.0, -31.0, -39.0, -27.0, -40.0, -62.0, -26.0, -35.0, -34.0, -37.0, -38.0, -41.0, -42.0, -38.0, -37.0, -36.0, -64.0, -63.0, -43.0, -64.0, -61.0, -38.0, -34.0, -41.0, -32.0, -37.0, -27.0, -42.0, -44.0, -39.0, -64.0, -64.0, -64.0, -64.0, -64.0, -61.0, -33.0, -47.0, -62.0, -63.0, -36.0, -40.0, -30.0, -64.0, -32.0, -63.0, -63.0, -34.0, -38.0, -64.0, -38.0, -33.0, -36.0, -38.0, -62.0, -63.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3603206119187967, "mean_inference_ms": 18.715249750530432, "mean_action_processing_ms": 0.8130539324357926, "mean_env_wait_ms": 0.47645324455367716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.514840841293335, "StateBufferConnector_ms": 0.0066525936126708984, "ViewRequirementAgentConnector_ms": 0.2501349449157715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4006306095076066, "num_agent_steps_trained_throughput_per_sec": 3.4006306095076066, "timesteps_total": 31744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 152716.593, "sample_time_ms": 11057.07, "load_time_ms": 0.4, "load_throughput": 1279711.369, "learn_time_ms": 141658.589, "learn_throughput": 3.614, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "episodes_total": 1984, "training_iteration": 62, "trial_id": "6f959_00019", "date": "2024-02-28_17-51-58", "timestamp": 1709139118, "time_this_iter_s": 150.57884430885315, "time_total_s": 9835.197816371918, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9835.197816371918, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 57.101401869158884, "ram_util_percent": 17.91355140186916}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.35, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.137890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.137890625, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9099375080317259, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.018390472730001, "policy_loss": -0.022414036692741016, "vf_loss": 9.945664505163828, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.91739006042481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.35, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.35, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.137890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.137890625, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -32.0, -62.0, -63.0, -36.0, -41.0, -63.0, -34.0, -64.0, -44.0, -64.0, -35.0, -31.0, -39.0, -27.0, -40.0, -62.0, -26.0, -35.0, -34.0, -37.0, -38.0, -41.0, -42.0, -38.0, -37.0, -36.0, -64.0, -63.0, -43.0, -64.0, -61.0, -38.0, -34.0, -41.0, -32.0, -37.0, -27.0, -42.0, -44.0, -39.0, -64.0, -64.0, -64.0, -64.0, -64.0, -61.0, -33.0, -47.0, -62.0, -63.0, -36.0, -40.0, -30.0, -64.0, -32.0, -63.0, -63.0, -34.0, -38.0, -64.0, -38.0, -33.0, -36.0, -38.0, -62.0, -63.0, -39.0, -64.0, -31.0, -44.0, -64.0, -31.0, -37.0, -37.0, -29.0, -38.0, -42.0, -34.0, -63.0, -64.0, -64.0, -36.0, -50.0, -40.0, -28.0, -33.0, -64.0, -63.0, -64.0, -39.0, -63.0, -63.0, -37.0, -36.0, -32.0, -63.0, -36.0, -51.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3577053358177404, "mean_inference_ms": 18.697399291082256, "mean_action_processing_ms": 0.8121653069026048, "mean_env_wait_ms": 0.47596640631726844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5211236476898193, "StateBufferConnector_ms": 0.006730794906616211, "ViewRequirementAgentConnector_ms": 0.2527341842651367}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.35, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -32.0, -62.0, -63.0, -36.0, -41.0, -63.0, -34.0, -64.0, -44.0, -64.0, -35.0, -31.0, -39.0, -27.0, -40.0, -62.0, -26.0, -35.0, -34.0, -37.0, -38.0, -41.0, -42.0, -38.0, -37.0, -36.0, -64.0, -63.0, -43.0, -64.0, -61.0, -38.0, -34.0, -41.0, -32.0, -37.0, -27.0, -42.0, -44.0, -39.0, -64.0, -64.0, -64.0, -64.0, -64.0, -61.0, -33.0, -47.0, -62.0, -63.0, -36.0, -40.0, -30.0, -64.0, -32.0, -63.0, -63.0, -34.0, -38.0, -64.0, -38.0, -33.0, -36.0, -38.0, -62.0, -63.0, -39.0, -64.0, -31.0, -44.0, -64.0, -31.0, -37.0, -37.0, -29.0, -38.0, -42.0, -34.0, -63.0, -64.0, -64.0, -36.0, -50.0, -40.0, -28.0, -33.0, -64.0, -63.0, -64.0, -39.0, -63.0, -63.0, -37.0, -36.0, -32.0, -63.0, -36.0, -51.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3577053358177404, "mean_inference_ms": 18.697399291082256, "mean_action_processing_ms": 0.8121653069026048, "mean_env_wait_ms": 0.47596640631726844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5211236476898193, "StateBufferConnector_ms": 0.006730794906616211, "ViewRequirementAgentConnector_ms": 0.2527341842651367}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3889237010409037, "num_agent_steps_trained_throughput_per_sec": 3.3889237010409037, "timesteps_total": 32256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 152634.412, "sample_time_ms": 11067.635, "load_time_ms": 0.416, "load_throughput": 1231143.523, "learn_time_ms": 141565.831, "learn_throughput": 3.617, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 2016, "training_iteration": 63, "trial_id": "6f959_00019", "date": "2024-02-28_17-54-29", "timestamp": 1709139269, "time_this_iter_s": 151.09068369865417, "time_total_s": 9986.288500070572, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9986.288500070572, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 56.91116279069768, "ram_util_percent": 17.81860465116279}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -47.22, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.13109375, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8515275334939361, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.025446657339732, "policy_loss": -0.02183965699902425, "vf_loss": 9.952795124053955, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.97411168416342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.22, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -47.22, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.13109375, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -34.0, -41.0, -32.0, -37.0, -27.0, -42.0, -44.0, -39.0, -64.0, -64.0, -64.0, -64.0, -64.0, -61.0, -33.0, -47.0, -62.0, -63.0, -36.0, -40.0, -30.0, -64.0, -32.0, -63.0, -63.0, -34.0, -38.0, -64.0, -38.0, -33.0, -36.0, -38.0, -62.0, -63.0, -39.0, -64.0, -31.0, -44.0, -64.0, -31.0, -37.0, -37.0, -29.0, -38.0, -42.0, -34.0, -63.0, -64.0, -64.0, -36.0, -50.0, -40.0, -28.0, -33.0, -64.0, -63.0, -64.0, -39.0, -63.0, -63.0, -37.0, -36.0, -32.0, -63.0, -36.0, -51.0, -64.0, -26.0, -30.0, -64.0, -37.0, -50.0, -64.0, -41.0, -63.0, -63.0, -32.0, -62.0, -62.0, -64.0, -40.0, -51.0, -39.0, -64.0, -63.0, -35.0, -64.0, -36.0, -60.0, -40.0, -42.0, 0.0, -27.0, -63.0, -64.0, -62.0, -50.0, -32.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3562111236590524, "mean_inference_ms": 18.687255301194938, "mean_action_processing_ms": 0.8116657430542893, "mean_env_wait_ms": 0.47571104951657717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5377511978149414, "StateBufferConnector_ms": 0.006853818893432617, "ViewRequirementAgentConnector_ms": 0.2563750743865967}}, "episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.22, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -34.0, -41.0, -32.0, -37.0, -27.0, -42.0, -44.0, -39.0, -64.0, -64.0, -64.0, -64.0, -64.0, -61.0, -33.0, -47.0, -62.0, -63.0, -36.0, -40.0, -30.0, -64.0, -32.0, -63.0, -63.0, -34.0, -38.0, -64.0, -38.0, -33.0, -36.0, -38.0, -62.0, -63.0, -39.0, -64.0, -31.0, -44.0, -64.0, -31.0, -37.0, -37.0, -29.0, -38.0, -42.0, -34.0, -63.0, -64.0, -64.0, -36.0, -50.0, -40.0, -28.0, -33.0, -64.0, -63.0, -64.0, -39.0, -63.0, -63.0, -37.0, -36.0, -32.0, -63.0, -36.0, -51.0, -64.0, -26.0, -30.0, -64.0, -37.0, -50.0, -64.0, -41.0, -63.0, -63.0, -32.0, -62.0, -62.0, -64.0, -40.0, -51.0, -39.0, -64.0, -63.0, -35.0, -64.0, -36.0, -60.0, -40.0, -42.0, 0.0, -27.0, -63.0, -64.0, -62.0, -50.0, -32.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3562111236590524, "mean_inference_ms": 18.687255301194938, "mean_action_processing_ms": 0.8116657430542893, "mean_env_wait_ms": 0.47571104951657717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5377511978149414, "StateBufferConnector_ms": 0.006853818893432617, "ViewRequirementAgentConnector_ms": 0.2563750743865967}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3440133154625618, "num_agent_steps_trained_throughput_per_sec": 3.3440133154625618, "timesteps_total": 32768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 152589.023, "sample_time_ms": 11038.517, "load_time_ms": 0.417, "load_throughput": 1228186.244, "learn_time_ms": 141549.571, "learn_throughput": 3.617, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 2048, "training_iteration": 64, "trial_id": "6f959_00019", "date": "2024-02-28_17-57-02", "timestamp": 1709139422, "time_this_iter_s": 153.11972784996033, "time_total_s": 10139.408227920532, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10139.408227920532, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 57.32211981566821, "ram_util_percent": 17.605069124423963}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.07, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.140078125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.140078125, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9574592389166355, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.989862755934398, "policy_loss": -0.03053574695562323, "vf_loss": 9.923215957482656, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.35639673868815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.07, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.07, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.140078125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.140078125, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -62.0, -63.0, -39.0, -64.0, -31.0, -44.0, -64.0, -31.0, -37.0, -37.0, -29.0, -38.0, -42.0, -34.0, -63.0, -64.0, -64.0, -36.0, -50.0, -40.0, -28.0, -33.0, -64.0, -63.0, -64.0, -39.0, -63.0, -63.0, -37.0, -36.0, -32.0, -63.0, -36.0, -51.0, -64.0, -26.0, -30.0, -64.0, -37.0, -50.0, -64.0, -41.0, -63.0, -63.0, -32.0, -62.0, -62.0, -64.0, -40.0, -51.0, -39.0, -64.0, -63.0, -35.0, -64.0, -36.0, -60.0, -40.0, -42.0, 0.0, -27.0, -63.0, -64.0, -62.0, -50.0, -32.0, -35.0, -34.0, -63.0, -41.0, -42.0, -32.0, -64.0, -42.0, -37.0, -40.0, -40.0, -38.0, -64.0, -37.0, -39.0, -43.0, -29.0, -35.0, -62.0, -30.0, -40.0, -31.0, -40.0, -63.0, -44.0, -64.0, -37.0, -48.0, -31.0, -26.0, -42.0, -34.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354880885807055, "mean_inference_ms": 18.67922741320122, "mean_action_processing_ms": 0.8113008371589178, "mean_env_wait_ms": 0.47553602227210745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5434174537658691, "StateBufferConnector_ms": 0.006923198699951172, "ViewRequirementAgentConnector_ms": 0.26045680046081543}}, "episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.07, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -62.0, -63.0, -39.0, -64.0, -31.0, -44.0, -64.0, -31.0, -37.0, -37.0, -29.0, -38.0, -42.0, -34.0, -63.0, -64.0, -64.0, -36.0, -50.0, -40.0, -28.0, -33.0, -64.0, -63.0, -64.0, -39.0, -63.0, -63.0, -37.0, -36.0, -32.0, -63.0, -36.0, -51.0, -64.0, -26.0, -30.0, -64.0, -37.0, -50.0, -64.0, -41.0, -63.0, -63.0, -32.0, -62.0, -62.0, -64.0, -40.0, -51.0, -39.0, -64.0, -63.0, -35.0, -64.0, -36.0, -60.0, -40.0, -42.0, 0.0, -27.0, -63.0, -64.0, -62.0, -50.0, -32.0, -35.0, -34.0, -63.0, -41.0, -42.0, -32.0, -64.0, -42.0, -37.0, -40.0, -40.0, -38.0, -64.0, -37.0, -39.0, -43.0, -29.0, -35.0, -62.0, -30.0, -40.0, -31.0, -40.0, -63.0, -44.0, -64.0, -37.0, -48.0, -31.0, -26.0, -42.0, -34.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354880885807055, "mean_inference_ms": 18.67922741320122, "mean_action_processing_ms": 0.8113008371589178, "mean_env_wait_ms": 0.47553602227210745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5434174537658691, "StateBufferConnector_ms": 0.006923198699951172, "ViewRequirementAgentConnector_ms": 0.26045680046081543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2021614120388304, "num_agent_steps_trained_throughput_per_sec": 3.2021614120388304, "timesteps_total": 33280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 153188.199, "sample_time_ms": 11072.43, "load_time_ms": 0.431, "load_throughput": 1187570.452, "learn_time_ms": 142114.814, "learn_throughput": 3.603, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 2080, "training_iteration": 65, "trial_id": "6f959_00019", "date": "2024-02-28_17-59-42", "timestamp": 1709139582, "time_this_iter_s": 159.90251517295837, "time_total_s": 10299.31074309349, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10299.31074309349, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 57.052863436123346, "ram_util_percent": 17.700440528634363}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.51, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.136640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.136640625, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9357959712545078, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.913339094320934, "policy_loss": -0.002109277093162139, "vf_loss": 9.80776187578837, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.58421688079834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.51, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.136640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.136640625, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -36.0, -51.0, -64.0, -26.0, -30.0, -64.0, -37.0, -50.0, -64.0, -41.0, -63.0, -63.0, -32.0, -62.0, -62.0, -64.0, -40.0, -51.0, -39.0, -64.0, -63.0, -35.0, -64.0, -36.0, -60.0, -40.0, -42.0, 0.0, -27.0, -63.0, -64.0, -62.0, -50.0, -32.0, -35.0, -34.0, -63.0, -41.0, -42.0, -32.0, -64.0, -42.0, -37.0, -40.0, -40.0, -38.0, -64.0, -37.0, -39.0, -43.0, -29.0, -35.0, -62.0, -30.0, -40.0, -31.0, -40.0, -63.0, -44.0, -64.0, -37.0, -48.0, -31.0, -26.0, -42.0, -34.0, -64.0, -40.0, -64.0, -64.0, -27.0, -63.0, -32.0, -34.0, -63.0, -21.0, -64.0, -42.0, -41.0, -62.0, -64.0, -60.0, -32.0, -36.0, -34.0, -64.0, -62.0, -64.0, -63.0, -38.0, -39.0, -38.0, -45.0, -51.0, -64.0, -33.0, -38.0, -62.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354836082820833, "mean_inference_ms": 18.680790156596153, "mean_action_processing_ms": 0.8114784298468396, "mean_env_wait_ms": 0.47568494800236394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5699241161346436, "StateBufferConnector_ms": 0.007147073745727539, "ViewRequirementAgentConnector_ms": 0.26879310607910156}}, "episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -36.0, -51.0, -64.0, -26.0, -30.0, -64.0, -37.0, -50.0, -64.0, -41.0, -63.0, -63.0, -32.0, -62.0, -62.0, -64.0, -40.0, -51.0, -39.0, -64.0, -63.0, -35.0, -64.0, -36.0, -60.0, -40.0, -42.0, 0.0, -27.0, -63.0, -64.0, -62.0, -50.0, -32.0, -35.0, -34.0, -63.0, -41.0, -42.0, -32.0, -64.0, -42.0, -37.0, -40.0, -40.0, -38.0, -64.0, -37.0, -39.0, -43.0, -29.0, -35.0, -62.0, -30.0, -40.0, -31.0, -40.0, -63.0, -44.0, -64.0, -37.0, -48.0, -31.0, -26.0, -42.0, -34.0, -64.0, -40.0, -64.0, -64.0, -27.0, -63.0, -32.0, -34.0, -63.0, -21.0, -64.0, -42.0, -41.0, -62.0, -64.0, -60.0, -32.0, -36.0, -34.0, -64.0, -62.0, -64.0, -63.0, -38.0, -39.0, -38.0, -45.0, -51.0, -64.0, -33.0, -38.0, -62.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354836082820833, "mean_inference_ms": 18.680790156596153, "mean_action_processing_ms": 0.8114784298468396, "mean_env_wait_ms": 0.47568494800236394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5699241161346436, "StateBufferConnector_ms": 0.007147073745727539, "ViewRequirementAgentConnector_ms": 0.26879310607910156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2432251813731425, "num_agent_steps_trained_throughput_per_sec": 3.2432251813731425, "timesteps_total": 33792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 153614.092, "sample_time_ms": 11182.468, "load_time_ms": 0.432, "load_throughput": 1184883.937, "learn_time_ms": 142430.662, "learn_throughput": 3.595, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "episodes_total": 2112, "training_iteration": 66, "trial_id": "6f959_00019", "date": "2024-02-28_18-02-20", "timestamp": 1709139740, "time_this_iter_s": 157.88255167007446, "time_total_s": 10457.193294763565, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10457.193294763565, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 56.074107142857144, "ram_util_percent": 17.87946428571429}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.64, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1434375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.1434375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9237534452229739, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.007688907782237, "policy_loss": -0.0359795025549829, "vf_loss": 9.948814956347148, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.56317977905273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.64, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1434375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.1434375, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -50.0, -32.0, -35.0, -34.0, -63.0, -41.0, -42.0, -32.0, -64.0, -42.0, -37.0, -40.0, -40.0, -38.0, -64.0, -37.0, -39.0, -43.0, -29.0, -35.0, -62.0, -30.0, -40.0, -31.0, -40.0, -63.0, -44.0, -64.0, -37.0, -48.0, -31.0, -26.0, -42.0, -34.0, -64.0, -40.0, -64.0, -64.0, -27.0, -63.0, -32.0, -34.0, -63.0, -21.0, -64.0, -42.0, -41.0, -62.0, -64.0, -60.0, -32.0, -36.0, -34.0, -64.0, -62.0, -64.0, -63.0, -38.0, -39.0, -38.0, -45.0, -51.0, -64.0, -33.0, -38.0, -62.0, -32.0, -63.0, -44.0, -24.0, -63.0, -43.0, -31.0, -41.0, -43.0, -43.0, -44.0, -63.0, -64.0, -54.0, -19.0, -31.0, -43.0, -63.0, -64.0, -46.0, -61.0, -31.0, -37.0, -38.0, -42.0, -25.0, -39.0, -62.0, -38.0, -39.0, -49.0, -64.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.35451376100089, "mean_inference_ms": 18.681630751723816, "mean_action_processing_ms": 0.8116032402596971, "mean_env_wait_ms": 0.4758087456717783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5720565319061279, "StateBufferConnector_ms": 0.0071773529052734375, "ViewRequirementAgentConnector_ms": 0.2705404758453369}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -50.0, -32.0, -35.0, -34.0, -63.0, -41.0, -42.0, -32.0, -64.0, -42.0, -37.0, -40.0, -40.0, -38.0, -64.0, -37.0, -39.0, -43.0, -29.0, -35.0, -62.0, -30.0, -40.0, -31.0, -40.0, -63.0, -44.0, -64.0, -37.0, -48.0, -31.0, -26.0, -42.0, -34.0, -64.0, -40.0, -64.0, -64.0, -27.0, -63.0, -32.0, -34.0, -63.0, -21.0, -64.0, -42.0, -41.0, -62.0, -64.0, -60.0, -32.0, -36.0, -34.0, -64.0, -62.0, -64.0, -63.0, -38.0, -39.0, -38.0, -45.0, -51.0, -64.0, -33.0, -38.0, -62.0, -32.0, -63.0, -44.0, -24.0, -63.0, -43.0, -31.0, -41.0, -43.0, -43.0, -44.0, -63.0, -64.0, -54.0, -19.0, -31.0, -43.0, -63.0, -64.0, -46.0, -61.0, -31.0, -37.0, -38.0, -42.0, -25.0, -39.0, -62.0, -38.0, -39.0, -49.0, -64.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.35451376100089, "mean_inference_ms": 18.681630751723816, "mean_action_processing_ms": 0.8116032402596971, "mean_env_wait_ms": 0.4758087456717783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5720565319061279, "StateBufferConnector_ms": 0.0071773529052734375, "ViewRequirementAgentConnector_ms": 0.2705404758453369}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.329289281384172, "num_agent_steps_trained_throughput_per_sec": 3.329289281384172, "timesteps_total": 34304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34304, "timers": {"training_iteration_time_ms": 153683.216, "sample_time_ms": 11191.099, "load_time_ms": 0.416, "load_throughput": 1231779.08, "learn_time_ms": 142491.169, "learn_throughput": 3.593, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "done": false, "episodes_total": 2144, "training_iteration": 67, "trial_id": "6f959_00019", "date": "2024-02-28_18-04-54", "timestamp": 1709139894, "time_this_iter_s": 153.79709315299988, "time_total_s": 10610.990387916565, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10610.990387916565, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 57.24155251141551, "ram_util_percent": 17.821461187214613}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.49, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.144609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.144609375, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.924385329335928, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.946636970837911, "policy_loss": -0.013388859379726151, "vf_loss": 9.856800929705303, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.25155086517334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.49, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.49, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.144609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.144609375, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-26.0, -42.0, -34.0, -64.0, -40.0, -64.0, -64.0, -27.0, -63.0, -32.0, -34.0, -63.0, -21.0, -64.0, -42.0, -41.0, -62.0, -64.0, -60.0, -32.0, -36.0, -34.0, -64.0, -62.0, -64.0, -63.0, -38.0, -39.0, -38.0, -45.0, -51.0, -64.0, -33.0, -38.0, -62.0, -32.0, -63.0, -44.0, -24.0, -63.0, -43.0, -31.0, -41.0, -43.0, -43.0, -44.0, -63.0, -64.0, -54.0, -19.0, -31.0, -43.0, -63.0, -64.0, -46.0, -61.0, -31.0, -37.0, -38.0, -42.0, -25.0, -39.0, -62.0, -38.0, -39.0, -49.0, -64.0, -62.0, -62.0, -64.0, -13.0, -37.0, -46.0, -64.0, -19.0, -63.0, -64.0, -64.0, -37.0, -63.0, -49.0, -17.0, -34.0, -38.0, -63.0, -41.0, -18.0, -43.0, -36.0, -12.0, -62.0, -63.0, -41.0, -34.0, -62.0, -34.0, -44.0, -64.0, -12.0, -11.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3541797854055213, "mean_inference_ms": 18.681395713468035, "mean_action_processing_ms": 0.8116959929249586, "mean_env_wait_ms": 0.4758985154863237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5687942504882812, "StateBufferConnector_ms": 0.007153749465942383, "ViewRequirementAgentConnector_ms": 0.2695484161376953}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.49, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.0, -42.0, -34.0, -64.0, -40.0, -64.0, -64.0, -27.0, -63.0, -32.0, -34.0, -63.0, -21.0, -64.0, -42.0, -41.0, -62.0, -64.0, -60.0, -32.0, -36.0, -34.0, -64.0, -62.0, -64.0, -63.0, -38.0, -39.0, -38.0, -45.0, -51.0, -64.0, -33.0, -38.0, -62.0, -32.0, -63.0, -44.0, -24.0, -63.0, -43.0, -31.0, -41.0, -43.0, -43.0, -44.0, -63.0, -64.0, -54.0, -19.0, -31.0, -43.0, -63.0, -64.0, -46.0, -61.0, -31.0, -37.0, -38.0, -42.0, -25.0, -39.0, -62.0, -38.0, -39.0, -49.0, -64.0, -62.0, -62.0, -64.0, -13.0, -37.0, -46.0, -64.0, -19.0, -63.0, -64.0, -64.0, -37.0, -63.0, -49.0, -17.0, -34.0, -38.0, -63.0, -41.0, -18.0, -43.0, -36.0, -12.0, -62.0, -63.0, -41.0, -34.0, -62.0, -34.0, -44.0, -64.0, -12.0, -11.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3541797854055213, "mean_inference_ms": 18.681395713468035, "mean_action_processing_ms": 0.8116959929249586, "mean_env_wait_ms": 0.4758985154863237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5687942504882812, "StateBufferConnector_ms": 0.007153749465942383, "ViewRequirementAgentConnector_ms": 0.2695484161376953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2818749125683144, "num_agent_steps_trained_throughput_per_sec": 3.2818749125683144, "timesteps_total": 34816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 154138.409, "sample_time_ms": 11191.443, "load_time_ms": 0.401, "load_throughput": 1276592.348, "learn_time_ms": 142946.049, "learn_throughput": 3.582, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "episodes_total": 2176, "training_iteration": 68, "trial_id": "6f959_00019", "date": "2024-02-28_18-07-30", "timestamp": 1709140050, "time_this_iter_s": 156.0185751914978, "time_total_s": 10767.008963108063, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10767.008963108063, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.269819819819816, "ram_util_percent": 17.580630630630626}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.36, "reward_total_min": -64, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.145625, "reward_score_min": 0.0, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8971809900676211, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.941737973690033, "policy_loss": -0.005140194979806741, "vf_loss": 9.842337393760682, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.15197893778483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "sampler_results": {"episode_reward_max": -9.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.36, "reward_total_min": -64, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.145625, "reward_score_min": 0.0, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-33.0, -38.0, -62.0, -32.0, -63.0, -44.0, -24.0, -63.0, -43.0, -31.0, -41.0, -43.0, -43.0, -44.0, -63.0, -64.0, -54.0, -19.0, -31.0, -43.0, -63.0, -64.0, -46.0, -61.0, -31.0, -37.0, -38.0, -42.0, -25.0, -39.0, -62.0, -38.0, -39.0, -49.0, -64.0, -62.0, -62.0, -64.0, -13.0, -37.0, -46.0, -64.0, -19.0, -63.0, -64.0, -64.0, -37.0, -63.0, -49.0, -17.0, -34.0, -38.0, -63.0, -41.0, -18.0, -43.0, -36.0, -12.0, -62.0, -63.0, -41.0, -34.0, -62.0, -34.0, -44.0, -64.0, -12.0, -11.0, -59.0, -64.0, -41.0, -12.0, -41.0, -64.0, -64.0, -36.0, -62.0, -46.0, -41.0, -63.0, -59.0, -64.0, -63.0, -38.0, -47.0, -22.0, -64.0, -9.0, -64.0, -16.0, -62.0, -63.0, -21.0, -59.0, -64.0, -40.0, -36.0, -37.0, -61.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3540929916740962, "mean_inference_ms": 18.682458467133173, "mean_action_processing_ms": 0.8118328367115517, "mean_env_wait_ms": 0.4759624857744951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5687353610992432, "StateBufferConnector_ms": 0.007117271423339844, "ViewRequirementAgentConnector_ms": 0.2681872844696045}}, "episode_reward_max": -9.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33.0, -38.0, -62.0, -32.0, -63.0, -44.0, -24.0, -63.0, -43.0, -31.0, -41.0, -43.0, -43.0, -44.0, -63.0, -64.0, -54.0, -19.0, -31.0, -43.0, -63.0, -64.0, -46.0, -61.0, -31.0, -37.0, -38.0, -42.0, -25.0, -39.0, -62.0, -38.0, -39.0, -49.0, -64.0, -62.0, -62.0, -64.0, -13.0, -37.0, -46.0, -64.0, -19.0, -63.0, -64.0, -64.0, -37.0, -63.0, -49.0, -17.0, -34.0, -38.0, -63.0, -41.0, -18.0, -43.0, -36.0, -12.0, -62.0, -63.0, -41.0, -34.0, -62.0, -34.0, -44.0, -64.0, -12.0, -11.0, -59.0, -64.0, -41.0, -12.0, -41.0, -64.0, -64.0, -36.0, -62.0, -46.0, -41.0, -63.0, -59.0, -64.0, -63.0, -38.0, -47.0, -22.0, -64.0, -9.0, -64.0, -16.0, -62.0, -63.0, -21.0, -59.0, -64.0, -40.0, -36.0, -37.0, -61.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3540929916740962, "mean_inference_ms": 18.682458467133173, "mean_action_processing_ms": 0.8118328367115517, "mean_env_wait_ms": 0.4759624857744951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5687353610992432, "StateBufferConnector_ms": 0.007117271423339844, "ViewRequirementAgentConnector_ms": 0.2681872844696045}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.144109916377986, "num_agent_steps_trained_throughput_per_sec": 3.144109916377986, "timesteps_total": 35328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35328, "timers": {"training_iteration_time_ms": 154888.843, "sample_time_ms": 11221.265, "load_time_ms": 0.41, "load_throughput": 1248464.42, "learn_time_ms": 143666.647, "learn_throughput": 3.564, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "done": false, "episodes_total": 2208, "training_iteration": 69, "trial_id": "6f959_00019", "date": "2024-02-28_18-10-13", "timestamp": 1709140213, "time_this_iter_s": 162.86489367485046, "time_total_s": 10929.873856782913, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10929.873856782913, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.057575757575755, "ram_util_percent": 17.707359307359308}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.88, "reward_total_min": -64, "reward_total_max": -6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1415625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.453125, "reward_score_mean": 0.1415625, "reward_score_min": 0.0, "reward_score_max": 0.453125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8924245680371921, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.889749161402385, "policy_loss": 0.005736626436312993, "vf_loss": 9.773179701964061, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.11930497487386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "sampler_results": {"episode_reward_max": -6.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.88, "reward_total_min": -64, "reward_total_max": -6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1415625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.453125, "reward_score_mean": 0.1415625, "reward_score_min": 0.0, "reward_score_max": 0.453125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-39.0, -49.0, -64.0, -62.0, -62.0, -64.0, -13.0, -37.0, -46.0, -64.0, -19.0, -63.0, -64.0, -64.0, -37.0, -63.0, -49.0, -17.0, -34.0, -38.0, -63.0, -41.0, -18.0, -43.0, -36.0, -12.0, -62.0, -63.0, -41.0, -34.0, -62.0, -34.0, -44.0, -64.0, -12.0, -11.0, -59.0, -64.0, -41.0, -12.0, -41.0, -64.0, -64.0, -36.0, -62.0, -46.0, -41.0, -63.0, -59.0, -64.0, -63.0, -38.0, -47.0, -22.0, -64.0, -9.0, -64.0, -16.0, -62.0, -63.0, -21.0, -59.0, -64.0, -40.0, -36.0, -37.0, -61.0, -42.0, -61.0, -61.0, -45.0, -62.0, -42.0, -62.0, -62.0, -43.0, -43.0, -64.0, -44.0, -47.0, -9.0, -64.0, -12.0, -39.0, -33.0, -50.0, -39.0, -6.0, -64.0, -60.0, -63.0, -45.0, -18.0, -37.0, -64.0, -9.0, -60.0, -40.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.353933685247889, "mean_inference_ms": 18.682520282212117, "mean_action_processing_ms": 0.8119830374024701, "mean_env_wait_ms": 0.4760105746871606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5635161399841309, "StateBufferConnector_ms": 0.007065534591674805, "ViewRequirementAgentConnector_ms": 0.267683744430542}}, "episode_reward_max": -6.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.0, -49.0, -64.0, -62.0, -62.0, -64.0, -13.0, -37.0, -46.0, -64.0, -19.0, -63.0, -64.0, -64.0, -37.0, -63.0, -49.0, -17.0, -34.0, -38.0, -63.0, -41.0, -18.0, -43.0, -36.0, -12.0, -62.0, -63.0, -41.0, -34.0, -62.0, -34.0, -44.0, -64.0, -12.0, -11.0, -59.0, -64.0, -41.0, -12.0, -41.0, -64.0, -64.0, -36.0, -62.0, -46.0, -41.0, -63.0, -59.0, -64.0, -63.0, -38.0, -47.0, -22.0, -64.0, -9.0, -64.0, -16.0, -62.0, -63.0, -21.0, -59.0, -64.0, -40.0, -36.0, -37.0, -61.0, -42.0, -61.0, -61.0, -45.0, -62.0, -42.0, -62.0, -62.0, -43.0, -43.0, -64.0, -44.0, -47.0, -9.0, -64.0, -12.0, -39.0, -33.0, -50.0, -39.0, -6.0, -64.0, -60.0, -63.0, -45.0, -18.0, -37.0, -64.0, -9.0, -60.0, -40.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.353933685247889, "mean_inference_ms": 18.682520282212117, "mean_action_processing_ms": 0.8119830374024701, "mean_env_wait_ms": 0.4760105746871606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5635161399841309, "StateBufferConnector_ms": 0.007065534591674805, "ViewRequirementAgentConnector_ms": 0.267683744430542}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0625164056224357, "num_agent_steps_trained_throughput_per_sec": 3.0625164056224357, "timesteps_total": 35840, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 156274.275, "sample_time_ms": 11270.564, "load_time_ms": 0.41, "load_throughput": 1250063.245, "learn_time_ms": 145002.773, "learn_throughput": 3.531, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "episodes_total": 2240, "training_iteration": 70, "trial_id": "6f959_00019", "date": "2024-02-28_18-13-00", "timestamp": 1709140380, "time_this_iter_s": 167.19330835342407, "time_total_s": 11097.067165136337, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11097.067165136337, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 57.005907172995784, "ram_util_percent": 17.718565400843886}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.97, "reward_total_min": -64, "reward_total_max": -6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.453125, "reward_score_mean": 0.133046875, "reward_score_min": 0.0, "reward_score_max": 0.453125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8739080322906375, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.000181893507639, "policy_loss": 0.003003558764855067, "vf_loss": 9.897671870390575, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.8477908452352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "sampler_results": {"episode_reward_max": -6.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.97, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.97, "reward_total_min": -64, "reward_total_max": -6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.453125, "reward_score_mean": 0.133046875, "reward_score_min": 0.0, "reward_score_max": 0.453125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -64.0, -12.0, -11.0, -59.0, -64.0, -41.0, -12.0, -41.0, -64.0, -64.0, -36.0, -62.0, -46.0, -41.0, -63.0, -59.0, -64.0, -63.0, -38.0, -47.0, -22.0, -64.0, -9.0, -64.0, -16.0, -62.0, -63.0, -21.0, -59.0, -64.0, -40.0, -36.0, -37.0, -61.0, -42.0, -61.0, -61.0, -45.0, -62.0, -42.0, -62.0, -62.0, -43.0, -43.0, -64.0, -44.0, -47.0, -9.0, -64.0, -12.0, -39.0, -33.0, -50.0, -39.0, -6.0, -64.0, -60.0, -63.0, -45.0, -18.0, -37.0, -64.0, -9.0, -60.0, -40.0, -64.0, -64.0, -60.0, -21.0, -35.0, -64.0, -64.0, -46.0, -35.0, -37.0, -64.0, -47.0, -64.0, -46.0, -64.0, -64.0, -36.0, -50.0, -26.0, -40.0, -63.0, -41.0, -25.0, -44.0, -45.0, -47.0, -63.0, -64.0, -45.0, -17.0, -60.0, -63.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355236097847419, "mean_inference_ms": 18.691730916553155, "mean_action_processing_ms": 0.8126535704313618, "mean_env_wait_ms": 0.4763388794443804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5944600105285645, "StateBufferConnector_ms": 0.00724482536315918, "ViewRequirementAgentConnector_ms": 0.2762117385864258}}, "episode_reward_max": -6.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.97, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -64.0, -12.0, -11.0, -59.0, -64.0, -41.0, -12.0, -41.0, -64.0, -64.0, -36.0, -62.0, -46.0, -41.0, -63.0, -59.0, -64.0, -63.0, -38.0, -47.0, -22.0, -64.0, -9.0, -64.0, -16.0, -62.0, -63.0, -21.0, -59.0, -64.0, -40.0, -36.0, -37.0, -61.0, -42.0, -61.0, -61.0, -45.0, -62.0, -42.0, -62.0, -62.0, -43.0, -43.0, -64.0, -44.0, -47.0, -9.0, -64.0, -12.0, -39.0, -33.0, -50.0, -39.0, -6.0, -64.0, -60.0, -63.0, -45.0, -18.0, -37.0, -64.0, -9.0, -60.0, -40.0, -64.0, -64.0, -60.0, -21.0, -35.0, -64.0, -64.0, -46.0, -35.0, -37.0, -64.0, -47.0, -64.0, -46.0, -64.0, -64.0, -36.0, -50.0, -26.0, -40.0, -63.0, -41.0, -25.0, -44.0, -45.0, -47.0, -63.0, -64.0, -45.0, -17.0, -60.0, -63.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355236097847419, "mean_inference_ms": 18.691730916553155, "mean_action_processing_ms": 0.8126535704313618, "mean_env_wait_ms": 0.4763388794443804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5944600105285645, "StateBufferConnector_ms": 0.00724482536315918, "ViewRequirementAgentConnector_ms": 0.2762117385864258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2309322684348234, "num_agent_steps_trained_throughput_per_sec": 3.2309322684348234, "timesteps_total": 36352, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36352, "timers": {"training_iteration_time_ms": 157079.94, "sample_time_ms": 11447.332, "load_time_ms": 0.412, "load_throughput": 1243980.564, "learn_time_ms": 145631.641, "learn_throughput": 3.516, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "done": false, "episodes_total": 2272, "training_iteration": 71, "trial_id": "6f959_00019", "date": "2024-02-28_18-15-39", "timestamp": 1709140539, "time_this_iter_s": 158.4791750907898, "time_total_s": 11255.546340227127, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11255.546340227127, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 57.01814159292035, "ram_util_percent": 17.750000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.5, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.13671875, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.93614478657643, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.97970724105835, "policy_loss": -0.01761743432531754, "vf_loss": 9.897832870483398, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.3201499303182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.5, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.13671875, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-36.0, -37.0, -61.0, -42.0, -61.0, -61.0, -45.0, -62.0, -42.0, -62.0, -62.0, -43.0, -43.0, -64.0, -44.0, -47.0, -9.0, -64.0, -12.0, -39.0, -33.0, -50.0, -39.0, -6.0, -64.0, -60.0, -63.0, -45.0, -18.0, -37.0, -64.0, -9.0, -60.0, -40.0, -64.0, -64.0, -60.0, -21.0, -35.0, -64.0, -64.0, -46.0, -35.0, -37.0, -64.0, -47.0, -64.0, -46.0, -64.0, -64.0, -36.0, -50.0, -26.0, -40.0, -63.0, -41.0, -25.0, -44.0, -45.0, -47.0, -63.0, -64.0, -45.0, -17.0, -60.0, -63.0, -62.0, -64.0, -64.0, -64.0, -2.0, -40.0, -44.0, -62.0, -62.0, -45.0, -12.0, -64.0, -49.0, -39.0, -11.0, -45.0, -39.0, -64.0, -50.0, -54.0, -64.0, 0.0, -63.0, -5.0, -62.0, -62.0, -64.0, -33.0, -9.0, -29.0, -62.0, -64.0, -42.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3551270529919, "mean_inference_ms": 18.689544811775622, "mean_action_processing_ms": 0.8127048047512261, "mean_env_wait_ms": 0.476365747858768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5752847194671631, "StateBufferConnector_ms": 0.007120370864868164, "ViewRequirementAgentConnector_ms": 0.2691500186920166}}, "episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.0, -37.0, -61.0, -42.0, -61.0, -61.0, -45.0, -62.0, -42.0, -62.0, -62.0, -43.0, -43.0, -64.0, -44.0, -47.0, -9.0, -64.0, -12.0, -39.0, -33.0, -50.0, -39.0, -6.0, -64.0, -60.0, -63.0, -45.0, -18.0, -37.0, -64.0, -9.0, -60.0, -40.0, -64.0, -64.0, -60.0, -21.0, -35.0, -64.0, -64.0, -46.0, -35.0, -37.0, -64.0, -47.0, -64.0, -46.0, -64.0, -64.0, -36.0, -50.0, -26.0, -40.0, -63.0, -41.0, -25.0, -44.0, -45.0, -47.0, -63.0, -64.0, -45.0, -17.0, -60.0, -63.0, -62.0, -64.0, -64.0, -64.0, -2.0, -40.0, -44.0, -62.0, -62.0, -45.0, -12.0, -64.0, -49.0, -39.0, -11.0, -45.0, -39.0, -64.0, -50.0, -54.0, -64.0, 0.0, -63.0, -5.0, -62.0, -62.0, -64.0, -33.0, -9.0, -29.0, -62.0, -64.0, -42.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3551270529919, "mean_inference_ms": 18.689544811775622, "mean_action_processing_ms": 0.8127048047512261, "mean_env_wait_ms": 0.476365747858768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5752847194671631, "StateBufferConnector_ms": 0.007120370864868164, "ViewRequirementAgentConnector_ms": 0.2691500186920166}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1670057259073667, "num_agent_steps_trained_throughput_per_sec": 3.1670057259073667, "timesteps_total": 36864, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 158190.598, "sample_time_ms": 11410.985, "load_time_ms": 0.397, "load_throughput": 1288464.42, "learn_time_ms": 146778.655, "learn_throughput": 3.488, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 2304, "training_iteration": 72, "trial_id": "6f959_00019", "date": "2024-02-28_18-18-20", "timestamp": 1709140700, "time_this_iter_s": 161.67728233337402, "time_total_s": 11417.223622560501, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11417.223622560501, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 56.58471615720525, "ram_util_percent": 17.62096069868996}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.39, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.145390625, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9437972125907739, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.06158481836319, "policy_loss": -0.012193953587363164, "vf_loss": 9.981939021746317, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.95649452209473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.39, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.39, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.145390625, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -40.0, -64.0, -64.0, -60.0, -21.0, -35.0, -64.0, -64.0, -46.0, -35.0, -37.0, -64.0, -47.0, -64.0, -46.0, -64.0, -64.0, -36.0, -50.0, -26.0, -40.0, -63.0, -41.0, -25.0, -44.0, -45.0, -47.0, -63.0, -64.0, -45.0, -17.0, -60.0, -63.0, -62.0, -64.0, -64.0, -64.0, -2.0, -40.0, -44.0, -62.0, -62.0, -45.0, -12.0, -64.0, -49.0, -39.0, -11.0, -45.0, -39.0, -64.0, -50.0, -54.0, -64.0, 0.0, -63.0, -5.0, -62.0, -62.0, -64.0, -33.0, -9.0, -29.0, -62.0, -64.0, -42.0, -63.0, -61.0, -43.0, -1.0, -50.0, -63.0, -42.0, -39.0, -8.0, -25.0, -64.0, -9.0, -27.0, -63.0, -46.0, -30.0, -41.0, -49.0, -20.0, -63.0, -45.0, -3.0, -37.0, -63.0, -19.0, -64.0, -42.0, -60.0, -43.0, -64.0, -24.0, -61.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355030801580674, "mean_inference_ms": 18.68577738545099, "mean_action_processing_ms": 0.8126103357387393, "mean_env_wait_ms": 0.47635120501343337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5588932037353516, "StateBufferConnector_ms": 0.00706934928894043, "ViewRequirementAgentConnector_ms": 0.26353955268859863}}, "episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.39, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -40.0, -64.0, -64.0, -60.0, -21.0, -35.0, -64.0, -64.0, -46.0, -35.0, -37.0, -64.0, -47.0, -64.0, -46.0, -64.0, -64.0, -36.0, -50.0, -26.0, -40.0, -63.0, -41.0, -25.0, -44.0, -45.0, -47.0, -63.0, -64.0, -45.0, -17.0, -60.0, -63.0, -62.0, -64.0, -64.0, -64.0, -2.0, -40.0, -44.0, -62.0, -62.0, -45.0, -12.0, -64.0, -49.0, -39.0, -11.0, -45.0, -39.0, -64.0, -50.0, -54.0, -64.0, 0.0, -63.0, -5.0, -62.0, -62.0, -64.0, -33.0, -9.0, -29.0, -62.0, -64.0, -42.0, -63.0, -61.0, -43.0, -1.0, -50.0, -63.0, -42.0, -39.0, -8.0, -25.0, -64.0, -9.0, -27.0, -63.0, -46.0, -30.0, -41.0, -49.0, -20.0, -63.0, -45.0, -3.0, -37.0, -63.0, -19.0, -64.0, -42.0, -60.0, -43.0, -64.0, -24.0, -61.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355030801580674, "mean_inference_ms": 18.68577738545099, "mean_action_processing_ms": 0.8126103357387393, "mean_env_wait_ms": 0.47635120501343337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5588932037353516, "StateBufferConnector_ms": 0.00706934928894043, "ViewRequirementAgentConnector_ms": 0.26353955268859863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2398485426031938, "num_agent_steps_trained_throughput_per_sec": 3.2398485426031938, "timesteps_total": 37376, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37376, "timers": {"training_iteration_time_ms": 158885.764, "sample_time_ms": 11428.09, "load_time_ms": 0.385, "load_throughput": 1330287.832, "learn_time_ms": 147456.709, "learn_throughput": 3.472, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "done": false, "episodes_total": 2336, "training_iteration": 73, "trial_id": "6f959_00019", "date": "2024-02-28_18-20-59", "timestamp": 1709140859, "time_this_iter_s": 158.05301880836487, "time_total_s": 11575.276641368866, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11575.276641368866, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 56.66533333333333, "ram_util_percent": 17.80933333333334}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.96, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.14875, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7440621750807622, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.083837723731994, "policy_loss": 0.009216184116667137, "vf_loss": 9.982866088549295, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.307932472229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "sampler_results": {"episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.96, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.14875, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -63.0, -62.0, -64.0, -64.0, -64.0, -2.0, -40.0, -44.0, -62.0, -62.0, -45.0, -12.0, -64.0, -49.0, -39.0, -11.0, -45.0, -39.0, -64.0, -50.0, -54.0, -64.0, 0.0, -63.0, -5.0, -62.0, -62.0, -64.0, -33.0, -9.0, -29.0, -62.0, -64.0, -42.0, -63.0, -61.0, -43.0, -1.0, -50.0, -63.0, -42.0, -39.0, -8.0, -25.0, -64.0, -9.0, -27.0, -63.0, -46.0, -30.0, -41.0, -49.0, -20.0, -63.0, -45.0, -3.0, -37.0, -63.0, -19.0, -64.0, -42.0, -60.0, -43.0, -64.0, -24.0, -61.0, -44.0, -47.0, -9.0, -51.0, 9.0, -63.0, -49.0, -64.0, -64.0, -37.0, -64.0, -60.0, 0.0, -64.0, -41.0, -34.0, -40.0, -64.0, -54.0, -47.0, -63.0, -64.0, -48.0, -63.0, -13.0, -39.0, -63.0, -5.0, -64.0, -62.0, -63.0, -64.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.353955856575238, "mean_inference_ms": 18.676794232099127, "mean_action_processing_ms": 0.8121754462543105, "mean_env_wait_ms": 0.47616024047303734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5422213077545166, "StateBufferConnector_ms": 0.006977081298828125, "ViewRequirementAgentConnector_ms": 0.2582859992980957}}, "episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -63.0, -62.0, -64.0, -64.0, -64.0, -2.0, -40.0, -44.0, -62.0, -62.0, -45.0, -12.0, -64.0, -49.0, -39.0, -11.0, -45.0, -39.0, -64.0, -50.0, -54.0, -64.0, 0.0, -63.0, -5.0, -62.0, -62.0, -64.0, -33.0, -9.0, -29.0, -62.0, -64.0, -42.0, -63.0, -61.0, -43.0, -1.0, -50.0, -63.0, -42.0, -39.0, -8.0, -25.0, -64.0, -9.0, -27.0, -63.0, -46.0, -30.0, -41.0, -49.0, -20.0, -63.0, -45.0, -3.0, -37.0, -63.0, -19.0, -64.0, -42.0, -60.0, -43.0, -64.0, -24.0, -61.0, -44.0, -47.0, -9.0, -51.0, 9.0, -63.0, -49.0, -64.0, -64.0, -37.0, -64.0, -60.0, 0.0, -64.0, -41.0, -34.0, -40.0, -64.0, -54.0, -47.0, -63.0, -64.0, -48.0, -63.0, -13.0, -39.0, -63.0, -5.0, -64.0, -62.0, -63.0, -64.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.353955856575238, "mean_inference_ms": 18.676794232099127, "mean_action_processing_ms": 0.8121754462543105, "mean_env_wait_ms": 0.47616024047303734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5422213077545166, "StateBufferConnector_ms": 0.006977081298828125, "ViewRequirementAgentConnector_ms": 0.2582859992980957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1307007723437117, "num_agent_steps_trained_throughput_per_sec": 3.1307007723437117, "timesteps_total": 37888, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 159928.982, "sample_time_ms": 11422.806, "load_time_ms": 0.388, "load_throughput": 1320147.322, "learn_time_ms": 148505.175, "learn_throughput": 3.448, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "episodes_total": 2368, "training_iteration": 74, "trial_id": "6f959_00019", "date": "2024-02-28_18-23-42", "timestamp": 1709141022, "time_this_iter_s": 163.5628798007965, "time_total_s": 11738.839521169662, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11738.839521169662, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.067672413793105, "ram_util_percent": 17.7646551724138}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.96, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.14875, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8395070464660724, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.043459967772167, "policy_loss": 0.00407586470246315, "vf_loss": 9.944101826349895, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.0872584025065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.96, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.14875, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -64.0, -42.0, -63.0, -61.0, -43.0, -1.0, -50.0, -63.0, -42.0, -39.0, -8.0, -25.0, -64.0, -9.0, -27.0, -63.0, -46.0, -30.0, -41.0, -49.0, -20.0, -63.0, -45.0, -3.0, -37.0, -63.0, -19.0, -64.0, -42.0, -60.0, -43.0, -64.0, -24.0, -61.0, -44.0, -47.0, -9.0, -51.0, 9.0, -63.0, -49.0, -64.0, -64.0, -37.0, -64.0, -60.0, 0.0, -64.0, -41.0, -34.0, -40.0, -64.0, -54.0, -47.0, -63.0, -64.0, -48.0, -63.0, -13.0, -39.0, -63.0, -5.0, -64.0, -62.0, -63.0, -64.0, -48.0, -63.0, -44.0, -16.0, -1.0, -34.0, -45.0, -53.0, -50.0, -47.0, -50.0, -48.0, -63.0, -64.0, -43.0, -64.0, -64.0, -43.0, -23.0, -64.0, -63.0, -64.0, -63.0, -64.0, -55.0, -46.0, -50.0, -45.0, -64.0, -47.0, -8.0, -4.0, 2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354676240877551, "mean_inference_ms": 18.681159448807904, "mean_action_processing_ms": 0.8124079426762943, "mean_env_wait_ms": 0.4763490052092683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5873463153839111, "StateBufferConnector_ms": 0.007284402847290039, "ViewRequirementAgentConnector_ms": 0.27048349380493164}}, "episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -64.0, -42.0, -63.0, -61.0, -43.0, -1.0, -50.0, -63.0, -42.0, -39.0, -8.0, -25.0, -64.0, -9.0, -27.0, -63.0, -46.0, -30.0, -41.0, -49.0, -20.0, -63.0, -45.0, -3.0, -37.0, -63.0, -19.0, -64.0, -42.0, -60.0, -43.0, -64.0, -24.0, -61.0, -44.0, -47.0, -9.0, -51.0, 9.0, -63.0, -49.0, -64.0, -64.0, -37.0, -64.0, -60.0, 0.0, -64.0, -41.0, -34.0, -40.0, -64.0, -54.0, -47.0, -63.0, -64.0, -48.0, -63.0, -13.0, -39.0, -63.0, -5.0, -64.0, -62.0, -63.0, -64.0, -48.0, -63.0, -44.0, -16.0, -1.0, -34.0, -45.0, -53.0, -50.0, -47.0, -50.0, -48.0, -63.0, -64.0, -43.0, -64.0, -64.0, -43.0, -23.0, -64.0, -63.0, -64.0, -63.0, -64.0, -55.0, -46.0, -50.0, -45.0, -64.0, -47.0, -8.0, -4.0, 2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354676240877551, "mean_inference_ms": 18.681159448807904, "mean_action_processing_ms": 0.8124079426762943, "mean_env_wait_ms": 0.4763490052092683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5873463153839111, "StateBufferConnector_ms": 0.007284402847290039, "ViewRequirementAgentConnector_ms": 0.27048349380493164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0958614256905492, "num_agent_steps_trained_throughput_per_sec": 3.0958614256905492, "timesteps_total": 38400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 160477.992, "sample_time_ms": 11582.555, "load_time_ms": 0.392, "load_throughput": 1304826.618, "learn_time_ms": 148894.429, "learn_throughput": 3.439, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 2400, "training_iteration": 75, "trial_id": "6f959_00019", "date": "2024-02-28_18-26-35", "timestamp": 1709141195, "time_this_iter_s": 165.39232921600342, "time_total_s": 11904.231850385666, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11904.231850385666, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 56.43020408163266, "ram_util_percent": 17.839591836734698}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -47.44, "reward_total_min": -64, "reward_total_max": 13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.129375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6015625, "reward_score_mean": 0.129375, "reward_score_min": 0.0, "reward_score_max": 0.6015625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8332814230273168, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.052100276947021, "policy_loss": -0.026178979470084112, "vf_loss": 9.98688994248708, "vf_explained_var": -4.3511390686035155e-07, "kl": 0.0, "entropy": 86.17028795878092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "sampler_results": {"episode_reward_max": 13.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -47.44, "reward_total_min": -64, "reward_total_max": 13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.129375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6015625, "reward_score_mean": 0.129375, "reward_score_min": 0.0, "reward_score_max": 0.6015625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -24.0, -61.0, -44.0, -47.0, -9.0, -51.0, 9.0, -63.0, -49.0, -64.0, -64.0, -37.0, -64.0, -60.0, 0.0, -64.0, -41.0, -34.0, -40.0, -64.0, -54.0, -47.0, -63.0, -64.0, -48.0, -63.0, -13.0, -39.0, -63.0, -5.0, -64.0, -62.0, -63.0, -64.0, -48.0, -63.0, -44.0, -16.0, -1.0, -34.0, -45.0, -53.0, -50.0, -47.0, -50.0, -48.0, -63.0, -64.0, -43.0, -64.0, -64.0, -43.0, -23.0, -64.0, -63.0, -64.0, -63.0, -64.0, -55.0, -46.0, -50.0, -45.0, -64.0, -47.0, -8.0, -4.0, 2.0, -15.0, -56.0, -64.0, -38.0, -60.0, -64.0, -51.0, -22.0, -40.0, -36.0, -64.0, -62.0, 13.0, -64.0, -63.0, -63.0, -62.0, -63.0, -27.0, -63.0, -42.0, -47.0, -63.0, -63.0, -58.0, -59.0, -60.0, -25.0, -47.0, -64.0, -64.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3561590411215976, "mean_inference_ms": 18.691400134559522, "mean_action_processing_ms": 0.8129193778461883, "mean_env_wait_ms": 0.4767008870681927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6172089576721191, "StateBufferConnector_ms": 0.007447242736816406, "ViewRequirementAgentConnector_ms": 0.2785518169403076}}, "episode_reward_max": 13.0, "episode_reward_min": -64.0, "episode_reward_mean": -47.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -24.0, -61.0, -44.0, -47.0, -9.0, -51.0, 9.0, -63.0, -49.0, -64.0, -64.0, -37.0, -64.0, -60.0, 0.0, -64.0, -41.0, -34.0, -40.0, -64.0, -54.0, -47.0, -63.0, -64.0, -48.0, -63.0, -13.0, -39.0, -63.0, -5.0, -64.0, -62.0, -63.0, -64.0, -48.0, -63.0, -44.0, -16.0, -1.0, -34.0, -45.0, -53.0, -50.0, -47.0, -50.0, -48.0, -63.0, -64.0, -43.0, -64.0, -64.0, -43.0, -23.0, -64.0, -63.0, -64.0, -63.0, -64.0, -55.0, -46.0, -50.0, -45.0, -64.0, -47.0, -8.0, -4.0, 2.0, -15.0, -56.0, -64.0, -38.0, -60.0, -64.0, -51.0, -22.0, -40.0, -36.0, -64.0, -62.0, 13.0, -64.0, -63.0, -63.0, -62.0, -63.0, -27.0, -63.0, -42.0, -47.0, -63.0, -63.0, -58.0, -59.0, -60.0, -25.0, -47.0, -64.0, -64.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3561590411215976, "mean_inference_ms": 18.691400134559522, "mean_action_processing_ms": 0.8129193778461883, "mean_env_wait_ms": 0.4767008870681927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6172089576721191, "StateBufferConnector_ms": 0.007447242736816406, "ViewRequirementAgentConnector_ms": 0.2785518169403076}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1465519587385273, "num_agent_steps_trained_throughput_per_sec": 3.1465519587385273, "timesteps_total": 38912, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 160963.013, "sample_time_ms": 11558.275, "load_time_ms": 0.419, "load_throughput": 1222592.455, "learn_time_ms": 149403.671, "learn_throughput": 3.427, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "episodes_total": 2432, "training_iteration": 76, "trial_id": "6f959_00019", "date": "2024-02-28_18-29-18", "timestamp": 1709141358, "time_this_iter_s": 162.73312377929688, "time_total_s": 12066.964974164963, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12066.964974164963, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.330603448275866, "ram_util_percent": 17.77931034482759}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.14, "reward_total_min": -64, "reward_total_max": 17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6328125, "reward_score_mean": 0.15515625, "reward_score_min": 0.0, "reward_score_max": 0.6328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9608161783466737, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.794505580266316, "policy_loss": -0.0017803139383128534, "vf_loss": 9.676672911643982, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 84.65393047332763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "sampler_results": {"episode_reward_max": 17.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.14, "reward_total_min": -64, "reward_total_max": 17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6328125, "reward_score_mean": 0.15515625, "reward_score_min": 0.0, "reward_score_max": 0.6328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -63.0, -64.0, -48.0, -63.0, -44.0, -16.0, -1.0, -34.0, -45.0, -53.0, -50.0, -47.0, -50.0, -48.0, -63.0, -64.0, -43.0, -64.0, -64.0, -43.0, -23.0, -64.0, -63.0, -64.0, -63.0, -64.0, -55.0, -46.0, -50.0, -45.0, -64.0, -47.0, -8.0, -4.0, 2.0, -15.0, -56.0, -64.0, -38.0, -60.0, -64.0, -51.0, -22.0, -40.0, -36.0, -64.0, -62.0, 13.0, -64.0, -63.0, -63.0, -62.0, -63.0, -27.0, -63.0, -42.0, -47.0, -63.0, -63.0, -58.0, -59.0, -60.0, -25.0, -47.0, -64.0, -64.0, -43.0, -31.0, 16.0, -5.0, -32.0, -44.0, -47.0, 6.0, -63.0, -47.0, -64.0, -47.0, -58.0, 17.0, -22.0, -63.0, -4.0, -47.0, -19.0, -44.0, -47.0, 9.0, -45.0, -64.0, -64.0, -29.0, -27.0, -62.0, -62.0, -48.0, -42.0, -13.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3586191907914498, "mean_inference_ms": 18.707683931891175, "mean_action_processing_ms": 0.8137992336323987, "mean_env_wait_ms": 0.4772530254100216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6334714889526367, "StateBufferConnector_ms": 0.007531881332397461, "ViewRequirementAgentConnector_ms": 0.2836730480194092}}, "episode_reward_max": 17.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -63.0, -64.0, -48.0, -63.0, -44.0, -16.0, -1.0, -34.0, -45.0, -53.0, -50.0, -47.0, -50.0, -48.0, -63.0, -64.0, -43.0, -64.0, -64.0, -43.0, -23.0, -64.0, -63.0, -64.0, -63.0, -64.0, -55.0, -46.0, -50.0, -45.0, -64.0, -47.0, -8.0, -4.0, 2.0, -15.0, -56.0, -64.0, -38.0, -60.0, -64.0, -51.0, -22.0, -40.0, -36.0, -64.0, -62.0, 13.0, -64.0, -63.0, -63.0, -62.0, -63.0, -27.0, -63.0, -42.0, -47.0, -63.0, -63.0, -58.0, -59.0, -60.0, -25.0, -47.0, -64.0, -64.0, -43.0, -31.0, 16.0, -5.0, -32.0, -44.0, -47.0, 6.0, -63.0, -47.0, -64.0, -47.0, -58.0, 17.0, -22.0, -63.0, -4.0, -47.0, -19.0, -44.0, -47.0, 9.0, -45.0, -64.0, -64.0, -29.0, -27.0, -62.0, -62.0, -48.0, -42.0, -13.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3586191907914498, "mean_inference_ms": 18.707683931891175, "mean_action_processing_ms": 0.8137992336323987, "mean_env_wait_ms": 0.4772530254100216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6334714889526367, "StateBufferConnector_ms": 0.007531881332397461, "ViewRequirementAgentConnector_ms": 0.2836730480194092}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.337878853805547, "num_agent_steps_trained_throughput_per_sec": 3.337878853805547, "timesteps_total": 39424, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39424, "timers": {"training_iteration_time_ms": 160923.441, "sample_time_ms": 11663.265, "load_time_ms": 0.451, "load_throughput": 1135093.635, "learn_time_ms": 149259.059, "learn_throughput": 3.43, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "done": false, "episodes_total": 2464, "training_iteration": 77, "trial_id": "6f959_00019", "date": "2024-02-28_18-31-51", "timestamp": 1709141511, "time_this_iter_s": 153.40130186080933, "time_total_s": 12220.366276025772, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12220.366276025772, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 56.84036697247707, "ram_util_percent": 17.765596330275233}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.29, "reward_total_min": -64, "reward_total_max": 47, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.169609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8671875, "reward_score_mean": 0.169609375, "reward_score_min": 0.0, "reward_score_max": 0.8671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9025750584279497, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.316441869735717, "policy_loss": 0.03137758891098201, "vf_loss": 9.114284920692445, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.16989262898763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "sampler_results": {"episode_reward_max": 47.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.29, "reward_total_min": -64, "reward_total_max": 47, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.169609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8671875, "reward_score_mean": 0.169609375, "reward_score_min": 0.0, "reward_score_max": 0.8671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -8.0, -4.0, 2.0, -15.0, -56.0, -64.0, -38.0, -60.0, -64.0, -51.0, -22.0, -40.0, -36.0, -64.0, -62.0, 13.0, -64.0, -63.0, -63.0, -62.0, -63.0, -27.0, -63.0, -42.0, -47.0, -63.0, -63.0, -58.0, -59.0, -60.0, -25.0, -47.0, -64.0, -64.0, -43.0, -31.0, 16.0, -5.0, -32.0, -44.0, -47.0, 6.0, -63.0, -47.0, -64.0, -47.0, -58.0, 17.0, -22.0, -63.0, -4.0, -47.0, -19.0, -44.0, -47.0, 9.0, -45.0, -64.0, -64.0, -29.0, -27.0, -62.0, -62.0, -48.0, -42.0, -13.0, -36.0, -36.0, -39.0, -64.0, -64.0, -40.0, -42.0, -44.0, -61.0, -60.0, -39.0, -45.0, -50.0, -42.0, -64.0, -58.0, -61.0, 9.0, -63.0, 47.0, -64.0, -33.0, -48.0, -61.0, -47.0, -43.0, -43.0, -63.0, -60.0, -46.0, -8.0, -64.0, -49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3593499423134743, "mean_inference_ms": 18.71165089661268, "mean_action_processing_ms": 0.8140987469047741, "mean_env_wait_ms": 0.47744198525585324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5863759517669678, "StateBufferConnector_ms": 0.00720524787902832, "ViewRequirementAgentConnector_ms": 0.27355432510375977}}, "episode_reward_max": 47.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -8.0, -4.0, 2.0, -15.0, -56.0, -64.0, -38.0, -60.0, -64.0, -51.0, -22.0, -40.0, -36.0, -64.0, -62.0, 13.0, -64.0, -63.0, -63.0, -62.0, -63.0, -27.0, -63.0, -42.0, -47.0, -63.0, -63.0, -58.0, -59.0, -60.0, -25.0, -47.0, -64.0, -64.0, -43.0, -31.0, 16.0, -5.0, -32.0, -44.0, -47.0, 6.0, -63.0, -47.0, -64.0, -47.0, -58.0, 17.0, -22.0, -63.0, -4.0, -47.0, -19.0, -44.0, -47.0, 9.0, -45.0, -64.0, -64.0, -29.0, -27.0, -62.0, -62.0, -48.0, -42.0, -13.0, -36.0, -36.0, -39.0, -64.0, -64.0, -40.0, -42.0, -44.0, -61.0, -60.0, -39.0, -45.0, -50.0, -42.0, -64.0, -58.0, -61.0, 9.0, -63.0, 47.0, -64.0, -33.0, -48.0, -61.0, -47.0, -43.0, -43.0, -63.0, -60.0, -46.0, -8.0, -64.0, -49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3593499423134743, "mean_inference_ms": 18.71165089661268, "mean_action_processing_ms": 0.8140987469047741, "mean_env_wait_ms": 0.47744198525585324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5863759517669678, "StateBufferConnector_ms": 0.00720524787902832, "ViewRequirementAgentConnector_ms": 0.27355432510375977}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0700028626797407, "num_agent_steps_trained_throughput_per_sec": 3.0700028626797407, "timesteps_total": 39936, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 162000.111, "sample_time_ms": 11636.338, "load_time_ms": 0.45, "load_throughput": 1137498.622, "learn_time_ms": 150362.649, "learn_throughput": 3.405, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "episodes_total": 2496, "training_iteration": 78, "trial_id": "6f959_00019", "date": "2024-02-28_18-34-38", "timestamp": 1709141678, "time_this_iter_s": 166.79623556137085, "time_total_s": 12387.162511587143, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12387.162511587143, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.04576271186442, "ram_util_percent": 17.56059322033898}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.54, "reward_total_min": -64, "reward_total_max": 47, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17546875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8671875, "reward_score_mean": 0.17546875, "reward_score_min": 0.0, "reward_score_max": 0.8671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8792446546256543, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.036313756306965, "policy_loss": -0.023587631325547895, "vf_loss": 9.966672571500142, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.14278532663981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "sampler_results": {"episode_reward_max": 47.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.54, "reward_total_min": -64, "reward_total_max": 47, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17546875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8671875, "reward_score_mean": 0.17546875, "reward_score_min": 0.0, "reward_score_max": 0.8671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-47.0, -64.0, -64.0, -43.0, -31.0, 16.0, -5.0, -32.0, -44.0, -47.0, 6.0, -63.0, -47.0, -64.0, -47.0, -58.0, 17.0, -22.0, -63.0, -4.0, -47.0, -19.0, -44.0, -47.0, 9.0, -45.0, -64.0, -64.0, -29.0, -27.0, -62.0, -62.0, -48.0, -42.0, -13.0, -36.0, -36.0, -39.0, -64.0, -64.0, -40.0, -42.0, -44.0, -61.0, -60.0, -39.0, -45.0, -50.0, -42.0, -64.0, -58.0, -61.0, 9.0, -63.0, 47.0, -64.0, -33.0, -48.0, -61.0, -47.0, -43.0, -43.0, -63.0, -60.0, -46.0, -8.0, -64.0, -49.0, -63.0, -21.0, -40.0, -62.0, -62.0, -63.0, 5.0, -32.0, -63.0, -43.0, -46.0, -40.0, -13.0, -63.0, -36.0, 1.0, -64.0, -64.0, -61.0, -39.0, -61.0, -38.0, -2.0, -38.0, -63.0, -21.0, -64.0, -47.0, -46.0, -8.0, -43.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359491717121246, "mean_inference_ms": 18.712042822334496, "mean_action_processing_ms": 0.8142795430403629, "mean_env_wait_ms": 0.47751918694567214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5838603973388672, "StateBufferConnector_ms": 0.007157087326049805, "ViewRequirementAgentConnector_ms": 0.27364253997802734}}, "episode_reward_max": 47.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.0, -64.0, -64.0, -43.0, -31.0, 16.0, -5.0, -32.0, -44.0, -47.0, 6.0, -63.0, -47.0, -64.0, -47.0, -58.0, 17.0, -22.0, -63.0, -4.0, -47.0, -19.0, -44.0, -47.0, 9.0, -45.0, -64.0, -64.0, -29.0, -27.0, -62.0, -62.0, -48.0, -42.0, -13.0, -36.0, -36.0, -39.0, -64.0, -64.0, -40.0, -42.0, -44.0, -61.0, -60.0, -39.0, -45.0, -50.0, -42.0, -64.0, -58.0, -61.0, 9.0, -63.0, 47.0, -64.0, -33.0, -48.0, -61.0, -47.0, -43.0, -43.0, -63.0, -60.0, -46.0, -8.0, -64.0, -49.0, -63.0, -21.0, -40.0, -62.0, -62.0, -63.0, 5.0, -32.0, -63.0, -43.0, -46.0, -40.0, -13.0, -63.0, -36.0, 1.0, -64.0, -64.0, -61.0, -39.0, -61.0, -38.0, -2.0, -38.0, -63.0, -21.0, -64.0, -47.0, -46.0, -8.0, -43.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359491717121246, "mean_inference_ms": 18.712042822334496, "mean_action_processing_ms": 0.8142795430403629, "mean_env_wait_ms": 0.47751918694567214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5838603973388672, "StateBufferConnector_ms": 0.007157087326049805, "ViewRequirementAgentConnector_ms": 0.27364253997802734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.167045019714471, "num_agent_steps_trained_throughput_per_sec": 3.167045019714471, "timesteps_total": 40448, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40448, "timers": {"training_iteration_time_ms": 161882.182, "sample_time_ms": 11562.546, "load_time_ms": 0.426, "load_throughput": 1202937.289, "learn_time_ms": 150318.553, "learn_throughput": 3.406, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "done": false, "episodes_total": 2528, "training_iteration": 79, "trial_id": "6f959_00019", "date": "2024-02-28_18-37-20", "timestamp": 1709141840, "time_this_iter_s": 161.67533946037292, "time_total_s": 12548.837851047516, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12548.837851047516, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.67217391304347, "ram_util_percent": 17.779130434782616}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.58, "reward_total_min": -64, "reward_total_max": 47, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8671875, "reward_score_mean": 0.15171875, "reward_score_min": 0.0, "reward_score_max": 0.8671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7034827090178927, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.935199753443401, "policy_loss": 0.04961020970561852, "vf_loss": 9.774914582570394, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.61192773183187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 47.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.58, "reward_total_min": -64, "reward_total_max": 47, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8671875, "reward_score_mean": 0.15171875, "reward_score_min": 0.0, "reward_score_max": 0.8671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -42.0, -13.0, -36.0, -36.0, -39.0, -64.0, -64.0, -40.0, -42.0, -44.0, -61.0, -60.0, -39.0, -45.0, -50.0, -42.0, -64.0, -58.0, -61.0, 9.0, -63.0, 47.0, -64.0, -33.0, -48.0, -61.0, -47.0, -43.0, -43.0, -63.0, -60.0, -46.0, -8.0, -64.0, -49.0, -63.0, -21.0, -40.0, -62.0, -62.0, -63.0, 5.0, -32.0, -63.0, -43.0, -46.0, -40.0, -13.0, -63.0, -36.0, 1.0, -64.0, -64.0, -61.0, -39.0, -61.0, -38.0, -2.0, -38.0, -63.0, -21.0, -64.0, -47.0, -46.0, -8.0, -43.0, -63.0, -45.0, -64.0, -4.0, -62.0, -44.0, -53.0, -45.0, -63.0, -37.0, -61.0, -41.0, -64.0, -55.0, -47.0, -63.0, -16.0, -64.0, -46.0, -42.0, -64.0, -42.0, -48.0, -47.0, -49.0, -63.0, -14.0, -62.0, -63.0, -58.0, -46.0, -1.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3589048633834295, "mean_inference_ms": 18.707086882557817, "mean_action_processing_ms": 0.8142074122125484, "mean_env_wait_ms": 0.4774315169260735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5650453567504883, "StateBufferConnector_ms": 0.007043600082397461, "ViewRequirementAgentConnector_ms": 0.26847362518310547}}, "episode_reward_max": 47.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -42.0, -13.0, -36.0, -36.0, -39.0, -64.0, -64.0, -40.0, -42.0, -44.0, -61.0, -60.0, -39.0, -45.0, -50.0, -42.0, -64.0, -58.0, -61.0, 9.0, -63.0, 47.0, -64.0, -33.0, -48.0, -61.0, -47.0, -43.0, -43.0, -63.0, -60.0, -46.0, -8.0, -64.0, -49.0, -63.0, -21.0, -40.0, -62.0, -62.0, -63.0, 5.0, -32.0, -63.0, -43.0, -46.0, -40.0, -13.0, -63.0, -36.0, 1.0, -64.0, -64.0, -61.0, -39.0, -61.0, -38.0, -2.0, -38.0, -63.0, -21.0, -64.0, -47.0, -46.0, -8.0, -43.0, -63.0, -45.0, -64.0, -4.0, -62.0, -44.0, -53.0, -45.0, -63.0, -37.0, -61.0, -41.0, -64.0, -55.0, -47.0, -63.0, -16.0, -64.0, -46.0, -42.0, -64.0, -42.0, -48.0, -47.0, -49.0, -63.0, -14.0, -62.0, -63.0, -58.0, -46.0, -1.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3589048633834295, "mean_inference_ms": 18.707086882557817, "mean_action_processing_ms": 0.8142074122125484, "mean_env_wait_ms": 0.4774315169260735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5650453567504883, "StateBufferConnector_ms": 0.007043600082397461, "ViewRequirementAgentConnector_ms": 0.26847362518310547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3209797790442463, "num_agent_steps_trained_throughput_per_sec": 3.3209797790442463, "timesteps_total": 40960, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 160581.04, "sample_time_ms": 11583.206, "load_time_ms": 0.442, "load_throughput": 1158547.501, "learn_time_ms": 148996.724, "learn_throughput": 3.436, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 2560, "training_iteration": 80, "trial_id": "6f959_00019", "date": "2024-02-28_18-39-54", "timestamp": 1709141994, "time_this_iter_s": 154.18665647506714, "time_total_s": 12703.024507522583, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12703.024507522583, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 56.93424657534247, "ram_util_percent": 17.800000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.58, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.14390625, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9088302758211891, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.990134366353352, "policy_loss": -0.016822926110277574, "vf_loss": 9.908429559071859, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.46205673217773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.58, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.14390625, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -8.0, -64.0, -49.0, -63.0, -21.0, -40.0, -62.0, -62.0, -63.0, 5.0, -32.0, -63.0, -43.0, -46.0, -40.0, -13.0, -63.0, -36.0, 1.0, -64.0, -64.0, -61.0, -39.0, -61.0, -38.0, -2.0, -38.0, -63.0, -21.0, -64.0, -47.0, -46.0, -8.0, -43.0, -63.0, -45.0, -64.0, -4.0, -62.0, -44.0, -53.0, -45.0, -63.0, -37.0, -61.0, -41.0, -64.0, -55.0, -47.0, -63.0, -16.0, -64.0, -46.0, -42.0, -64.0, -42.0, -48.0, -47.0, -49.0, -63.0, -14.0, -62.0, -63.0, -58.0, -46.0, -1.0, -38.0, -41.0, -38.0, -38.0, -40.0, -64.0, -29.0, -64.0, -64.0, -42.0, -40.0, -11.0, -32.0, -44.0, -31.0, -37.0, -42.0, -64.0, -61.0, -39.0, -64.0, -64.0, -43.0, -64.0, -37.0, -64.0, -63.0, -64.0, -40.0, -62.0, -43.0, -43.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359350544690956, "mean_inference_ms": 18.71124841819411, "mean_action_processing_ms": 0.8146390019745414, "mean_env_wait_ms": 0.47761849829499214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5877413749694824, "StateBufferConnector_ms": 0.0071849822998046875, "ViewRequirementAgentConnector_ms": 0.2744269371032715}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -8.0, -64.0, -49.0, -63.0, -21.0, -40.0, -62.0, -62.0, -63.0, 5.0, -32.0, -63.0, -43.0, -46.0, -40.0, -13.0, -63.0, -36.0, 1.0, -64.0, -64.0, -61.0, -39.0, -61.0, -38.0, -2.0, -38.0, -63.0, -21.0, -64.0, -47.0, -46.0, -8.0, -43.0, -63.0, -45.0, -64.0, -4.0, -62.0, -44.0, -53.0, -45.0, -63.0, -37.0, -61.0, -41.0, -64.0, -55.0, -47.0, -63.0, -16.0, -64.0, -46.0, -42.0, -64.0, -42.0, -48.0, -47.0, -49.0, -63.0, -14.0, -62.0, -63.0, -58.0, -46.0, -1.0, -38.0, -41.0, -38.0, -38.0, -40.0, -64.0, -29.0, -64.0, -64.0, -42.0, -40.0, -11.0, -32.0, -44.0, -31.0, -37.0, -42.0, -64.0, -61.0, -39.0, -64.0, -64.0, -43.0, -64.0, -37.0, -64.0, -63.0, -64.0, -40.0, -62.0, -43.0, -43.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359350544690956, "mean_inference_ms": 18.71124841819411, "mean_action_processing_ms": 0.8146390019745414, "mean_env_wait_ms": 0.47761849829499214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5877413749694824, "StateBufferConnector_ms": 0.0071849822998046875, "ViewRequirementAgentConnector_ms": 0.2744269371032715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1312615106632844, "num_agent_steps_trained_throughput_per_sec": 3.1312615106632844, "timesteps_total": 41472, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41472, "timers": {"training_iteration_time_ms": 161085.461, "sample_time_ms": 11583.77, "load_time_ms": 0.441, "load_throughput": 1161366.961, "learn_time_ms": 149500.597, "learn_throughput": 3.425, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "done": false, "episodes_total": 2592, "training_iteration": 81, "trial_id": "6f959_00019", "date": "2024-02-28_18-42-38", "timestamp": 1709142158, "time_this_iter_s": 163.52820801734924, "time_total_s": 12866.552715539932, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12866.552715539932, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 56.903879310344834, "ram_util_percent": 17.800000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.52, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1365625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.1365625, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9431235840544104, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.049439577261607, "policy_loss": -0.02551976585139831, "vf_loss": 9.983237632115681, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.34548263549804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.52, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1365625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.1365625, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -8.0, -43.0, -63.0, -45.0, -64.0, -4.0, -62.0, -44.0, -53.0, -45.0, -63.0, -37.0, -61.0, -41.0, -64.0, -55.0, -47.0, -63.0, -16.0, -64.0, -46.0, -42.0, -64.0, -42.0, -48.0, -47.0, -49.0, -63.0, -14.0, -62.0, -63.0, -58.0, -46.0, -1.0, -38.0, -41.0, -38.0, -38.0, -40.0, -64.0, -29.0, -64.0, -64.0, -42.0, -40.0, -11.0, -32.0, -44.0, -31.0, -37.0, -42.0, -64.0, -61.0, -39.0, -64.0, -64.0, -43.0, -64.0, -37.0, -64.0, -63.0, -64.0, -40.0, -62.0, -43.0, -43.0, -45.0, -31.0, -32.0, -25.0, -64.0, -62.0, -64.0, -63.0, -41.0, -22.0, -63.0, -64.0, -39.0, -42.0, -28.0, -63.0, -62.0, -44.0, -6.0, -42.0, -63.0, -38.0, -63.0, -62.0, -42.0, -32.0, -19.0, -63.0, -33.0, -27.0, -61.0, -61.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.360499063739521, "mean_inference_ms": 18.719494443974057, "mean_action_processing_ms": 0.8153021193576363, "mean_env_wait_ms": 0.477942664858145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6013476848602295, "StateBufferConnector_ms": 0.007292985916137695, "ViewRequirementAgentConnector_ms": 0.2786672115325928}}, "episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -8.0, -43.0, -63.0, -45.0, -64.0, -4.0, -62.0, -44.0, -53.0, -45.0, -63.0, -37.0, -61.0, -41.0, -64.0, -55.0, -47.0, -63.0, -16.0, -64.0, -46.0, -42.0, -64.0, -42.0, -48.0, -47.0, -49.0, -63.0, -14.0, -62.0, -63.0, -58.0, -46.0, -1.0, -38.0, -41.0, -38.0, -38.0, -40.0, -64.0, -29.0, -64.0, -64.0, -42.0, -40.0, -11.0, -32.0, -44.0, -31.0, -37.0, -42.0, -64.0, -61.0, -39.0, -64.0, -64.0, -43.0, -64.0, -37.0, -64.0, -63.0, -64.0, -40.0, -62.0, -43.0, -43.0, -45.0, -31.0, -32.0, -25.0, -64.0, -62.0, -64.0, -63.0, -41.0, -22.0, -63.0, -64.0, -39.0, -42.0, -28.0, -63.0, -62.0, -44.0, -6.0, -42.0, -63.0, -38.0, -63.0, -62.0, -42.0, -32.0, -19.0, -63.0, -33.0, -27.0, -61.0, -61.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.360499063739521, "mean_inference_ms": 18.719494443974057, "mean_action_processing_ms": 0.8153021193576363, "mean_env_wait_ms": 0.477942664858145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6013476848602295, "StateBufferConnector_ms": 0.007292985916137695, "ViewRequirementAgentConnector_ms": 0.2786672115325928}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1783094209769085, "num_agent_steps_trained_throughput_per_sec": 3.1783094209769085, "timesteps_total": 41984, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 161027.964, "sample_time_ms": 11738.256, "load_time_ms": 0.442, "load_throughput": 1157174.075, "learn_time_ms": 149288.609, "learn_throughput": 3.43, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "episodes_total": 2624, "training_iteration": 82, "trial_id": "6f959_00019", "date": "2024-02-28_18-45-19", "timestamp": 1709142319, "time_this_iter_s": 161.1024296283722, "time_total_s": 13027.655145168304, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13027.655145168304, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 56.91615720524017, "ram_util_percent": 17.800000000000008}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.11, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.147578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.147578125, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8709562631168714, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.038168434302012, "policy_loss": -0.016900297704463205, "vf_loss": 9.96135634581248, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 84.35748875935873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.11, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.147578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.147578125, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -46.0, -1.0, -38.0, -41.0, -38.0, -38.0, -40.0, -64.0, -29.0, -64.0, -64.0, -42.0, -40.0, -11.0, -32.0, -44.0, -31.0, -37.0, -42.0, -64.0, -61.0, -39.0, -64.0, -64.0, -43.0, -64.0, -37.0, -64.0, -63.0, -64.0, -40.0, -62.0, -43.0, -43.0, -45.0, -31.0, -32.0, -25.0, -64.0, -62.0, -64.0, -63.0, -41.0, -22.0, -63.0, -64.0, -39.0, -42.0, -28.0, -63.0, -62.0, -44.0, -6.0, -42.0, -63.0, -38.0, -63.0, -62.0, -42.0, -32.0, -19.0, -63.0, -33.0, -27.0, -61.0, -61.0, -43.0, -36.0, -63.0, -28.0, -30.0, -40.0, -63.0, -64.0, -27.0, -14.0, -61.0, -20.0, -64.0, -64.0, -34.0, -62.0, -23.0, -63.0, -50.0, -27.0, -11.0, -64.0, -63.0, -42.0, -39.0, -31.0, -64.0, -48.0, -39.0, -35.0, -14.0, -40.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3634491235616224, "mean_inference_ms": 18.739674627802298, "mean_action_processing_ms": 0.8165735953947123, "mean_env_wait_ms": 0.4786614244585883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6443283557891846, "StateBufferConnector_ms": 0.0076482295989990234, "ViewRequirementAgentConnector_ms": 0.29555702209472656}}, "episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -46.0, -1.0, -38.0, -41.0, -38.0, -38.0, -40.0, -64.0, -29.0, -64.0, -64.0, -42.0, -40.0, -11.0, -32.0, -44.0, -31.0, -37.0, -42.0, -64.0, -61.0, -39.0, -64.0, -64.0, -43.0, -64.0, -37.0, -64.0, -63.0, -64.0, -40.0, -62.0, -43.0, -43.0, -45.0, -31.0, -32.0, -25.0, -64.0, -62.0, -64.0, -63.0, -41.0, -22.0, -63.0, -64.0, -39.0, -42.0, -28.0, -63.0, -62.0, -44.0, -6.0, -42.0, -63.0, -38.0, -63.0, -62.0, -42.0, -32.0, -19.0, -63.0, -33.0, -27.0, -61.0, -61.0, -43.0, -36.0, -63.0, -28.0, -30.0, -40.0, -63.0, -64.0, -27.0, -14.0, -61.0, -20.0, -64.0, -64.0, -34.0, -62.0, -23.0, -63.0, -50.0, -27.0, -11.0, -64.0, -63.0, -42.0, -39.0, -31.0, -64.0, -48.0, -39.0, -35.0, -14.0, -40.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3634491235616224, "mean_inference_ms": 18.739674627802298, "mean_action_processing_ms": 0.8165735953947123, "mean_env_wait_ms": 0.4786614244585883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6443283557891846, "StateBufferConnector_ms": 0.0076482295989990234, "ViewRequirementAgentConnector_ms": 0.29555702209472656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.069252724699652, "num_agent_steps_trained_throughput_per_sec": 3.069252724699652, "timesteps_total": 42496, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42496, "timers": {"training_iteration_time_ms": 161906.341, "sample_time_ms": 11966.072, "load_time_ms": 0.441, "load_throughput": 1161366.961, "learn_time_ms": 149939.182, "learn_throughput": 3.415, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "done": false, "episodes_total": 2656, "training_iteration": 83, "trial_id": "6f959_00019", "date": "2024-02-28_18-48-06", "timestamp": 1709142486, "time_this_iter_s": 166.8372185230255, "time_total_s": 13194.49236369133, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13194.49236369133, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 56.85316455696203, "ram_util_percent": 17.800000000000008}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.58, "reward_total_min": -64, "reward_total_max": -6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.453125, "reward_score_mean": 0.15171875, "reward_score_min": 0.0, "reward_score_max": 0.453125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9062759580711524, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.066891380151112, "policy_loss": -0.007918971590697765, "vf_loss": 9.983073886235555, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.72908484141031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -6.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.58, "reward_total_min": -64, "reward_total_max": -6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.453125, "reward_score_mean": 0.15171875, "reward_score_min": 0.0, "reward_score_max": 0.453125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -43.0, -43.0, -45.0, -31.0, -32.0, -25.0, -64.0, -62.0, -64.0, -63.0, -41.0, -22.0, -63.0, -64.0, -39.0, -42.0, -28.0, -63.0, -62.0, -44.0, -6.0, -42.0, -63.0, -38.0, -63.0, -62.0, -42.0, -32.0, -19.0, -63.0, -33.0, -27.0, -61.0, -61.0, -43.0, -36.0, -63.0, -28.0, -30.0, -40.0, -63.0, -64.0, -27.0, -14.0, -61.0, -20.0, -64.0, -64.0, -34.0, -62.0, -23.0, -63.0, -50.0, -27.0, -11.0, -64.0, -63.0, -42.0, -39.0, -31.0, -64.0, -48.0, -39.0, -35.0, -14.0, -40.0, -64.0, -32.0, -31.0, -36.0, -33.0, -63.0, -62.0, -63.0, -46.0, -40.0, -27.0, -24.0, -62.0, -36.0, -52.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, -26.0, -62.0, -31.0, -40.0, -22.0, -42.0, -38.0, -47.0, -56.0, -27.0, -39.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3656580178335567, "mean_inference_ms": 18.75404955029937, "mean_action_processing_ms": 0.817514471248964, "mean_env_wait_ms": 0.4792064742379575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6384804248809814, "StateBufferConnector_ms": 0.0075914859771728516, "ViewRequirementAgentConnector_ms": 0.292163610458374}}, "episode_reward_max": -6.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -43.0, -43.0, -45.0, -31.0, -32.0, -25.0, -64.0, -62.0, -64.0, -63.0, -41.0, -22.0, -63.0, -64.0, -39.0, -42.0, -28.0, -63.0, -62.0, -44.0, -6.0, -42.0, -63.0, -38.0, -63.0, -62.0, -42.0, -32.0, -19.0, -63.0, -33.0, -27.0, -61.0, -61.0, -43.0, -36.0, -63.0, -28.0, -30.0, -40.0, -63.0, -64.0, -27.0, -14.0, -61.0, -20.0, -64.0, -64.0, -34.0, -62.0, -23.0, -63.0, -50.0, -27.0, -11.0, -64.0, -63.0, -42.0, -39.0, -31.0, -64.0, -48.0, -39.0, -35.0, -14.0, -40.0, -64.0, -32.0, -31.0, -36.0, -33.0, -63.0, -62.0, -63.0, -46.0, -40.0, -27.0, -24.0, -62.0, -36.0, -52.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, -26.0, -62.0, -31.0, -40.0, -22.0, -42.0, -38.0, -47.0, -56.0, -27.0, -39.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3656580178335567, "mean_inference_ms": 18.75404955029937, "mean_action_processing_ms": 0.817514471248964, "mean_env_wait_ms": 0.4792064742379575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6384804248809814, "StateBufferConnector_ms": 0.0075914859771728516, "ViewRequirementAgentConnector_ms": 0.292163610458374}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2869122253842176, "num_agent_steps_trained_throughput_per_sec": 3.2869122253842176, "timesteps_total": 43008, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 161129.106, "sample_time_ms": 11958.202, "load_time_ms": 0.436, "load_throughput": 1174065.742, "learn_time_ms": 149169.842, "learn_throughput": 3.432, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 2688, "training_iteration": 84, "trial_id": "6f959_00019", "date": "2024-02-28_18-50-41", "timestamp": 1709142641, "time_this_iter_s": 155.77975130081177, "time_total_s": 13350.272114992142, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13350.272114992142, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 56.83873873873874, "ram_util_percent": 17.66666666666667}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.13, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.147421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.147421875, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9613801945621768, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.007894543806712, "policy_loss": -0.04053175793960691, "vf_loss": 9.95404912630717, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.09905726114908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.13, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.147421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.147421875, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-27.0, -61.0, -61.0, -43.0, -36.0, -63.0, -28.0, -30.0, -40.0, -63.0, -64.0, -27.0, -14.0, -61.0, -20.0, -64.0, -64.0, -34.0, -62.0, -23.0, -63.0, -50.0, -27.0, -11.0, -64.0, -63.0, -42.0, -39.0, -31.0, -64.0, -48.0, -39.0, -35.0, -14.0, -40.0, -64.0, -32.0, -31.0, -36.0, -33.0, -63.0, -62.0, -63.0, -46.0, -40.0, -27.0, -24.0, -62.0, -36.0, -52.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, -26.0, -62.0, -31.0, -40.0, -22.0, -42.0, -38.0, -47.0, -56.0, -27.0, -39.0, -33.0, -39.0, -62.0, -24.0, -34.0, -21.0, -63.0, -62.0, -36.0, -35.0, -64.0, -33.0, -64.0, -38.0, -38.0, -62.0, -32.0, -38.0, -62.0, -61.0, -37.0, -64.0, -63.0, -23.0, -63.0, -39.0, -64.0, -64.0, -64.0, -27.0, -40.0, -63.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3667476219969705, "mean_inference_ms": 18.762426861699186, "mean_action_processing_ms": 0.8180586323311368, "mean_env_wait_ms": 0.47953393179820986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5989029407501221, "StateBufferConnector_ms": 0.0073146820068359375, "ViewRequirementAgentConnector_ms": 0.28118467330932617}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.0, -61.0, -61.0, -43.0, -36.0, -63.0, -28.0, -30.0, -40.0, -63.0, -64.0, -27.0, -14.0, -61.0, -20.0, -64.0, -64.0, -34.0, -62.0, -23.0, -63.0, -50.0, -27.0, -11.0, -64.0, -63.0, -42.0, -39.0, -31.0, -64.0, -48.0, -39.0, -35.0, -14.0, -40.0, -64.0, -32.0, -31.0, -36.0, -33.0, -63.0, -62.0, -63.0, -46.0, -40.0, -27.0, -24.0, -62.0, -36.0, -52.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, -26.0, -62.0, -31.0, -40.0, -22.0, -42.0, -38.0, -47.0, -56.0, -27.0, -39.0, -33.0, -39.0, -62.0, -24.0, -34.0, -21.0, -63.0, -62.0, -36.0, -35.0, -64.0, -33.0, -64.0, -38.0, -38.0, -62.0, -32.0, -38.0, -62.0, -61.0, -37.0, -64.0, -63.0, -23.0, -63.0, -39.0, -64.0, -64.0, -64.0, -27.0, -40.0, -63.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3667476219969705, "mean_inference_ms": 18.762426861699186, "mean_action_processing_ms": 0.8180586323311368, "mean_env_wait_ms": 0.47953393179820986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5989029407501221, "StateBufferConnector_ms": 0.0073146820068359375, "ViewRequirementAgentConnector_ms": 0.28118467330932617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3938663005150915, "num_agent_steps_trained_throughput_per_sec": 3.3938663005150915, "timesteps_total": 43520, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43520, "timers": {"training_iteration_time_ms": 159676.938, "sample_time_ms": 11803.016, "load_time_ms": 0.417, "load_throughput": 1228397.007, "learn_time_ms": 147872.894, "learn_throughput": 3.462, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "done": false, "episodes_total": 2720, "training_iteration": 85, "trial_id": "6f959_00019", "date": "2024-02-28_18-53-12", "timestamp": 1709142792, "time_this_iter_s": 150.87076616287231, "time_total_s": 13501.142881155014, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13501.142881155014, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.22990654205608, "ram_util_percent": 17.632710280373836}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.99, "reward_total_min": -64, "reward_total_max": -14, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.148515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.390625, "reward_score_mean": 0.148515625, "reward_score_min": 0.0, "reward_score_max": 0.390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8609471531584859, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.071066546440125, "policy_loss": 0.021773257556681833, "vf_loss": 9.955002744992575, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.61285909016927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.99, "reward_total_min": -64, "reward_total_max": -14, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.148515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.390625, "reward_score_mean": 0.148515625, "reward_score_min": 0.0, "reward_score_max": 0.390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-35.0, -14.0, -40.0, -64.0, -32.0, -31.0, -36.0, -33.0, -63.0, -62.0, -63.0, -46.0, -40.0, -27.0, -24.0, -62.0, -36.0, -52.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, -26.0, -62.0, -31.0, -40.0, -22.0, -42.0, -38.0, -47.0, -56.0, -27.0, -39.0, -33.0, -39.0, -62.0, -24.0, -34.0, -21.0, -63.0, -62.0, -36.0, -35.0, -64.0, -33.0, -64.0, -38.0, -38.0, -62.0, -32.0, -38.0, -62.0, -61.0, -37.0, -64.0, -63.0, -23.0, -63.0, -39.0, -64.0, -64.0, -64.0, -27.0, -40.0, -63.0, -41.0, -22.0, -64.0, -34.0, -64.0, -28.0, -32.0, -62.0, -64.0, -40.0, -30.0, -36.0, -46.0, -20.0, -32.0, -63.0, -45.0, -32.0, -34.0, -63.0, -40.0, -39.0, -41.0, -63.0, -37.0, -46.0, -39.0, -63.0, -27.0, -64.0, -45.0, -64.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.365918060527764, "mean_inference_ms": 18.75856454010812, "mean_action_processing_ms": 0.8179419604201139, "mean_env_wait_ms": 0.47945228966695924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5488824844360352, "StateBufferConnector_ms": 0.0069277286529541016, "ViewRequirementAgentConnector_ms": 0.2631561756134033}}, "episode_reward_max": -14.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35.0, -14.0, -40.0, -64.0, -32.0, -31.0, -36.0, -33.0, -63.0, -62.0, -63.0, -46.0, -40.0, -27.0, -24.0, -62.0, -36.0, -52.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, -26.0, -62.0, -31.0, -40.0, -22.0, -42.0, -38.0, -47.0, -56.0, -27.0, -39.0, -33.0, -39.0, -62.0, -24.0, -34.0, -21.0, -63.0, -62.0, -36.0, -35.0, -64.0, -33.0, -64.0, -38.0, -38.0, -62.0, -32.0, -38.0, -62.0, -61.0, -37.0, -64.0, -63.0, -23.0, -63.0, -39.0, -64.0, -64.0, -64.0, -27.0, -40.0, -63.0, -41.0, -22.0, -64.0, -34.0, -64.0, -28.0, -32.0, -62.0, -64.0, -40.0, -30.0, -36.0, -46.0, -20.0, -32.0, -63.0, -45.0, -32.0, -34.0, -63.0, -40.0, -39.0, -41.0, -63.0, -37.0, -46.0, -39.0, -63.0, -27.0, -64.0, -45.0, -64.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.365918060527764, "mean_inference_ms": 18.75856454010812, "mean_action_processing_ms": 0.8179419604201139, "mean_env_wait_ms": 0.47945228966695924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5488824844360352, "StateBufferConnector_ms": 0.0069277286529541016, "ViewRequirementAgentConnector_ms": 0.2631561756134033}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.308650048021627, "num_agent_steps_trained_throughput_per_sec": 3.308650048021627, "timesteps_total": 44032, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 158879.752, "sample_time_ms": 11734.153, "load_time_ms": 0.401, "load_throughput": 1275455.038, "learn_time_ms": 147144.631, "learn_throughput": 3.48, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "episodes_total": 2752, "training_iteration": 86, "trial_id": "6f959_00019", "date": "2024-02-28_18-55-47", "timestamp": 1709142947, "time_this_iter_s": 154.75610613822937, "time_total_s": 13655.898987293243, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13655.898987293243, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 57.5609090909091, "ram_util_percent": 17.665454545454544}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.78, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.14234375, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9124560877370338, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.858792328834534, "policy_loss": -0.015217274272193512, "vf_loss": 9.762175675233205, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.82094961802164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.78, "reward_total_min": -64, "reward_total_max": 0, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5, "reward_score_mean": 0.14234375, "reward_score_min": 0.0, "reward_score_max": 0.5, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-56.0, -27.0, -39.0, -33.0, -39.0, -62.0, -24.0, -34.0, -21.0, -63.0, -62.0, -36.0, -35.0, -64.0, -33.0, -64.0, -38.0, -38.0, -62.0, -32.0, -38.0, -62.0, -61.0, -37.0, -64.0, -63.0, -23.0, -63.0, -39.0, -64.0, -64.0, -64.0, -27.0, -40.0, -63.0, -41.0, -22.0, -64.0, -34.0, -64.0, -28.0, -32.0, -62.0, -64.0, -40.0, -30.0, -36.0, -46.0, -20.0, -32.0, -63.0, -45.0, -32.0, -34.0, -63.0, -40.0, -39.0, -41.0, -63.0, -37.0, -46.0, -39.0, -63.0, -27.0, -64.0, -45.0, -64.0, -33.0, -28.0, -31.0, -36.0, -63.0, -42.0, -64.0, -64.0, -28.0, -62.0, -33.0, -62.0, -42.0, -63.0, -63.0, -62.0, -63.0, -44.0, -36.0, -34.0, -39.0, -64.0, -48.0, -64.0, -39.0, -32.0, 0.0, -64.0, -63.0, -26.0, -63.0, -38.0, -31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3646331706297103, "mean_inference_ms": 18.752043587135844, "mean_action_processing_ms": 0.8176582009498569, "mean_env_wait_ms": 0.47927312352668294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5357577800750732, "StateBufferConnector_ms": 0.006834983825683594, "ViewRequirementAgentConnector_ms": 0.2597489356994629}}, "episode_reward_max": 0.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -27.0, -39.0, -33.0, -39.0, -62.0, -24.0, -34.0, -21.0, -63.0, -62.0, -36.0, -35.0, -64.0, -33.0, -64.0, -38.0, -38.0, -62.0, -32.0, -38.0, -62.0, -61.0, -37.0, -64.0, -63.0, -23.0, -63.0, -39.0, -64.0, -64.0, -64.0, -27.0, -40.0, -63.0, -41.0, -22.0, -64.0, -34.0, -64.0, -28.0, -32.0, -62.0, -64.0, -40.0, -30.0, -36.0, -46.0, -20.0, -32.0, -63.0, -45.0, -32.0, -34.0, -63.0, -40.0, -39.0, -41.0, -63.0, -37.0, -46.0, -39.0, -63.0, -27.0, -64.0, -45.0, -64.0, -33.0, -28.0, -31.0, -36.0, -63.0, -42.0, -64.0, -64.0, -28.0, -62.0, -33.0, -62.0, -42.0, -63.0, -63.0, -62.0, -63.0, -44.0, -36.0, -34.0, -39.0, -64.0, -48.0, -64.0, -39.0, -32.0, 0.0, -64.0, -63.0, -26.0, -63.0, -38.0, -31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3646331706297103, "mean_inference_ms": 18.752043587135844, "mean_action_processing_ms": 0.8176582009498569, "mean_env_wait_ms": 0.47927312352668294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5357577800750732, "StateBufferConnector_ms": 0.006834983825683594, "ViewRequirementAgentConnector_ms": 0.2597489356994629}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0797650743336322, "num_agent_steps_trained_throughput_per_sec": 3.0797650743336322, "timesteps_total": 44544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44544, "timers": {"training_iteration_time_ms": 160165.313, "sample_time_ms": 11612.779, "load_time_ms": 0.379, "load_throughput": 1351723.83, "learn_time_ms": 148551.598, "learn_throughput": 3.447, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "done": false, "episodes_total": 2784, "training_iteration": 87, "trial_id": "6f959_00019", "date": "2024-02-28_18-58-34", "timestamp": 1709143114, "time_this_iter_s": 166.2614827156067, "time_total_s": 13822.16047000885, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13822.16047000885, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.15127118644068, "ram_util_percent": 17.59449152542372}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.23, "reward_total_min": -64, "reward_total_max": 12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.154453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.59375, "reward_score_mean": 0.154453125, "reward_score_min": 0.0, "reward_score_max": 0.59375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9341554194688797, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.985783052444457, "policy_loss": -0.02560429146202902, "vf_loss": 9.913302950064342, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.87416051228841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.23, "reward_total_min": -64, "reward_total_max": 12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.154453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.59375, "reward_score_mean": 0.154453125, "reward_score_min": 0.0, "reward_score_max": 0.59375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-27.0, -40.0, -63.0, -41.0, -22.0, -64.0, -34.0, -64.0, -28.0, -32.0, -62.0, -64.0, -40.0, -30.0, -36.0, -46.0, -20.0, -32.0, -63.0, -45.0, -32.0, -34.0, -63.0, -40.0, -39.0, -41.0, -63.0, -37.0, -46.0, -39.0, -63.0, -27.0, -64.0, -45.0, -64.0, -33.0, -28.0, -31.0, -36.0, -63.0, -42.0, -64.0, -64.0, -28.0, -62.0, -33.0, -62.0, -42.0, -63.0, -63.0, -62.0, -63.0, -44.0, -36.0, -34.0, -39.0, -64.0, -48.0, -64.0, -39.0, -32.0, 0.0, -64.0, -63.0, -26.0, -63.0, -38.0, -31.0, -63.0, 12.0, -64.0, -44.0, -63.0, -62.0, -35.0, -49.0, -27.0, -12.0, -37.0, -64.0, -43.0, -39.0, -43.0, -43.0, -48.0, -64.0, -64.0, -63.0, -44.0, -20.0, -64.0, -33.0, -35.0, -38.0, -33.0, -19.0, -31.0, -5.0, -64.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3635517526809404, "mean_inference_ms": 18.74587282292712, "mean_action_processing_ms": 0.8174422317052707, "mean_env_wait_ms": 0.47913951166598095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5374720096588135, "StateBufferConnector_ms": 0.006832599639892578, "ViewRequirementAgentConnector_ms": 0.26045751571655273}}, "episode_reward_max": 12.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.0, -40.0, -63.0, -41.0, -22.0, -64.0, -34.0, -64.0, -28.0, -32.0, -62.0, -64.0, -40.0, -30.0, -36.0, -46.0, -20.0, -32.0, -63.0, -45.0, -32.0, -34.0, -63.0, -40.0, -39.0, -41.0, -63.0, -37.0, -46.0, -39.0, -63.0, -27.0, -64.0, -45.0, -64.0, -33.0, -28.0, -31.0, -36.0, -63.0, -42.0, -64.0, -64.0, -28.0, -62.0, -33.0, -62.0, -42.0, -63.0, -63.0, -62.0, -63.0, -44.0, -36.0, -34.0, -39.0, -64.0, -48.0, -64.0, -39.0, -32.0, 0.0, -64.0, -63.0, -26.0, -63.0, -38.0, -31.0, -63.0, 12.0, -64.0, -44.0, -63.0, -62.0, -35.0, -49.0, -27.0, -12.0, -37.0, -64.0, -43.0, -39.0, -43.0, -43.0, -48.0, -64.0, -64.0, -63.0, -44.0, -20.0, -64.0, -33.0, -35.0, -38.0, -33.0, -19.0, -31.0, -5.0, -64.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3635517526809404, "mean_inference_ms": 18.74587282292712, "mean_action_processing_ms": 0.8174422317052707, "mean_env_wait_ms": 0.47913951166598095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5374720096588135, "StateBufferConnector_ms": 0.006832599639892578, "ViewRequirementAgentConnector_ms": 0.26045751571655273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.005807586404266, "num_agent_steps_trained_throughput_per_sec": 3.005807586404266, "timesteps_total": 45056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 160521.496, "sample_time_ms": 11663.039, "load_time_ms": 0.386, "load_throughput": 1326507.905, "learn_time_ms": 148857.508, "learn_throughput": 3.44, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "episodes_total": 2816, "training_iteration": 88, "trial_id": "6f959_00019", "date": "2024-02-28_19-01-24", "timestamp": 1709143284, "time_this_iter_s": 170.35199880599976, "time_total_s": 13992.51246881485, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13992.51246881485, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 56.853719008264456, "ram_util_percent": 17.70537190082645}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.52, "reward_total_min": -64, "reward_total_max": 12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.144375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.59375, "reward_score_mean": 0.144375, "reward_score_min": 0.0, "reward_score_max": 0.59375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9857881610592206, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.674722711245218, "policy_loss": -0.009301306121051312, "vf_loss": 9.553175087769826, "vf_explained_var": -9.695688883463541e-07, "kl": 0.0, "entropy": 89.11523844401042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.52, "reward_total_min": -64, "reward_total_max": 12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.144375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.59375, "reward_score_mean": 0.144375, "reward_score_min": 0.0, "reward_score_max": 0.59375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -45.0, -64.0, -33.0, -28.0, -31.0, -36.0, -63.0, -42.0, -64.0, -64.0, -28.0, -62.0, -33.0, -62.0, -42.0, -63.0, -63.0, -62.0, -63.0, -44.0, -36.0, -34.0, -39.0, -64.0, -48.0, -64.0, -39.0, -32.0, 0.0, -64.0, -63.0, -26.0, -63.0, -38.0, -31.0, -63.0, 12.0, -64.0, -44.0, -63.0, -62.0, -35.0, -49.0, -27.0, -12.0, -37.0, -64.0, -43.0, -39.0, -43.0, -43.0, -48.0, -64.0, -64.0, -63.0, -44.0, -20.0, -64.0, -33.0, -35.0, -38.0, -33.0, -19.0, -31.0, -5.0, -64.0, -48.0, -25.0, -12.0, -64.0, -35.0, -63.0, -63.0, -64.0, -14.0, -64.0, -63.0, -64.0, -63.0, -28.0, -30.0, -39.0, -18.0, -29.0, -35.0, -41.0, -18.0, -62.0, -62.0, -63.0, -29.0, -63.0, -64.0, -63.0, -38.0, -64.0, -38.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.363241043396142, "mean_inference_ms": 18.745556941591232, "mean_action_processing_ms": 0.8175638367255599, "mean_env_wait_ms": 0.4791998937513549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5641422271728516, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.26839327812194824}}, "episode_reward_max": 12.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -45.0, -64.0, -33.0, -28.0, -31.0, -36.0, -63.0, -42.0, -64.0, -64.0, -28.0, -62.0, -33.0, -62.0, -42.0, -63.0, -63.0, -62.0, -63.0, -44.0, -36.0, -34.0, -39.0, -64.0, -48.0, -64.0, -39.0, -32.0, 0.0, -64.0, -63.0, -26.0, -63.0, -38.0, -31.0, -63.0, 12.0, -64.0, -44.0, -63.0, -62.0, -35.0, -49.0, -27.0, -12.0, -37.0, -64.0, -43.0, -39.0, -43.0, -43.0, -48.0, -64.0, -64.0, -63.0, -44.0, -20.0, -64.0, -33.0, -35.0, -38.0, -33.0, -19.0, -31.0, -5.0, -64.0, -48.0, -25.0, -12.0, -64.0, -35.0, -63.0, -63.0, -64.0, -14.0, -64.0, -63.0, -64.0, -63.0, -28.0, -30.0, -39.0, -18.0, -29.0, -35.0, -41.0, -18.0, -62.0, -62.0, -63.0, -29.0, -63.0, -64.0, -63.0, -38.0, -64.0, -38.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.363241043396142, "mean_inference_ms": 18.745556941591232, "mean_action_processing_ms": 0.8175638367255599, "mean_env_wait_ms": 0.4791998937513549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5641422271728516, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.26839327812194824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.076716668246848, "num_agent_steps_trained_throughput_per_sec": 3.076716668246848, "timesteps_total": 45568, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45568, "timers": {"training_iteration_time_ms": 160996.124, "sample_time_ms": 11735.924, "load_time_ms": 0.407, "load_throughput": 1256720.3, "learn_time_ms": 149259.221, "learn_throughput": 3.43, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "done": false, "episodes_total": 2848, "training_iteration": 89, "trial_id": "6f959_00019", "date": "2024-02-28_19-04-10", "timestamp": 1709143450, "time_this_iter_s": 166.42163825035095, "time_total_s": 14158.9341070652, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14158.9341070652, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 56.61610169491526, "ram_util_percent": 17.858050847457626}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.92, "reward_total_min": -64, "reward_total_max": 12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1490625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.59375, "reward_score_mean": 0.1490625, "reward_score_min": 0.0, "reward_score_max": 0.59375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9296615694339077, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.888058988253276, "policy_loss": 0.0049220623758931955, "vf_loss": 9.772216435273489, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.8869639078776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.92, "reward_total_min": -64, "reward_total_max": 12, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1490625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.59375, "reward_score_mean": 0.1490625, "reward_score_min": 0.0, "reward_score_max": 0.59375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-26.0, -63.0, -38.0, -31.0, -63.0, 12.0, -64.0, -44.0, -63.0, -62.0, -35.0, -49.0, -27.0, -12.0, -37.0, -64.0, -43.0, -39.0, -43.0, -43.0, -48.0, -64.0, -64.0, -63.0, -44.0, -20.0, -64.0, -33.0, -35.0, -38.0, -33.0, -19.0, -31.0, -5.0, -64.0, -48.0, -25.0, -12.0, -64.0, -35.0, -63.0, -63.0, -64.0, -14.0, -64.0, -63.0, -64.0, -63.0, -28.0, -30.0, -39.0, -18.0, -29.0, -35.0, -41.0, -18.0, -62.0, -62.0, -63.0, -29.0, -63.0, -64.0, -63.0, -38.0, -64.0, -38.0, -64.0, -64.0, -33.0, -41.0, -43.0, -38.0, -64.0, -63.0, -64.0, -62.0, -41.0, -42.0, -64.0, -64.0, -18.0, -41.0, -64.0, -17.0, -26.0, -29.0, -33.0, -43.0, -43.0, -35.0, -52.0, -12.0, -63.0, -63.0, -41.0, -64.0, -64.0, -25.0, -64.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.364917928954562, "mean_inference_ms": 18.7581143367808, "mean_action_processing_ms": 0.8184082865090332, "mean_env_wait_ms": 0.4796667937309296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6273760795593262, "StateBufferConnector_ms": 0.007485628128051758, "ViewRequirementAgentConnector_ms": 0.28539586067199707}}, "episode_reward_max": 12.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.0, -63.0, -38.0, -31.0, -63.0, 12.0, -64.0, -44.0, -63.0, -62.0, -35.0, -49.0, -27.0, -12.0, -37.0, -64.0, -43.0, -39.0, -43.0, -43.0, -48.0, -64.0, -64.0, -63.0, -44.0, -20.0, -64.0, -33.0, -35.0, -38.0, -33.0, -19.0, -31.0, -5.0, -64.0, -48.0, -25.0, -12.0, -64.0, -35.0, -63.0, -63.0, -64.0, -14.0, -64.0, -63.0, -64.0, -63.0, -28.0, -30.0, -39.0, -18.0, -29.0, -35.0, -41.0, -18.0, -62.0, -62.0, -63.0, -29.0, -63.0, -64.0, -63.0, -38.0, -64.0, -38.0, -64.0, -64.0, -33.0, -41.0, -43.0, -38.0, -64.0, -63.0, -64.0, -62.0, -41.0, -42.0, -64.0, -64.0, -18.0, -41.0, -64.0, -17.0, -26.0, -29.0, -33.0, -43.0, -43.0, -35.0, -52.0, -12.0, -63.0, -63.0, -41.0, -64.0, -64.0, -25.0, -64.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.364917928954562, "mean_inference_ms": 18.7581143367808, "mean_action_processing_ms": 0.8184082865090332, "mean_env_wait_ms": 0.4796667937309296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6273760795593262, "StateBufferConnector_ms": 0.007485628128051758, "ViewRequirementAgentConnector_ms": 0.28539586067199707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.081737778057433, "num_agent_steps_trained_throughput_per_sec": 3.081737778057433, "timesteps_total": 46080, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 162192.993, "sample_time_ms": 11930.762, "load_time_ms": 0.393, "load_throughput": 1304113.468, "learn_time_ms": 150261.28, "learn_throughput": 3.407, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "episodes_total": 2880, "training_iteration": 90, "trial_id": "6f959_00019", "date": "2024-02-28_19-06-57", "timestamp": 1709143617, "time_this_iter_s": 166.15037274360657, "time_total_s": 14325.084479808807, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14325.084479808807, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 56.938135593220345, "ram_util_percent": 17.905932203389828}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.29, "reward_total_min": -64, "reward_total_max": -5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.146171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4609375, "reward_score_mean": 0.146171875, "reward_score_min": 0.0, "reward_score_max": 0.4609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9634073646118243, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.01690141359965, "policy_loss": -0.032732801116071644, "vf_loss": 9.955377980073292, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.24864921569824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "sampler_results": {"episode_reward_max": -5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.29, "reward_total_min": -64, "reward_total_max": -5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.146171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4609375, "reward_score_mean": 0.146171875, "reward_score_min": 0.0, "reward_score_max": 0.4609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-31.0, -5.0, -64.0, -48.0, -25.0, -12.0, -64.0, -35.0, -63.0, -63.0, -64.0, -14.0, -64.0, -63.0, -64.0, -63.0, -28.0, -30.0, -39.0, -18.0, -29.0, -35.0, -41.0, -18.0, -62.0, -62.0, -63.0, -29.0, -63.0, -64.0, -63.0, -38.0, -64.0, -38.0, -64.0, -64.0, -33.0, -41.0, -43.0, -38.0, -64.0, -63.0, -64.0, -62.0, -41.0, -42.0, -64.0, -64.0, -18.0, -41.0, -64.0, -17.0, -26.0, -29.0, -33.0, -43.0, -43.0, -35.0, -52.0, -12.0, -63.0, -63.0, -41.0, -64.0, -64.0, -25.0, -64.0, -63.0, -22.0, -64.0, -25.0, -64.0, -64.0, -63.0, -37.0, -64.0, -64.0, -22.0, -64.0, -64.0, -41.0, -22.0, -34.0, -64.0, -64.0, -19.0, -51.0, -36.0, -62.0, -31.0, -31.0, -37.0, -26.0, -14.0, -64.0, -37.0, -41.0, -11.0, -63.0, -31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3668442718850025, "mean_inference_ms": 18.77162059670981, "mean_action_processing_ms": 0.8193098528313558, "mean_env_wait_ms": 0.48015539681177716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6371519565582275, "StateBufferConnector_ms": 0.007561206817626953, "ViewRequirementAgentConnector_ms": 0.2872161865234375}}, "episode_reward_max": -5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.0, -5.0, -64.0, -48.0, -25.0, -12.0, -64.0, -35.0, -63.0, -63.0, -64.0, -14.0, -64.0, -63.0, -64.0, -63.0, -28.0, -30.0, -39.0, -18.0, -29.0, -35.0, -41.0, -18.0, -62.0, -62.0, -63.0, -29.0, -63.0, -64.0, -63.0, -38.0, -64.0, -38.0, -64.0, -64.0, -33.0, -41.0, -43.0, -38.0, -64.0, -63.0, -64.0, -62.0, -41.0, -42.0, -64.0, -64.0, -18.0, -41.0, -64.0, -17.0, -26.0, -29.0, -33.0, -43.0, -43.0, -35.0, -52.0, -12.0, -63.0, -63.0, -41.0, -64.0, -64.0, -25.0, -64.0, -63.0, -22.0, -64.0, -25.0, -64.0, -64.0, -63.0, -37.0, -64.0, -64.0, -22.0, -64.0, -64.0, -41.0, -22.0, -34.0, -64.0, -64.0, -19.0, -51.0, -36.0, -62.0, -31.0, -31.0, -37.0, -26.0, -14.0, -64.0, -37.0, -41.0, -11.0, -63.0, -31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3668442718850025, "mean_inference_ms": 18.77162059670981, "mean_action_processing_ms": 0.8193098528313558, "mean_env_wait_ms": 0.48015539681177716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6371519565582275, "StateBufferConnector_ms": 0.007561206817626953, "ViewRequirementAgentConnector_ms": 0.2872161865234375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.320259525211023, "num_agent_steps_trained_throughput_per_sec": 3.320259525211023, "timesteps_total": 46592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46592, "timers": {"training_iteration_time_ms": 161262.238, "sample_time_ms": 11840.861, "load_time_ms": 0.421, "load_throughput": 1215740.29, "learn_time_ms": 149420.389, "learn_throughput": 3.427, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "done": false, "episodes_total": 2912, "training_iteration": 91, "trial_id": "6f959_00019", "date": "2024-02-28_19-09-31", "timestamp": 1709143771, "time_this_iter_s": 154.21507167816162, "time_total_s": 14479.299551486969, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14479.299551486969, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 57.68036529680365, "ram_util_percent": 17.79908675799087}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.47, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.136953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.136953125, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.987984370191892, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.843227577209472, "policy_loss": 0.04829705944284797, "vf_loss": 9.675181762377422, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 89.1990567525228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.47, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.47, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.136953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.136953125, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -38.0, -64.0, -64.0, -33.0, -41.0, -43.0, -38.0, -64.0, -63.0, -64.0, -62.0, -41.0, -42.0, -64.0, -64.0, -18.0, -41.0, -64.0, -17.0, -26.0, -29.0, -33.0, -43.0, -43.0, -35.0, -52.0, -12.0, -63.0, -63.0, -41.0, -64.0, -64.0, -25.0, -64.0, -63.0, -22.0, -64.0, -25.0, -64.0, -64.0, -63.0, -37.0, -64.0, -64.0, -22.0, -64.0, -64.0, -41.0, -22.0, -34.0, -64.0, -64.0, -19.0, -51.0, -36.0, -62.0, -31.0, -31.0, -37.0, -26.0, -14.0, -64.0, -37.0, -41.0, -11.0, -63.0, -31.0, -64.0, -64.0, -36.0, -28.0, -64.0, -64.0, -32.0, -37.0, -64.0, -29.0, -37.0, -64.0, -64.0, -64.0, -34.0, -36.0, -31.0, -36.0, -64.0, -33.0, -33.0, -64.0, -22.0, -43.0, -24.0, -63.0, -64.0, -64.0, -64.0, -28.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3678481562355898, "mean_inference_ms": 18.77713016902555, "mean_action_processing_ms": 0.8197335124440046, "mean_env_wait_ms": 0.48038185079195594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6188201904296875, "StateBufferConnector_ms": 0.007449626922607422, "ViewRequirementAgentConnector_ms": 0.2796671390533447}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.47, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -38.0, -64.0, -64.0, -33.0, -41.0, -43.0, -38.0, -64.0, -63.0, -64.0, -62.0, -41.0, -42.0, -64.0, -64.0, -18.0, -41.0, -64.0, -17.0, -26.0, -29.0, -33.0, -43.0, -43.0, -35.0, -52.0, -12.0, -63.0, -63.0, -41.0, -64.0, -64.0, -25.0, -64.0, -63.0, -22.0, -64.0, -25.0, -64.0, -64.0, -63.0, -37.0, -64.0, -64.0, -22.0, -64.0, -64.0, -41.0, -22.0, -34.0, -64.0, -64.0, -19.0, -51.0, -36.0, -62.0, -31.0, -31.0, -37.0, -26.0, -14.0, -64.0, -37.0, -41.0, -11.0, -63.0, -31.0, -64.0, -64.0, -36.0, -28.0, -64.0, -64.0, -32.0, -37.0, -64.0, -29.0, -37.0, -64.0, -64.0, -64.0, -34.0, -36.0, -31.0, -36.0, -64.0, -33.0, -33.0, -64.0, -22.0, -43.0, -24.0, -63.0, -64.0, -64.0, -64.0, -28.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3678481562355898, "mean_inference_ms": 18.77713016902555, "mean_action_processing_ms": 0.8197335124440046, "mean_env_wait_ms": 0.48038185079195594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6188201904296875, "StateBufferConnector_ms": 0.007449626922607422, "ViewRequirementAgentConnector_ms": 0.2796671390533447}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4031950192452025, "num_agent_steps_trained_throughput_per_sec": 3.4031950192452025, "timesteps_total": 47104, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 160197.727, "sample_time_ms": 11704.71, "load_time_ms": 0.418, "load_throughput": 1225173.236, "learn_time_ms": 148492.016, "learn_throughput": 3.448, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "episodes_total": 2944, "training_iteration": 92, "trial_id": "6f959_00019", "date": "2024-02-28_19-12-07", "timestamp": 1709143927, "time_this_iter_s": 150.46004390716553, "time_total_s": 14629.759595394135, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14629.759595394135, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 56.97918552036198, "ram_util_percent": 17.99864253393665}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.31, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.138203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.138203125, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.980474941432476, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.01038954257965, "policy_loss": -0.01930841413171341, "vf_loss": 9.933446315924327, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.7352352142334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.31, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.31, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.138203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.138203125, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -25.0, -64.0, -63.0, -22.0, -64.0, -25.0, -64.0, -64.0, -63.0, -37.0, -64.0, -64.0, -22.0, -64.0, -64.0, -41.0, -22.0, -34.0, -64.0, -64.0, -19.0, -51.0, -36.0, -62.0, -31.0, -31.0, -37.0, -26.0, -14.0, -64.0, -37.0, -41.0, -11.0, -63.0, -31.0, -64.0, -64.0, -36.0, -28.0, -64.0, -64.0, -32.0, -37.0, -64.0, -29.0, -37.0, -64.0, -64.0, -64.0, -34.0, -36.0, -31.0, -36.0, -64.0, -33.0, -33.0, -64.0, -22.0, -43.0, -24.0, -63.0, -64.0, -64.0, -64.0, -28.0, -64.0, -64.0, -42.0, -35.0, -33.0, -24.0, -63.0, -64.0, -24.0, -63.0, -27.0, -64.0, -37.0, -22.0, -64.0, -64.0, -64.0, -37.0, -38.0, -32.0, -30.0, -37.0, -64.0, -45.0, -63.0, -62.0, -64.0, -63.0, -34.0, -28.0, -32.0, -64.0, -30.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.366615301017434, "mean_inference_ms": 18.76765424302627, "mean_action_processing_ms": 0.819322341367845, "mean_env_wait_ms": 0.4801309055463686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5465662479400635, "StateBufferConnector_ms": 0.006894350051879883, "ViewRequirementAgentConnector_ms": 0.25919246673583984}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.31, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -25.0, -64.0, -63.0, -22.0, -64.0, -25.0, -64.0, -64.0, -63.0, -37.0, -64.0, -64.0, -22.0, -64.0, -64.0, -41.0, -22.0, -34.0, -64.0, -64.0, -19.0, -51.0, -36.0, -62.0, -31.0, -31.0, -37.0, -26.0, -14.0, -64.0, -37.0, -41.0, -11.0, -63.0, -31.0, -64.0, -64.0, -36.0, -28.0, -64.0, -64.0, -32.0, -37.0, -64.0, -29.0, -37.0, -64.0, -64.0, -64.0, -34.0, -36.0, -31.0, -36.0, -64.0, -33.0, -33.0, -64.0, -22.0, -43.0, -24.0, -63.0, -64.0, -64.0, -64.0, -28.0, -64.0, -64.0, -42.0, -35.0, -33.0, -24.0, -63.0, -64.0, -24.0, -63.0, -27.0, -64.0, -37.0, -22.0, -64.0, -64.0, -64.0, -37.0, -38.0, -32.0, -30.0, -37.0, -64.0, -45.0, -63.0, -62.0, -64.0, -63.0, -34.0, -28.0, -32.0, -64.0, -30.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.366615301017434, "mean_inference_ms": 18.76765424302627, "mean_action_processing_ms": 0.819322341367845, "mean_env_wait_ms": 0.4801309055463686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5465662479400635, "StateBufferConnector_ms": 0.006894350051879883, "ViewRequirementAgentConnector_ms": 0.25919246673583984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.377958369255317, "num_agent_steps_trained_throughput_per_sec": 3.377958369255317, "timesteps_total": 47616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47616, "timers": {"training_iteration_time_ms": 158673.227, "sample_time_ms": 11417.097, "load_time_ms": 0.438, "load_throughput": 1169526.004, "learn_time_ms": 147255.111, "learn_throughput": 3.477, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "done": false, "episodes_total": 2976, "training_iteration": 93, "trial_id": "6f959_00019", "date": "2024-02-28_19-14-38", "timestamp": 1709144078, "time_this_iter_s": 151.581041097641, "time_total_s": 14781.340636491776, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14781.340636491776, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 57.30046511627907, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.37, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.153359375, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9086491306622823, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.040366291999817, "policy_loss": 0.002093612402677536, "vf_loss": 9.942879231770833, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0, "entropy": 83.59088764190673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "sampler_results": {"episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.37, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.37, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.153359375, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -11.0, -63.0, -31.0, -64.0, -64.0, -36.0, -28.0, -64.0, -64.0, -32.0, -37.0, -64.0, -29.0, -37.0, -64.0, -64.0, -64.0, -34.0, -36.0, -31.0, -36.0, -64.0, -33.0, -33.0, -64.0, -22.0, -43.0, -24.0, -63.0, -64.0, -64.0, -64.0, -28.0, -64.0, -64.0, -42.0, -35.0, -33.0, -24.0, -63.0, -64.0, -24.0, -63.0, -27.0, -64.0, -37.0, -22.0, -64.0, -64.0, -64.0, -37.0, -38.0, -32.0, -30.0, -37.0, -64.0, -45.0, -63.0, -62.0, -64.0, -63.0, -34.0, -28.0, -32.0, -64.0, -30.0, -64.0, -34.0, -63.0, 6.0, -32.0, -28.0, -3.0, -29.0, -41.0, -31.0, -30.0, -64.0, -31.0, -41.0, -63.0, -25.0, -63.0, -43.0, -42.0, -29.0, -26.0, -24.0, -64.0, -63.0, -63.0, -41.0, -64.0, -27.0, -31.0, -43.0, -36.0, -41.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3651226724893144, "mean_inference_ms": 18.756174135312534, "mean_action_processing_ms": 0.8188007862837626, "mean_env_wait_ms": 0.4798117540863934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5332150459289551, "StateBufferConnector_ms": 0.0067861080169677734, "ViewRequirementAgentConnector_ms": 0.2566807270050049}}, "episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.37, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -11.0, -63.0, -31.0, -64.0, -64.0, -36.0, -28.0, -64.0, -64.0, -32.0, -37.0, -64.0, -29.0, -37.0, -64.0, -64.0, -64.0, -34.0, -36.0, -31.0, -36.0, -64.0, -33.0, -33.0, -64.0, -22.0, -43.0, -24.0, -63.0, -64.0, -64.0, -64.0, -28.0, -64.0, -64.0, -42.0, -35.0, -33.0, -24.0, -63.0, -64.0, -24.0, -63.0, -27.0, -64.0, -37.0, -22.0, -64.0, -64.0, -64.0, -37.0, -38.0, -32.0, -30.0, -37.0, -64.0, -45.0, -63.0, -62.0, -64.0, -63.0, -34.0, -28.0, -32.0, -64.0, -30.0, -64.0, -34.0, -63.0, 6.0, -32.0, -28.0, -3.0, -29.0, -41.0, -31.0, -30.0, -64.0, -31.0, -41.0, -63.0, -25.0, -63.0, -43.0, -42.0, -29.0, -26.0, -24.0, -64.0, -63.0, -63.0, -41.0, -64.0, -27.0, -31.0, -43.0, -36.0, -41.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3651226724893144, "mean_inference_ms": 18.756174135312534, "mean_action_processing_ms": 0.8188007862837626, "mean_env_wait_ms": 0.4798117540863934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5332150459289551, "StateBufferConnector_ms": 0.0067861080169677734, "ViewRequirementAgentConnector_ms": 0.2566807270050049}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3325606720296097, "num_agent_steps_trained_throughput_per_sec": 3.3325606720296097, "timesteps_total": 48128, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 158459.861, "sample_time_ms": 11412.988, "load_time_ms": 0.473, "load_throughput": 1081583.303, "learn_time_ms": 147045.825, "learn_throughput": 3.482, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "episodes_total": 3008, "training_iteration": 94, "trial_id": "6f959_00019", "date": "2024-02-28_19-17-12", "timestamp": 1709144232, "time_this_iter_s": 153.6465802192688, "time_total_s": 14934.987216711044, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14934.987216711044, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 57.38264840182648, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.09, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.171171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.171171875, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9322204238424698, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.010429298877716, "policy_loss": 0.031120864596838754, "vf_loss": 9.878013420104981, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 84.45827630360921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "sampler_results": {"episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.09, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.171171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.171171875, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -28.0, -64.0, -64.0, -42.0, -35.0, -33.0, -24.0, -63.0, -64.0, -24.0, -63.0, -27.0, -64.0, -37.0, -22.0, -64.0, -64.0, -64.0, -37.0, -38.0, -32.0, -30.0, -37.0, -64.0, -45.0, -63.0, -62.0, -64.0, -63.0, -34.0, -28.0, -32.0, -64.0, -30.0, -64.0, -34.0, -63.0, 6.0, -32.0, -28.0, -3.0, -29.0, -41.0, -31.0, -30.0, -64.0, -31.0, -41.0, -63.0, -25.0, -63.0, -43.0, -42.0, -29.0, -26.0, -24.0, -64.0, -63.0, -63.0, -41.0, -64.0, -27.0, -31.0, -43.0, -36.0, -41.0, -63.0, -34.0, -40.0, -23.0, -17.0, -16.0, -64.0, -24.0, -32.0, -39.0, -14.0, -26.0, -37.0, -34.0, -64.0, -39.0, -63.0, -35.0, -41.0, -64.0, -37.0, -39.0, -43.0, -36.0, -40.0, -48.0, -28.0, -21.0, -64.0, -64.0, -17.0, -33.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.36335766696557, "mean_inference_ms": 18.743406894867185, "mean_action_processing_ms": 0.8182307328393091, "mean_env_wait_ms": 0.479452018796209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5113811492919922, "StateBufferConnector_ms": 0.0066149234771728516, "ViewRequirementAgentConnector_ms": 0.2522575855255127}}, "episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -28.0, -64.0, -64.0, -42.0, -35.0, -33.0, -24.0, -63.0, -64.0, -24.0, -63.0, -27.0, -64.0, -37.0, -22.0, -64.0, -64.0, -64.0, -37.0, -38.0, -32.0, -30.0, -37.0, -64.0, -45.0, -63.0, -62.0, -64.0, -63.0, -34.0, -28.0, -32.0, -64.0, -30.0, -64.0, -34.0, -63.0, 6.0, -32.0, -28.0, -3.0, -29.0, -41.0, -31.0, -30.0, -64.0, -31.0, -41.0, -63.0, -25.0, -63.0, -43.0, -42.0, -29.0, -26.0, -24.0, -64.0, -63.0, -63.0, -41.0, -64.0, -27.0, -31.0, -43.0, -36.0, -41.0, -63.0, -34.0, -40.0, -23.0, -17.0, -16.0, -64.0, -24.0, -32.0, -39.0, -14.0, -26.0, -37.0, -34.0, -64.0, -39.0, -63.0, -35.0, -41.0, -64.0, -37.0, -39.0, -43.0, -36.0, -40.0, -48.0, -28.0, -21.0, -64.0, -64.0, -17.0, -33.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.36335766696557, "mean_inference_ms": 18.743406894867185, "mean_action_processing_ms": 0.8182307328393091, "mean_env_wait_ms": 0.479452018796209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5113811492919922, "StateBufferConnector_ms": 0.0066149234771728516, "ViewRequirementAgentConnector_ms": 0.2522575855255127}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3855061721274344, "num_agent_steps_trained_throughput_per_sec": 3.3855061721274344, "timesteps_total": 48640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48640, "timers": {"training_iteration_time_ms": 158497.114, "sample_time_ms": 11353.097, "load_time_ms": 0.474, "load_throughput": 1080168.829, "learn_time_ms": 147142.971, "learn_throughput": 3.48, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "done": false, "episodes_total": 3040, "training_iteration": 95, "trial_id": "6f959_00019", "date": "2024-02-28_19-19-43", "timestamp": 1709144383, "time_this_iter_s": 151.24322152137756, "time_total_s": 15086.230438232422, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15086.230438232422, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 57.4285046728972, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.79, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.165703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.165703125, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9403415856262048, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.081002235412598, "policy_loss": -0.0015565285769601662, "vf_loss": 9.991597644488017, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.91099662780762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.79, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.79, "reward_total_min": -64, "reward_total_max": 6, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.165703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.546875, "reward_score_mean": 0.165703125, "reward_score_min": 0.0, "reward_score_max": 0.546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-32.0, -64.0, -30.0, -64.0, -34.0, -63.0, 6.0, -32.0, -28.0, -3.0, -29.0, -41.0, -31.0, -30.0, -64.0, -31.0, -41.0, -63.0, -25.0, -63.0, -43.0, -42.0, -29.0, -26.0, -24.0, -64.0, -63.0, -63.0, -41.0, -64.0, -27.0, -31.0, -43.0, -36.0, -41.0, -63.0, -34.0, -40.0, -23.0, -17.0, -16.0, -64.0, -24.0, -32.0, -39.0, -14.0, -26.0, -37.0, -34.0, -64.0, -39.0, -63.0, -35.0, -41.0, -64.0, -37.0, -39.0, -43.0, -36.0, -40.0, -48.0, -28.0, -21.0, -64.0, -64.0, -17.0, -33.0, -64.0, -35.0, -64.0, -63.0, -4.0, -27.0, -64.0, -36.0, -20.0, -21.0, -64.0, -30.0, -64.0, -35.0, -63.0, -40.0, -64.0, -64.0, -13.0, -64.0, -63.0, -63.0, -63.0, -64.0, -64.0, -64.0, -23.0, -64.0, -41.0, -64.0, -63.0, -64.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3619365136908335, "mean_inference_ms": 18.732198946636316, "mean_action_processing_ms": 0.8177404374320687, "mean_env_wait_ms": 0.47914563308307345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5237822532653809, "StateBufferConnector_ms": 0.0066988468170166016, "ViewRequirementAgentConnector_ms": 0.2566709518432617}}, "episode_reward_max": 6.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.79, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.0, -64.0, -30.0, -64.0, -34.0, -63.0, 6.0, -32.0, -28.0, -3.0, -29.0, -41.0, -31.0, -30.0, -64.0, -31.0, -41.0, -63.0, -25.0, -63.0, -43.0, -42.0, -29.0, -26.0, -24.0, -64.0, -63.0, -63.0, -41.0, -64.0, -27.0, -31.0, -43.0, -36.0, -41.0, -63.0, -34.0, -40.0, -23.0, -17.0, -16.0, -64.0, -24.0, -32.0, -39.0, -14.0, -26.0, -37.0, -34.0, -64.0, -39.0, -63.0, -35.0, -41.0, -64.0, -37.0, -39.0, -43.0, -36.0, -40.0, -48.0, -28.0, -21.0, -64.0, -64.0, -17.0, -33.0, -64.0, -35.0, -64.0, -63.0, -4.0, -27.0, -64.0, -36.0, -20.0, -21.0, -64.0, -30.0, -64.0, -35.0, -63.0, -40.0, -64.0, -64.0, -13.0, -64.0, -63.0, -63.0, -63.0, -64.0, -64.0, -64.0, -23.0, -64.0, -41.0, -64.0, -63.0, -64.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3619365136908335, "mean_inference_ms": 18.732198946636316, "mean_action_processing_ms": 0.8177404374320687, "mean_env_wait_ms": 0.47914563308307345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5237822532653809, "StateBufferConnector_ms": 0.0066988468170166016, "ViewRequirementAgentConnector_ms": 0.2566709518432617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.340014493611391, "num_agent_steps_trained_throughput_per_sec": 3.340014493611391, "timesteps_total": 49152, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 158351.8, "sample_time_ms": 11312.223, "load_time_ms": 0.487, "load_throughput": 1051039.374, "learn_time_ms": 147038.5, "learn_throughput": 3.482, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 3072, "training_iteration": 96, "trial_id": "6f959_00019", "date": "2024-02-28_19-22-17", "timestamp": 1709144537, "time_this_iter_s": 153.30335807800293, "time_total_s": 15239.533796310425, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15239.533796310425, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 57.39816513761468, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -43.28, "reward_total_min": -64, "reward_total_max": 7, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.161875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5546875, "reward_score_mean": 0.161875, "reward_score_min": 0.0, "reward_score_max": 0.5546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8842160066494519, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.022183493773143, "policy_loss": -0.022764264155800143, "vf_loss": 9.950222408771515, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.28632876078288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "sampler_results": {"episode_reward_max": 7.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -43.28, "reward_total_min": -64, "reward_total_max": 7, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.161875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5546875, "reward_score_mean": 0.161875, "reward_score_min": 0.0, "reward_score_max": 0.5546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -36.0, -41.0, -63.0, -34.0, -40.0, -23.0, -17.0, -16.0, -64.0, -24.0, -32.0, -39.0, -14.0, -26.0, -37.0, -34.0, -64.0, -39.0, -63.0, -35.0, -41.0, -64.0, -37.0, -39.0, -43.0, -36.0, -40.0, -48.0, -28.0, -21.0, -64.0, -64.0, -17.0, -33.0, -64.0, -35.0, -64.0, -63.0, -4.0, -27.0, -64.0, -36.0, -20.0, -21.0, -64.0, -30.0, -64.0, -35.0, -63.0, -40.0, -64.0, -64.0, -13.0, -64.0, -63.0, -63.0, -63.0, -64.0, -64.0, -64.0, -23.0, -64.0, -41.0, -64.0, -63.0, -64.0, -42.0, -37.0, -19.0, -31.0, -64.0, -47.0, -27.0, -24.0, -33.0, -9.0, -28.0, -63.0, -61.0, 7.0, -64.0, -63.0, -64.0, -26.0, -42.0, -28.0, -64.0, -62.0, -64.0, -64.0, -24.0, -20.0, -34.0, -62.0, -64.0, -21.0, -31.0, -63.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3603109806559956, "mean_inference_ms": 18.720354037007954, "mean_action_processing_ms": 0.8172025378174104, "mean_env_wait_ms": 0.47881527274380276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5187728404998779, "StateBufferConnector_ms": 0.0066394805908203125, "ViewRequirementAgentConnector_ms": 0.2533135414123535}}, "episode_reward_max": 7.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -36.0, -41.0, -63.0, -34.0, -40.0, -23.0, -17.0, -16.0, -64.0, -24.0, -32.0, -39.0, -14.0, -26.0, -37.0, -34.0, -64.0, -39.0, -63.0, -35.0, -41.0, -64.0, -37.0, -39.0, -43.0, -36.0, -40.0, -48.0, -28.0, -21.0, -64.0, -64.0, -17.0, -33.0, -64.0, -35.0, -64.0, -63.0, -4.0, -27.0, -64.0, -36.0, -20.0, -21.0, -64.0, -30.0, -64.0, -35.0, -63.0, -40.0, -64.0, -64.0, -13.0, -64.0, -63.0, -63.0, -63.0, -64.0, -64.0, -64.0, -23.0, -64.0, -41.0, -64.0, -63.0, -64.0, -42.0, -37.0, -19.0, -31.0, -64.0, -47.0, -27.0, -24.0, -33.0, -9.0, -28.0, -63.0, -61.0, 7.0, -64.0, -63.0, -64.0, -26.0, -42.0, -28.0, -64.0, -62.0, -64.0, -64.0, -24.0, -20.0, -34.0, -62.0, -64.0, -21.0, -31.0, -63.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3603109806559956, "mean_inference_ms": 18.720354037007954, "mean_action_processing_ms": 0.8172025378174104, "mean_env_wait_ms": 0.47881527274380276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5187728404998779, "StateBufferConnector_ms": 0.0066394805908203125, "ViewRequirementAgentConnector_ms": 0.2533135414123535}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3585126654214776, "num_agent_steps_trained_throughput_per_sec": 3.3585126654214776, "timesteps_total": 49664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49664, "timers": {"training_iteration_time_ms": 156971.999, "sample_time_ms": 11302.458, "load_time_ms": 0.479, "load_throughput": 1069038.057, "learn_time_ms": 145668.476, "learn_throughput": 3.515, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "done": false, "episodes_total": 3104, "training_iteration": 97, "trial_id": "6f959_00019", "date": "2024-02-28_19-24-49", "timestamp": 1709144689, "time_this_iter_s": 152.46361565589905, "time_total_s": 15391.997411966324, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15391.997411966324, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.39815668202765, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.66, "reward_total_min": -64, "reward_total_max": 7, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5546875, "reward_score_mean": 0.14328125, "reward_score_min": 0.0, "reward_score_max": 0.5546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9318363138164083, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.052776797612507, "policy_loss": -0.021444930508732796, "vf_loss": 9.982426158587138, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.9239387512207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "sampler_results": {"episode_reward_max": 7.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.66, "reward_total_min": -64, "reward_total_max": 7, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5546875, "reward_score_mean": 0.14328125, "reward_score_min": 0.0, "reward_score_max": 0.5546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -17.0, -33.0, -64.0, -35.0, -64.0, -63.0, -4.0, -27.0, -64.0, -36.0, -20.0, -21.0, -64.0, -30.0, -64.0, -35.0, -63.0, -40.0, -64.0, -64.0, -13.0, -64.0, -63.0, -63.0, -63.0, -64.0, -64.0, -64.0, -23.0, -64.0, -41.0, -64.0, -63.0, -64.0, -42.0, -37.0, -19.0, -31.0, -64.0, -47.0, -27.0, -24.0, -33.0, -9.0, -28.0, -63.0, -61.0, 7.0, -64.0, -63.0, -64.0, -26.0, -42.0, -28.0, -64.0, -62.0, -64.0, -64.0, -24.0, -20.0, -34.0, -62.0, -64.0, -21.0, -31.0, -63.0, -32.0, -44.0, -41.0, -27.0, -64.0, -36.0, -64.0, -64.0, -29.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -17.0, -25.0, -64.0, -64.0, -64.0, -14.0, -39.0, -34.0, -64.0, -36.0, -62.0, -43.0, -26.0, -63.0, -63.0, -40.0, -40.0, -6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.358473127623823, "mean_inference_ms": 18.707728596607307, "mean_action_processing_ms": 0.8165836300383816, "mean_env_wait_ms": 0.4784577471582612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.516711950302124, "StateBufferConnector_ms": 0.006634712219238281, "ViewRequirementAgentConnector_ms": 0.25185346603393555}}, "episode_reward_max": 7.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -17.0, -33.0, -64.0, -35.0, -64.0, -63.0, -4.0, -27.0, -64.0, -36.0, -20.0, -21.0, -64.0, -30.0, -64.0, -35.0, -63.0, -40.0, -64.0, -64.0, -13.0, -64.0, -63.0, -63.0, -63.0, -64.0, -64.0, -64.0, -23.0, -64.0, -41.0, -64.0, -63.0, -64.0, -42.0, -37.0, -19.0, -31.0, -64.0, -47.0, -27.0, -24.0, -33.0, -9.0, -28.0, -63.0, -61.0, 7.0, -64.0, -63.0, -64.0, -26.0, -42.0, -28.0, -64.0, -62.0, -64.0, -64.0, -24.0, -20.0, -34.0, -62.0, -64.0, -21.0, -31.0, -63.0, -32.0, -44.0, -41.0, -27.0, -64.0, -36.0, -64.0, -64.0, -29.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -17.0, -25.0, -64.0, -64.0, -64.0, -14.0, -39.0, -34.0, -64.0, -36.0, -62.0, -43.0, -26.0, -63.0, -63.0, -40.0, -40.0, -6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.358473127623823, "mean_inference_ms": 18.707728596607307, "mean_action_processing_ms": 0.8165836300383816, "mean_env_wait_ms": 0.4784577471582612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.516711950302124, "StateBufferConnector_ms": 0.006634712219238281, "ViewRequirementAgentConnector_ms": 0.25185346603393555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4176524309656404, "num_agent_steps_trained_throughput_per_sec": 3.4176524309656404, "timesteps_total": 50176, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 154919.348, "sample_time_ms": 11220.273, "load_time_ms": 0.473, "load_throughput": 1083329.288, "learn_time_ms": 143698.023, "learn_throughput": 3.563, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "episodes_total": 3136, "training_iteration": 98, "trial_id": "6f959_00019", "date": "2024-02-28_19-27-19", "timestamp": 1709144839, "time_this_iter_s": 149.82088971138, "time_total_s": 15541.818301677704, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15541.818301677704, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.33098591549296, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.3, "reward_total_min": -64, "reward_total_max": 7, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5546875, "reward_score_mean": 0.15390625, "reward_score_min": 0.0, "reward_score_max": 0.5546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8909287155838683, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.043293221791584, "policy_loss": 0.021158265803630154, "vf_loss": 9.925126425425212, "vf_explained_var": 7.173418998718261e-06, "kl": 0.0, "entropy": 93.34746259053549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "sampler_results": {"episode_reward_max": 7.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.3, "reward_total_min": -64, "reward_total_max": 7, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5546875, "reward_score_mean": 0.15390625, "reward_score_min": 0.0, "reward_score_max": 0.5546875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -63.0, -64.0, -42.0, -37.0, -19.0, -31.0, -64.0, -47.0, -27.0, -24.0, -33.0, -9.0, -28.0, -63.0, -61.0, 7.0, -64.0, -63.0, -64.0, -26.0, -42.0, -28.0, -64.0, -62.0, -64.0, -64.0, -24.0, -20.0, -34.0, -62.0, -64.0, -21.0, -31.0, -63.0, -32.0, -44.0, -41.0, -27.0, -64.0, -36.0, -64.0, -64.0, -29.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -17.0, -25.0, -64.0, -64.0, -64.0, -14.0, -39.0, -34.0, -64.0, -36.0, -62.0, -43.0, -26.0, -63.0, -63.0, -40.0, -40.0, -6.0, -64.0, -32.0, -64.0, -63.0, -38.0, -35.0, -34.0, -42.0, -34.0, -19.0, -64.0, -36.0, -13.0, -63.0, -63.0, -38.0, -34.0, -25.0, -64.0, -23.0, -36.0, -64.0, -39.0, -64.0, -35.0, -64.0, -64.0, -16.0, -12.0, -40.0, -40.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3568456895596723, "mean_inference_ms": 18.69670175108198, "mean_action_processing_ms": 0.816024204589128, "mean_env_wait_ms": 0.47815132975688157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5194449424743652, "StateBufferConnector_ms": 0.0066928863525390625, "ViewRequirementAgentConnector_ms": 0.25230836868286133}}, "episode_reward_max": 7.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -63.0, -64.0, -42.0, -37.0, -19.0, -31.0, -64.0, -47.0, -27.0, -24.0, -33.0, -9.0, -28.0, -63.0, -61.0, 7.0, -64.0, -63.0, -64.0, -26.0, -42.0, -28.0, -64.0, -62.0, -64.0, -64.0, -24.0, -20.0, -34.0, -62.0, -64.0, -21.0, -31.0, -63.0, -32.0, -44.0, -41.0, -27.0, -64.0, -36.0, -64.0, -64.0, -29.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -17.0, -25.0, -64.0, -64.0, -64.0, -14.0, -39.0, -34.0, -64.0, -36.0, -62.0, -43.0, -26.0, -63.0, -63.0, -40.0, -40.0, -6.0, -64.0, -32.0, -64.0, -63.0, -38.0, -35.0, -34.0, -42.0, -34.0, -19.0, -64.0, -36.0, -13.0, -63.0, -63.0, -38.0, -34.0, -25.0, -64.0, -23.0, -36.0, -64.0, -39.0, -64.0, -35.0, -64.0, -64.0, -16.0, -12.0, -40.0, -40.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3568456895596723, "mean_inference_ms": 18.69670175108198, "mean_action_processing_ms": 0.816024204589128, "mean_env_wait_ms": 0.47815132975688157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5194449424743652, "StateBufferConnector_ms": 0.0066928863525390625, "ViewRequirementAgentConnector_ms": 0.25230836868286133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3979828284244995, "num_agent_steps_trained_throughput_per_sec": 3.3979828284244995, "timesteps_total": 50688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50688, "timers": {"training_iteration_time_ms": 153345.995, "sample_time_ms": 11102.824, "load_time_ms": 0.468, "load_throughput": 1094705.433, "learn_time_ms": 142242.126, "learn_throughput": 3.599, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "done": false, "episodes_total": 3168, "training_iteration": 99, "trial_id": "6f959_00019", "date": "2024-02-28_19-29-50", "timestamp": 1709144990, "time_this_iter_s": 150.68796706199646, "time_total_s": 15692.5062687397, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15692.5062687397, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 57.42196261682243, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.9, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14921875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.14921875, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8933816611922035, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.05493419567744, "policy_loss": -0.011424326151609421, "vf_loss": 9.973775986830393, "vf_explained_var": -8.240342140197753e-07, "kl": 0.0, "entropy": 97.03286933898926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.9, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14921875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.14921875, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-21.0, -31.0, -63.0, -32.0, -44.0, -41.0, -27.0, -64.0, -36.0, -64.0, -64.0, -29.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -17.0, -25.0, -64.0, -64.0, -64.0, -14.0, -39.0, -34.0, -64.0, -36.0, -62.0, -43.0, -26.0, -63.0, -63.0, -40.0, -40.0, -6.0, -64.0, -32.0, -64.0, -63.0, -38.0, -35.0, -34.0, -42.0, -34.0, -19.0, -64.0, -36.0, -13.0, -63.0, -63.0, -38.0, -34.0, -25.0, -64.0, -23.0, -36.0, -64.0, -39.0, -64.0, -35.0, -64.0, -64.0, -16.0, -12.0, -40.0, -40.0, -64.0, -64.0, -64.0, 5.0, -36.0, -41.0, -32.0, -16.0, -18.0, -64.0, -42.0, -64.0, -64.0, -34.0, -63.0, -64.0, -35.0, -40.0, -43.0, -64.0, -42.0, -6.0, -28.0, -35.0, -64.0, -64.0, -64.0, -64.0, -64.0, -32.0, -64.0, -64.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355614659122602, "mean_inference_ms": 18.688150105249434, "mean_action_processing_ms": 0.8155789438371406, "mean_env_wait_ms": 0.477931274565715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5285959243774414, "StateBufferConnector_ms": 0.006795406341552734, "ViewRequirementAgentConnector_ms": 0.25525426864624023}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.0, -31.0, -63.0, -32.0, -44.0, -41.0, -27.0, -64.0, -36.0, -64.0, -64.0, -29.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -17.0, -25.0, -64.0, -64.0, -64.0, -14.0, -39.0, -34.0, -64.0, -36.0, -62.0, -43.0, -26.0, -63.0, -63.0, -40.0, -40.0, -6.0, -64.0, -32.0, -64.0, -63.0, -38.0, -35.0, -34.0, -42.0, -34.0, -19.0, -64.0, -36.0, -13.0, -63.0, -63.0, -38.0, -34.0, -25.0, -64.0, -23.0, -36.0, -64.0, -39.0, -64.0, -35.0, -64.0, -64.0, -16.0, -12.0, -40.0, -40.0, -64.0, -64.0, -64.0, 5.0, -36.0, -41.0, -32.0, -16.0, -18.0, -64.0, -42.0, -64.0, -64.0, -34.0, -63.0, -64.0, -35.0, -40.0, -43.0, -64.0, -42.0, -6.0, -28.0, -35.0, -64.0, -64.0, -64.0, -64.0, -64.0, -32.0, -64.0, -64.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355614659122602, "mean_inference_ms": 18.688150105249434, "mean_action_processing_ms": 0.8155789438371406, "mean_env_wait_ms": 0.477931274565715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5285959243774414, "StateBufferConnector_ms": 0.006795406341552734, "ViewRequirementAgentConnector_ms": 0.25525426864624023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1288686549988927, "num_agent_steps_trained_throughput_per_sec": 3.1288686549988927, "timesteps_total": 51200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 153095.732, "sample_time_ms": 10905.243, "load_time_ms": 0.47, "load_throughput": 1089982.564, "learn_time_ms": 142189.435, "learn_throughput": 3.601, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 3200, "training_iteration": 100, "trial_id": "6f959_00019", "date": "2024-02-28_19-32-33", "timestamp": 1709145153, "time_this_iter_s": 163.64800453186035, "time_total_s": 15856.15427327156, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15856.15427327156, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 57.19396551724138, "ram_util_percent": 17.662931034482757}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.04, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1715625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.1715625, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8229810148477554, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.03362492720286, "policy_loss": -0.016318205821638305, "vf_loss": 9.955717778205871, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.97673327128092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.04, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.04, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1715625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.1715625, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -40.0, -40.0, -6.0, -64.0, -32.0, -64.0, -63.0, -38.0, -35.0, -34.0, -42.0, -34.0, -19.0, -64.0, -36.0, -13.0, -63.0, -63.0, -38.0, -34.0, -25.0, -64.0, -23.0, -36.0, -64.0, -39.0, -64.0, -35.0, -64.0, -64.0, -16.0, -12.0, -40.0, -40.0, -64.0, -64.0, -64.0, 5.0, -36.0, -41.0, -32.0, -16.0, -18.0, -64.0, -42.0, -64.0, -64.0, -34.0, -63.0, -64.0, -35.0, -40.0, -43.0, -64.0, -42.0, -6.0, -28.0, -35.0, -64.0, -64.0, -64.0, -64.0, -64.0, -32.0, -64.0, -64.0, -40.0, -37.0, -64.0, -23.0, -17.0, -36.0, -38.0, -39.0, -38.0, -25.0, -34.0, -31.0, -64.0, -64.0, -40.0, -44.0, -9.0, -64.0, -24.0, -8.0, -43.0, -21.0, -41.0, -39.0, -64.0, -64.0, -41.0, -22.0, -45.0, -9.0, -30.0, -34.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3550321849078917, "mean_inference_ms": 18.68280175723749, "mean_action_processing_ms": 0.8153502244790153, "mean_env_wait_ms": 0.4778171830637817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5496213436126709, "StateBufferConnector_ms": 0.006970405578613281, "ViewRequirementAgentConnector_ms": 0.26345062255859375}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.04, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -40.0, -40.0, -6.0, -64.0, -32.0, -64.0, -63.0, -38.0, -35.0, -34.0, -42.0, -34.0, -19.0, -64.0, -36.0, -13.0, -63.0, -63.0, -38.0, -34.0, -25.0, -64.0, -23.0, -36.0, -64.0, -39.0, -64.0, -35.0, -64.0, -64.0, -16.0, -12.0, -40.0, -40.0, -64.0, -64.0, -64.0, 5.0, -36.0, -41.0, -32.0, -16.0, -18.0, -64.0, -42.0, -64.0, -64.0, -34.0, -63.0, -64.0, -35.0, -40.0, -43.0, -64.0, -42.0, -6.0, -28.0, -35.0, -64.0, -64.0, -64.0, -64.0, -64.0, -32.0, -64.0, -64.0, -40.0, -37.0, -64.0, -23.0, -17.0, -36.0, -38.0, -39.0, -38.0, -25.0, -34.0, -31.0, -64.0, -64.0, -40.0, -44.0, -9.0, -64.0, -24.0, -8.0, -43.0, -21.0, -41.0, -39.0, -64.0, -64.0, -41.0, -22.0, -45.0, -9.0, -30.0, -34.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3550321849078917, "mean_inference_ms": 18.68280175723749, "mean_action_processing_ms": 0.8153502244790153, "mean_env_wait_ms": 0.4778171830637817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5496213436126709, "StateBufferConnector_ms": 0.006970405578613281, "ViewRequirementAgentConnector_ms": 0.26345062255859375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9417164238786717, "num_agent_steps_trained_throughput_per_sec": 2.9417164238786717, "timesteps_total": 51712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51712, "timers": {"training_iteration_time_ms": 155080.056, "sample_time_ms": 10874.826, "load_time_ms": 0.461, "load_throughput": 1111476.449, "learn_time_ms": 144204.181, "learn_throughput": 3.551, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "done": false, "episodes_total": 3232, "training_iteration": 101, "trial_id": "6f959_00019", "date": "2024-02-28_19-35-28", "timestamp": 1709145328, "time_this_iter_s": 174.05837845802307, "time_total_s": 16030.212651729584, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16030.212651729584, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 56.998387096774195, "ram_util_percent": 17.52540322580645}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"reward_total_mean": -41.91, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.172578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.172578125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9220150161534548, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.875663542747498, "policy_loss": 0.016913095586157095, "vf_loss": 9.745389250914256, "vf_explained_var": -9.457270304361979e-07, "kl": 0.0, "entropy": 94.10190442403157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.91, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.91, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.172578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.172578125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-12.0, -40.0, -40.0, -64.0, -64.0, -64.0, 5.0, -36.0, -41.0, -32.0, -16.0, -18.0, -64.0, -42.0, -64.0, -64.0, -34.0, -63.0, -64.0, -35.0, -40.0, -43.0, -64.0, -42.0, -6.0, -28.0, -35.0, -64.0, -64.0, -64.0, -64.0, -64.0, -32.0, -64.0, -64.0, -40.0, -37.0, -64.0, -23.0, -17.0, -36.0, -38.0, -39.0, -38.0, -25.0, -34.0, -31.0, -64.0, -64.0, -40.0, -44.0, -9.0, -64.0, -24.0, -8.0, -43.0, -21.0, -41.0, -39.0, -64.0, -64.0, -41.0, -22.0, -45.0, -9.0, -30.0, -34.0, -43.0, -63.0, -64.0, -63.0, -45.0, -41.0, -22.0, -63.0, -64.0, -37.0, -38.0, -44.0, -21.0, -38.0, -18.0, -41.0, -64.0, -64.0, -62.0, -9.0, -24.0, -10.0, -42.0, -32.0, -21.0, -64.0, -14.0, -64.0, -41.0, -64.0, -34.0, -31.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355570301938835, "mean_inference_ms": 18.685847162883917, "mean_action_processing_ms": 0.8155803709062448, "mean_env_wait_ms": 0.4779530153200916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5889692306518555, "StateBufferConnector_ms": 0.007224321365356445, "ViewRequirementAgentConnector_ms": 0.2747385501861572}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.91, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -40.0, -40.0, -64.0, -64.0, -64.0, 5.0, -36.0, -41.0, -32.0, -16.0, -18.0, -64.0, -42.0, -64.0, -64.0, -34.0, -63.0, -64.0, -35.0, -40.0, -43.0, -64.0, -42.0, -6.0, -28.0, -35.0, -64.0, -64.0, -64.0, -64.0, -64.0, -32.0, -64.0, -64.0, -40.0, -37.0, -64.0, -23.0, -17.0, -36.0, -38.0, -39.0, -38.0, -25.0, -34.0, -31.0, -64.0, -64.0, -40.0, -44.0, -9.0, -64.0, -24.0, -8.0, -43.0, -21.0, -41.0, -39.0, -64.0, -64.0, -41.0, -22.0, -45.0, -9.0, -30.0, -34.0, -43.0, -63.0, -64.0, -63.0, -45.0, -41.0, -22.0, -63.0, -64.0, -37.0, -38.0, -44.0, -21.0, -38.0, -18.0, -41.0, -64.0, -64.0, -62.0, -9.0, -24.0, -10.0, -42.0, -32.0, -21.0, -64.0, -14.0, -64.0, -41.0, -64.0, -34.0, -31.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355570301938835, "mean_inference_ms": 18.685847162883917, "mean_action_processing_ms": 0.8155803709062448, "mean_env_wait_ms": 0.4779530153200916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5889692306518555, "StateBufferConnector_ms": 0.007224321365356445, "ViewRequirementAgentConnector_ms": 0.2747385501861572}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.904707752442816, "num_agent_steps_trained_throughput_per_sec": 2.904707752442816, "timesteps_total": 52224, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 157661.929, "sample_time_ms": 11064.329, "load_time_ms": 0.487, "load_throughput": 1051502.545, "learn_time_ms": 146596.529, "learn_throughput": 3.493, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "episodes_total": 3264, "training_iteration": 102, "trial_id": "6f959_00019", "date": "2024-02-28_19-38-24", "timestamp": 1709145504, "time_this_iter_s": 176.27643013000488, "time_total_s": 16206.489081859589, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16206.489081859589, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 57.0064, "ram_util_percent": 17.562}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.7, "reward_total_min": -64, "reward_total_max": -5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4609375, "reward_score_mean": 0.17421875, "reward_score_min": 0.0, "reward_score_max": 0.4609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9290853715501726, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.009354611237844, "policy_loss": -0.01430781176313758, "vf_loss": 9.926806743939718, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 98.7853239695231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "sampler_results": {"episode_reward_max": -5.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.7, "reward_total_min": -64, "reward_total_max": -5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4609375, "reward_score_mean": 0.17421875, "reward_score_min": 0.0, "reward_score_max": 0.4609375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-32.0, -64.0, -64.0, -40.0, -37.0, -64.0, -23.0, -17.0, -36.0, -38.0, -39.0, -38.0, -25.0, -34.0, -31.0, -64.0, -64.0, -40.0, -44.0, -9.0, -64.0, -24.0, -8.0, -43.0, -21.0, -41.0, -39.0, -64.0, -64.0, -41.0, -22.0, -45.0, -9.0, -30.0, -34.0, -43.0, -63.0, -64.0, -63.0, -45.0, -41.0, -22.0, -63.0, -64.0, -37.0, -38.0, -44.0, -21.0, -38.0, -18.0, -41.0, -64.0, -64.0, -62.0, -9.0, -24.0, -10.0, -42.0, -32.0, -21.0, -64.0, -14.0, -64.0, -41.0, -64.0, -34.0, -31.0, -64.0, -42.0, -64.0, -43.0, -39.0, -26.0, -11.0, -64.0, -35.0, -63.0, -64.0, -36.0, -28.0, -64.0, -11.0, -20.0, -64.0, -5.0, -13.0, -64.0, -45.0, -64.0, -64.0, -64.0, -64.0, -63.0, -40.0, -15.0, -64.0, -27.0, -64.0, -43.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3577819769946977, "mean_inference_ms": 18.700751409273145, "mean_action_processing_ms": 0.8164243198554115, "mean_env_wait_ms": 0.47843038337068605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6464071273803711, "StateBufferConnector_ms": 0.00764775276184082, "ViewRequirementAgentConnector_ms": 0.29222774505615234}}, "episode_reward_max": -5.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.0, -64.0, -64.0, -40.0, -37.0, -64.0, -23.0, -17.0, -36.0, -38.0, -39.0, -38.0, -25.0, -34.0, -31.0, -64.0, -64.0, -40.0, -44.0, -9.0, -64.0, -24.0, -8.0, -43.0, -21.0, -41.0, -39.0, -64.0, -64.0, -41.0, -22.0, -45.0, -9.0, -30.0, -34.0, -43.0, -63.0, -64.0, -63.0, -45.0, -41.0, -22.0, -63.0, -64.0, -37.0, -38.0, -44.0, -21.0, -38.0, -18.0, -41.0, -64.0, -64.0, -62.0, -9.0, -24.0, -10.0, -42.0, -32.0, -21.0, -64.0, -14.0, -64.0, -41.0, -64.0, -34.0, -31.0, -64.0, -42.0, -64.0, -43.0, -39.0, -26.0, -11.0, -64.0, -35.0, -63.0, -64.0, -36.0, -28.0, -64.0, -11.0, -20.0, -64.0, -5.0, -13.0, -64.0, -45.0, -64.0, -64.0, -64.0, -64.0, -63.0, -40.0, -15.0, -64.0, -27.0, -64.0, -43.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3577819769946977, "mean_inference_ms": 18.700751409273145, "mean_action_processing_ms": 0.8164243198554115, "mean_env_wait_ms": 0.47843038337068605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6464071273803711, "StateBufferConnector_ms": 0.00764775276184082, "ViewRequirementAgentConnector_ms": 0.29222774505615234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0611326617204173, "num_agent_steps_trained_throughput_per_sec": 3.0611326617204173, "timesteps_total": 52736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52736, "timers": {"training_iteration_time_ms": 159230.677, "sample_time_ms": 11385.978, "load_time_ms": 0.495, "load_throughput": 1035081.529, "learn_time_ms": 147843.598, "learn_throughput": 3.463, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "done": false, "episodes_total": 3296, "training_iteration": 103, "trial_id": "6f959_00019", "date": "2024-02-28_19-41-13", "timestamp": 1709145673, "time_this_iter_s": 167.26903319358826, "time_total_s": 16373.758115053177, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16373.758115053177, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 56.92510460251045, "ram_util_percent": 17.56527196652719}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.01, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.156171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.156171875, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8135402014915598, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.02988840341568, "policy_loss": 0.026727303682127966, "vf_loss": 9.904253542423248, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 99.7277104695638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "sampler_results": {"episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.01, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.01, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.156171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.156171875, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-9.0, -30.0, -34.0, -43.0, -63.0, -64.0, -63.0, -45.0, -41.0, -22.0, -63.0, -64.0, -37.0, -38.0, -44.0, -21.0, -38.0, -18.0, -41.0, -64.0, -64.0, -62.0, -9.0, -24.0, -10.0, -42.0, -32.0, -21.0, -64.0, -14.0, -64.0, -41.0, -64.0, -34.0, -31.0, -64.0, -42.0, -64.0, -43.0, -39.0, -26.0, -11.0, -64.0, -35.0, -63.0, -64.0, -36.0, -28.0, -64.0, -11.0, -20.0, -64.0, -5.0, -13.0, -64.0, -45.0, -64.0, -64.0, -64.0, -64.0, -63.0, -40.0, -15.0, -64.0, -27.0, -64.0, -43.0, -36.0, -64.0, -18.0, -64.0, -64.0, -33.0, -63.0, -17.0, -64.0, -57.0, -44.0, -63.0, -64.0, -64.0, -64.0, -51.0, -64.0, -39.0, -1.0, -64.0, -64.0, -64.0, -35.0, -8.0, -17.0, -46.0, 9.0, -64.0, -29.0, -63.0, -39.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359668428893546, "mean_inference_ms": 18.714211427715032, "mean_action_processing_ms": 0.8171771822279831, "mean_env_wait_ms": 0.4788609188636873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6317481994628906, "StateBufferConnector_ms": 0.007560253143310547, "ViewRequirementAgentConnector_ms": 0.2872769832611084}}, "episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.01, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.0, -30.0, -34.0, -43.0, -63.0, -64.0, -63.0, -45.0, -41.0, -22.0, -63.0, -64.0, -37.0, -38.0, -44.0, -21.0, -38.0, -18.0, -41.0, -64.0, -64.0, -62.0, -9.0, -24.0, -10.0, -42.0, -32.0, -21.0, -64.0, -14.0, -64.0, -41.0, -64.0, -34.0, -31.0, -64.0, -42.0, -64.0, -43.0, -39.0, -26.0, -11.0, -64.0, -35.0, -63.0, -64.0, -36.0, -28.0, -64.0, -11.0, -20.0, -64.0, -5.0, -13.0, -64.0, -45.0, -64.0, -64.0, -64.0, -64.0, -63.0, -40.0, -15.0, -64.0, -27.0, -64.0, -43.0, -36.0, -64.0, -18.0, -64.0, -64.0, -33.0, -63.0, -17.0, -64.0, -57.0, -44.0, -63.0, -64.0, -64.0, -64.0, -51.0, -64.0, -39.0, -1.0, -64.0, -64.0, -64.0, -35.0, -8.0, -17.0, -46.0, 9.0, -64.0, -29.0, -63.0, -39.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359668428893546, "mean_inference_ms": 18.714211427715032, "mean_action_processing_ms": 0.8171771822279831, "mean_env_wait_ms": 0.4788609188636873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6317481994628906, "StateBufferConnector_ms": 0.007560253143310547, "ViewRequirementAgentConnector_ms": 0.2872769832611084}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.222387327918986, "num_agent_steps_trained_throughput_per_sec": 3.222387327918986, "timesteps_total": 53248, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 159755.954, "sample_time_ms": 11342.902, "load_time_ms": 0.465, "load_throughput": 1100088.954, "learn_time_ms": 148411.962, "learn_throughput": 3.45, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "episodes_total": 3328, "training_iteration": 104, "trial_id": "6f959_00019", "date": "2024-02-28_19-43-52", "timestamp": 1709145832, "time_this_iter_s": 158.89914441108704, "time_total_s": 16532.657259464264, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16532.657259464264, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 56.704424778761066, "ram_util_percent": 17.889380530973455}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.15, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.139453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.139453125, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9093034503050148, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.928768448034923, "policy_loss": 0.01850885177652041, "vf_loss": 9.802053833007813, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 103.30916398366293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.15, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.139453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.139453125, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -34.0, -31.0, -64.0, -42.0, -64.0, -43.0, -39.0, -26.0, -11.0, -64.0, -35.0, -63.0, -64.0, -36.0, -28.0, -64.0, -11.0, -20.0, -64.0, -5.0, -13.0, -64.0, -45.0, -64.0, -64.0, -64.0, -64.0, -63.0, -40.0, -15.0, -64.0, -27.0, -64.0, -43.0, -36.0, -64.0, -18.0, -64.0, -64.0, -33.0, -63.0, -17.0, -64.0, -57.0, -44.0, -63.0, -64.0, -64.0, -64.0, -51.0, -64.0, -39.0, -1.0, -64.0, -64.0, -64.0, -35.0, -8.0, -17.0, -46.0, 9.0, -64.0, -29.0, -63.0, -39.0, -64.0, -64.0, -20.0, -64.0, -39.0, -37.0, -64.0, -64.0, -40.0, -44.0, -26.0, -20.0, -30.0, -41.0, -35.0, -64.0, -31.0, -38.0, -42.0, -64.0, -28.0, -64.0, -64.0, -46.0, -64.0, -64.0, -40.0, -39.0, -42.0, -64.0, -34.0, -64.0, -63.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.36102344806441, "mean_inference_ms": 18.724044516227913, "mean_action_processing_ms": 0.8177204937905442, "mean_env_wait_ms": 0.47918989679853674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6245737075805664, "StateBufferConnector_ms": 0.00751948356628418, "ViewRequirementAgentConnector_ms": 0.28523993492126465}}, "episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -34.0, -31.0, -64.0, -42.0, -64.0, -43.0, -39.0, -26.0, -11.0, -64.0, -35.0, -63.0, -64.0, -36.0, -28.0, -64.0, -11.0, -20.0, -64.0, -5.0, -13.0, -64.0, -45.0, -64.0, -64.0, -64.0, -64.0, -63.0, -40.0, -15.0, -64.0, -27.0, -64.0, -43.0, -36.0, -64.0, -18.0, -64.0, -64.0, -33.0, -63.0, -17.0, -64.0, -57.0, -44.0, -63.0, -64.0, -64.0, -64.0, -51.0, -64.0, -39.0, -1.0, -64.0, -64.0, -64.0, -35.0, -8.0, -17.0, -46.0, 9.0, -64.0, -29.0, -63.0, -39.0, -64.0, -64.0, -20.0, -64.0, -39.0, -37.0, -64.0, -64.0, -40.0, -44.0, -26.0, -20.0, -30.0, -41.0, -35.0, -64.0, -31.0, -38.0, -42.0, -64.0, -28.0, -64.0, -64.0, -46.0, -64.0, -64.0, -40.0, -39.0, -42.0, -64.0, -34.0, -64.0, -63.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.36102344806441, "mean_inference_ms": 18.724044516227913, "mean_action_processing_ms": 0.8177204937905442, "mean_env_wait_ms": 0.47918989679853674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6245737075805664, "StateBufferConnector_ms": 0.00751948356628418, "ViewRequirementAgentConnector_ms": 0.28523993492126465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2633816484907587, "num_agent_steps_trained_throughput_per_sec": 3.2633816484907587, "timesteps_total": 53760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 160321.908, "sample_time_ms": 11464.634, "load_time_ms": 0.47, "load_throughput": 1090203.903, "learn_time_ms": 148856.176, "learn_throughput": 3.44, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 3360, "training_iteration": 105, "trial_id": "6f959_00019", "date": "2024-02-28_19-46-29", "timestamp": 1709145989, "time_this_iter_s": 156.90281510353088, "time_total_s": 16689.560074567795, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16689.560074567795, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 57.34843049327355, "ram_util_percent": 17.757847533632294}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.31, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.153828125, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8872950514778495, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.949929213523864, "policy_loss": -0.006579592707566917, "vf_loss": 9.852931984265645, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 88.94740626017253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "sampler_results": {"episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.31, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.31, "reward_total_min": -64, "reward_total_max": 9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5703125, "reward_score_mean": 0.153828125, "reward_score_min": 0.0, "reward_score_max": 0.5703125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-27.0, -64.0, -43.0, -36.0, -64.0, -18.0, -64.0, -64.0, -33.0, -63.0, -17.0, -64.0, -57.0, -44.0, -63.0, -64.0, -64.0, -64.0, -51.0, -64.0, -39.0, -1.0, -64.0, -64.0, -64.0, -35.0, -8.0, -17.0, -46.0, 9.0, -64.0, -29.0, -63.0, -39.0, -64.0, -64.0, -20.0, -64.0, -39.0, -37.0, -64.0, -64.0, -40.0, -44.0, -26.0, -20.0, -30.0, -41.0, -35.0, -64.0, -31.0, -38.0, -42.0, -64.0, -28.0, -64.0, -64.0, -46.0, -64.0, -64.0, -40.0, -39.0, -42.0, -64.0, -34.0, -64.0, -63.0, -64.0, -28.0, -35.0, -39.0, -28.0, -64.0, -29.0, -33.0, -64.0, -41.0, -34.0, -27.0, -64.0, -36.0, -30.0, -64.0, -23.0, -64.0, -38.0, -64.0, -64.0, -40.0, -20.0, -40.0, -64.0, -36.0, -20.0, -28.0, -12.0, -46.0, -27.0, -42.0, -4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3603020571777993, "mean_inference_ms": 18.719001552579524, "mean_action_processing_ms": 0.8174883730758704, "mean_env_wait_ms": 0.4790772678643229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5473206043243408, "StateBufferConnector_ms": 0.006880044937133789, "ViewRequirementAgentConnector_ms": 0.2586863040924072}}, "episode_reward_max": 9.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.31, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.0, -64.0, -43.0, -36.0, -64.0, -18.0, -64.0, -64.0, -33.0, -63.0, -17.0, -64.0, -57.0, -44.0, -63.0, -64.0, -64.0, -64.0, -51.0, -64.0, -39.0, -1.0, -64.0, -64.0, -64.0, -35.0, -8.0, -17.0, -46.0, 9.0, -64.0, -29.0, -63.0, -39.0, -64.0, -64.0, -20.0, -64.0, -39.0, -37.0, -64.0, -64.0, -40.0, -44.0, -26.0, -20.0, -30.0, -41.0, -35.0, -64.0, -31.0, -38.0, -42.0, -64.0, -28.0, -64.0, -64.0, -46.0, -64.0, -64.0, -40.0, -39.0, -42.0, -64.0, -34.0, -64.0, -63.0, -64.0, -28.0, -35.0, -39.0, -28.0, -64.0, -29.0, -33.0, -64.0, -41.0, -34.0, -27.0, -64.0, -36.0, -30.0, -64.0, -23.0, -64.0, -38.0, -64.0, -64.0, -40.0, -20.0, -40.0, -64.0, -36.0, -20.0, -28.0, -12.0, -46.0, -27.0, -42.0, -4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3603020571777993, "mean_inference_ms": 18.719001552579524, "mean_action_processing_ms": 0.8174883730758704, "mean_env_wait_ms": 0.4790772678643229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5473206043243408, "StateBufferConnector_ms": 0.006880044937133789, "ViewRequirementAgentConnector_ms": 0.2586863040924072}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3766863028563336, "num_agent_steps_trained_throughput_per_sec": 3.3766863028563336, "timesteps_total": 54272, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 160155.428, "sample_time_ms": 11443.133, "load_time_ms": 0.442, "load_throughput": 1159360.605, "learn_time_ms": 148711.239, "learn_throughput": 3.443, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "episodes_total": 3392, "training_iteration": 106, "trial_id": "6f959_00019", "date": "2024-02-28_19-49-00", "timestamp": 1709146140, "time_this_iter_s": 151.63851952552795, "time_total_s": 16841.198594093323, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16841.198594093323, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 57.10370370370371, "ram_util_percent": 17.922222222222224}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -43.21, "reward_total_min": -64, "reward_total_max": -4, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.162421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.46875, "reward_score_mean": 0.162421875, "reward_score_min": 0.0, "reward_score_max": 0.46875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9256102435290814, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.043775196870168, "policy_loss": -0.019989576074294746, "vf_loss": 9.970922640959422, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 98.68164990743001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.21, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -43.21, "reward_total_min": -64, "reward_total_max": -4, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.162421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.46875, "reward_score_mean": 0.162421875, "reward_score_min": 0.0, "reward_score_max": 0.46875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-63.0, -39.0, -64.0, -64.0, -20.0, -64.0, -39.0, -37.0, -64.0, -64.0, -40.0, -44.0, -26.0, -20.0, -30.0, -41.0, -35.0, -64.0, -31.0, -38.0, -42.0, -64.0, -28.0, -64.0, -64.0, -46.0, -64.0, -64.0, -40.0, -39.0, -42.0, -64.0, -34.0, -64.0, -63.0, -64.0, -28.0, -35.0, -39.0, -28.0, -64.0, -29.0, -33.0, -64.0, -41.0, -34.0, -27.0, -64.0, -36.0, -30.0, -64.0, -23.0, -64.0, -38.0, -64.0, -64.0, -40.0, -20.0, -40.0, -64.0, -36.0, -20.0, -28.0, -12.0, -46.0, -27.0, -42.0, -4.0, -64.0, -22.0, -64.0, -13.0, -17.0, -25.0, -64.0, -44.0, -43.0, -38.0, -27.0, -11.0, -27.0, -30.0, -64.0, -64.0, -64.0, -37.0, -33.0, -63.0, -38.0, -40.0, -30.0, -25.0, -64.0, -64.0, -64.0, -35.0, -41.0, -31.0, -30.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.35945682233347, "mean_inference_ms": 18.712443837559146, "mean_action_processing_ms": 0.8171602809083521, "mean_env_wait_ms": 0.4789272108391839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5456490516662598, "StateBufferConnector_ms": 0.0068666934967041016, "ViewRequirementAgentConnector_ms": 0.25686144828796387}}, "episode_reward_max": -4.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.21, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.0, -39.0, -64.0, -64.0, -20.0, -64.0, -39.0, -37.0, -64.0, -64.0, -40.0, -44.0, -26.0, -20.0, -30.0, -41.0, -35.0, -64.0, -31.0, -38.0, -42.0, -64.0, -28.0, -64.0, -64.0, -46.0, -64.0, -64.0, -40.0, -39.0, -42.0, -64.0, -34.0, -64.0, -63.0, -64.0, -28.0, -35.0, -39.0, -28.0, -64.0, -29.0, -33.0, -64.0, -41.0, -34.0, -27.0, -64.0, -36.0, -30.0, -64.0, -23.0, -64.0, -38.0, -64.0, -64.0, -40.0, -20.0, -40.0, -64.0, -36.0, -20.0, -28.0, -12.0, -46.0, -27.0, -42.0, -4.0, -64.0, -22.0, -64.0, -13.0, -17.0, -25.0, -64.0, -44.0, -43.0, -38.0, -27.0, -11.0, -27.0, -30.0, -64.0, -64.0, -64.0, -37.0, -33.0, -63.0, -38.0, -40.0, -30.0, -25.0, -64.0, -64.0, -64.0, -35.0, -41.0, -31.0, -30.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.35945682233347, "mean_inference_ms": 18.712443837559146, "mean_action_processing_ms": 0.8171602809083521, "mean_env_wait_ms": 0.4789272108391839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5456490516662598, "StateBufferConnector_ms": 0.0068666934967041016, "ViewRequirementAgentConnector_ms": 0.25686144828796387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4252642849174744, "num_agent_steps_trained_throughput_per_sec": 3.4252642849174744, "timesteps_total": 54784, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54784, "timers": {"training_iteration_time_ms": 159858.336, "sample_time_ms": 11431.286, "load_time_ms": 0.44, "load_throughput": 1164578.985, "learn_time_ms": 148426.009, "learn_throughput": 3.45, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "done": false, "episodes_total": 3424, "training_iteration": 107, "trial_id": "6f959_00019", "date": "2024-02-28_19-51-30", "timestamp": 1709146290, "time_this_iter_s": 149.48805570602417, "time_total_s": 16990.686649799347, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16990.686649799347, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.35283018867924, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.18, "reward_total_min": -64, "reward_total_max": -4, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.46875, "reward_score_mean": 0.17046875, "reward_score_min": 0.0, "reward_score_max": 0.46875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9981887181599934, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.014473688602447, "policy_loss": 0.017739975793908038, "vf_loss": 9.897182734807332, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 106.86765314737956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.18, "reward_total_min": -64, "reward_total_max": -4, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.46875, "reward_score_mean": 0.17046875, "reward_score_min": 0.0, "reward_score_max": 0.46875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-34.0, -64.0, -63.0, -64.0, -28.0, -35.0, -39.0, -28.0, -64.0, -29.0, -33.0, -64.0, -41.0, -34.0, -27.0, -64.0, -36.0, -30.0, -64.0, -23.0, -64.0, -38.0, -64.0, -64.0, -40.0, -20.0, -40.0, -64.0, -36.0, -20.0, -28.0, -12.0, -46.0, -27.0, -42.0, -4.0, -64.0, -22.0, -64.0, -13.0, -17.0, -25.0, -64.0, -44.0, -43.0, -38.0, -27.0, -11.0, -27.0, -30.0, -64.0, -64.0, -64.0, -37.0, -33.0, -63.0, -38.0, -40.0, -30.0, -25.0, -64.0, -64.0, -64.0, -35.0, -41.0, -31.0, -30.0, -64.0, -19.0, -37.0, -29.0, -29.0, -38.0, -32.0, -63.0, -64.0, -64.0, -64.0, -32.0, -28.0, -64.0, -33.0, -26.0, -31.0, -28.0, -33.0, -41.0, -64.0, -64.0, -25.0, -64.0, -64.0, -64.0, -64.0, -16.0, -37.0, -31.0, -64.0, -29.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3587509654091336, "mean_inference_ms": 18.706778110442908, "mean_action_processing_ms": 0.8168801638362327, "mean_env_wait_ms": 0.4788021720602589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5504100322723389, "StateBufferConnector_ms": 0.006905317306518555, "ViewRequirementAgentConnector_ms": 0.25742387771606445}}, "episode_reward_max": -4.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -64.0, -63.0, -64.0, -28.0, -35.0, -39.0, -28.0, -64.0, -29.0, -33.0, -64.0, -41.0, -34.0, -27.0, -64.0, -36.0, -30.0, -64.0, -23.0, -64.0, -38.0, -64.0, -64.0, -40.0, -20.0, -40.0, -64.0, -36.0, -20.0, -28.0, -12.0, -46.0, -27.0, -42.0, -4.0, -64.0, -22.0, -64.0, -13.0, -17.0, -25.0, -64.0, -44.0, -43.0, -38.0, -27.0, -11.0, -27.0, -30.0, -64.0, -64.0, -64.0, -37.0, -33.0, -63.0, -38.0, -40.0, -30.0, -25.0, -64.0, -64.0, -64.0, -35.0, -41.0, -31.0, -30.0, -64.0, -19.0, -37.0, -29.0, -29.0, -38.0, -32.0, -63.0, -64.0, -64.0, -64.0, -32.0, -28.0, -64.0, -33.0, -26.0, -31.0, -28.0, -33.0, -41.0, -64.0, -64.0, -25.0, -64.0, -64.0, -64.0, -64.0, -16.0, -37.0, -31.0, -64.0, -29.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3587509654091336, "mean_inference_ms": 18.706778110442908, "mean_action_processing_ms": 0.8168801638362327, "mean_env_wait_ms": 0.4788021720602589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5504100322723389, "StateBufferConnector_ms": 0.006905317306518555, "ViewRequirementAgentConnector_ms": 0.25742387771606445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3748781742208513, "num_agent_steps_trained_throughput_per_sec": 3.3748781742208513, "timesteps_total": 55296, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 160048.214, "sample_time_ms": 11572.987, "load_time_ms": 0.444, "load_throughput": 1153816.703, "learn_time_ms": 148474.184, "learn_throughput": 3.448, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "episodes_total": 3456, "training_iteration": 108, "trial_id": "6f959_00019", "date": "2024-02-28_19-54-02", "timestamp": 1709146442, "time_this_iter_s": 151.71959948539734, "time_total_s": 17142.406249284744, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17142.406249284744, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 57.35370370370371, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.09, "reward_total_min": -64, "reward_total_max": -4, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155546875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.46875, "reward_score_mean": 0.155546875, "reward_score_min": 0.0, "reward_score_max": 0.46875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9096063616375129, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.057335007190705, "policy_loss": 0.1098835999922206, "vf_loss": 9.84296792348226, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 111.7909932454427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.09, "reward_total_min": -64, "reward_total_max": -4, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155546875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.46875, "reward_score_mean": 0.155546875, "reward_score_min": 0.0, "reward_score_max": 0.46875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -27.0, -42.0, -4.0, -64.0, -22.0, -64.0, -13.0, -17.0, -25.0, -64.0, -44.0, -43.0, -38.0, -27.0, -11.0, -27.0, -30.0, -64.0, -64.0, -64.0, -37.0, -33.0, -63.0, -38.0, -40.0, -30.0, -25.0, -64.0, -64.0, -64.0, -35.0, -41.0, -31.0, -30.0, -64.0, -19.0, -37.0, -29.0, -29.0, -38.0, -32.0, -63.0, -64.0, -64.0, -64.0, -32.0, -28.0, -64.0, -33.0, -26.0, -31.0, -28.0, -33.0, -41.0, -64.0, -64.0, -25.0, -64.0, -64.0, -64.0, -64.0, -16.0, -37.0, -31.0, -64.0, -29.0, -64.0, -64.0, -64.0, -31.0, -63.0, -64.0, -64.0, -31.0, -64.0, -40.0, -64.0, -64.0, -64.0, -40.0, -34.0, -64.0, -30.0, -30.0, -64.0, -17.0, -64.0, -32.0, -38.0, -64.0, -64.0, -17.0, -40.0, -40.0, -64.0, -37.0, -64.0, -41.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3581183978999234, "mean_inference_ms": 18.702586373900687, "mean_action_processing_ms": 0.8167006326545652, "mean_env_wait_ms": 0.4787191140896782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5558044910430908, "StateBufferConnector_ms": 0.006988048553466797, "ViewRequirementAgentConnector_ms": 0.26311802864074707}}, "episode_reward_max": -4.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -27.0, -42.0, -4.0, -64.0, -22.0, -64.0, -13.0, -17.0, -25.0, -64.0, -44.0, -43.0, -38.0, -27.0, -11.0, -27.0, -30.0, -64.0, -64.0, -64.0, -37.0, -33.0, -63.0, -38.0, -40.0, -30.0, -25.0, -64.0, -64.0, -64.0, -35.0, -41.0, -31.0, -30.0, -64.0, -19.0, -37.0, -29.0, -29.0, -38.0, -32.0, -63.0, -64.0, -64.0, -64.0, -32.0, -28.0, -64.0, -33.0, -26.0, -31.0, -28.0, -33.0, -41.0, -64.0, -64.0, -25.0, -64.0, -64.0, -64.0, -64.0, -16.0, -37.0, -31.0, -64.0, -29.0, -64.0, -64.0, -64.0, -31.0, -63.0, -64.0, -64.0, -31.0, -64.0, -40.0, -64.0, -64.0, -64.0, -40.0, -34.0, -64.0, -30.0, -30.0, -64.0, -17.0, -64.0, -32.0, -38.0, -64.0, -64.0, -17.0, -40.0, -40.0, -64.0, -37.0, -64.0, -41.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3581183978999234, "mean_inference_ms": 18.702586373900687, "mean_action_processing_ms": 0.8167006326545652, "mean_env_wait_ms": 0.4787191140896782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5558044910430908, "StateBufferConnector_ms": 0.006988048553466797, "ViewRequirementAgentConnector_ms": 0.26311802864074707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.346773237506909, "num_agent_steps_trained_throughput_per_sec": 3.346773237506909, "timesteps_total": 55808, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55808, "timers": {"training_iteration_time_ms": 160278.768, "sample_time_ms": 11570.275, "load_time_ms": 0.43, "load_throughput": 1189609.821, "learn_time_ms": 148707.466, "learn_throughput": 3.443, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "done": false, "episodes_total": 3488, "training_iteration": 109, "trial_id": "6f959_00019", "date": "2024-02-28_19-56-35", "timestamp": 1709146595, "time_this_iter_s": 152.99355792999268, "time_total_s": 17295.399807214737, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17295.399807214737, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 57.30783410138248, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.86, "reward_total_min": -64, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.14171875, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9679831591745217, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.085179313023884, "policy_loss": 0.02409049584530294, "vf_loss": 9.967978954315186, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 108.49842993418376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.86, "reward_total_min": -64, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14171875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.14171875, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -31.0, -30.0, -64.0, -19.0, -37.0, -29.0, -29.0, -38.0, -32.0, -63.0, -64.0, -64.0, -64.0, -32.0, -28.0, -64.0, -33.0, -26.0, -31.0, -28.0, -33.0, -41.0, -64.0, -64.0, -25.0, -64.0, -64.0, -64.0, -64.0, -16.0, -37.0, -31.0, -64.0, -29.0, -64.0, -64.0, -64.0, -31.0, -63.0, -64.0, -64.0, -31.0, -64.0, -40.0, -64.0, -64.0, -64.0, -40.0, -34.0, -64.0, -30.0, -30.0, -64.0, -17.0, -64.0, -32.0, -38.0, -64.0, -64.0, -17.0, -40.0, -40.0, -64.0, -37.0, -64.0, -41.0, -24.0, -19.0, -64.0, -64.0, -64.0, -64.0, -30.0, -36.0, -29.0, -26.0, -64.0, -64.0, -41.0, -64.0, -34.0, -64.0, -19.0, -28.0, -64.0, -42.0, -16.0, -34.0, -64.0, -64.0, -64.0, -42.0, -64.0, -64.0, -21.0, -38.0, -46.0, -34.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3572757750266415, "mean_inference_ms": 18.69817931383494, "mean_action_processing_ms": 0.8165264122770176, "mean_env_wait_ms": 0.478609945199535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5450382232666016, "StateBufferConnector_ms": 0.006894111633300781, "ViewRequirementAgentConnector_ms": 0.2624197006225586}}, "episode_reward_max": -16.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -31.0, -30.0, -64.0, -19.0, -37.0, -29.0, -29.0, -38.0, -32.0, -63.0, -64.0, -64.0, -64.0, -32.0, -28.0, -64.0, -33.0, -26.0, -31.0, -28.0, -33.0, -41.0, -64.0, -64.0, -25.0, -64.0, -64.0, -64.0, -64.0, -16.0, -37.0, -31.0, -64.0, -29.0, -64.0, -64.0, -64.0, -31.0, -63.0, -64.0, -64.0, -31.0, -64.0, -40.0, -64.0, -64.0, -64.0, -40.0, -34.0, -64.0, -30.0, -30.0, -64.0, -17.0, -64.0, -32.0, -38.0, -64.0, -64.0, -17.0, -40.0, -40.0, -64.0, -37.0, -64.0, -41.0, -24.0, -19.0, -64.0, -64.0, -64.0, -64.0, -30.0, -36.0, -29.0, -26.0, -64.0, -64.0, -41.0, -64.0, -34.0, -64.0, -19.0, -28.0, -64.0, -42.0, -16.0, -34.0, -64.0, -64.0, -64.0, -42.0, -64.0, -64.0, -21.0, -38.0, -46.0, -34.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3572757750266415, "mean_inference_ms": 18.69817931383494, "mean_action_processing_ms": 0.8165264122770176, "mean_env_wait_ms": 0.478609945199535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5450382232666016, "StateBufferConnector_ms": 0.006894111633300781, "ViewRequirementAgentConnector_ms": 0.2624197006225586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3552401293337346, "num_agent_steps_trained_throughput_per_sec": 3.3552401293337346, "timesteps_total": 56320, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 159174.74, "sample_time_ms": 11501.169, "load_time_ms": 0.427, "load_throughput": 1197771.012, "learn_time_ms": 147672.556, "learn_throughput": 3.467, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "episodes_total": 3520, "training_iteration": 110, "trial_id": "6f959_00019", "date": "2024-02-28_19-59-08", "timestamp": 1709146748, "time_this_iter_s": 152.60800647735596, "time_total_s": 17448.007813692093, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17448.007813692093, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 57.62811059907834, "ram_util_percent": 17.865437788018433}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -46.85, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.133984375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9623210854828358, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.07997496922811, "policy_loss": 0.022917785169556736, "vf_loss": 9.963543728987377, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 96.87935155232748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "sampler_results": {"episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.85, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -46.85, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.133984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.133984375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-31.0, -64.0, -29.0, -64.0, -64.0, -64.0, -31.0, -63.0, -64.0, -64.0, -31.0, -64.0, -40.0, -64.0, -64.0, -64.0, -40.0, -34.0, -64.0, -30.0, -30.0, -64.0, -17.0, -64.0, -32.0, -38.0, -64.0, -64.0, -17.0, -40.0, -40.0, -64.0, -37.0, -64.0, -41.0, -24.0, -19.0, -64.0, -64.0, -64.0, -64.0, -30.0, -36.0, -29.0, -26.0, -64.0, -64.0, -41.0, -64.0, -34.0, -64.0, -19.0, -28.0, -64.0, -42.0, -16.0, -34.0, -64.0, -64.0, -64.0, -42.0, -64.0, -64.0, -21.0, -38.0, -46.0, -34.0, -39.0, -64.0, -33.0, -64.0, -29.0, -64.0, -25.0, -39.0, -32.0, -15.0, -19.0, -64.0, -64.0, -34.0, -31.0, -45.0, -56.0, -64.0, -64.0, -64.0, -50.0, -23.0, -47.0, -41.0, -57.0, -38.0, -64.0, -30.0, -38.0, -64.0, -64.0, -32.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3557910360872127, "mean_inference_ms": 18.68961008550119, "mean_action_processing_ms": 0.8161597726282301, "mean_env_wait_ms": 0.47837524611619714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5131747722625732, "StateBufferConnector_ms": 0.006676912307739258, "ViewRequirementAgentConnector_ms": 0.2550508975982666}}, "episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -46.85, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.0, -64.0, -29.0, -64.0, -64.0, -64.0, -31.0, -63.0, -64.0, -64.0, -31.0, -64.0, -40.0, -64.0, -64.0, -64.0, -40.0, -34.0, -64.0, -30.0, -30.0, -64.0, -17.0, -64.0, -32.0, -38.0, -64.0, -64.0, -17.0, -40.0, -40.0, -64.0, -37.0, -64.0, -41.0, -24.0, -19.0, -64.0, -64.0, -64.0, -64.0, -30.0, -36.0, -29.0, -26.0, -64.0, -64.0, -41.0, -64.0, -34.0, -64.0, -19.0, -28.0, -64.0, -42.0, -16.0, -34.0, -64.0, -64.0, -64.0, -42.0, -64.0, -64.0, -21.0, -38.0, -46.0, -34.0, -39.0, -64.0, -33.0, -64.0, -29.0, -64.0, -25.0, -39.0, -32.0, -15.0, -19.0, -64.0, -64.0, -34.0, -31.0, -45.0, -56.0, -64.0, -64.0, -64.0, -50.0, -23.0, -47.0, -41.0, -57.0, -38.0, -64.0, -30.0, -38.0, -64.0, -64.0, -32.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3557910360872127, "mean_inference_ms": 18.68961008550119, "mean_action_processing_ms": 0.8161597726282301, "mean_env_wait_ms": 0.47837524611619714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5131747722625732, "StateBufferConnector_ms": 0.006676912307739258, "ViewRequirementAgentConnector_ms": 0.2550508975982666}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3534734482935065, "num_agent_steps_trained_throughput_per_sec": 3.3534734482935065, "timesteps_total": 56832, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56832, "timers": {"training_iteration_time_ms": 157037.684, "sample_time_ms": 11469.264, "load_time_ms": 0.409, "load_throughput": 1253200.075, "learn_time_ms": 145567.426, "learn_throughput": 3.517, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "done": false, "episodes_total": 3552, "training_iteration": 111, "trial_id": "6f959_00019", "date": "2024-02-28_20-01-40", "timestamp": 1709146900, "time_this_iter_s": 152.69354891777039, "time_total_s": 17600.701362609863, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17600.701362609863, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 56.90414746543779, "ram_util_percent": 17.860829493087557}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.0, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.15625, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9862236102422078, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.073941175142924, "policy_loss": 0.024326441809535027, "vf_loss": 9.955356454849243, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 94.41221345265707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.0, "reward_total_min": -64, "reward_total_max": -1, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4921875, "reward_score_mean": 0.15625, "reward_score_min": 0.0, "reward_score_max": 0.4921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-37.0, -64.0, -41.0, -24.0, -19.0, -64.0, -64.0, -64.0, -64.0, -30.0, -36.0, -29.0, -26.0, -64.0, -64.0, -41.0, -64.0, -34.0, -64.0, -19.0, -28.0, -64.0, -42.0, -16.0, -34.0, -64.0, -64.0, -64.0, -42.0, -64.0, -64.0, -21.0, -38.0, -46.0, -34.0, -39.0, -64.0, -33.0, -64.0, -29.0, -64.0, -25.0, -39.0, -32.0, -15.0, -19.0, -64.0, -64.0, -34.0, -31.0, -45.0, -56.0, -64.0, -64.0, -64.0, -50.0, -23.0, -47.0, -41.0, -57.0, -38.0, -64.0, -30.0, -38.0, -64.0, -64.0, -32.0, -64.0, -1.0, -64.0, -64.0, -16.0, -43.0, -33.0, -15.0, -45.0, -53.0, -64.0, -34.0, -64.0, -16.0, -38.0, -64.0, -29.0, -19.0, -36.0, -34.0, -17.0, -64.0, -21.0, -64.0, -30.0, -15.0, -64.0, -44.0, -64.0, -44.0, -23.0, -37.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354391794429725, "mean_inference_ms": 18.68190415437147, "mean_action_processing_ms": 0.8158426279173124, "mean_env_wait_ms": 0.47817008543657613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5217366218566895, "StateBufferConnector_ms": 0.0067441463470458984, "ViewRequirementAgentConnector_ms": 0.2579011917114258}}, "episode_reward_max": -1.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.0, -64.0, -41.0, -24.0, -19.0, -64.0, -64.0, -64.0, -64.0, -30.0, -36.0, -29.0, -26.0, -64.0, -64.0, -41.0, -64.0, -34.0, -64.0, -19.0, -28.0, -64.0, -42.0, -16.0, -34.0, -64.0, -64.0, -64.0, -42.0, -64.0, -64.0, -21.0, -38.0, -46.0, -34.0, -39.0, -64.0, -33.0, -64.0, -29.0, -64.0, -25.0, -39.0, -32.0, -15.0, -19.0, -64.0, -64.0, -34.0, -31.0, -45.0, -56.0, -64.0, -64.0, -64.0, -50.0, -23.0, -47.0, -41.0, -57.0, -38.0, -64.0, -30.0, -38.0, -64.0, -64.0, -32.0, -64.0, -1.0, -64.0, -64.0, -16.0, -43.0, -33.0, -15.0, -45.0, -53.0, -64.0, -34.0, -64.0, -16.0, -38.0, -64.0, -29.0, -19.0, -36.0, -34.0, -17.0, -64.0, -21.0, -64.0, -30.0, -15.0, -64.0, -44.0, -64.0, -44.0, -23.0, -37.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354391794429725, "mean_inference_ms": 18.68190415437147, "mean_action_processing_ms": 0.8158426279173124, "mean_env_wait_ms": 0.47817008543657613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5217366218566895, "StateBufferConnector_ms": 0.0067441463470458984, "ViewRequirementAgentConnector_ms": 0.2579011917114258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3440608893236305, "num_agent_steps_trained_throughput_per_sec": 3.3440608893236305, "timesteps_total": 57344, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 154721.853, "sample_time_ms": 11335.725, "load_time_ms": 0.383, "load_throughput": 1336413.995, "learn_time_ms": 143385.171, "learn_throughput": 3.571, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "episodes_total": 3584, "training_iteration": 112, "trial_id": "6f959_00019", "date": "2024-02-28_20-04-13", "timestamp": 1709147053, "time_this_iter_s": 153.11813473701477, "time_total_s": 17753.819497346878, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17753.819497346878, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 57.454377880184325, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -43.48, "reward_total_min": -64, "reward_total_max": 2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1603125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.515625, "reward_score_mean": 0.1603125, "reward_score_min": 0.0, "reward_score_max": 0.515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9319583398289979, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.00593330860138, "policy_loss": 0.04237352928612381, "vf_loss": 9.860688626766205, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 100.25447800954183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "sampler_results": {"episode_reward_max": 2.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.48, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -43.48, "reward_total_min": -64, "reward_total_max": 2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1603125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.515625, "reward_score_mean": 0.1603125, "reward_score_min": 0.0, "reward_score_max": 0.515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -46.0, -34.0, -39.0, -64.0, -33.0, -64.0, -29.0, -64.0, -25.0, -39.0, -32.0, -15.0, -19.0, -64.0, -64.0, -34.0, -31.0, -45.0, -56.0, -64.0, -64.0, -64.0, -50.0, -23.0, -47.0, -41.0, -57.0, -38.0, -64.0, -30.0, -38.0, -64.0, -64.0, -32.0, -64.0, -1.0, -64.0, -64.0, -16.0, -43.0, -33.0, -15.0, -45.0, -53.0, -64.0, -34.0, -64.0, -16.0, -38.0, -64.0, -29.0, -19.0, -36.0, -34.0, -17.0, -64.0, -21.0, -64.0, -30.0, -15.0, -64.0, -44.0, -64.0, -44.0, -23.0, -37.0, -63.0, -64.0, -40.0, -43.0, -64.0, -29.0, -24.0, -64.0, -27.0, 2.0, -16.0, -64.0, -24.0, -64.0, -64.0, -33.0, -46.0, -32.0, -64.0, -34.0, -40.0, -31.0, -63.0, -34.0, -63.0, -64.0, -64.0, -31.0, -22.0, -64.0, -64.0, -63.0, -30.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3536810935922055, "mean_inference_ms": 18.678344569482046, "mean_action_processing_ms": 0.8157041595493824, "mean_env_wait_ms": 0.47809103903168393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5411770343780518, "StateBufferConnector_ms": 0.0068933963775634766, "ViewRequirementAgentConnector_ms": 0.26309633255004883}}, "episode_reward_max": 2.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.48, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -46.0, -34.0, -39.0, -64.0, -33.0, -64.0, -29.0, -64.0, -25.0, -39.0, -32.0, -15.0, -19.0, -64.0, -64.0, -34.0, -31.0, -45.0, -56.0, -64.0, -64.0, -64.0, -50.0, -23.0, -47.0, -41.0, -57.0, -38.0, -64.0, -30.0, -38.0, -64.0, -64.0, -32.0, -64.0, -1.0, -64.0, -64.0, -16.0, -43.0, -33.0, -15.0, -45.0, -53.0, -64.0, -34.0, -64.0, -16.0, -38.0, -64.0, -29.0, -19.0, -36.0, -34.0, -17.0, -64.0, -21.0, -64.0, -30.0, -15.0, -64.0, -44.0, -64.0, -44.0, -23.0, -37.0, -63.0, -64.0, -40.0, -43.0, -64.0, -29.0, -24.0, -64.0, -27.0, 2.0, -16.0, -64.0, -24.0, -64.0, -64.0, -33.0, -46.0, -32.0, -64.0, -34.0, -40.0, -31.0, -63.0, -34.0, -63.0, -64.0, -64.0, -31.0, -22.0, -64.0, -64.0, -63.0, -30.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3536810935922055, "mean_inference_ms": 18.678344569482046, "mean_action_processing_ms": 0.8157041595493824, "mean_env_wait_ms": 0.47809103903168393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5411770343780518, "StateBufferConnector_ms": 0.0068933963775634766, "ViewRequirementAgentConnector_ms": 0.26309633255004883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.358540141350653, "num_agent_steps_trained_throughput_per_sec": 3.358540141350653, "timesteps_total": 57856, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57856, "timers": {"training_iteration_time_ms": 153240.74, "sample_time_ms": 11124.703, "load_time_ms": 0.357, "load_throughput": 1434908.224, "learn_time_ms": 142115.138, "learn_throughput": 3.603, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "done": false, "episodes_total": 3616, "training_iteration": 113, "trial_id": "6f959_00019", "date": "2024-02-28_20-06-46", "timestamp": 1709147206, "time_this_iter_s": 152.45774602890015, "time_total_s": 17906.27724337578, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17906.27724337578, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 57.394470046082944, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -43.33, "reward_total_min": -64, "reward_total_max": 2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.161484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.515625, "reward_score_mean": 0.161484375, "reward_score_min": 0.0, "reward_score_max": 0.515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 7.129928604761759, "policy_loss": 0.03413270514768859, "vf_loss": 7.805987250804901, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 85.5051462173462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "sampler_results": {"episode_reward_max": 2.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.33, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -43.33, "reward_total_min": -64, "reward_total_max": 2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.161484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.515625, "reward_score_mean": 0.161484375, "reward_score_min": 0.0, "reward_score_max": 0.515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -32.0, -64.0, -1.0, -64.0, -64.0, -16.0, -43.0, -33.0, -15.0, -45.0, -53.0, -64.0, -34.0, -64.0, -16.0, -38.0, -64.0, -29.0, -19.0, -36.0, -34.0, -17.0, -64.0, -21.0, -64.0, -30.0, -15.0, -64.0, -44.0, -64.0, -44.0, -23.0, -37.0, -63.0, -64.0, -40.0, -43.0, -64.0, -29.0, -24.0, -64.0, -27.0, 2.0, -16.0, -64.0, -24.0, -64.0, -64.0, -33.0, -46.0, -32.0, -64.0, -34.0, -40.0, -31.0, -63.0, -34.0, -63.0, -64.0, -64.0, -31.0, -22.0, -64.0, -64.0, -63.0, -30.0, -32.0, -64.0, -40.0, -36.0, -39.0, -36.0, -34.0, -64.0, -34.0, -39.0, -64.0, -36.0, -45.0, -41.0, -28.0, -63.0, -40.0, -19.0, -64.0, -64.0, -33.0, -43.0, -64.0, -64.0, -39.0, -28.0, -42.0, -25.0, -38.0, -64.0, -38.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.35319560949477, "mean_inference_ms": 18.675737523551028, "mean_action_processing_ms": 0.8155989211801251, "mean_env_wait_ms": 0.4780314148686925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5478408336639404, "StateBufferConnector_ms": 0.006940126419067383, "ViewRequirementAgentConnector_ms": 0.2641274929046631}}, "episode_reward_max": 2.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.33, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -32.0, -64.0, -1.0, -64.0, -64.0, -16.0, -43.0, -33.0, -15.0, -45.0, -53.0, -64.0, -34.0, -64.0, -16.0, -38.0, -64.0, -29.0, -19.0, -36.0, -34.0, -17.0, -64.0, -21.0, -64.0, -30.0, -15.0, -64.0, -44.0, -64.0, -44.0, -23.0, -37.0, -63.0, -64.0, -40.0, -43.0, -64.0, -29.0, -24.0, -64.0, -27.0, 2.0, -16.0, -64.0, -24.0, -64.0, -64.0, -33.0, -46.0, -32.0, -64.0, -34.0, -40.0, -31.0, -63.0, -34.0, -63.0, -64.0, -64.0, -31.0, -22.0, -64.0, -64.0, -63.0, -30.0, -32.0, -64.0, -40.0, -36.0, -39.0, -36.0, -34.0, -64.0, -34.0, -39.0, -64.0, -36.0, -45.0, -41.0, -28.0, -63.0, -40.0, -19.0, -64.0, -64.0, -33.0, -43.0, -64.0, -64.0, -39.0, -28.0, -42.0, -25.0, -38.0, -64.0, -38.0, -40.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.35319560949477, "mean_inference_ms": 18.675737523551028, "mean_action_processing_ms": 0.8155989211801251, "mean_env_wait_ms": 0.4780314148686925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5478408336639404, "StateBufferConnector_ms": 0.006940126419067383, "ViewRequirementAgentConnector_ms": 0.2641274929046631}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.362051511868386, "num_agent_steps_trained_throughput_per_sec": 3.362051511868386, "timesteps_total": 58368, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 152580.699, "sample_time_ms": 11137.865, "load_time_ms": 0.354, "load_throughput": 1447384.005, "learn_time_ms": 141441.959, "learn_throughput": 3.62, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "episodes_total": 3648, "training_iteration": 114, "trial_id": "6f959_00019", "date": "2024-02-28_20-09-18", "timestamp": 1709147358, "time_this_iter_s": 152.2990756034851, "time_total_s": 18058.576318979263, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18058.576318979263, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 56.91203703703704, "ram_util_percent": 17.75555555555556}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.95, "reward_total_min": -64, "reward_total_max": 2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.148828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.515625, "reward_score_mean": 0.148828125, "reward_score_min": 0.0, "reward_score_max": 0.515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9940130576491356, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.960027162233988, "policy_loss": 0.0009864313527941705, "vf_loss": 9.855717249711354, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 98.32154922485351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "sampler_results": {"episode_reward_max": 2.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.95, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.95, "reward_total_min": -64, "reward_total_max": 2, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.148828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.515625, "reward_score_mean": 0.148828125, "reward_score_min": 0.0, "reward_score_max": 0.515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -23.0, -37.0, -63.0, -64.0, -40.0, -43.0, -64.0, -29.0, -24.0, -64.0, -27.0, 2.0, -16.0, -64.0, -24.0, -64.0, -64.0, -33.0, -46.0, -32.0, -64.0, -34.0, -40.0, -31.0, -63.0, -34.0, -63.0, -64.0, -64.0, -31.0, -22.0, -64.0, -64.0, -63.0, -30.0, -32.0, -64.0, -40.0, -36.0, -39.0, -36.0, -34.0, -64.0, -34.0, -39.0, -64.0, -36.0, -45.0, -41.0, -28.0, -63.0, -40.0, -19.0, -64.0, -64.0, -33.0, -43.0, -64.0, -64.0, -39.0, -28.0, -42.0, -25.0, -38.0, -64.0, -38.0, -40.0, -64.0, -32.0, -35.0, -64.0, -64.0, -64.0, -64.0, -31.0, 1.0, -41.0, -64.0, -63.0, -64.0, -64.0, -64.0, -64.0, -21.0, -43.0, -46.0, -32.0, -10.0, -64.0, -64.0, -64.0, -37.0, -24.0, -64.0, -64.0, -32.0, -33.0, -38.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3526782924593435, "mean_inference_ms": 18.67259896757423, "mean_action_processing_ms": 0.8154445117985345, "mean_env_wait_ms": 0.47794911887777586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5461962223052979, "StateBufferConnector_ms": 0.00690770149230957, "ViewRequirementAgentConnector_ms": 0.26201462745666504}}, "episode_reward_max": 2.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.95, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -23.0, -37.0, -63.0, -64.0, -40.0, -43.0, -64.0, -29.0, -24.0, -64.0, -27.0, 2.0, -16.0, -64.0, -24.0, -64.0, -64.0, -33.0, -46.0, -32.0, -64.0, -34.0, -40.0, -31.0, -63.0, -34.0, -63.0, -64.0, -64.0, -31.0, -22.0, -64.0, -64.0, -63.0, -30.0, -32.0, -64.0, -40.0, -36.0, -39.0, -36.0, -34.0, -64.0, -34.0, -39.0, -64.0, -36.0, -45.0, -41.0, -28.0, -63.0, -40.0, -19.0, -64.0, -64.0, -33.0, -43.0, -64.0, -64.0, -39.0, -28.0, -42.0, -25.0, -38.0, -64.0, -38.0, -40.0, -64.0, -32.0, -35.0, -64.0, -64.0, -64.0, -64.0, -31.0, 1.0, -41.0, -64.0, -63.0, -64.0, -64.0, -64.0, -64.0, -21.0, -43.0, -46.0, -32.0, -10.0, -64.0, -64.0, -64.0, -37.0, -24.0, -64.0, -64.0, -32.0, -33.0, -38.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3526782924593435, "mean_inference_ms": 18.67259896757423, "mean_action_processing_ms": 0.8154445117985345, "mean_env_wait_ms": 0.47794911887777586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5461962223052979, "StateBufferConnector_ms": 0.00690770149230957, "ViewRequirementAgentConnector_ms": 0.26201462745666504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4003909920466, "num_agent_steps_trained_throughput_per_sec": 3.4003909920466, "timesteps_total": 58880, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58880, "timers": {"training_iteration_time_ms": 151948.542, "sample_time_ms": 11074.016, "load_time_ms": 0.351, "load_throughput": 1457106.56, "learn_time_ms": 140873.638, "learn_throughput": 3.634, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "done": false, "episodes_total": 3680, "training_iteration": 115, "trial_id": "6f959_00019", "date": "2024-02-28_20-11-49", "timestamp": 1709147509, "time_this_iter_s": 150.58616161346436, "time_total_s": 18209.162480592728, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18209.162480592728, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 57.05981308411214, "ram_util_percent": 17.870560747663554}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.99, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.140703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.140703125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9609893428782622, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.041103665033976, "policy_loss": 0.020981890397767225, "vf_loss": 9.922911667823792, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 97.05225709279378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.99, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.140703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.140703125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -63.0, -30.0, -32.0, -64.0, -40.0, -36.0, -39.0, -36.0, -34.0, -64.0, -34.0, -39.0, -64.0, -36.0, -45.0, -41.0, -28.0, -63.0, -40.0, -19.0, -64.0, -64.0, -33.0, -43.0, -64.0, -64.0, -39.0, -28.0, -42.0, -25.0, -38.0, -64.0, -38.0, -40.0, -64.0, -32.0, -35.0, -64.0, -64.0, -64.0, -64.0, -31.0, 1.0, -41.0, -64.0, -63.0, -64.0, -64.0, -64.0, -64.0, -21.0, -43.0, -46.0, -32.0, -10.0, -64.0, -64.0, -64.0, -37.0, -24.0, -64.0, -64.0, -32.0, -33.0, -38.0, -24.0, -47.0, -64.0, 5.0, -64.0, -64.0, -42.0, -64.0, -21.0, -64.0, -64.0, -64.0, -7.0, -39.0, -64.0, -64.0, -38.0, -45.0, -64.0, -33.0, -64.0, -18.0, -64.0, -33.0, -25.0, -64.0, -34.0, -34.0, -64.0, -64.0, -64.0, -33.0, -9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3518106303305895, "mean_inference_ms": 18.666491847052104, "mean_action_processing_ms": 0.815170738834521, "mean_env_wait_ms": 0.47778687352577975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5339536666870117, "StateBufferConnector_ms": 0.006814718246459961, "ViewRequirementAgentConnector_ms": 0.2579817771911621}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -63.0, -30.0, -32.0, -64.0, -40.0, -36.0, -39.0, -36.0, -34.0, -64.0, -34.0, -39.0, -64.0, -36.0, -45.0, -41.0, -28.0, -63.0, -40.0, -19.0, -64.0, -64.0, -33.0, -43.0, -64.0, -64.0, -39.0, -28.0, -42.0, -25.0, -38.0, -64.0, -38.0, -40.0, -64.0, -32.0, -35.0, -64.0, -64.0, -64.0, -64.0, -31.0, 1.0, -41.0, -64.0, -63.0, -64.0, -64.0, -64.0, -64.0, -21.0, -43.0, -46.0, -32.0, -10.0, -64.0, -64.0, -64.0, -37.0, -24.0, -64.0, -64.0, -32.0, -33.0, -38.0, -24.0, -47.0, -64.0, 5.0, -64.0, -64.0, -42.0, -64.0, -21.0, -64.0, -64.0, -64.0, -7.0, -39.0, -64.0, -64.0, -38.0, -45.0, -64.0, -33.0, -64.0, -18.0, -64.0, -33.0, -25.0, -64.0, -34.0, -34.0, -64.0, -64.0, -64.0, -33.0, -9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3518106303305895, "mean_inference_ms": 18.666491847052104, "mean_action_processing_ms": 0.815170738834521, "mean_env_wait_ms": 0.47778687352577975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5339536666870117, "StateBufferConnector_ms": 0.006814718246459961, "ViewRequirementAgentConnector_ms": 0.2579817771911621}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.276882522078162, "num_agent_steps_trained_throughput_per_sec": 3.276882522078162, "timesteps_total": 59392, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 152410.352, "sample_time_ms": 11107.854, "load_time_ms": 0.368, "load_throughput": 1391848.887, "learn_time_ms": 141301.577, "learn_throughput": 3.623, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "episodes_total": 3712, "training_iteration": 116, "trial_id": "6f959_00019", "date": "2024-02-28_20-14-25", "timestamp": 1709147665, "time_this_iter_s": 156.25667762756348, "time_total_s": 18365.41915822029, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18365.41915822029, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 57.38153153153153, "ram_util_percent": 17.842342342342345}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.19, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.146953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.146953125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9637486410637697, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.850219372908274, "policy_loss": 0.024447496846551075, "vf_loss": 9.7091099858284, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 89.39958578745524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.19, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.19, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.146953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.146953125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -64.0, -38.0, -40.0, -64.0, -32.0, -35.0, -64.0, -64.0, -64.0, -64.0, -31.0, 1.0, -41.0, -64.0, -63.0, -64.0, -64.0, -64.0, -64.0, -21.0, -43.0, -46.0, -32.0, -10.0, -64.0, -64.0, -64.0, -37.0, -24.0, -64.0, -64.0, -32.0, -33.0, -38.0, -24.0, -47.0, -64.0, 5.0, -64.0, -64.0, -42.0, -64.0, -21.0, -64.0, -64.0, -64.0, -7.0, -39.0, -64.0, -64.0, -38.0, -45.0, -64.0, -33.0, -64.0, -18.0, -64.0, -33.0, -25.0, -64.0, -34.0, -34.0, -64.0, -64.0, -64.0, -33.0, -9.0, -32.0, -12.0, -8.0, -52.0, -21.0, -7.0, -36.0, -64.0, -64.0, -64.0, -64.0, -64.0, -21.0, -50.0, -21.0, -41.0, -50.0, -64.0, -64.0, -29.0, -22.0, -64.0, -49.0, -64.0, -64.0, -45.0, -64.0, -19.0, 5.0, -19.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3515092054475333, "mean_inference_ms": 18.664941308583376, "mean_action_processing_ms": 0.8151516087989978, "mean_env_wait_ms": 0.47776506399966545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.559981107711792, "StateBufferConnector_ms": 0.006974458694458008, "ViewRequirementAgentConnector_ms": 0.2648618221282959}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.19, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -64.0, -38.0, -40.0, -64.0, -32.0, -35.0, -64.0, -64.0, -64.0, -64.0, -31.0, 1.0, -41.0, -64.0, -63.0, -64.0, -64.0, -64.0, -64.0, -21.0, -43.0, -46.0, -32.0, -10.0, -64.0, -64.0, -64.0, -37.0, -24.0, -64.0, -64.0, -32.0, -33.0, -38.0, -24.0, -47.0, -64.0, 5.0, -64.0, -64.0, -42.0, -64.0, -21.0, -64.0, -64.0, -64.0, -7.0, -39.0, -64.0, -64.0, -38.0, -45.0, -64.0, -33.0, -64.0, -18.0, -64.0, -33.0, -25.0, -64.0, -34.0, -34.0, -64.0, -64.0, -64.0, -33.0, -9.0, -32.0, -12.0, -8.0, -52.0, -21.0, -7.0, -36.0, -64.0, -64.0, -64.0, -64.0, -64.0, -21.0, -50.0, -21.0, -41.0, -50.0, -64.0, -64.0, -29.0, -22.0, -64.0, -49.0, -64.0, -64.0, -45.0, -64.0, -19.0, 5.0, -19.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3515092054475333, "mean_inference_ms": 18.664941308583376, "mean_action_processing_ms": 0.8151516087989978, "mean_env_wait_ms": 0.47776506399966545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.559981107711792, "StateBufferConnector_ms": 0.006974458694458008, "ViewRequirementAgentConnector_ms": 0.2648618221282959}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.087260053608095, "num_agent_steps_trained_throughput_per_sec": 3.087260053608095, "timesteps_total": 59904, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59904, "timers": {"training_iteration_time_ms": 154046.884, "sample_time_ms": 11226.389, "load_time_ms": 0.385, "load_throughput": 1329135.141, "learn_time_ms": 142819.542, "learn_throughput": 3.585, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "done": false, "episodes_total": 3744, "training_iteration": 117, "trial_id": "6f959_00019", "date": "2024-02-28_20-17-11", "timestamp": 1709147831, "time_this_iter_s": 165.8580448627472, "time_total_s": 18531.27720308304, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18531.27720308304, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 56.78389830508475, "ram_util_percent": 17.936016949152545}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.11, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.147578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.147578125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8157456263278922, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.027848676840465, "policy_loss": 0.025555953135093054, "vf_loss": 9.903298179308573, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 97.66685638427734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "sampler_results": {"episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.11, "reward_total_min": -64, "reward_total_max": 5, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.147578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.5390625, "reward_score_mean": 0.147578125, "reward_score_min": 0.0, "reward_score_max": 0.5390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-32.0, -33.0, -38.0, -24.0, -47.0, -64.0, 5.0, -64.0, -64.0, -42.0, -64.0, -21.0, -64.0, -64.0, -64.0, -7.0, -39.0, -64.0, -64.0, -38.0, -45.0, -64.0, -33.0, -64.0, -18.0, -64.0, -33.0, -25.0, -64.0, -34.0, -34.0, -64.0, -64.0, -64.0, -33.0, -9.0, -32.0, -12.0, -8.0, -52.0, -21.0, -7.0, -36.0, -64.0, -64.0, -64.0, -64.0, -64.0, -21.0, -50.0, -21.0, -41.0, -50.0, -64.0, -64.0, -29.0, -22.0, -64.0, -49.0, -64.0, -64.0, -45.0, -64.0, -19.0, 5.0, -19.0, -64.0, -64.0, -64.0, -64.0, -64.0, -10.0, -24.0, -24.0, -64.0, -64.0, -22.0, -25.0, -40.0, -29.0, -64.0, -14.0, -35.0, -64.0, -45.0, -64.0, -10.0, -64.0, -39.0, -64.0, -64.0, -48.0, -45.0, -64.0, -64.0, -64.0, -48.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3514863018155046, "mean_inference_ms": 18.664002629729215, "mean_action_processing_ms": 0.8151528695802054, "mean_env_wait_ms": 0.4777729470984105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5650901794433594, "StateBufferConnector_ms": 0.007041454315185547, "ViewRequirementAgentConnector_ms": 0.26718831062316895}}, "episode_reward_max": 5.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.0, -33.0, -38.0, -24.0, -47.0, -64.0, 5.0, -64.0, -64.0, -42.0, -64.0, -21.0, -64.0, -64.0, -64.0, -7.0, -39.0, -64.0, -64.0, -38.0, -45.0, -64.0, -33.0, -64.0, -18.0, -64.0, -33.0, -25.0, -64.0, -34.0, -34.0, -64.0, -64.0, -64.0, -33.0, -9.0, -32.0, -12.0, -8.0, -52.0, -21.0, -7.0, -36.0, -64.0, -64.0, -64.0, -64.0, -64.0, -21.0, -50.0, -21.0, -41.0, -50.0, -64.0, -64.0, -29.0, -22.0, -64.0, -49.0, -64.0, -64.0, -45.0, -64.0, -19.0, 5.0, -19.0, -64.0, -64.0, -64.0, -64.0, -64.0, -10.0, -24.0, -24.0, -64.0, -64.0, -22.0, -25.0, -40.0, -29.0, -64.0, -14.0, -35.0, -64.0, -45.0, -64.0, -10.0, -64.0, -39.0, -64.0, -64.0, -48.0, -45.0, -64.0, -64.0, -64.0, -48.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3514863018155046, "mean_inference_ms": 18.664002629729215, "mean_action_processing_ms": 0.8151528695802054, "mean_env_wait_ms": 0.4777729470984105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5650901794433594, "StateBufferConnector_ms": 0.007041454315185547, "ViewRequirementAgentConnector_ms": 0.26718831062316895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.143323277881478, "num_agent_steps_trained_throughput_per_sec": 3.143323277881478, "timesteps_total": 60416, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 155164.456, "sample_time_ms": 11170.612, "load_time_ms": 0.384, "load_throughput": 1333178.326, "learn_time_ms": 143992.879, "learn_throughput": 3.556, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "episodes_total": 3776, "training_iteration": 118, "trial_id": "6f959_00019", "date": "2024-02-28_20-19-54", "timestamp": 1709147994, "time_this_iter_s": 162.8955614566803, "time_total_s": 18694.17276453972, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18694.17276453972, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 57.064935064935064, "ram_util_percent": 18.0021645021645}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -43.17, "reward_total_min": -64, "reward_total_max": 21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.162734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6640625, "reward_score_mean": 0.162734375, "reward_score_min": 0.0, "reward_score_max": 0.6640625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9048303091704535, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.020062883694967, "policy_loss": -0.01116502908989787, "vf_loss": 9.935129284858704, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 90.96944929758708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "sampler_results": {"episode_reward_max": 21.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.17, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -43.17, "reward_total_min": -64, "reward_total_max": 21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.162734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6640625, "reward_score_mean": 0.162734375, "reward_score_min": 0.0, "reward_score_max": 0.6640625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -33.0, -9.0, -32.0, -12.0, -8.0, -52.0, -21.0, -7.0, -36.0, -64.0, -64.0, -64.0, -64.0, -64.0, -21.0, -50.0, -21.0, -41.0, -50.0, -64.0, -64.0, -29.0, -22.0, -64.0, -49.0, -64.0, -64.0, -45.0, -64.0, -19.0, 5.0, -19.0, -64.0, -64.0, -64.0, -64.0, -64.0, -10.0, -24.0, -24.0, -64.0, -64.0, -22.0, -25.0, -40.0, -29.0, -64.0, -14.0, -35.0, -64.0, -45.0, -64.0, -10.0, -64.0, -39.0, -64.0, -64.0, -48.0, -45.0, -64.0, -64.0, -64.0, -48.0, -64.0, -64.0, -64.0, -9.0, -10.0, -28.0, -64.0, -64.0, -26.0, -64.0, -37.0, -36.0, -64.0, 8.0, -64.0, -64.0, -64.0, -64.0, -64.0, -31.0, -4.0, -26.0, 21.0, -64.0, -64.0, -16.0, -64.0, -21.0, -38.0, -64.0, -17.0, -64.0, -29.0, -21.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.351512337941385, "mean_inference_ms": 18.664337699270806, "mean_action_processing_ms": 0.8151820442974409, "mean_env_wait_ms": 0.47781413917219523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5698988437652588, "StateBufferConnector_ms": 0.007061958312988281, "ViewRequirementAgentConnector_ms": 0.2664952278137207}}, "episode_reward_max": 21.0, "episode_reward_min": -64.0, "episode_reward_mean": -43.17, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -33.0, -9.0, -32.0, -12.0, -8.0, -52.0, -21.0, -7.0, -36.0, -64.0, -64.0, -64.0, -64.0, -64.0, -21.0, -50.0, -21.0, -41.0, -50.0, -64.0, -64.0, -29.0, -22.0, -64.0, -49.0, -64.0, -64.0, -45.0, -64.0, -19.0, 5.0, -19.0, -64.0, -64.0, -64.0, -64.0, -64.0, -10.0, -24.0, -24.0, -64.0, -64.0, -22.0, -25.0, -40.0, -29.0, -64.0, -14.0, -35.0, -64.0, -45.0, -64.0, -10.0, -64.0, -39.0, -64.0, -64.0, -48.0, -45.0, -64.0, -64.0, -64.0, -48.0, -64.0, -64.0, -64.0, -9.0, -10.0, -28.0, -64.0, -64.0, -26.0, -64.0, -37.0, -36.0, -64.0, 8.0, -64.0, -64.0, -64.0, -64.0, -64.0, -31.0, -4.0, -26.0, 21.0, -64.0, -64.0, -16.0, -64.0, -21.0, -38.0, -64.0, -17.0, -64.0, -29.0, -21.0, -24.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.351512337941385, "mean_inference_ms": 18.664337699270806, "mean_action_processing_ms": 0.8151820442974409, "mean_env_wait_ms": 0.47781413917219523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5698988437652588, "StateBufferConnector_ms": 0.007061958312988281, "ViewRequirementAgentConnector_ms": 0.2664952278137207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.289136873062764, "num_agent_steps_trained_throughput_per_sec": 3.289136873062764, "timesteps_total": 60928, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60928, "timers": {"training_iteration_time_ms": 155432.533, "sample_time_ms": 11190.62, "load_time_ms": 0.384, "load_throughput": 1332185.886, "learn_time_ms": 144240.945, "learn_throughput": 3.55, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "done": false, "episodes_total": 3808, "training_iteration": 119, "trial_id": "6f959_00019", "date": "2024-02-28_20-22-30", "timestamp": 1709148150, "time_this_iter_s": 155.67430973052979, "time_total_s": 18849.84707427025, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18849.84707427025, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.05384615384616, "ram_util_percent": 18.0710407239819}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -45.92, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.14125, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9744770218928654, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.02393285036087, "policy_loss": -0.0003909680061042309, "vf_loss": 9.927534286181132, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 90.24323234558105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "sampler_results": {"episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -45.92, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.14125, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [5.0, -19.0, -64.0, -64.0, -64.0, -64.0, -64.0, -10.0, -24.0, -24.0, -64.0, -64.0, -22.0, -25.0, -40.0, -29.0, -64.0, -14.0, -35.0, -64.0, -45.0, -64.0, -10.0, -64.0, -39.0, -64.0, -64.0, -48.0, -45.0, -64.0, -64.0, -64.0, -48.0, -64.0, -64.0, -64.0, -9.0, -10.0, -28.0, -64.0, -64.0, -26.0, -64.0, -37.0, -36.0, -64.0, 8.0, -64.0, -64.0, -64.0, -64.0, -64.0, -31.0, -4.0, -26.0, 21.0, -64.0, -64.0, -16.0, -64.0, -21.0, -38.0, -64.0, -17.0, -64.0, -29.0, -21.0, -24.0, -64.0, -64.0, 27.0, -64.0, -64.0, -64.0, -42.0, -47.0, -40.0, -31.0, -64.0, -64.0, -64.0, -64.0, -64.0, -37.0, -47.0, -41.0, -64.0, -64.0, -40.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -28.0, -31.0, -64.0, -63.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3511048236833165, "mean_inference_ms": 18.661428649362662, "mean_action_processing_ms": 0.8150267092295246, "mean_env_wait_ms": 0.47776787787075314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5483989715576172, "StateBufferConnector_ms": 0.00693821907043457, "ViewRequirementAgentConnector_ms": 0.2610774040222168}}, "episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -45.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.0, -19.0, -64.0, -64.0, -64.0, -64.0, -64.0, -10.0, -24.0, -24.0, -64.0, -64.0, -22.0, -25.0, -40.0, -29.0, -64.0, -14.0, -35.0, -64.0, -45.0, -64.0, -10.0, -64.0, -39.0, -64.0, -64.0, -48.0, -45.0, -64.0, -64.0, -64.0, -48.0, -64.0, -64.0, -64.0, -9.0, -10.0, -28.0, -64.0, -64.0, -26.0, -64.0, -37.0, -36.0, -64.0, 8.0, -64.0, -64.0, -64.0, -64.0, -64.0, -31.0, -4.0, -26.0, 21.0, -64.0, -64.0, -16.0, -64.0, -21.0, -38.0, -64.0, -17.0, -64.0, -29.0, -21.0, -24.0, -64.0, -64.0, 27.0, -64.0, -64.0, -64.0, -42.0, -47.0, -40.0, -31.0, -64.0, -64.0, -64.0, -64.0, -64.0, -37.0, -47.0, -41.0, -64.0, -64.0, -40.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -28.0, -31.0, -64.0, -63.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3511048236833165, "mean_inference_ms": 18.661428649362662, "mean_action_processing_ms": 0.8150267092295246, "mean_env_wait_ms": 0.47776787787075314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5483989715576172, "StateBufferConnector_ms": 0.00693821907043457, "ViewRequirementAgentConnector_ms": 0.2610774040222168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1561154725848244, "num_agent_steps_trained_throughput_per_sec": 3.1561154725848244, "timesteps_total": 61440, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 156395.291, "sample_time_ms": 11234.337, "load_time_ms": 0.383, "load_throughput": 1335416.733, "learn_time_ms": 145159.971, "learn_throughput": 3.527, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 3840, "training_iteration": 120, "trial_id": "6f959_00019", "date": "2024-02-28_20-25-12", "timestamp": 1709148312, "time_this_iter_s": 162.24006748199463, "time_total_s": 19012.087141752243, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19012.087141752243, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 57.15021645021645, "ram_util_percent": 17.803896103896108}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.18, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.15484375, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9498746070079506, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.778950281937917, "policy_loss": 0.021659486213078102, "vf_loss": 9.633775019645691, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 88.53195419311524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "sampler_results": {"episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.18, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.15484375, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -64.0, -64.0, -64.0, -9.0, -10.0, -28.0, -64.0, -64.0, -26.0, -64.0, -37.0, -36.0, -64.0, 8.0, -64.0, -64.0, -64.0, -64.0, -64.0, -31.0, -4.0, -26.0, 21.0, -64.0, -64.0, -16.0, -64.0, -21.0, -38.0, -64.0, -17.0, -64.0, -29.0, -21.0, -24.0, -64.0, -64.0, 27.0, -64.0, -64.0, -64.0, -42.0, -47.0, -40.0, -31.0, -64.0, -64.0, -64.0, -64.0, -64.0, -37.0, -47.0, -41.0, -64.0, -64.0, -40.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -28.0, -31.0, -64.0, -63.0, -64.0, -64.0, -41.0, -36.0, -64.0, 13.0, 21.0, -34.0, -46.0, 8.0, -36.0, -64.0, -42.0, -21.0, 10.0, -64.0, -64.0, -64.0, -64.0, -29.0, -27.0, -50.0, -50.0, -33.0, -64.0, -34.0, -1.0, -64.0, -64.0, -44.0, -64.0, -34.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.350903684638626, "mean_inference_ms": 18.66032704473651, "mean_action_processing_ms": 0.815000119253055, "mean_env_wait_ms": 0.47778125923123815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5625948905944824, "StateBufferConnector_ms": 0.007054805755615234, "ViewRequirementAgentConnector_ms": 0.26641201972961426}}, "episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -64.0, -64.0, -64.0, -9.0, -10.0, -28.0, -64.0, -64.0, -26.0, -64.0, -37.0, -36.0, -64.0, 8.0, -64.0, -64.0, -64.0, -64.0, -64.0, -31.0, -4.0, -26.0, 21.0, -64.0, -64.0, -16.0, -64.0, -21.0, -38.0, -64.0, -17.0, -64.0, -29.0, -21.0, -24.0, -64.0, -64.0, 27.0, -64.0, -64.0, -64.0, -42.0, -47.0, -40.0, -31.0, -64.0, -64.0, -64.0, -64.0, -64.0, -37.0, -47.0, -41.0, -64.0, -64.0, -40.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -28.0, -31.0, -64.0, -63.0, -64.0, -64.0, -41.0, -36.0, -64.0, 13.0, 21.0, -34.0, -46.0, 8.0, -36.0, -64.0, -42.0, -21.0, 10.0, -64.0, -64.0, -64.0, -64.0, -29.0, -27.0, -50.0, -50.0, -33.0, -64.0, -34.0, -1.0, -64.0, -64.0, -44.0, -64.0, -34.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.350903684638626, "mean_inference_ms": 18.66032704473651, "mean_action_processing_ms": 0.815000119253055, "mean_env_wait_ms": 0.47778125923123815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5625948905944824, "StateBufferConnector_ms": 0.007054805755615234, "ViewRequirementAgentConnector_ms": 0.26641201972961426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.137335136768627, "num_agent_steps_trained_throughput_per_sec": 3.137335136768627, "timesteps_total": 61952, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61952, "timers": {"training_iteration_time_ms": 157447.124, "sample_time_ms": 11333.926, "load_time_ms": 0.399, "load_throughput": 1283996.202, "learn_time_ms": 146112.199, "learn_throughput": 3.504, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "done": false, "episodes_total": 3872, "training_iteration": 121, "trial_id": "6f959_00019", "date": "2024-02-28_20-27-56", "timestamp": 1709148476, "time_this_iter_s": 163.21653699874878, "time_total_s": 19175.303678750992, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19175.303678750992, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 56.94698275862069, "ram_util_percent": 17.95258620689655}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.35, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.153515625, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9376061094303926, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.989974959691365, "policy_loss": 0.010892573678089927, "vf_loss": 9.877764809131623, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 93.41406707763672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "sampler_results": {"episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.35, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.35, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.153515625, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -29.0, -21.0, -24.0, -64.0, -64.0, 27.0, -64.0, -64.0, -64.0, -42.0, -47.0, -40.0, -31.0, -64.0, -64.0, -64.0, -64.0, -64.0, -37.0, -47.0, -41.0, -64.0, -64.0, -40.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -28.0, -31.0, -64.0, -63.0, -64.0, -64.0, -41.0, -36.0, -64.0, 13.0, 21.0, -34.0, -46.0, 8.0, -36.0, -64.0, -42.0, -21.0, 10.0, -64.0, -64.0, -64.0, -64.0, -29.0, -27.0, -50.0, -50.0, -33.0, -64.0, -34.0, -1.0, -64.0, -64.0, -44.0, -64.0, -34.0, -64.0, -43.0, -31.0, -21.0, -17.0, -64.0, -37.0, -35.0, -64.0, -41.0, 13.0, -28.0, -64.0, -64.0, -53.0, -64.0, -45.0, -64.0, -64.0, -64.0, -17.0, -64.0, -18.0, -42.0, -39.0, -64.0, -64.0, -64.0, -3.0, -27.0, -64.0, -39.0, -4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3513995258109945, "mean_inference_ms": 18.66402173737597, "mean_action_processing_ms": 0.8152504396230063, "mean_env_wait_ms": 0.477929853207107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5920586585998535, "StateBufferConnector_ms": 0.007284879684448242, "ViewRequirementAgentConnector_ms": 0.2772250175476074}}, "episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.35, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -29.0, -21.0, -24.0, -64.0, -64.0, 27.0, -64.0, -64.0, -64.0, -42.0, -47.0, -40.0, -31.0, -64.0, -64.0, -64.0, -64.0, -64.0, -37.0, -47.0, -41.0, -64.0, -64.0, -40.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -28.0, -31.0, -64.0, -63.0, -64.0, -64.0, -41.0, -36.0, -64.0, 13.0, 21.0, -34.0, -46.0, 8.0, -36.0, -64.0, -42.0, -21.0, 10.0, -64.0, -64.0, -64.0, -64.0, -29.0, -27.0, -50.0, -50.0, -33.0, -64.0, -34.0, -1.0, -64.0, -64.0, -44.0, -64.0, -34.0, -64.0, -43.0, -31.0, -21.0, -17.0, -64.0, -37.0, -35.0, -64.0, -41.0, 13.0, -28.0, -64.0, -64.0, -53.0, -64.0, -45.0, -64.0, -64.0, -64.0, -17.0, -64.0, -18.0, -42.0, -39.0, -64.0, -64.0, -64.0, -3.0, -27.0, -64.0, -39.0, -4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3513995258109945, "mean_inference_ms": 18.66402173737597, "mean_action_processing_ms": 0.8152504396230063, "mean_env_wait_ms": 0.477929853207107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5920586585998535, "StateBufferConnector_ms": 0.007284879684448242, "ViewRequirementAgentConnector_ms": 0.2772250175476074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.226216280179489, "num_agent_steps_trained_throughput_per_sec": 3.226216280179489, "timesteps_total": 62464, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 158006.384, "sample_time_ms": 11443.444, "load_time_ms": 0.4, "load_throughput": 1278568.497, "learn_time_ms": 146561.949, "learn_throughput": 3.493, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "episodes_total": 3904, "training_iteration": 122, "trial_id": "6f959_00019", "date": "2024-02-28_20-30-34", "timestamp": 1709148634, "time_this_iter_s": 158.7104573249817, "time_total_s": 19334.014136075974, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19334.014136075974, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 57.21111111111111, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.11, "reward_total_min": -64, "reward_total_max": 23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.171015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6796875, "reward_score_mean": 0.171015625, "reward_score_min": 0.0, "reward_score_max": 0.6796875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.901534715294838, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.023569436868032, "policy_loss": -0.02959968087573846, "vf_loss": 9.959266606966654, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 95.99619178771972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "sampler_results": {"episode_reward_max": 23.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.11, "reward_total_min": -64, "reward_total_max": 23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.171015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6796875, "reward_score_mean": 0.171015625, "reward_score_min": 0.0, "reward_score_max": 0.6796875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-31.0, -64.0, -63.0, -64.0, -64.0, -41.0, -36.0, -64.0, 13.0, 21.0, -34.0, -46.0, 8.0, -36.0, -64.0, -42.0, -21.0, 10.0, -64.0, -64.0, -64.0, -64.0, -29.0, -27.0, -50.0, -50.0, -33.0, -64.0, -34.0, -1.0, -64.0, -64.0, -44.0, -64.0, -34.0, -64.0, -43.0, -31.0, -21.0, -17.0, -64.0, -37.0, -35.0, -64.0, -41.0, 13.0, -28.0, -64.0, -64.0, -53.0, -64.0, -45.0, -64.0, -64.0, -64.0, -17.0, -64.0, -18.0, -42.0, -39.0, -64.0, -64.0, -64.0, -3.0, -27.0, -64.0, -39.0, -4.0, -64.0, -39.0, -34.0, -45.0, -18.0, -64.0, -35.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -35.0, -64.0, -64.0, 23.0, -35.0, -64.0, -64.0, -2.0, -14.0, 2.0, -31.0, -35.0, -2.0, -34.0, -64.0, -64.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.351970311786243, "mean_inference_ms": 18.66780881496992, "mean_action_processing_ms": 0.815494583749145, "mean_env_wait_ms": 0.47807470800695784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5852134227752686, "StateBufferConnector_ms": 0.00723576545715332, "ViewRequirementAgentConnector_ms": 0.27433037757873535}}, "episode_reward_max": 23.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.0, -64.0, -63.0, -64.0, -64.0, -41.0, -36.0, -64.0, 13.0, 21.0, -34.0, -46.0, 8.0, -36.0, -64.0, -42.0, -21.0, 10.0, -64.0, -64.0, -64.0, -64.0, -29.0, -27.0, -50.0, -50.0, -33.0, -64.0, -34.0, -1.0, -64.0, -64.0, -44.0, -64.0, -34.0, -64.0, -43.0, -31.0, -21.0, -17.0, -64.0, -37.0, -35.0, -64.0, -41.0, 13.0, -28.0, -64.0, -64.0, -53.0, -64.0, -45.0, -64.0, -64.0, -64.0, -17.0, -64.0, -18.0, -42.0, -39.0, -64.0, -64.0, -64.0, -3.0, -27.0, -64.0, -39.0, -4.0, -64.0, -39.0, -34.0, -45.0, -18.0, -64.0, -35.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -35.0, -64.0, -64.0, 23.0, -35.0, -64.0, -64.0, -2.0, -14.0, 2.0, -31.0, -35.0, -2.0, -34.0, -64.0, -64.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.351970311786243, "mean_inference_ms": 18.66780881496992, "mean_action_processing_ms": 0.815494583749145, "mean_env_wait_ms": 0.47807470800695784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5852134227752686, "StateBufferConnector_ms": 0.00723576545715332, "ViewRequirementAgentConnector_ms": 0.27433037757873535}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2659874962902813, "num_agent_steps_trained_throughput_per_sec": 3.2659874962902813, "timesteps_total": 62976, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62976, "timers": {"training_iteration_time_ms": 158438.391, "sample_time_ms": 11397.785, "load_time_ms": 0.413, "load_throughput": 1240029.823, "learn_time_ms": 147039.587, "learn_throughput": 3.482, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "done": false, "episodes_total": 3936, "training_iteration": 123, "trial_id": "6f959_00019", "date": "2024-02-28_20-33-11", "timestamp": 1709148791, "time_this_iter_s": 156.77783489227295, "time_total_s": 19490.791970968246, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19490.791970968246, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 56.98475336322869, "ram_util_percent": 18.0}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -42.44, "reward_total_min": -64, "reward_total_max": 23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1684375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6796875, "reward_score_mean": 0.1684375, "reward_score_min": 0.0, "reward_score_max": 0.6796875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9197097442423304, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.920434053738912, "policy_loss": 0.011666678451001644, "vf_loss": 9.800412011146545, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 89.86160481770834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "sampler_results": {"episode_reward_max": 23.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -42.44, "reward_total_min": -64, "reward_total_max": 23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1684375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6796875, "reward_score_mean": 0.1684375, "reward_score_min": 0.0, "reward_score_max": 0.6796875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -64.0, -34.0, -64.0, -43.0, -31.0, -21.0, -17.0, -64.0, -37.0, -35.0, -64.0, -41.0, 13.0, -28.0, -64.0, -64.0, -53.0, -64.0, -45.0, -64.0, -64.0, -64.0, -17.0, -64.0, -18.0, -42.0, -39.0, -64.0, -64.0, -64.0, -3.0, -27.0, -64.0, -39.0, -4.0, -64.0, -39.0, -34.0, -45.0, -18.0, -64.0, -35.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -35.0, -64.0, -64.0, 23.0, -35.0, -64.0, -64.0, -2.0, -14.0, 2.0, -31.0, -35.0, -2.0, -34.0, -64.0, -64.0, -34.0, -36.0, -53.0, -64.0, -64.0, -40.0, -21.0, -44.0, -64.0, 18.0, -30.0, -64.0, -39.0, -38.0, -64.0, -35.0, 17.0, -64.0, 7.0, -64.0, -64.0, -16.0, -21.0, 14.0, -64.0, -30.0, -64.0, -64.0, -51.0, -64.0, -29.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3522884864669718, "mean_inference_ms": 18.669654614246102, "mean_action_processing_ms": 0.8156174948336077, "mean_env_wait_ms": 0.478150272546018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.575188398361206, "StateBufferConnector_ms": 0.007158041000366211, "ViewRequirementAgentConnector_ms": 0.2698686122894287}}, "episode_reward_max": 23.0, "episode_reward_min": -64.0, "episode_reward_mean": -42.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -64.0, -34.0, -64.0, -43.0, -31.0, -21.0, -17.0, -64.0, -37.0, -35.0, -64.0, -41.0, 13.0, -28.0, -64.0, -64.0, -53.0, -64.0, -45.0, -64.0, -64.0, -64.0, -17.0, -64.0, -18.0, -42.0, -39.0, -64.0, -64.0, -64.0, -3.0, -27.0, -64.0, -39.0, -4.0, -64.0, -39.0, -34.0, -45.0, -18.0, -64.0, -35.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -35.0, -64.0, -64.0, 23.0, -35.0, -64.0, -64.0, -2.0, -14.0, 2.0, -31.0, -35.0, -2.0, -34.0, -64.0, -64.0, -34.0, -36.0, -53.0, -64.0, -64.0, -40.0, -21.0, -44.0, -64.0, 18.0, -30.0, -64.0, -39.0, -38.0, -64.0, -35.0, 17.0, -64.0, 7.0, -64.0, -64.0, -16.0, -21.0, 14.0, -64.0, -30.0, -64.0, -64.0, -51.0, -64.0, -29.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3522884864669718, "mean_inference_ms": 18.669654614246102, "mean_action_processing_ms": 0.8156174948336077, "mean_env_wait_ms": 0.478150272546018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.575188398361206, "StateBufferConnector_ms": 0.007158041000366211, "ViewRequirementAgentConnector_ms": 0.2698686122894287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3044802915794054, "num_agent_steps_trained_throughput_per_sec": 3.3044802915794054, "timesteps_total": 63488, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 158703.709, "sample_time_ms": 11424.456, "load_time_ms": 0.416, "load_throughput": 1231779.08, "learn_time_ms": 147278.222, "learn_throughput": 3.476, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "episodes_total": 3968, "training_iteration": 124, "trial_id": "6f959_00019", "date": "2024-02-28_20-35-46", "timestamp": 1709148946, "time_this_iter_s": 154.95158791542053, "time_total_s": 19645.743558883667, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19645.743558883667, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 57.37136363636364, "ram_util_percent": 17.832727272727276}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.12, "reward_total_min": -64, "reward_total_max": 23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6796875, "reward_score_mean": 0.17875, "reward_score_min": 0.0, "reward_score_max": 0.6796875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9329749803369244, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.055565031369527, "policy_loss": -0.010974277711162965, "vf_loss": 9.973974919319152, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 93.85352929433186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 23.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.12, "reward_total_min": -64, "reward_total_max": 23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6796875, "reward_score_mean": 0.17875, "reward_score_min": 0.0, "reward_score_max": 0.6796875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-27.0, -64.0, -39.0, -4.0, -64.0, -39.0, -34.0, -45.0, -18.0, -64.0, -35.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -35.0, -64.0, -64.0, 23.0, -35.0, -64.0, -64.0, -2.0, -14.0, 2.0, -31.0, -35.0, -2.0, -34.0, -64.0, -64.0, -34.0, -36.0, -53.0, -64.0, -64.0, -40.0, -21.0, -44.0, -64.0, 18.0, -30.0, -64.0, -39.0, -38.0, -64.0, -35.0, 17.0, -64.0, 7.0, -64.0, -64.0, -16.0, -21.0, 14.0, -64.0, -30.0, -64.0, -64.0, -51.0, -64.0, -29.0, -64.0, -64.0, -42.0, -38.0, -47.0, -64.0, -12.0, -45.0, -24.0, -64.0, -22.0, -20.0, 17.0, -64.0, 8.0, -64.0, -40.0, -45.0, -64.0, -22.0, -37.0, -29.0, -64.0, -35.0, -16.0, -64.0, -47.0, -64.0, -25.0, -64.0, -41.0, -64.0, -64.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3516874973487143, "mean_inference_ms": 18.664958496445433, "mean_action_processing_ms": 0.8154097276329547, "mean_env_wait_ms": 0.4780301819180284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5345478057861328, "StateBufferConnector_ms": 0.006834745407104492, "ViewRequirementAgentConnector_ms": 0.25719189643859863}}, "episode_reward_max": 23.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.0, -64.0, -39.0, -4.0, -64.0, -39.0, -34.0, -45.0, -18.0, -64.0, -35.0, -64.0, -64.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -35.0, -64.0, -64.0, 23.0, -35.0, -64.0, -64.0, -2.0, -14.0, 2.0, -31.0, -35.0, -2.0, -34.0, -64.0, -64.0, -34.0, -36.0, -53.0, -64.0, -64.0, -40.0, -21.0, -44.0, -64.0, 18.0, -30.0, -64.0, -39.0, -38.0, -64.0, -35.0, 17.0, -64.0, 7.0, -64.0, -64.0, -16.0, -21.0, 14.0, -64.0, -30.0, -64.0, -64.0, -51.0, -64.0, -29.0, -64.0, -64.0, -42.0, -38.0, -47.0, -64.0, -12.0, -45.0, -24.0, -64.0, -22.0, -20.0, 17.0, -64.0, 8.0, -64.0, -40.0, -45.0, -64.0, -22.0, -37.0, -29.0, -64.0, -35.0, -16.0, -64.0, -47.0, -64.0, -25.0, -64.0, -41.0, -64.0, -64.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3516874973487143, "mean_inference_ms": 18.664958496445433, "mean_action_processing_ms": 0.8154097276329547, "mean_env_wait_ms": 0.4780301819180284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5345478057861328, "StateBufferConnector_ms": 0.006834745407104492, "ViewRequirementAgentConnector_ms": 0.25719189643859863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.353395370521787, "num_agent_steps_trained_throughput_per_sec": 3.353395370521787, "timesteps_total": 64000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 158914.727, "sample_time_ms": 11388.085, "load_time_ms": 0.416, "load_throughput": 1229592.699, "learn_time_ms": 147525.626, "learn_throughput": 3.471, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 4000, "training_iteration": 125, "trial_id": "6f959_00019", "date": "2024-02-28_20-38-19", "timestamp": 1709149099, "time_this_iter_s": 152.69147372245789, "time_total_s": 19798.435032606125, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19798.435032606125, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 56.97327188940093, "ram_util_percent": 17.951152073732718}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.79, "reward_total_min": -64, "reward_total_max": 28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.173515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.71875, "reward_score_mean": 0.173515625, "reward_score_min": 0.0, "reward_score_max": 0.71875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9505026939014594, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.678576898574828, "policy_loss": 0.020233558533558002, "vf_loss": 9.524924274285635, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 95.11977958679199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": 28.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.79, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.79, "reward_total_min": -64, "reward_total_max": 28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.173515625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.71875, "reward_score_mean": 0.173515625, "reward_score_min": 0.0, "reward_score_max": 0.71875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-34.0, -64.0, -64.0, -34.0, -36.0, -53.0, -64.0, -64.0, -40.0, -21.0, -44.0, -64.0, 18.0, -30.0, -64.0, -39.0, -38.0, -64.0, -35.0, 17.0, -64.0, 7.0, -64.0, -64.0, -16.0, -21.0, 14.0, -64.0, -30.0, -64.0, -64.0, -51.0, -64.0, -29.0, -64.0, -64.0, -42.0, -38.0, -47.0, -64.0, -12.0, -45.0, -24.0, -64.0, -22.0, -20.0, 17.0, -64.0, 8.0, -64.0, -40.0, -45.0, -64.0, -22.0, -37.0, -29.0, -64.0, -35.0, -16.0, -64.0, -47.0, -64.0, -25.0, -64.0, -41.0, -64.0, -64.0, -33.0, 28.0, -64.0, -64.0, -34.0, -64.0, -64.0, -64.0, -26.0, -32.0, -64.0, -64.0, -64.0, -27.0, -64.0, -19.0, -64.0, -35.0, -38.0, -64.0, 0.0, -28.0, -64.0, -25.0, -64.0, -27.0, -64.0, -64.0, -64.0, -42.0, -24.0, -30.0, 22.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3511085453640628, "mean_inference_ms": 18.662512213226044, "mean_action_processing_ms": 0.8152471627731457, "mean_env_wait_ms": 0.4779223218514408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5474932193756104, "StateBufferConnector_ms": 0.0069580078125, "ViewRequirementAgentConnector_ms": 0.2633838653564453}}, "episode_reward_max": 28.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.79, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -64.0, -64.0, -34.0, -36.0, -53.0, -64.0, -64.0, -40.0, -21.0, -44.0, -64.0, 18.0, -30.0, -64.0, -39.0, -38.0, -64.0, -35.0, 17.0, -64.0, 7.0, -64.0, -64.0, -16.0, -21.0, 14.0, -64.0, -30.0, -64.0, -64.0, -51.0, -64.0, -29.0, -64.0, -64.0, -42.0, -38.0, -47.0, -64.0, -12.0, -45.0, -24.0, -64.0, -22.0, -20.0, 17.0, -64.0, 8.0, -64.0, -40.0, -45.0, -64.0, -22.0, -37.0, -29.0, -64.0, -35.0, -16.0, -64.0, -47.0, -64.0, -25.0, -64.0, -41.0, -64.0, -64.0, -33.0, 28.0, -64.0, -64.0, -34.0, -64.0, -64.0, -64.0, -26.0, -32.0, -64.0, -64.0, -64.0, -27.0, -64.0, -19.0, -64.0, -35.0, -38.0, -64.0, 0.0, -28.0, -64.0, -25.0, -64.0, -27.0, -64.0, -64.0, -64.0, -42.0, -24.0, -30.0, 22.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3511085453640628, "mean_inference_ms": 18.662512213226044, "mean_action_processing_ms": 0.8152471627731457, "mean_env_wait_ms": 0.4779223218514408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5474932193756104, "StateBufferConnector_ms": 0.0069580078125, "ViewRequirementAgentConnector_ms": 0.2633838653564453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1202129491883683, "num_agent_steps_trained_throughput_per_sec": 3.1202129491883683, "timesteps_total": 64512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 159699.257, "sample_time_ms": 11473.249, "load_time_ms": 0.403, "load_throughput": 1271829.226, "learn_time_ms": 148225.01, "learn_throughput": 3.454, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 4032, "training_iteration": 126, "trial_id": "6f959_00019", "date": "2024-02-28_20-41-03", "timestamp": 1709149263, "time_this_iter_s": 164.1019012928009, "time_total_s": 19962.536933898926, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19962.536933898926, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 57.351931330472105, "ram_util_percent": 17.848927038626613}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.09, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.178984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.178984375, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8658807801824158, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.032434658209484, "policy_loss": 0.025955397309735416, "vf_loss": 9.907903730869293, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 95.55079263051351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 65024, "num_env_steps_trained": 65024, "num_agent_steps_sampled": 65024, "num_agent_steps_trained": 65024}, "sampler_results": {"episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.09, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.178984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.178984375, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -29.0, -64.0, -64.0, -42.0, -38.0, -47.0, -64.0, -12.0, -45.0, -24.0, -64.0, -22.0, -20.0, 17.0, -64.0, 8.0, -64.0, -40.0, -45.0, -64.0, -22.0, -37.0, -29.0, -64.0, -35.0, -16.0, -64.0, -47.0, -64.0, -25.0, -64.0, -41.0, -64.0, -64.0, -33.0, 28.0, -64.0, -64.0, -34.0, -64.0, -64.0, -64.0, -26.0, -32.0, -64.0, -64.0, -64.0, -27.0, -64.0, -19.0, -64.0, -35.0, -38.0, -64.0, 0.0, -28.0, -64.0, -25.0, -64.0, -27.0, -64.0, -64.0, -64.0, -42.0, -24.0, -30.0, 22.0, -64.0, -16.0, -25.0, 34.0, -64.0, -64.0, 32.0, -19.0, -36.0, -44.0, -64.0, -2.0, 23.0, -64.0, -64.0, 14.0, -57.0, -64.0, -64.0, -64.0, -36.0, -64.0, -64.0, -64.0, -37.0, -53.0, -41.0, -64.0, -48.0, -43.0, -64.0, 22.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3508306955550187, "mean_inference_ms": 18.662173217142364, "mean_action_processing_ms": 0.8152072389006528, "mean_env_wait_ms": 0.4778853984032794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5592207908630371, "StateBufferConnector_ms": 0.0069925785064697266, "ViewRequirementAgentConnector_ms": 0.26592087745666504}}, "episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -29.0, -64.0, -64.0, -42.0, -38.0, -47.0, -64.0, -12.0, -45.0, -24.0, -64.0, -22.0, -20.0, 17.0, -64.0, 8.0, -64.0, -40.0, -45.0, -64.0, -22.0, -37.0, -29.0, -64.0, -35.0, -16.0, -64.0, -47.0, -64.0, -25.0, -64.0, -41.0, -64.0, -64.0, -33.0, 28.0, -64.0, -64.0, -34.0, -64.0, -64.0, -64.0, -26.0, -32.0, -64.0, -64.0, -64.0, -27.0, -64.0, -19.0, -64.0, -35.0, -38.0, -64.0, 0.0, -28.0, -64.0, -25.0, -64.0, -27.0, -64.0, -64.0, -64.0, -42.0, -24.0, -30.0, 22.0, -64.0, -16.0, -25.0, 34.0, -64.0, -64.0, 32.0, -19.0, -36.0, -44.0, -64.0, -2.0, 23.0, -64.0, -64.0, 14.0, -57.0, -64.0, -64.0, -64.0, -36.0, -64.0, -64.0, -64.0, -37.0, -53.0, -41.0, -64.0, -48.0, -43.0, -64.0, 22.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3508306955550187, "mean_inference_ms": 18.662173217142364, "mean_action_processing_ms": 0.8152072389006528, "mean_env_wait_ms": 0.4778853984032794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5592207908630371, "StateBufferConnector_ms": 0.0069925785064697266, "ViewRequirementAgentConnector_ms": 0.26592087745666504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65024, "num_agent_steps_trained": 65024, "num_env_steps_sampled": 65024, "num_env_steps_trained": 65024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.213121699532192, "num_agent_steps_trained_throughput_per_sec": 3.213121699532192, "timesteps_total": 65024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65024, "timers": {"training_iteration_time_ms": 159049.633, "sample_time_ms": 11441.309, "load_time_ms": 0.39, "load_throughput": 1313525.994, "learn_time_ms": 147607.354, "learn_throughput": 3.469, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 65024, "num_env_steps_trained": 65024, "num_agent_steps_sampled": 65024, "num_agent_steps_trained": 65024}, "done": false, "episodes_total": 4064, "training_iteration": 127, "trial_id": "6f959_00019", "date": "2024-02-28_20-43-43", "timestamp": 1709149423, "time_this_iter_s": 159.35696649551392, "time_total_s": 20121.89390039444, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20121.89390039444, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 55.93480176211454, "ram_util_percent": 17.709251101321588}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.79, "reward_total_min": -64, "reward_total_max": 43, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.181328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8359375, "reward_score_mean": 0.181328125, "reward_score_min": 0.0, "reward_score_max": 0.8359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8236319297458976, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.044833171367646, "policy_loss": -0.002778550889343023, "vf_loss": 9.953153049945831, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 102.59292888641357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "sampler_results": {"episode_reward_max": 43.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.79, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.79, "reward_total_min": -64, "reward_total_max": 43, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.181328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8359375, "reward_score_mean": 0.181328125, "reward_score_min": 0.0, "reward_score_max": 0.8359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -64.0, -64.0, -33.0, 28.0, -64.0, -64.0, -34.0, -64.0, -64.0, -64.0, -26.0, -32.0, -64.0, -64.0, -64.0, -27.0, -64.0, -19.0, -64.0, -35.0, -38.0, -64.0, 0.0, -28.0, -64.0, -25.0, -64.0, -27.0, -64.0, -64.0, -64.0, -42.0, -24.0, -30.0, 22.0, -64.0, -16.0, -25.0, 34.0, -64.0, -64.0, 32.0, -19.0, -36.0, -44.0, -64.0, -2.0, 23.0, -64.0, -64.0, 14.0, -57.0, -64.0, -64.0, -64.0, -36.0, -64.0, -64.0, -64.0, -37.0, -53.0, -41.0, -64.0, -48.0, -43.0, -64.0, 22.0, -64.0, -64.0, -63.0, -64.0, -64.0, -40.0, -26.0, -64.0, -64.0, -64.0, -64.0, 22.0, -50.0, -64.0, -64.0, -26.0, -64.0, -64.0, -63.0, -36.0, -64.0, 42.0, -26.0, 14.0, -64.0, -64.0, -37.0, 43.0, -48.0, -17.0, -53.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.351987532473946, "mean_inference_ms": 18.67126498856053, "mean_action_processing_ms": 0.8156216340921936, "mean_env_wait_ms": 0.4781277124037831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6183397769927979, "StateBufferConnector_ms": 0.007449626922607422, "ViewRequirementAgentConnector_ms": 0.28179430961608887}}, "episode_reward_max": 43.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.79, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -64.0, -64.0, -33.0, 28.0, -64.0, -64.0, -34.0, -64.0, -64.0, -64.0, -26.0, -32.0, -64.0, -64.0, -64.0, -27.0, -64.0, -19.0, -64.0, -35.0, -38.0, -64.0, 0.0, -28.0, -64.0, -25.0, -64.0, -27.0, -64.0, -64.0, -64.0, -42.0, -24.0, -30.0, 22.0, -64.0, -16.0, -25.0, 34.0, -64.0, -64.0, 32.0, -19.0, -36.0, -44.0, -64.0, -2.0, 23.0, -64.0, -64.0, 14.0, -57.0, -64.0, -64.0, -64.0, -36.0, -64.0, -64.0, -64.0, -37.0, -53.0, -41.0, -64.0, -48.0, -43.0, -64.0, 22.0, -64.0, -64.0, -63.0, -64.0, -64.0, -40.0, -26.0, -64.0, -64.0, -64.0, -64.0, 22.0, -50.0, -64.0, -64.0, -26.0, -64.0, -64.0, -63.0, -36.0, -64.0, 42.0, -26.0, 14.0, -64.0, -64.0, -37.0, 43.0, -48.0, -17.0, -53.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.351987532473946, "mean_inference_ms": 18.67126498856053, "mean_action_processing_ms": 0.8156216340921936, "mean_env_wait_ms": 0.4781277124037831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6183397769927979, "StateBufferConnector_ms": 0.007449626922607422, "ViewRequirementAgentConnector_ms": 0.28179430961608887}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.156562212378586, "num_agent_steps_trained_throughput_per_sec": 3.156562212378586, "timesteps_total": 65536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 158981.32, "sample_time_ms": 11632.916, "load_time_ms": 0.414, "load_throughput": 1238099.538, "learn_time_ms": 147347.408, "learn_throughput": 3.475, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "episodes_total": 4096, "training_iteration": 128, "trial_id": "6f959_00019", "date": "2024-02-28_20-46-25", "timestamp": 1709149585, "time_this_iter_s": 162.2161009311676, "time_total_s": 20284.110001325607, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20284.110001325607, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 56.65086956521739, "ram_util_percent": 17.86521739130434}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.08, "reward_total_min": -64, "reward_total_max": 43, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1946875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8359375, "reward_score_mean": 0.1946875, "reward_score_min": 0.0, "reward_score_max": 0.8359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8979449809063226, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.051140117645264, "policy_loss": -0.016857455329348642, "vf_loss": 9.975579190254212, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 104.66173159281412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 66048, "num_env_steps_trained": 66048, "num_agent_steps_sampled": 66048, "num_agent_steps_trained": 66048}, "sampler_results": {"episode_reward_max": 43.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.08, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.08, "reward_total_min": -64, "reward_total_max": 43, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1946875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8359375, "reward_score_mean": 0.1946875, "reward_score_min": 0.0, "reward_score_max": 0.8359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -24.0, -30.0, 22.0, -64.0, -16.0, -25.0, 34.0, -64.0, -64.0, 32.0, -19.0, -36.0, -44.0, -64.0, -2.0, 23.0, -64.0, -64.0, 14.0, -57.0, -64.0, -64.0, -64.0, -36.0, -64.0, -64.0, -64.0, -37.0, -53.0, -41.0, -64.0, -48.0, -43.0, -64.0, 22.0, -64.0, -64.0, -63.0, -64.0, -64.0, -40.0, -26.0, -64.0, -64.0, -64.0, -64.0, 22.0, -50.0, -64.0, -64.0, -26.0, -64.0, -64.0, -63.0, -36.0, -64.0, 42.0, -26.0, 14.0, -64.0, -64.0, -37.0, 43.0, -48.0, -17.0, -53.0, 36.0, -13.0, -64.0, -35.0, -5.0, -63.0, -64.0, -64.0, -63.0, 20.0, -64.0, -64.0, -46.0, -64.0, -50.0, 38.0, -27.0, -64.0, 5.0, -64.0, -31.0, -39.0, -64.0, -62.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, 14.0, -61.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3528389800593827, "mean_inference_ms": 18.676742499252374, "mean_action_processing_ms": 0.8159146821653275, "mean_env_wait_ms": 0.47831214875329975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6029748916625977, "StateBufferConnector_ms": 0.007318258285522461, "ViewRequirementAgentConnector_ms": 0.2765216827392578}}, "episode_reward_max": 43.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.08, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -24.0, -30.0, 22.0, -64.0, -16.0, -25.0, 34.0, -64.0, -64.0, 32.0, -19.0, -36.0, -44.0, -64.0, -2.0, 23.0, -64.0, -64.0, 14.0, -57.0, -64.0, -64.0, -64.0, -36.0, -64.0, -64.0, -64.0, -37.0, -53.0, -41.0, -64.0, -48.0, -43.0, -64.0, 22.0, -64.0, -64.0, -63.0, -64.0, -64.0, -40.0, -26.0, -64.0, -64.0, -64.0, -64.0, 22.0, -50.0, -64.0, -64.0, -26.0, -64.0, -64.0, -63.0, -36.0, -64.0, 42.0, -26.0, 14.0, -64.0, -64.0, -37.0, 43.0, -48.0, -17.0, -53.0, 36.0, -13.0, -64.0, -35.0, -5.0, -63.0, -64.0, -64.0, -63.0, 20.0, -64.0, -64.0, -46.0, -64.0, -50.0, 38.0, -27.0, -64.0, 5.0, -64.0, -31.0, -39.0, -64.0, -62.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, 14.0, -61.0, 36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3528389800593827, "mean_inference_ms": 18.676742499252374, "mean_action_processing_ms": 0.8159146821653275, "mean_env_wait_ms": 0.47831214875329975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6029748916625977, "StateBufferConnector_ms": 0.007318258285522461, "ViewRequirementAgentConnector_ms": 0.2765216827392578}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66048, "num_agent_steps_trained": 66048, "num_env_steps_sampled": 66048, "num_env_steps_trained": 66048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1966641047410604, "num_agent_steps_trained_throughput_per_sec": 3.1966641047410604, "timesteps_total": 66048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 66048, "timers": {"training_iteration_time_ms": 159431.621, "sample_time_ms": 11595.537, "load_time_ms": 0.413, "load_throughput": 1238385.127, "learn_time_ms": 147835.082, "learn_throughput": 3.463, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 66048, "num_env_steps_trained": 66048, "num_agent_steps_sampled": 66048, "num_agent_steps_trained": 66048}, "done": false, "episodes_total": 4128, "training_iteration": 129, "trial_id": "6f959_00019", "date": "2024-02-28_20-49-05", "timestamp": 1709149745, "time_this_iter_s": 160.1774082183838, "time_total_s": 20444.28740954399, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20444.28740954399, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 57.208771929824564, "ram_util_percent": 18.099999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.8, "reward_total_min": -64, "reward_total_max": 43, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8359375, "reward_score_mean": 0.2046875, "reward_score_min": 0.0, "reward_score_max": 0.8359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9215589430804054, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.05816354751587, "policy_loss": -0.0071882348041981455, "vf_loss": 9.97266857624054, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 93.27755298614503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "sampler_results": {"episode_reward_max": 43.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.8, "reward_total_min": -64, "reward_total_max": 43, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2046875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8359375, "reward_score_mean": 0.2046875, "reward_score_min": 0.0, "reward_score_max": 0.8359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -43.0, -64.0, 22.0, -64.0, -64.0, -63.0, -64.0, -64.0, -40.0, -26.0, -64.0, -64.0, -64.0, -64.0, 22.0, -50.0, -64.0, -64.0, -26.0, -64.0, -64.0, -63.0, -36.0, -64.0, 42.0, -26.0, 14.0, -64.0, -64.0, -37.0, 43.0, -48.0, -17.0, -53.0, 36.0, -13.0, -64.0, -35.0, -5.0, -63.0, -64.0, -64.0, -63.0, 20.0, -64.0, -64.0, -46.0, -64.0, -50.0, 38.0, -27.0, -64.0, 5.0, -64.0, -31.0, -39.0, -64.0, -62.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, 14.0, -61.0, 36.0, 19.0, -47.0, -64.0, -10.0, 11.0, -40.0, 39.0, -33.0, -11.0, 28.0, -44.0, -64.0, -64.0, -64.0, -38.0, -63.0, -28.0, -42.0, 0.0, -64.0, -34.0, -33.0, -63.0, -51.0, -39.0, 27.0, -64.0, -16.0, -64.0, -64.0, -25.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3543039384928135, "mean_inference_ms": 18.687527651629868, "mean_action_processing_ms": 0.8164619093994794, "mean_env_wait_ms": 0.478633428305957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6262426376342773, "StateBufferConnector_ms": 0.007452487945556641, "ViewRequirementAgentConnector_ms": 0.28230929374694824}}, "episode_reward_max": 43.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -43.0, -64.0, 22.0, -64.0, -64.0, -63.0, -64.0, -64.0, -40.0, -26.0, -64.0, -64.0, -64.0, -64.0, 22.0, -50.0, -64.0, -64.0, -26.0, -64.0, -64.0, -63.0, -36.0, -64.0, 42.0, -26.0, 14.0, -64.0, -64.0, -37.0, 43.0, -48.0, -17.0, -53.0, 36.0, -13.0, -64.0, -35.0, -5.0, -63.0, -64.0, -64.0, -63.0, 20.0, -64.0, -64.0, -46.0, -64.0, -50.0, 38.0, -27.0, -64.0, 5.0, -64.0, -31.0, -39.0, -64.0, -62.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, 14.0, -61.0, 36.0, 19.0, -47.0, -64.0, -10.0, 11.0, -40.0, 39.0, -33.0, -11.0, 28.0, -44.0, -64.0, -64.0, -64.0, -38.0, -63.0, -28.0, -42.0, 0.0, -64.0, -34.0, -33.0, -63.0, -51.0, -39.0, 27.0, -64.0, -16.0, -64.0, -64.0, -25.0, -36.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3543039384928135, "mean_inference_ms": 18.687527651629868, "mean_action_processing_ms": 0.8164619093994794, "mean_env_wait_ms": 0.478633428305957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6262426376342773, "StateBufferConnector_ms": 0.007452487945556641, "ViewRequirementAgentConnector_ms": 0.28230929374694824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.160056906178903, "num_agent_steps_trained_throughput_per_sec": 3.160056906178903, "timesteps_total": 66560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 159411.387, "sample_time_ms": 11786.458, "load_time_ms": 0.419, "load_throughput": 1222244.535, "learn_time_ms": 147623.924, "learn_throughput": 3.468, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "episodes_total": 4160, "training_iteration": 130, "trial_id": "6f959_00019", "date": "2024-02-28_20-51-47", "timestamp": 1709149907, "time_this_iter_s": 162.03765964508057, "time_total_s": 20606.32506918907, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20606.32506918907, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 57.12782608695652, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -36.55, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.214453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.214453125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8469374950354298, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.042128487428029, "policy_loss": 0.03095492684127142, "vf_loss": 9.913067901134491, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 96.12170403798422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 67072, "num_env_steps_trained": 67072, "num_agent_steps_sampled": 67072, "num_agent_steps_trained": 67072}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.55, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -36.55, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.214453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.214453125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -17.0, -53.0, 36.0, -13.0, -64.0, -35.0, -5.0, -63.0, -64.0, -64.0, -63.0, 20.0, -64.0, -64.0, -46.0, -64.0, -50.0, 38.0, -27.0, -64.0, 5.0, -64.0, -31.0, -39.0, -64.0, -62.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, 14.0, -61.0, 36.0, 19.0, -47.0, -64.0, -10.0, 11.0, -40.0, 39.0, -33.0, -11.0, 28.0, -44.0, -64.0, -64.0, -64.0, -38.0, -63.0, -28.0, -42.0, 0.0, -64.0, -34.0, -33.0, -63.0, -51.0, -39.0, 27.0, -64.0, -16.0, -64.0, -64.0, -25.0, -36.0, -29.0, 44.0, -35.0, -64.0, -63.0, -42.0, -29.0, -64.0, -30.0, -64.0, -12.0, -38.0, -38.0, -64.0, 1.0, -63.0, -36.0, -13.0, -26.0, -64.0, -43.0, -64.0, -64.0, -64.0, -44.0, -25.0, 19.0, -39.0, -64.0, -31.0, -35.0, -31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3553817456008286, "mean_inference_ms": 18.695986510916924, "mean_action_processing_ms": 0.8169206713060768, "mean_env_wait_ms": 0.4788890164966787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6242532730102539, "StateBufferConnector_ms": 0.007436990737915039, "ViewRequirementAgentConnector_ms": 0.28279733657836914}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.55, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -17.0, -53.0, 36.0, -13.0, -64.0, -35.0, -5.0, -63.0, -64.0, -64.0, -63.0, 20.0, -64.0, -64.0, -46.0, -64.0, -50.0, 38.0, -27.0, -64.0, 5.0, -64.0, -31.0, -39.0, -64.0, -62.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, 14.0, -61.0, 36.0, 19.0, -47.0, -64.0, -10.0, 11.0, -40.0, 39.0, -33.0, -11.0, 28.0, -44.0, -64.0, -64.0, -64.0, -38.0, -63.0, -28.0, -42.0, 0.0, -64.0, -34.0, -33.0, -63.0, -51.0, -39.0, 27.0, -64.0, -16.0, -64.0, -64.0, -25.0, -36.0, -29.0, 44.0, -35.0, -64.0, -63.0, -42.0, -29.0, -64.0, -30.0, -64.0, -12.0, -38.0, -38.0, -64.0, 1.0, -63.0, -36.0, -13.0, -26.0, -64.0, -43.0, -64.0, -64.0, -64.0, -44.0, -25.0, 19.0, -39.0, -64.0, -31.0, -35.0, -31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3553817456008286, "mean_inference_ms": 18.695986510916924, "mean_action_processing_ms": 0.8169206713060768, "mean_env_wait_ms": 0.4788890164966787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6242532730102539, "StateBufferConnector_ms": 0.007436990737915039, "ViewRequirementAgentConnector_ms": 0.28279733657836914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67072, "num_agent_steps_trained": 67072, "num_env_steps_sampled": 67072, "num_env_steps_trained": 67072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0716643896961533, "num_agent_steps_trained_throughput_per_sec": 3.0716643896961533, "timesteps_total": 67072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 67072, "timers": {"training_iteration_time_ms": 159760.292, "sample_time_ms": 11853.301, "load_time_ms": 0.406, "load_throughput": 1261741.274, "learn_time_ms": 147906.017, "learn_throughput": 3.462, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 67072, "num_env_steps_trained": 67072, "num_agent_steps_sampled": 67072, "num_agent_steps_trained": 67072}, "done": false, "episodes_total": 4192, "training_iteration": 131, "trial_id": "6f959_00019", "date": "2024-02-28_20-54-34", "timestamp": 1709150074, "time_this_iter_s": 166.69541573524475, "time_total_s": 20773.020484924316, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20773.020484924316, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 57.06075949367088, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.27, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.193203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.193203125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8581191764834026, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.985349706808726, "policy_loss": -0.0035669234270850818, "vf_loss": 9.888583288590114, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 105.94171155293783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.27, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.27, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.193203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.193203125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, 14.0, -61.0, 36.0, 19.0, -47.0, -64.0, -10.0, 11.0, -40.0, 39.0, -33.0, -11.0, 28.0, -44.0, -64.0, -64.0, -64.0, -38.0, -63.0, -28.0, -42.0, 0.0, -64.0, -34.0, -33.0, -63.0, -51.0, -39.0, 27.0, -64.0, -16.0, -64.0, -64.0, -25.0, -36.0, -29.0, 44.0, -35.0, -64.0, -63.0, -42.0, -29.0, -64.0, -30.0, -64.0, -12.0, -38.0, -38.0, -64.0, 1.0, -63.0, -36.0, -13.0, -26.0, -64.0, -43.0, -64.0, -64.0, -64.0, -44.0, -25.0, 19.0, -39.0, -64.0, -31.0, -35.0, -31.0, -64.0, -20.0, -64.0, -39.0, -64.0, -64.0, -36.0, -64.0, -64.0, 1.0, -64.0, 31.0, -58.0, -64.0, -42.0, -37.0, -34.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -64.0, -39.0, -64.0, -64.0, -64.0, -64.0, -43.0, -64.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.356809101694787, "mean_inference_ms": 18.70707398583763, "mean_action_processing_ms": 0.8175328782283696, "mean_env_wait_ms": 0.4792278068999432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6272530555725098, "StateBufferConnector_ms": 0.007471799850463867, "ViewRequirementAgentConnector_ms": 0.2855703830718994}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.27, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, 14.0, -61.0, 36.0, 19.0, -47.0, -64.0, -10.0, 11.0, -40.0, 39.0, -33.0, -11.0, 28.0, -44.0, -64.0, -64.0, -64.0, -38.0, -63.0, -28.0, -42.0, 0.0, -64.0, -34.0, -33.0, -63.0, -51.0, -39.0, 27.0, -64.0, -16.0, -64.0, -64.0, -25.0, -36.0, -29.0, 44.0, -35.0, -64.0, -63.0, -42.0, -29.0, -64.0, -30.0, -64.0, -12.0, -38.0, -38.0, -64.0, 1.0, -63.0, -36.0, -13.0, -26.0, -64.0, -43.0, -64.0, -64.0, -64.0, -44.0, -25.0, 19.0, -39.0, -64.0, -31.0, -35.0, -31.0, -64.0, -20.0, -64.0, -39.0, -64.0, -64.0, -36.0, -64.0, -64.0, 1.0, -64.0, 31.0, -58.0, -64.0, -42.0, -37.0, -34.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -64.0, -39.0, -64.0, -64.0, -64.0, -64.0, -43.0, -64.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.356809101694787, "mean_inference_ms": 18.70707398583763, "mean_action_processing_ms": 0.8175328782283696, "mean_env_wait_ms": 0.4792278068999432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6272530555725098, "StateBufferConnector_ms": 0.007471799850463867, "ViewRequirementAgentConnector_ms": 0.2855703830718994}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9719302188017562, "num_agent_steps_trained_throughput_per_sec": 2.9719302188017562, "timesteps_total": 67584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 161118.169, "sample_time_ms": 11798.839, "load_time_ms": 0.406, "load_throughput": 1261593.025, "learn_time_ms": 149318.35, "learn_throughput": 3.429, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "done": false, "episodes_total": 4224, "training_iteration": 132, "trial_id": "6f959_00019", "date": "2024-02-28_20-57-26", "timestamp": 1709150246, "time_this_iter_s": 172.28911972045898, "time_total_s": 20945.309604644775, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20945.309604644775, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 57.11551020408163, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.51, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.175703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.175703125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9390887100249529, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.090691550572712, "policy_loss": 0.013284989865496755, "vf_loss": 9.985929838816325, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.68963845570882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 68096, "num_agent_steps_sampled": 68096, "num_agent_steps_trained": 68096}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.51, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.175703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.175703125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -25.0, -36.0, -29.0, 44.0, -35.0, -64.0, -63.0, -42.0, -29.0, -64.0, -30.0, -64.0, -12.0, -38.0, -38.0, -64.0, 1.0, -63.0, -36.0, -13.0, -26.0, -64.0, -43.0, -64.0, -64.0, -64.0, -44.0, -25.0, 19.0, -39.0, -64.0, -31.0, -35.0, -31.0, -64.0, -20.0, -64.0, -39.0, -64.0, -64.0, -36.0, -64.0, -64.0, 1.0, -64.0, 31.0, -58.0, -64.0, -42.0, -37.0, -34.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -64.0, -39.0, -64.0, -64.0, -64.0, -64.0, -43.0, -64.0, -35.0, -64.0, -37.0, -37.0, -22.0, -17.0, -64.0, -53.0, -28.0, -63.0, -31.0, 1.0, -64.0, -30.0, -39.0, -38.0, -36.0, -33.0, -29.0, -39.0, -64.0, -20.0, -28.0, 0.0, 24.0, -64.0, -45.0, -27.0, -64.0, -25.0, -23.0, -28.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3584363503006167, "mean_inference_ms": 18.718479368323138, "mean_action_processing_ms": 0.8181966385510716, "mean_env_wait_ms": 0.47958894670500785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6287543773651123, "StateBufferConnector_ms": 0.0075283050537109375, "ViewRequirementAgentConnector_ms": 0.28708481788635254}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -25.0, -36.0, -29.0, 44.0, -35.0, -64.0, -63.0, -42.0, -29.0, -64.0, -30.0, -64.0, -12.0, -38.0, -38.0, -64.0, 1.0, -63.0, -36.0, -13.0, -26.0, -64.0, -43.0, -64.0, -64.0, -64.0, -44.0, -25.0, 19.0, -39.0, -64.0, -31.0, -35.0, -31.0, -64.0, -20.0, -64.0, -39.0, -64.0, -64.0, -36.0, -64.0, -64.0, 1.0, -64.0, 31.0, -58.0, -64.0, -42.0, -37.0, -34.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -64.0, -39.0, -64.0, -64.0, -64.0, -64.0, -43.0, -64.0, -35.0, -64.0, -37.0, -37.0, -22.0, -17.0, -64.0, -53.0, -28.0, -63.0, -31.0, 1.0, -64.0, -30.0, -39.0, -38.0, -36.0, -33.0, -29.0, -39.0, -64.0, -20.0, -28.0, 0.0, 24.0, -64.0, -45.0, -27.0, -64.0, -25.0, -23.0, -28.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3584363503006167, "mean_inference_ms": 18.718479368323138, "mean_action_processing_ms": 0.8181966385510716, "mean_env_wait_ms": 0.47958894670500785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6287543773651123, "StateBufferConnector_ms": 0.0075283050537109375, "ViewRequirementAgentConnector_ms": 0.28708481788635254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68096, "num_agent_steps_trained": 68096, "num_env_steps_sampled": 68096, "num_env_steps_trained": 68096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9971114408515502, "num_agent_steps_trained_throughput_per_sec": 2.9971114408515502, "timesteps_total": 68096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 68096, "timers": {"training_iteration_time_ms": 162524.558, "sample_time_ms": 11975.861, "load_time_ms": 0.391, "load_throughput": 1308085.307, "learn_time_ms": 150547.739, "learn_throughput": 3.401, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 68096, "num_agent_steps_sampled": 68096, "num_agent_steps_trained": 68096}, "done": false, "episodes_total": 4256, "training_iteration": 133, "trial_id": "6f959_00019", "date": "2024-02-28_21-00-17", "timestamp": 1709150417, "time_this_iter_s": 170.84641098976135, "time_total_s": 21116.156015634537, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21116.156015634537, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 57.15165289256198, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -44.11, "reward_total_min": -64, "reward_total_max": 32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.155390625, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.711717424790065, "policy_loss": 0.15387366278252254, "vf_loss": 7.214193586508433, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 102.11216773986817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "sampler_results": {"episode_reward_max": 32.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -44.11, "reward_total_min": -64, "reward_total_max": 32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.155390625, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -31.0, -35.0, -31.0, -64.0, -20.0, -64.0, -39.0, -64.0, -64.0, -36.0, -64.0, -64.0, 1.0, -64.0, 31.0, -58.0, -64.0, -42.0, -37.0, -34.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -64.0, -39.0, -64.0, -64.0, -64.0, -64.0, -43.0, -64.0, -35.0, -64.0, -37.0, -37.0, -22.0, -17.0, -64.0, -53.0, -28.0, -63.0, -31.0, 1.0, -64.0, -30.0, -39.0, -38.0, -36.0, -33.0, -29.0, -39.0, -64.0, -20.0, -28.0, 0.0, 24.0, -64.0, -45.0, -27.0, -64.0, -25.0, -23.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, -39.0, -3.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -46.0, -64.0, -35.0, -64.0, 26.0, -38.0, -64.0, -64.0, -10.0, -64.0, -36.0, -64.0, -37.0, -1.0, -64.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.360796294536228, "mean_inference_ms": 18.73462659349613, "mean_action_processing_ms": 0.8191141760049387, "mean_env_wait_ms": 0.4800993030840338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6567673683166504, "StateBufferConnector_ms": 0.0077402591705322266, "ViewRequirementAgentConnector_ms": 0.29624438285827637}}, "episode_reward_max": 32.0, "episode_reward_min": -64.0, "episode_reward_mean": -44.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -31.0, -35.0, -31.0, -64.0, -20.0, -64.0, -39.0, -64.0, -64.0, -36.0, -64.0, -64.0, 1.0, -64.0, 31.0, -58.0, -64.0, -42.0, -37.0, -34.0, -64.0, -64.0, -64.0, -64.0, -30.0, -64.0, -64.0, -39.0, -64.0, -64.0, -64.0, -64.0, -43.0, -64.0, -35.0, -64.0, -37.0, -37.0, -22.0, -17.0, -64.0, -53.0, -28.0, -63.0, -31.0, 1.0, -64.0, -30.0, -39.0, -38.0, -36.0, -33.0, -29.0, -39.0, -64.0, -20.0, -28.0, 0.0, 24.0, -64.0, -45.0, -27.0, -64.0, -25.0, -23.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, -39.0, -3.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -46.0, -64.0, -35.0, -64.0, 26.0, -38.0, -64.0, -64.0, -10.0, -64.0, -36.0, -64.0, -37.0, -1.0, -64.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.360796294536228, "mean_inference_ms": 18.73462659349613, "mean_action_processing_ms": 0.8191141760049387, "mean_env_wait_ms": 0.4800993030840338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6567673683166504, "StateBufferConnector_ms": 0.0077402591705322266, "ViewRequirementAgentConnector_ms": 0.29624438285827637}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.036016614985094, "num_agent_steps_trained_throughput_per_sec": 3.036016614985094, "timesteps_total": 68608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 163894.645, "sample_time_ms": 12235.755, "load_time_ms": 0.416, "load_throughput": 1232203.149, "learn_time_ms": 151657.899, "learn_throughput": 3.376, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "done": false, "episodes_total": 4288, "training_iteration": 134, "trial_id": "6f959_00019", "date": "2024-02-28_21-03-06", "timestamp": 1709150586, "time_this_iter_s": 168.6522572040558, "time_total_s": 21284.808272838593, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21284.808272838593, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 57.20083682008368, "ram_util_percent": 17.900000000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.2, "reward_total_min": -64, "reward_total_max": 32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.19375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.949652265260617, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.95475161075592, "policy_loss": -0.017390839972843727, "vf_loss": 9.870130181312561, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 89.28944180806478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120}, "sampler_results": {"episode_reward_max": 32.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.2, "reward_total_min": -64, "reward_total_max": 32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.19375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -43.0, -64.0, -35.0, -64.0, -37.0, -37.0, -22.0, -17.0, -64.0, -53.0, -28.0, -63.0, -31.0, 1.0, -64.0, -30.0, -39.0, -38.0, -36.0, -33.0, -29.0, -39.0, -64.0, -20.0, -28.0, 0.0, 24.0, -64.0, -45.0, -27.0, -64.0, -25.0, -23.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, -39.0, -3.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -46.0, -64.0, -35.0, -64.0, 26.0, -38.0, -64.0, -64.0, -10.0, -64.0, -36.0, -64.0, -37.0, -1.0, -64.0, -35.0, -37.0, -64.0, 15.0, -64.0, 8.0, -64.0, 4.0, -35.0, -32.0, -31.0, -52.0, -29.0, -64.0, 9.0, -46.0, -41.0, -26.0, -64.0, -39.0, -39.0, -45.0, -64.0, -64.0, 5.0, -31.0, -28.0, -26.0, -51.0, 13.0, -33.0, -36.0, -10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3630519874092117, "mean_inference_ms": 18.750211843347632, "mean_action_processing_ms": 0.8199706042581769, "mean_env_wait_ms": 0.4805777513470245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.65102219581604, "StateBufferConnector_ms": 0.007650613784790039, "ViewRequirementAgentConnector_ms": 0.292492151260376}}, "episode_reward_max": 32.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -43.0, -64.0, -35.0, -64.0, -37.0, -37.0, -22.0, -17.0, -64.0, -53.0, -28.0, -63.0, -31.0, 1.0, -64.0, -30.0, -39.0, -38.0, -36.0, -33.0, -29.0, -39.0, -64.0, -20.0, -28.0, 0.0, 24.0, -64.0, -45.0, -27.0, -64.0, -25.0, -23.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, -39.0, -3.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -46.0, -64.0, -35.0, -64.0, 26.0, -38.0, -64.0, -64.0, -10.0, -64.0, -36.0, -64.0, -37.0, -1.0, -64.0, -35.0, -37.0, -64.0, 15.0, -64.0, 8.0, -64.0, 4.0, -35.0, -32.0, -31.0, -52.0, -29.0, -64.0, 9.0, -46.0, -41.0, -26.0, -64.0, -39.0, -39.0, -45.0, -64.0, -64.0, 5.0, -31.0, -28.0, -26.0, -51.0, 13.0, -33.0, -36.0, -10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3630519874092117, "mean_inference_ms": 18.750211843347632, "mean_action_processing_ms": 0.8199706042581769, "mean_env_wait_ms": 0.4805777513470245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.65102219581604, "StateBufferConnector_ms": 0.007650613784790039, "ViewRequirementAgentConnector_ms": 0.292492151260376}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120, "num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.188148031280663, "num_agent_steps_trained_throughput_per_sec": 3.188148031280663, "timesteps_total": 69120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 69120, "timers": {"training_iteration_time_ms": 164686.015, "sample_time_ms": 12342.134, "load_time_ms": 0.431, "load_throughput": 1186651.737, "learn_time_ms": 152342.861, "learn_throughput": 3.361, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120}, "done": false, "episodes_total": 4320, "training_iteration": 135, "trial_id": "6f959_00019", "date": "2024-02-28_21-05-47", "timestamp": 1709150747, "time_this_iter_s": 160.60554242134094, "time_total_s": 21445.413815259933, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21445.413815259933, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 56.886842105263156, "ram_util_percent": 18.038596491228066}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.8, "reward_total_min": -64, "reward_total_max": 32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.18125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.18125, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8232286094377438, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.048164228598276, "policy_loss": 0.0005371548992116004, "vf_loss": 9.953169763088226, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 101.92113030751547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "sampler_results": {"episode_reward_max": 32.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.8, "reward_total_min": -64, "reward_total_max": 32, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.18125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.18125, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-25.0, -23.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, -39.0, -3.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -46.0, -64.0, -35.0, -64.0, 26.0, -38.0, -64.0, -64.0, -10.0, -64.0, -36.0, -64.0, -37.0, -1.0, -64.0, -35.0, -37.0, -64.0, 15.0, -64.0, 8.0, -64.0, 4.0, -35.0, -32.0, -31.0, -52.0, -29.0, -64.0, 9.0, -46.0, -41.0, -26.0, -64.0, -39.0, -39.0, -45.0, -64.0, -64.0, 5.0, -31.0, -28.0, -26.0, -51.0, 13.0, -33.0, -36.0, -10.0, -64.0, -64.0, -64.0, -32.0, -19.0, -54.0, -36.0, -41.0, 1.0, 2.0, -64.0, -64.0, -44.0, -39.0, -64.0, -64.0, -55.0, -64.0, -64.0, -36.0, -32.0, -64.0, -32.0, -64.0, -64.0, -64.0, -64.0, -64.0, 5.0, 28.0, -64.0, 31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.365600277324579, "mean_inference_ms": 18.768560323396155, "mean_action_processing_ms": 0.820889034715666, "mean_env_wait_ms": 0.4811075468904532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6612505912780762, "StateBufferConnector_ms": 0.007725238800048828, "ViewRequirementAgentConnector_ms": 0.29566478729248047}}, "episode_reward_max": 32.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.0, -23.0, -28.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, -39.0, -3.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -46.0, -64.0, -35.0, -64.0, 26.0, -38.0, -64.0, -64.0, -10.0, -64.0, -36.0, -64.0, -37.0, -1.0, -64.0, -35.0, -37.0, -64.0, 15.0, -64.0, 8.0, -64.0, 4.0, -35.0, -32.0, -31.0, -52.0, -29.0, -64.0, 9.0, -46.0, -41.0, -26.0, -64.0, -39.0, -39.0, -45.0, -64.0, -64.0, 5.0, -31.0, -28.0, -26.0, -51.0, 13.0, -33.0, -36.0, -10.0, -64.0, -64.0, -64.0, -32.0, -19.0, -54.0, -36.0, -41.0, 1.0, 2.0, -64.0, -64.0, -44.0, -39.0, -64.0, -64.0, -55.0, -64.0, -64.0, -36.0, -32.0, -64.0, -32.0, -64.0, -64.0, -64.0, -64.0, -64.0, 5.0, 28.0, -64.0, 31.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.365600277324579, "mean_inference_ms": 18.768560323396155, "mean_action_processing_ms": 0.820889034715666, "mean_env_wait_ms": 0.4811075468904532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6612505912780762, "StateBufferConnector_ms": 0.007725238800048828, "ViewRequirementAgentConnector_ms": 0.29566478729248047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1161263652014988, "num_agent_steps_trained_throughput_per_sec": 3.1161263652014988, "timesteps_total": 69632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 164707.537, "sample_time_ms": 12519.66, "load_time_ms": 0.433, "load_throughput": 1183643.084, "learn_time_ms": 152186.865, "learn_throughput": 3.364, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "episodes_total": 4352, "training_iteration": 136, "trial_id": "6f959_00019", "date": "2024-02-28_21-08-31", "timestamp": 1709150911, "time_this_iter_s": 164.3174693584442, "time_total_s": 21609.731284618378, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21609.731284618378, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 57.090598290598294, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.58, "reward_total_min": -64, "reward_total_max": 31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19078125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7421875, "reward_score_mean": 0.19078125, "reward_score_min": 0.0, "reward_score_max": 0.7421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9265596135519445, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.91981551249822, "policy_loss": 0.011009634449146688, "vf_loss": 9.800454564889272, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 95.08477617899577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 70144, "num_env_steps_trained": 70144, "num_agent_steps_sampled": 70144, "num_agent_steps_trained": 70144}, "sampler_results": {"episode_reward_max": 31.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.58, "reward_total_min": -64, "reward_total_max": 31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19078125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7421875, "reward_score_mean": 0.19078125, "reward_score_min": 0.0, "reward_score_max": 0.7421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-37.0, -1.0, -64.0, -35.0, -37.0, -64.0, 15.0, -64.0, 8.0, -64.0, 4.0, -35.0, -32.0, -31.0, -52.0, -29.0, -64.0, 9.0, -46.0, -41.0, -26.0, -64.0, -39.0, -39.0, -45.0, -64.0, -64.0, 5.0, -31.0, -28.0, -26.0, -51.0, 13.0, -33.0, -36.0, -10.0, -64.0, -64.0, -64.0, -32.0, -19.0, -54.0, -36.0, -41.0, 1.0, 2.0, -64.0, -64.0, -44.0, -39.0, -64.0, -64.0, -55.0, -64.0, -64.0, -36.0, -32.0, -64.0, -32.0, -64.0, -64.0, -64.0, -64.0, -64.0, 5.0, 28.0, -64.0, 31.0, -39.0, -64.0, -64.0, 27.0, -15.0, -40.0, -64.0, -64.0, -42.0, -64.0, -50.0, -30.0, 10.0, -11.0, -64.0, -33.0, -64.0, -37.0, -29.0, -64.0, -64.0, -46.0, -44.0, 13.0, -64.0, -63.0, -64.0, -28.0, -64.0, -64.0, -49.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3667599830354735, "mean_inference_ms": 18.77719644023836, "mean_action_processing_ms": 0.8212679540058183, "mean_env_wait_ms": 0.48135067229858747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6188397407531738, "StateBufferConnector_ms": 0.007447719573974609, "ViewRequirementAgentConnector_ms": 0.2821640968322754}}, "episode_reward_max": 31.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.0, -1.0, -64.0, -35.0, -37.0, -64.0, 15.0, -64.0, 8.0, -64.0, 4.0, -35.0, -32.0, -31.0, -52.0, -29.0, -64.0, 9.0, -46.0, -41.0, -26.0, -64.0, -39.0, -39.0, -45.0, -64.0, -64.0, 5.0, -31.0, -28.0, -26.0, -51.0, 13.0, -33.0, -36.0, -10.0, -64.0, -64.0, -64.0, -32.0, -19.0, -54.0, -36.0, -41.0, 1.0, 2.0, -64.0, -64.0, -44.0, -39.0, -64.0, -64.0, -55.0, -64.0, -64.0, -36.0, -32.0, -64.0, -32.0, -64.0, -64.0, -64.0, -64.0, -64.0, 5.0, 28.0, -64.0, 31.0, -39.0, -64.0, -64.0, 27.0, -15.0, -40.0, -64.0, -64.0, -42.0, -64.0, -50.0, -30.0, 10.0, -11.0, -64.0, -33.0, -64.0, -37.0, -29.0, -64.0, -64.0, -46.0, -44.0, 13.0, -64.0, -63.0, -64.0, -28.0, -64.0, -64.0, -49.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3667599830354735, "mean_inference_ms": 18.77719644023836, "mean_action_processing_ms": 0.8212679540058183, "mean_env_wait_ms": 0.48135067229858747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6188397407531738, "StateBufferConnector_ms": 0.007447719573974609, "ViewRequirementAgentConnector_ms": 0.2821640968322754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70144, "num_agent_steps_trained": 70144, "num_env_steps_sampled": 70144, "num_env_steps_trained": 70144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0639270744933844, "num_agent_steps_trained_throughput_per_sec": 3.0639270744933844, "timesteps_total": 70144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 70144, "timers": {"training_iteration_time_ms": 165483.455, "sample_time_ms": 12463.886, "load_time_ms": 0.444, "load_throughput": 1153135.181, "learn_time_ms": 153018.533, "learn_throughput": 3.346, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 70144, "num_env_steps_trained": 70144, "num_agent_steps_sampled": 70144, "num_agent_steps_trained": 70144}, "done": false, "episodes_total": 4384, "training_iteration": 137, "trial_id": "6f959_00019", "date": "2024-02-28_21-11-18", "timestamp": 1709151078, "time_this_iter_s": 167.11741590499878, "time_total_s": 21776.848700523376, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21776.848700523376, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 57.04894514767932, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.02, "reward_total_min": -64, "reward_total_max": 31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7421875, "reward_score_mean": 0.17953125, "reward_score_min": 0.0, "reward_score_max": 0.7421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9177799983260532, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.055345491568248, "policy_loss": -0.0030187503434717655, "vf_loss": 9.96498155593872, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 87.868243598938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "sampler_results": {"episode_reward_max": 31.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.02, "reward_total_min": -64, "reward_total_max": 31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7421875, "reward_score_mean": 0.17953125, "reward_score_min": 0.0, "reward_score_max": 0.7421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [13.0, -33.0, -36.0, -10.0, -64.0, -64.0, -64.0, -32.0, -19.0, -54.0, -36.0, -41.0, 1.0, 2.0, -64.0, -64.0, -44.0, -39.0, -64.0, -64.0, -55.0, -64.0, -64.0, -36.0, -32.0, -64.0, -32.0, -64.0, -64.0, -64.0, -64.0, -64.0, 5.0, 28.0, -64.0, 31.0, -39.0, -64.0, -64.0, 27.0, -15.0, -40.0, -64.0, -64.0, -42.0, -64.0, -50.0, -30.0, 10.0, -11.0, -64.0, -33.0, -64.0, -37.0, -29.0, -64.0, -64.0, -46.0, -44.0, 13.0, -64.0, -63.0, -64.0, -28.0, -64.0, -64.0, -49.0, -45.0, -45.0, -46.0, -5.0, -40.0, -45.0, -8.0, -15.0, -64.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, 15.0, -64.0, -17.0, -8.0, 15.0, -35.0, -32.0, -18.0, -64.0, -64.0, -42.0, -64.0, -64.0, -30.0, -39.0, -38.0, -64.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.367704032383249, "mean_inference_ms": 18.783279092609696, "mean_action_processing_ms": 0.8215300510250786, "mean_env_wait_ms": 0.4815370850764005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6106605529785156, "StateBufferConnector_ms": 0.0074236392974853516, "ViewRequirementAgentConnector_ms": 0.280733585357666}}, "episode_reward_max": 31.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.0, -33.0, -36.0, -10.0, -64.0, -64.0, -64.0, -32.0, -19.0, -54.0, -36.0, -41.0, 1.0, 2.0, -64.0, -64.0, -44.0, -39.0, -64.0, -64.0, -55.0, -64.0, -64.0, -36.0, -32.0, -64.0, -32.0, -64.0, -64.0, -64.0, -64.0, -64.0, 5.0, 28.0, -64.0, 31.0, -39.0, -64.0, -64.0, 27.0, -15.0, -40.0, -64.0, -64.0, -42.0, -64.0, -50.0, -30.0, 10.0, -11.0, -64.0, -33.0, -64.0, -37.0, -29.0, -64.0, -64.0, -46.0, -44.0, 13.0, -64.0, -63.0, -64.0, -28.0, -64.0, -64.0, -49.0, -45.0, -45.0, -46.0, -5.0, -40.0, -45.0, -8.0, -15.0, -64.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, 15.0, -64.0, -17.0, -8.0, 15.0, -35.0, -32.0, -18.0, -64.0, -64.0, -42.0, -64.0, -64.0, -30.0, -39.0, -38.0, -64.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.367704032383249, "mean_inference_ms": 18.783279092609696, "mean_action_processing_ms": 0.8215300510250786, "mean_env_wait_ms": 0.4815370850764005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6106605529785156, "StateBufferConnector_ms": 0.0074236392974853516, "ViewRequirementAgentConnector_ms": 0.280733585357666}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1268058231023224, "num_agent_steps_trained_throughput_per_sec": 3.1268058231023224, "timesteps_total": 70656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 165637.812, "sample_time_ms": 12290.765, "load_time_ms": 0.436, "load_throughput": 1174001.557, "learn_time_ms": 153346.011, "learn_throughput": 3.339, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "done": false, "episodes_total": 4416, "training_iteration": 138, "trial_id": "6f959_00019", "date": "2024-02-28_21-14-02", "timestamp": 1709151242, "time_this_iter_s": 163.75612235069275, "time_total_s": 21940.60482287407, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21940.60482287407, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 57.13965517241379, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.09, "reward_total_min": -64, "reward_total_max": 31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.194609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7421875, "reward_score_mean": 0.194609375, "reward_score_min": 0.0, "reward_score_max": 0.7421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9174356007948518, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.004205969969432, "policy_loss": 0.0006497915058086316, "vf_loss": 9.904688048362733, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 88.28245779673259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 71168, "num_env_steps_trained": 71168, "num_agent_steps_sampled": 71168, "num_agent_steps_trained": 71168}, "sampler_results": {"episode_reward_max": 31.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.09, "reward_total_min": -64, "reward_total_max": 31, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.194609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7421875, "reward_score_mean": 0.194609375, "reward_score_min": 0.0, "reward_score_max": 0.7421875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [5.0, 28.0, -64.0, 31.0, -39.0, -64.0, -64.0, 27.0, -15.0, -40.0, -64.0, -64.0, -42.0, -64.0, -50.0, -30.0, 10.0, -11.0, -64.0, -33.0, -64.0, -37.0, -29.0, -64.0, -64.0, -46.0, -44.0, 13.0, -64.0, -63.0, -64.0, -28.0, -64.0, -64.0, -49.0, -45.0, -45.0, -46.0, -5.0, -40.0, -45.0, -8.0, -15.0, -64.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, 15.0, -64.0, -17.0, -8.0, 15.0, -35.0, -32.0, -18.0, -64.0, -64.0, -42.0, -64.0, -64.0, -30.0, -39.0, -38.0, -64.0, -51.0, 19.0, -64.0, -22.0, -37.0, -28.0, -45.0, -25.0, -64.0, -44.0, -27.0, -64.0, -39.0, -30.0, -45.0, -64.0, 11.0, -64.0, -47.0, -64.0, -42.0, -46.0, -64.0, -1.0, -64.0, 10.0, -19.0, -64.0, -64.0, -32.0, -46.0, -33.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.367834060681468, "mean_inference_ms": 18.782747673587775, "mean_action_processing_ms": 0.8214948818460391, "mean_env_wait_ms": 0.4815605148479186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5684428215026855, "StateBufferConnector_ms": 0.007102251052856445, "ViewRequirementAgentConnector_ms": 0.2683546543121338}}, "episode_reward_max": 31.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.0, 28.0, -64.0, 31.0, -39.0, -64.0, -64.0, 27.0, -15.0, -40.0, -64.0, -64.0, -42.0, -64.0, -50.0, -30.0, 10.0, -11.0, -64.0, -33.0, -64.0, -37.0, -29.0, -64.0, -64.0, -46.0, -44.0, 13.0, -64.0, -63.0, -64.0, -28.0, -64.0, -64.0, -49.0, -45.0, -45.0, -46.0, -5.0, -40.0, -45.0, -8.0, -15.0, -64.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, 15.0, -64.0, -17.0, -8.0, 15.0, -35.0, -32.0, -18.0, -64.0, -64.0, -42.0, -64.0, -64.0, -30.0, -39.0, -38.0, -64.0, -51.0, 19.0, -64.0, -22.0, -37.0, -28.0, -45.0, -25.0, -64.0, -44.0, -27.0, -64.0, -39.0, -30.0, -45.0, -64.0, 11.0, -64.0, -47.0, -64.0, -42.0, -46.0, -64.0, -1.0, -64.0, 10.0, -19.0, -64.0, -64.0, -32.0, -46.0, -33.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.367834060681468, "mean_inference_ms": 18.782747673587775, "mean_action_processing_ms": 0.8214948818460391, "mean_env_wait_ms": 0.4815605148479186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5684428215026855, "StateBufferConnector_ms": 0.007102251052856445, "ViewRequirementAgentConnector_ms": 0.2683546543121338}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71168, "num_agent_steps_trained": 71168, "num_env_steps_sampled": 71168, "num_env_steps_trained": 71168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.064038638336511, "num_agent_steps_trained_throughput_per_sec": 3.064038638336511, "timesteps_total": 71168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 71168, "timers": {"training_iteration_time_ms": 166331.089, "sample_time_ms": 12371.55, "load_time_ms": 0.461, "load_throughput": 1110212.298, "learn_time_ms": 153958.462, "learn_throughput": 3.326, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 71168, "num_env_steps_trained": 71168, "num_agent_steps_sampled": 71168, "num_agent_steps_trained": 71168}, "done": false, "episodes_total": 4448, "training_iteration": 139, "trial_id": "6f959_00019", "date": "2024-02-28_21-16-49", "timestamp": 1709151409, "time_this_iter_s": 167.12082195281982, "time_total_s": 22107.72564482689, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22107.72564482689, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 57.1701680672269, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.64, "reward_total_min": -64, "reward_total_max": 20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1825, "reward_percentile_min": 0.0, "reward_percentile_max": 0.65625, "reward_score_mean": 0.1825, "reward_score_min": 0.0, "reward_score_max": 0.65625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9467445589601994, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.023057905832927, "policy_loss": 0.022463915497064592, "vf_loss": 9.901429283618928, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 90.74555314381918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "sampler_results": {"episode_reward_max": 20.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.64, "reward_total_min": -64, "reward_total_max": 20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1825, "reward_percentile_min": 0.0, "reward_percentile_max": 0.65625, "reward_score_mean": 0.1825, "reward_score_min": 0.0, "reward_score_max": 0.65625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -49.0, -45.0, -45.0, -46.0, -5.0, -40.0, -45.0, -8.0, -15.0, -64.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, 15.0, -64.0, -17.0, -8.0, 15.0, -35.0, -32.0, -18.0, -64.0, -64.0, -42.0, -64.0, -64.0, -30.0, -39.0, -38.0, -64.0, -51.0, 19.0, -64.0, -22.0, -37.0, -28.0, -45.0, -25.0, -64.0, -44.0, -27.0, -64.0, -39.0, -30.0, -45.0, -64.0, 11.0, -64.0, -47.0, -64.0, -42.0, -46.0, -64.0, -1.0, -64.0, 10.0, -19.0, -64.0, -64.0, -32.0, -46.0, -33.0, -42.0, -63.0, -64.0, -14.0, -64.0, -46.0, -17.0, -64.0, -26.0, -10.0, -28.0, -64.0, 20.0, -64.0, -64.0, -38.0, -2.0, -22.0, -26.0, -64.0, -17.0, -24.0, -64.0, -64.0, -64.0, -31.0, -28.0, -64.0, -32.0, -64.0, -47.0, -64.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.367912941983089, "mean_inference_ms": 18.78198163263708, "mean_action_processing_ms": 0.8214532823222784, "mean_env_wait_ms": 0.4815914644239174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5801498889923096, "StateBufferConnector_ms": 0.007180690765380859, "ViewRequirementAgentConnector_ms": 0.2712900638580322}}, "episode_reward_max": 20.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -49.0, -45.0, -45.0, -46.0, -5.0, -40.0, -45.0, -8.0, -15.0, -64.0, -24.0, -64.0, -64.0, -64.0, -64.0, -64.0, 15.0, -64.0, -17.0, -8.0, 15.0, -35.0, -32.0, -18.0, -64.0, -64.0, -42.0, -64.0, -64.0, -30.0, -39.0, -38.0, -64.0, -51.0, 19.0, -64.0, -22.0, -37.0, -28.0, -45.0, -25.0, -64.0, -44.0, -27.0, -64.0, -39.0, -30.0, -45.0, -64.0, 11.0, -64.0, -47.0, -64.0, -42.0, -46.0, -64.0, -1.0, -64.0, 10.0, -19.0, -64.0, -64.0, -32.0, -46.0, -33.0, -42.0, -63.0, -64.0, -14.0, -64.0, -46.0, -17.0, -64.0, -26.0, -10.0, -28.0, -64.0, 20.0, -64.0, -64.0, -38.0, -2.0, -22.0, -26.0, -64.0, -17.0, -24.0, -64.0, -64.0, -64.0, -31.0, -28.0, -64.0, -32.0, -64.0, -47.0, -64.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.367912941983089, "mean_inference_ms": 18.78198163263708, "mean_action_processing_ms": 0.8214532823222784, "mean_env_wait_ms": 0.4815914644239174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5801498889923096, "StateBufferConnector_ms": 0.007180690765380859, "ViewRequirementAgentConnector_ms": 0.2712900638580322}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.166036482270708, "num_agent_steps_trained_throughput_per_sec": 3.166036482270708, "timesteps_total": 71680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 166300.492, "sample_time_ms": 12205.299, "load_time_ms": 0.475, "load_throughput": 1078866.44, "learn_time_ms": 154094.105, "learn_throughput": 3.323, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "episodes_total": 4480, "training_iteration": 140, "trial_id": "6f959_00019", "date": "2024-02-28_21-19-31", "timestamp": 1709151571, "time_this_iter_s": 161.72717118263245, "time_total_s": 22269.45281600952, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22269.45281600952, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 57.071615720524015, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.6, "reward_total_min": -64, "reward_total_max": 20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.65625, "reward_score_mean": 0.1828125, "reward_score_min": 0.0, "reward_score_max": 0.65625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 7.623193244139354, "policy_loss": 0.19515683675029624, "vf_loss": 8.17148034175237, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.97500381469726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 72192, "num_env_steps_trained": 72192, "num_agent_steps_sampled": 72192, "num_agent_steps_trained": 72192}, "sampler_results": {"episode_reward_max": 20.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.6, "reward_total_min": -64, "reward_total_max": 20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1828125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.65625, "reward_score_mean": 0.1828125, "reward_score_min": 0.0, "reward_score_max": 0.65625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-39.0, -38.0, -64.0, -51.0, 19.0, -64.0, -22.0, -37.0, -28.0, -45.0, -25.0, -64.0, -44.0, -27.0, -64.0, -39.0, -30.0, -45.0, -64.0, 11.0, -64.0, -47.0, -64.0, -42.0, -46.0, -64.0, -1.0, -64.0, 10.0, -19.0, -64.0, -64.0, -32.0, -46.0, -33.0, -42.0, -63.0, -64.0, -14.0, -64.0, -46.0, -17.0, -64.0, -26.0, -10.0, -28.0, -64.0, 20.0, -64.0, -64.0, -38.0, -2.0, -22.0, -26.0, -64.0, -17.0, -24.0, -64.0, -64.0, -64.0, -31.0, -28.0, -64.0, -32.0, -64.0, -47.0, -64.0, -33.0, -38.0, -8.0, -64.0, -33.0, -38.0, -42.0, -64.0, -63.0, -22.0, -64.0, 0.0, -63.0, -64.0, -60.0, -64.0, -21.0, -63.0, -64.0, -63.0, -34.0, -17.0, -9.0, -7.0, -23.0, -50.0, -64.0, -62.0, -48.0, -12.0, -29.0, -24.0, -25.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.369647920396289, "mean_inference_ms": 18.792838823887415, "mean_action_processing_ms": 0.8220440400891772, "mean_env_wait_ms": 0.48196328756392753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6494705677032471, "StateBufferConnector_ms": 0.007666826248168945, "ViewRequirementAgentConnector_ms": 0.2925748825073242}}, "episode_reward_max": 20.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.0, -38.0, -64.0, -51.0, 19.0, -64.0, -22.0, -37.0, -28.0, -45.0, -25.0, -64.0, -44.0, -27.0, -64.0, -39.0, -30.0, -45.0, -64.0, 11.0, -64.0, -47.0, -64.0, -42.0, -46.0, -64.0, -1.0, -64.0, 10.0, -19.0, -64.0, -64.0, -32.0, -46.0, -33.0, -42.0, -63.0, -64.0, -14.0, -64.0, -46.0, -17.0, -64.0, -26.0, -10.0, -28.0, -64.0, 20.0, -64.0, -64.0, -38.0, -2.0, -22.0, -26.0, -64.0, -17.0, -24.0, -64.0, -64.0, -64.0, -31.0, -28.0, -64.0, -32.0, -64.0, -47.0, -64.0, -33.0, -38.0, -8.0, -64.0, -33.0, -38.0, -42.0, -64.0, -63.0, -22.0, -64.0, 0.0, -63.0, -64.0, -60.0, -64.0, -21.0, -63.0, -64.0, -63.0, -34.0, -17.0, -9.0, -7.0, -23.0, -50.0, -64.0, -62.0, -48.0, -12.0, -29.0, -24.0, -25.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.369647920396289, "mean_inference_ms": 18.792838823887415, "mean_action_processing_ms": 0.8220440400891772, "mean_env_wait_ms": 0.48196328756392753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6494705677032471, "StateBufferConnector_ms": 0.007666826248168945, "ViewRequirementAgentConnector_ms": 0.2925748825073242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72192, "num_agent_steps_trained": 72192, "num_env_steps_sampled": 72192, "num_env_steps_trained": 72192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.242267848698877, "num_agent_steps_trained_throughput_per_sec": 3.242267848698877, "timesteps_total": 72192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 72192, "timers": {"training_iteration_time_ms": 165423.421, "sample_time_ms": 12423.372, "load_time_ms": 0.474, "load_throughput": 1080005.858, "learn_time_ms": 152998.955, "learn_throughput": 3.346, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 72192, "num_env_steps_trained": 72192, "num_agent_steps_sampled": 72192, "num_agent_steps_trained": 72192}, "done": false, "episodes_total": 4512, "training_iteration": 141, "trial_id": "6f959_00019", "date": "2024-02-28_21-22-10", "timestamp": 1709151730, "time_this_iter_s": 157.9245581626892, "time_total_s": 22427.37737417221, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22427.37737417221, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 57.153539823008856, "ram_util_percent": 17.90132743362832}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.07, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.210390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.210390625, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9933345143993696, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.009989746411641, "policy_loss": -0.0012360191283126672, "vf_loss": 9.913125252723693, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 83.6835486094157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.07, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.07, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.210390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.210390625, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-32.0, -46.0, -33.0, -42.0, -63.0, -64.0, -14.0, -64.0, -46.0, -17.0, -64.0, -26.0, -10.0, -28.0, -64.0, 20.0, -64.0, -64.0, -38.0, -2.0, -22.0, -26.0, -64.0, -17.0, -24.0, -64.0, -64.0, -64.0, -31.0, -28.0, -64.0, -32.0, -64.0, -47.0, -64.0, -33.0, -38.0, -8.0, -64.0, -33.0, -38.0, -42.0, -64.0, -63.0, -22.0, -64.0, 0.0, -63.0, -64.0, -60.0, -64.0, -21.0, -63.0, -64.0, -63.0, -34.0, -17.0, -9.0, -7.0, -23.0, -50.0, -64.0, -62.0, -48.0, -12.0, -29.0, -24.0, -25.0, -44.0, -17.0, -63.0, -64.0, -19.0, -39.0, 17.0, -4.0, -23.0, -34.0, -23.0, -24.0, -17.0, -42.0, -26.0, -19.0, 44.0, -63.0, -64.0, -63.0, -64.0, -17.0, -15.0, -8.0, -25.0, -64.0, -19.0, -46.0, -31.0, -4.0, 7.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.370971049960625, "mean_inference_ms": 18.801602740219256, "mean_action_processing_ms": 0.8225627323641773, "mean_env_wait_ms": 0.48226929094141474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6295332908630371, "StateBufferConnector_ms": 0.007494688034057617, "ViewRequirementAgentConnector_ms": 0.28578901290893555}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.07, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.0, -46.0, -33.0, -42.0, -63.0, -64.0, -14.0, -64.0, -46.0, -17.0, -64.0, -26.0, -10.0, -28.0, -64.0, 20.0, -64.0, -64.0, -38.0, -2.0, -22.0, -26.0, -64.0, -17.0, -24.0, -64.0, -64.0, -64.0, -31.0, -28.0, -64.0, -32.0, -64.0, -47.0, -64.0, -33.0, -38.0, -8.0, -64.0, -33.0, -38.0, -42.0, -64.0, -63.0, -22.0, -64.0, 0.0, -63.0, -64.0, -60.0, -64.0, -21.0, -63.0, -64.0, -63.0, -34.0, -17.0, -9.0, -7.0, -23.0, -50.0, -64.0, -62.0, -48.0, -12.0, -29.0, -24.0, -25.0, -44.0, -17.0, -63.0, -64.0, -19.0, -39.0, 17.0, -4.0, -23.0, -34.0, -23.0, -24.0, -17.0, -42.0, -26.0, -19.0, 44.0, -63.0, -64.0, -63.0, -64.0, -17.0, -15.0, -8.0, -25.0, -64.0, -19.0, -46.0, -31.0, -4.0, 7.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.370971049960625, "mean_inference_ms": 18.801602740219256, "mean_action_processing_ms": 0.8225627323641773, "mean_env_wait_ms": 0.48226929094141474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6295332908630371, "StateBufferConnector_ms": 0.007494688034057617, "ViewRequirementAgentConnector_ms": 0.28578901290893555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.951131717540845, "num_agent_steps_trained_throughput_per_sec": 2.951131717540845, "timesteps_total": 72704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 165544.836, "sample_time_ms": 12345.344, "load_time_ms": 0.471, "load_throughput": 1087333.493, "learn_time_ms": 153198.398, "learn_throughput": 3.342, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "done": false, "episodes_total": 4544, "training_iteration": 142, "trial_id": "6f959_00019", "date": "2024-02-28_21-25-04", "timestamp": 1709151904, "time_this_iter_s": 173.50816750526428, "time_total_s": 22600.885541677475, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22600.885541677475, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 56.70647773279352, "ram_util_percent": 18.04048582995951}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -36.71, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.213203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.213203125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9576329660912355, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.866501466433208, "policy_loss": 0.0938645369062821, "vf_loss": 9.650656871000926, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 80.38697427113851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 73216, "num_env_steps_trained": 73216, "num_agent_steps_sampled": 73216, "num_agent_steps_trained": 73216}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.71, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -36.71, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.213203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.213203125, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -47.0, -64.0, -33.0, -38.0, -8.0, -64.0, -33.0, -38.0, -42.0, -64.0, -63.0, -22.0, -64.0, 0.0, -63.0, -64.0, -60.0, -64.0, -21.0, -63.0, -64.0, -63.0, -34.0, -17.0, -9.0, -7.0, -23.0, -50.0, -64.0, -62.0, -48.0, -12.0, -29.0, -24.0, -25.0, -44.0, -17.0, -63.0, -64.0, -19.0, -39.0, 17.0, -4.0, -23.0, -34.0, -23.0, -24.0, -17.0, -42.0, -26.0, -19.0, 44.0, -63.0, -64.0, -63.0, -64.0, -17.0, -15.0, -8.0, -25.0, -64.0, -19.0, -46.0, -31.0, -4.0, 7.0, -63.0, -46.0, -24.0, -64.0, -47.0, -64.0, -40.0, 33.0, -11.0, -64.0, -39.0, -41.0, -3.0, -64.0, -47.0, -64.0, -21.0, -21.0, -45.0, -64.0, -64.0, -64.0, 8.0, -55.0, -44.0, -43.0, -6.0, -64.0, -14.0, -42.0, -43.0, -10.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3720431989634347, "mean_inference_ms": 18.80891687495849, "mean_action_processing_ms": 0.8230348586629584, "mean_env_wait_ms": 0.48252527750668917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6098172664642334, "StateBufferConnector_ms": 0.007380247116088867, "ViewRequirementAgentConnector_ms": 0.2826237678527832}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.71, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -47.0, -64.0, -33.0, -38.0, -8.0, -64.0, -33.0, -38.0, -42.0, -64.0, -63.0, -22.0, -64.0, 0.0, -63.0, -64.0, -60.0, -64.0, -21.0, -63.0, -64.0, -63.0, -34.0, -17.0, -9.0, -7.0, -23.0, -50.0, -64.0, -62.0, -48.0, -12.0, -29.0, -24.0, -25.0, -44.0, -17.0, -63.0, -64.0, -19.0, -39.0, 17.0, -4.0, -23.0, -34.0, -23.0, -24.0, -17.0, -42.0, -26.0, -19.0, 44.0, -63.0, -64.0, -63.0, -64.0, -17.0, -15.0, -8.0, -25.0, -64.0, -19.0, -46.0, -31.0, -4.0, 7.0, -63.0, -46.0, -24.0, -64.0, -47.0, -64.0, -40.0, 33.0, -11.0, -64.0, -39.0, -41.0, -3.0, -64.0, -47.0, -64.0, -21.0, -21.0, -45.0, -64.0, -64.0, -64.0, 8.0, -55.0, -44.0, -43.0, -6.0, -64.0, -14.0, -42.0, -43.0, -10.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3720431989634347, "mean_inference_ms": 18.80891687495849, "mean_action_processing_ms": 0.8230348586629584, "mean_env_wait_ms": 0.48252527750668917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6098172664642334, "StateBufferConnector_ms": 0.007380247116088867, "ViewRequirementAgentConnector_ms": 0.2826237678527832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73216, "num_agent_steps_trained": 73216, "num_env_steps_sampled": 73216, "num_env_steps_trained": 73216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1697162422730916, "num_agent_steps_trained_throughput_per_sec": 3.1697162422730916, "timesteps_total": 73216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73216, "timers": {"training_iteration_time_ms": 164614.586, "sample_time_ms": 12152.293, "load_time_ms": 0.509, "load_throughput": 1005282.112, "learn_time_ms": 152461.156, "learn_throughput": 3.358, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 73216, "num_env_steps_trained": 73216, "num_agent_steps_sampled": 73216, "num_agent_steps_trained": 73216}, "done": false, "episodes_total": 4576, "training_iteration": 143, "trial_id": "6f959_00019", "date": "2024-02-28_21-27-45", "timestamp": 1709152065, "time_this_iter_s": 161.54632210731506, "time_total_s": 22762.43186378479, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22762.43186378479, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 57.161572052401745, "ram_util_percent": 18.000873362445414}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -36.81, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.212421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.212421875, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9248815583297982, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.021485070387522, "policy_loss": 0.0050502608840664225, "vf_loss": 9.918855651219685, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 83.7507371266683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -36.81, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.212421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.212421875, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-12.0, -29.0, -24.0, -25.0, -44.0, -17.0, -63.0, -64.0, -19.0, -39.0, 17.0, -4.0, -23.0, -34.0, -23.0, -24.0, -17.0, -42.0, -26.0, -19.0, 44.0, -63.0, -64.0, -63.0, -64.0, -17.0, -15.0, -8.0, -25.0, -64.0, -19.0, -46.0, -31.0, -4.0, 7.0, -63.0, -46.0, -24.0, -64.0, -47.0, -64.0, -40.0, 33.0, -11.0, -64.0, -39.0, -41.0, -3.0, -64.0, -47.0, -64.0, -21.0, -21.0, -45.0, -64.0, -64.0, -64.0, 8.0, -55.0, -44.0, -43.0, -6.0, -64.0, -14.0, -42.0, -43.0, -10.0, -48.0, 22.0, -63.0, -64.0, -64.0, -64.0, -18.0, -32.0, -64.0, -13.0, -52.0, -16.0, -64.0, -48.0, -57.0, -45.0, -64.0, -64.0, -64.0, -64.0, -3.0, -64.0, -63.0, 24.0, -10.0, -64.0, -6.0, -64.0, -54.0, -36.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3713288006195317, "mean_inference_ms": 18.804285532905627, "mean_action_processing_ms": 0.822867477843698, "mean_env_wait_ms": 0.4824223113151976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5294630527496338, "StateBufferConnector_ms": 0.006815910339355469, "ViewRequirementAgentConnector_ms": 0.25950098037719727}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.0, -29.0, -24.0, -25.0, -44.0, -17.0, -63.0, -64.0, -19.0, -39.0, 17.0, -4.0, -23.0, -34.0, -23.0, -24.0, -17.0, -42.0, -26.0, -19.0, 44.0, -63.0, -64.0, -63.0, -64.0, -17.0, -15.0, -8.0, -25.0, -64.0, -19.0, -46.0, -31.0, -4.0, 7.0, -63.0, -46.0, -24.0, -64.0, -47.0, -64.0, -40.0, 33.0, -11.0, -64.0, -39.0, -41.0, -3.0, -64.0, -47.0, -64.0, -21.0, -21.0, -45.0, -64.0, -64.0, -64.0, 8.0, -55.0, -44.0, -43.0, -6.0, -64.0, -14.0, -42.0, -43.0, -10.0, -48.0, 22.0, -63.0, -64.0, -64.0, -64.0, -18.0, -32.0, -64.0, -13.0, -52.0, -16.0, -64.0, -48.0, -57.0, -45.0, -64.0, -64.0, -64.0, -64.0, -3.0, -64.0, -63.0, 24.0, -10.0, -64.0, -6.0, -64.0, -54.0, -36.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3713288006195317, "mean_inference_ms": 18.804285532905627, "mean_action_processing_ms": 0.822867477843698, "mean_env_wait_ms": 0.4824223113151976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5294630527496338, "StateBufferConnector_ms": 0.006815910339355469, "ViewRequirementAgentConnector_ms": 0.25950098037719727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.067367464127432, "num_agent_steps_trained_throughput_per_sec": 3.067367464127432, "timesteps_total": 73728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 164442.217, "sample_time_ms": 11857.92, "load_time_ms": 0.483, "load_throughput": 1060538.124, "learn_time_ms": 152583.181, "learn_throughput": 3.356, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "episodes_total": 4608, "training_iteration": 144, "trial_id": "6f959_00019", "date": "2024-02-28_21-30-33", "timestamp": 1709152233, "time_this_iter_s": 166.9341905117035, "time_total_s": 22929.366054296494, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22929.366054296494, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 57.52226890756303, "ram_util_percent": 17.630672268907556}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -38.91, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.196015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.196015625, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9355023711919784, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.984886427720388, "policy_loss": 0.04150574013280372, "vf_loss": 9.838489723205566, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 78.79841086069743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240}, "sampler_results": {"episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -38.91, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -38.91, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.196015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.196015625, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-31.0, -4.0, 7.0, -63.0, -46.0, -24.0, -64.0, -47.0, -64.0, -40.0, 33.0, -11.0, -64.0, -39.0, -41.0, -3.0, -64.0, -47.0, -64.0, -21.0, -21.0, -45.0, -64.0, -64.0, -64.0, 8.0, -55.0, -44.0, -43.0, -6.0, -64.0, -14.0, -42.0, -43.0, -10.0, -48.0, 22.0, -63.0, -64.0, -64.0, -64.0, -18.0, -32.0, -64.0, -13.0, -52.0, -16.0, -64.0, -48.0, -57.0, -45.0, -64.0, -64.0, -64.0, -64.0, -3.0, -64.0, -63.0, 24.0, -10.0, -64.0, -6.0, -64.0, -54.0, -36.0, -64.0, -64.0, -64.0, -4.0, 42.0, -64.0, -14.0, -44.0, -10.0, -26.0, -64.0, -19.0, -64.0, -64.0, -41.0, -43.0, -1.0, -43.0, 28.0, -64.0, -27.0, -64.0, -64.0, -8.0, -50.0, -64.0, -45.0, -64.0, -64.0, -64.0, 6.0, -16.0, -51.0, -64.0, -11.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3715753797493178, "mean_inference_ms": 18.805829717130397, "mean_action_processing_ms": 0.8230037352458797, "mean_env_wait_ms": 0.48250400235105856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.583613395690918, "StateBufferConnector_ms": 0.0071904659271240234, "ViewRequirementAgentConnector_ms": 0.2765657901763916}}, "episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -38.91, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.0, -4.0, 7.0, -63.0, -46.0, -24.0, -64.0, -47.0, -64.0, -40.0, 33.0, -11.0, -64.0, -39.0, -41.0, -3.0, -64.0, -47.0, -64.0, -21.0, -21.0, -45.0, -64.0, -64.0, -64.0, 8.0, -55.0, -44.0, -43.0, -6.0, -64.0, -14.0, -42.0, -43.0, -10.0, -48.0, 22.0, -63.0, -64.0, -64.0, -64.0, -18.0, -32.0, -64.0, -13.0, -52.0, -16.0, -64.0, -48.0, -57.0, -45.0, -64.0, -64.0, -64.0, -64.0, -3.0, -64.0, -63.0, 24.0, -10.0, -64.0, -6.0, -64.0, -54.0, -36.0, -64.0, -64.0, -64.0, -4.0, 42.0, -64.0, -14.0, -44.0, -10.0, -26.0, -64.0, -19.0, -64.0, -64.0, -41.0, -43.0, -1.0, -43.0, 28.0, -64.0, -27.0, -64.0, -64.0, -8.0, -50.0, -64.0, -45.0, -64.0, -64.0, -64.0, 6.0, -16.0, -51.0, -64.0, -11.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3715753797493178, "mean_inference_ms": 18.805829717130397, "mean_action_processing_ms": 0.8230037352458797, "mean_env_wait_ms": 0.48250400235105856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.583613395690918, "StateBufferConnector_ms": 0.0071904659271240234, "ViewRequirementAgentConnector_ms": 0.2765657901763916}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240, "num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2994191555351766, "num_agent_steps_trained_throughput_per_sec": 3.2994191555351766, "timesteps_total": 74240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 74240, "timers": {"training_iteration_time_ms": 163900.621, "sample_time_ms": 12005.563, "load_time_ms": 0.468, "load_throughput": 1093534.804, "learn_time_ms": 151893.957, "learn_throughput": 3.371, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240}, "done": false, "episodes_total": 4640, "training_iteration": 145, "trial_id": "6f959_00019", "date": "2024-02-28_21-33-08", "timestamp": 1709152388, "time_this_iter_s": 155.19991278648376, "time_total_s": 23084.565967082977, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23084.565967082977, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 57.23318181818181, "ram_util_percent": 17.564999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.88, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2040625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.2040625, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8882455493013064, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.949883397420248, "policy_loss": 0.057398763679278396, "vf_loss": 9.782499758402507, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 76.53040135701498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "sampler_results": {"episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.88, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2040625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.2040625, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -43.0, -10.0, -48.0, 22.0, -63.0, -64.0, -64.0, -64.0, -18.0, -32.0, -64.0, -13.0, -52.0, -16.0, -64.0, -48.0, -57.0, -45.0, -64.0, -64.0, -64.0, -64.0, -3.0, -64.0, -63.0, 24.0, -10.0, -64.0, -6.0, -64.0, -54.0, -36.0, -64.0, -64.0, -64.0, -4.0, 42.0, -64.0, -14.0, -44.0, -10.0, -26.0, -64.0, -19.0, -64.0, -64.0, -41.0, -43.0, -1.0, -43.0, 28.0, -64.0, -27.0, -64.0, -64.0, -8.0, -50.0, -64.0, -45.0, -64.0, -64.0, -64.0, 6.0, -16.0, -51.0, -64.0, -11.0, -49.0, -64.0, 42.0, -64.0, -27.0, 36.0, -47.0, -64.0, -48.0, -28.0, -64.0, -42.0, -28.0, -64.0, -49.0, -45.0, 15.0, -21.0, -64.0, -45.0, -46.0, 20.0, -44.0, 16.0, -47.0, -46.0, 24.0, -64.0, -15.0, -64.0, -64.0, -20.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3720370620149738, "mean_inference_ms": 18.80864031678403, "mean_action_processing_ms": 0.8231983023515054, "mean_env_wait_ms": 0.4826156258021521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5912504196166992, "StateBufferConnector_ms": 0.007210254669189453, "ViewRequirementAgentConnector_ms": 0.2779390811920166}}, "episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -43.0, -10.0, -48.0, 22.0, -63.0, -64.0, -64.0, -64.0, -18.0, -32.0, -64.0, -13.0, -52.0, -16.0, -64.0, -48.0, -57.0, -45.0, -64.0, -64.0, -64.0, -64.0, -3.0, -64.0, -63.0, 24.0, -10.0, -64.0, -6.0, -64.0, -54.0, -36.0, -64.0, -64.0, -64.0, -4.0, 42.0, -64.0, -14.0, -44.0, -10.0, -26.0, -64.0, -19.0, -64.0, -64.0, -41.0, -43.0, -1.0, -43.0, 28.0, -64.0, -27.0, -64.0, -64.0, -8.0, -50.0, -64.0, -45.0, -64.0, -64.0, -64.0, 6.0, -16.0, -51.0, -64.0, -11.0, -49.0, -64.0, 42.0, -64.0, -27.0, 36.0, -47.0, -64.0, -48.0, -28.0, -64.0, -42.0, -28.0, -64.0, -49.0, -45.0, 15.0, -21.0, -64.0, -45.0, -46.0, 20.0, -44.0, 16.0, -47.0, -46.0, 24.0, -64.0, -15.0, -64.0, -64.0, -20.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3720370620149738, "mean_inference_ms": 18.80864031678403, "mean_action_processing_ms": 0.8231983023515054, "mean_env_wait_ms": 0.4826156258021521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5912504196166992, "StateBufferConnector_ms": 0.007210254669189453, "ViewRequirementAgentConnector_ms": 0.2779390811920166}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3293559688804133, "num_agent_steps_trained_throughput_per_sec": 3.3293559688804133, "timesteps_total": 74752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 162848.314, "sample_time_ms": 11787.712, "load_time_ms": 0.466, "load_throughput": 1097727.163, "learn_time_ms": 151059.501, "learn_throughput": 3.389, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "done": false, "episodes_total": 4672, "training_iteration": 146, "trial_id": "6f959_00019", "date": "2024-02-28_21-35-42", "timestamp": 1709152542, "time_this_iter_s": 153.7986238002777, "time_total_s": 23238.364590883255, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23238.364590883255, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 57.14383561643836, "ram_util_percent": 17.943835616438356}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.13, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.194296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.194296875, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.367349898815155, "policy_loss": 0.30948501552144686, "vf_loss": 6.664173765977224, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 86.3589319229126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 75264, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 75264}, "sampler_results": {"episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.13, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.194296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.194296875, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-36.0, -64.0, -64.0, -64.0, -4.0, 42.0, -64.0, -14.0, -44.0, -10.0, -26.0, -64.0, -19.0, -64.0, -64.0, -41.0, -43.0, -1.0, -43.0, 28.0, -64.0, -27.0, -64.0, -64.0, -8.0, -50.0, -64.0, -45.0, -64.0, -64.0, -64.0, 6.0, -16.0, -51.0, -64.0, -11.0, -49.0, -64.0, 42.0, -64.0, -27.0, 36.0, -47.0, -64.0, -48.0, -28.0, -64.0, -42.0, -28.0, -64.0, -49.0, -45.0, 15.0, -21.0, -64.0, -45.0, -46.0, 20.0, -44.0, 16.0, -47.0, -46.0, 24.0, -64.0, -15.0, -64.0, -64.0, -20.0, -48.0, -64.0, -64.0, -64.0, -64.0, -43.0, -33.0, -19.0, -64.0, -64.0, -64.0, -18.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 21.0, 33.0, -64.0, -28.0, -15.0, -16.0, -64.0, -64.0, -64.0, -64.0, -17.0, -55.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.372614833949122, "mean_inference_ms": 18.812985582976385, "mean_action_processing_ms": 0.823463933212567, "mean_env_wait_ms": 0.48276326583122314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6004571914672852, "StateBufferConnector_ms": 0.007239103317260742, "ViewRequirementAgentConnector_ms": 0.2790539264678955}}, "episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.0, -64.0, -64.0, -64.0, -4.0, 42.0, -64.0, -14.0, -44.0, -10.0, -26.0, -64.0, -19.0, -64.0, -64.0, -41.0, -43.0, -1.0, -43.0, 28.0, -64.0, -27.0, -64.0, -64.0, -8.0, -50.0, -64.0, -45.0, -64.0, -64.0, -64.0, 6.0, -16.0, -51.0, -64.0, -11.0, -49.0, -64.0, 42.0, -64.0, -27.0, 36.0, -47.0, -64.0, -48.0, -28.0, -64.0, -42.0, -28.0, -64.0, -49.0, -45.0, 15.0, -21.0, -64.0, -45.0, -46.0, 20.0, -44.0, 16.0, -47.0, -46.0, 24.0, -64.0, -15.0, -64.0, -64.0, -20.0, -48.0, -64.0, -64.0, -64.0, -64.0, -43.0, -33.0, -19.0, -64.0, -64.0, -64.0, -18.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 21.0, 33.0, -64.0, -28.0, -15.0, -16.0, -64.0, -64.0, -64.0, -64.0, -17.0, -55.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.372614833949122, "mean_inference_ms": 18.812985582976385, "mean_action_processing_ms": 0.823463933212567, "mean_env_wait_ms": 0.48276326583122314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6004571914672852, "StateBufferConnector_ms": 0.007239103317260742, "ViewRequirementAgentConnector_ms": 0.2790539264678955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 75264, "num_env_steps_sampled": 75264, "num_env_steps_trained": 75264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.309261647082438, "num_agent_steps_trained_throughput_per_sec": 3.309261647082438, "timesteps_total": 75264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 161609.466, "sample_time_ms": 11799.95, "load_time_ms": 0.451, "load_throughput": 1135573.818, "learn_time_ms": 149808.444, "learn_throughput": 3.418, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 75264, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 75264}, "done": false, "episodes_total": 4704, "training_iteration": 147, "trial_id": "6f959_00019", "date": "2024-02-28_21-38-17", "timestamp": 1709152697, "time_this_iter_s": 154.72765183448792, "time_total_s": 23393.092242717743, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23393.092242717743, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 57.86545454545455, "ram_util_percent": 17.654999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -36.89, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.211796875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.211796875, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9532823922423025, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.942631590366364, "policy_loss": -0.004509098579486211, "vf_loss": 9.8426260749499, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 82.19680296579996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "sampler_results": {"episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.89, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -36.89, "reward_total_min": -64, "reward_total_max": 42, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.211796875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.828125, "reward_score_mean": 0.211796875, "reward_score_min": 0.0, "reward_score_max": 0.828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -51.0, -64.0, -11.0, -49.0, -64.0, 42.0, -64.0, -27.0, 36.0, -47.0, -64.0, -48.0, -28.0, -64.0, -42.0, -28.0, -64.0, -49.0, -45.0, 15.0, -21.0, -64.0, -45.0, -46.0, 20.0, -44.0, 16.0, -47.0, -46.0, 24.0, -64.0, -15.0, -64.0, -64.0, -20.0, -48.0, -64.0, -64.0, -64.0, -64.0, -43.0, -33.0, -19.0, -64.0, -64.0, -64.0, -18.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 21.0, 33.0, -64.0, -28.0, -15.0, -16.0, -64.0, -64.0, -64.0, -64.0, -17.0, -55.0, -16.0, -64.0, -64.0, 19.0, -64.0, -64.0, -42.0, 13.0, -51.0, -64.0, -22.0, 33.0, 38.0, -64.0, -53.0, -31.0, -40.0, -37.0, -64.0, -44.0, -28.0, -64.0, 18.0, -64.0, -32.0, 34.0, -42.0, -34.0, 28.0, -64.0, -64.0, 27.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3721971446995065, "mean_inference_ms": 18.81217739836019, "mean_action_processing_ms": 0.8233686059901716, "mean_env_wait_ms": 0.48270050983363383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5476281642913818, "StateBufferConnector_ms": 0.006849050521850586, "ViewRequirementAgentConnector_ms": 0.26203322410583496}}, "episode_reward_max": 42.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.89, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -51.0, -64.0, -11.0, -49.0, -64.0, 42.0, -64.0, -27.0, 36.0, -47.0, -64.0, -48.0, -28.0, -64.0, -42.0, -28.0, -64.0, -49.0, -45.0, 15.0, -21.0, -64.0, -45.0, -46.0, 20.0, -44.0, 16.0, -47.0, -46.0, 24.0, -64.0, -15.0, -64.0, -64.0, -20.0, -48.0, -64.0, -64.0, -64.0, -64.0, -43.0, -33.0, -19.0, -64.0, -64.0, -64.0, -18.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 21.0, 33.0, -64.0, -28.0, -15.0, -16.0, -64.0, -64.0, -64.0, -64.0, -17.0, -55.0, -16.0, -64.0, -64.0, 19.0, -64.0, -64.0, -42.0, 13.0, -51.0, -64.0, -22.0, 33.0, 38.0, -64.0, -53.0, -31.0, -40.0, -37.0, -64.0, -44.0, -28.0, -64.0, 18.0, -64.0, -32.0, 34.0, -42.0, -34.0, 28.0, -64.0, -64.0, 27.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3721971446995065, "mean_inference_ms": 18.81217739836019, "mean_action_processing_ms": 0.8233686059901716, "mean_env_wait_ms": 0.48270050983363383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5476281642913818, "StateBufferConnector_ms": 0.006849050521850586, "ViewRequirementAgentConnector_ms": 0.26203322410583496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.342971836140585, "num_agent_steps_trained_throughput_per_sec": 3.342971836140585, "timesteps_total": 75776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 160550.644, "sample_time_ms": 11798.415, "load_time_ms": 0.435, "load_throughput": 1177348.491, "learn_time_ms": 148751.193, "learn_throughput": 3.442, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "done": false, "episodes_total": 4736, "training_iteration": 148, "trial_id": "6f959_00019", "date": "2024-02-28_21-40-50", "timestamp": 1709152850, "time_this_iter_s": 153.16751337051392, "time_total_s": 23546.259756088257, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23546.259756088257, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 57.274654377880196, "ram_util_percent": 18.017050691244236}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.84, "reward_total_min": -64, "reward_total_max": 41, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.204375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8203125, "reward_score_mean": 0.204375, "reward_score_min": 0.0, "reward_score_max": 0.8203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.854305291175843, "policy_loss": 0.26798541396856307, "vf_loss": 7.245519777139028, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 89.0152982711792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 76288, "num_env_steps_trained": 76288, "num_agent_steps_sampled": 76288, "num_agent_steps_trained": 76288}, "sampler_results": {"episode_reward_max": 41.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.84, "reward_total_min": -64, "reward_total_max": 41, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.204375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8203125, "reward_score_mean": 0.204375, "reward_score_min": 0.0, "reward_score_max": 0.8203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-15.0, -64.0, -64.0, -20.0, -48.0, -64.0, -64.0, -64.0, -64.0, -43.0, -33.0, -19.0, -64.0, -64.0, -64.0, -18.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 21.0, 33.0, -64.0, -28.0, -15.0, -16.0, -64.0, -64.0, -64.0, -64.0, -17.0, -55.0, -16.0, -64.0, -64.0, 19.0, -64.0, -64.0, -42.0, 13.0, -51.0, -64.0, -22.0, 33.0, 38.0, -64.0, -53.0, -31.0, -40.0, -37.0, -64.0, -44.0, -28.0, -64.0, 18.0, -64.0, -32.0, 34.0, -42.0, -34.0, 28.0, -64.0, -64.0, 27.0, -57.0, -52.0, -64.0, 40.0, -24.0, -64.0, -4.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, -52.0, -20.0, 13.0, -49.0, -64.0, 41.0, -47.0, -64.0, -18.0, -64.0, -64.0, 1.0, -64.0, 17.0, -14.0, -36.0, 36.0, -40.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.371467776163043, "mean_inference_ms": 18.809364523716628, "mean_action_processing_ms": 0.8231718616272217, "mean_env_wait_ms": 0.48257616710137236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5426888465881348, "StateBufferConnector_ms": 0.006803750991821289, "ViewRequirementAgentConnector_ms": 0.25882554054260254}}, "episode_reward_max": 41.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-15.0, -64.0, -64.0, -20.0, -48.0, -64.0, -64.0, -64.0, -64.0, -43.0, -33.0, -19.0, -64.0, -64.0, -64.0, -18.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, -64.0, 21.0, 33.0, -64.0, -28.0, -15.0, -16.0, -64.0, -64.0, -64.0, -64.0, -17.0, -55.0, -16.0, -64.0, -64.0, 19.0, -64.0, -64.0, -42.0, 13.0, -51.0, -64.0, -22.0, 33.0, 38.0, -64.0, -53.0, -31.0, -40.0, -37.0, -64.0, -44.0, -28.0, -64.0, 18.0, -64.0, -32.0, 34.0, -42.0, -34.0, 28.0, -64.0, -64.0, 27.0, -57.0, -52.0, -64.0, 40.0, -24.0, -64.0, -4.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, -52.0, -20.0, 13.0, -49.0, -64.0, 41.0, -47.0, -64.0, -18.0, -64.0, -64.0, 1.0, -64.0, 17.0, -14.0, -36.0, 36.0, -40.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.371467776163043, "mean_inference_ms": 18.809364523716628, "mean_action_processing_ms": 0.8231718616272217, "mean_env_wait_ms": 0.48257616710137236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5426888465881348, "StateBufferConnector_ms": 0.006803750991821289, "ViewRequirementAgentConnector_ms": 0.25882554054260254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76288, "num_agent_steps_trained": 76288, "num_env_steps_sampled": 76288, "num_env_steps_trained": 76288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3785253697895365, "num_agent_steps_trained_throughput_per_sec": 3.3785253697895365, "timesteps_total": 76288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 76288, "timers": {"training_iteration_time_ms": 158995.209, "sample_time_ms": 11737.321, "load_time_ms": 0.408, "load_throughput": 1255618.107, "learn_time_ms": 147256.893, "learn_throughput": 3.477, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 76288, "num_env_steps_trained": 76288, "num_agent_steps_sampled": 76288, "num_agent_steps_trained": 76288}, "done": false, "episodes_total": 4768, "training_iteration": 149, "trial_id": "6f959_00019", "date": "2024-02-28_21-43-22", "timestamp": 1709153002, "time_this_iter_s": 151.5561044216156, "time_total_s": 23697.815860509872, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23697.815860509872, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 57.39441860465116, "ram_util_percent": 17.915813953488374}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -34.09, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.233671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.233671875, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.2706815779209135, "policy_loss": -0.06067325696349144, "vf_loss": 6.965036193529765, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.15464769999186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -34.09, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -34.09, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.233671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.233671875, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -17.0, -55.0, -16.0, -64.0, -64.0, 19.0, -64.0, -64.0, -42.0, 13.0, -51.0, -64.0, -22.0, 33.0, 38.0, -64.0, -53.0, -31.0, -40.0, -37.0, -64.0, -44.0, -28.0, -64.0, 18.0, -64.0, -32.0, 34.0, -42.0, -34.0, 28.0, -64.0, -64.0, 27.0, -57.0, -52.0, -64.0, 40.0, -24.0, -64.0, -4.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, -52.0, -20.0, 13.0, -49.0, -64.0, 41.0, -47.0, -64.0, -18.0, -64.0, -64.0, 1.0, -64.0, 17.0, -14.0, -36.0, 36.0, -40.0, -64.0, -64.0, -16.0, -64.0, -51.0, 7.0, -64.0, -41.0, -64.0, -64.0, 40.0, -64.0, -22.0, -12.0, -39.0, -64.0, -44.0, -64.0, 17.0, -64.0, -64.0, 44.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, 28.0, -19.0, -50.0, -17.0, -3.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.370522098618879, "mean_inference_ms": 18.80463247027365, "mean_action_processing_ms": 0.8228743651615565, "mean_env_wait_ms": 0.4823972273088309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.530048131942749, "StateBufferConnector_ms": 0.006712436676025391, "ViewRequirementAgentConnector_ms": 0.25521278381347656}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -34.09, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -17.0, -55.0, -16.0, -64.0, -64.0, 19.0, -64.0, -64.0, -42.0, 13.0, -51.0, -64.0, -22.0, 33.0, 38.0, -64.0, -53.0, -31.0, -40.0, -37.0, -64.0, -44.0, -28.0, -64.0, 18.0, -64.0, -32.0, 34.0, -42.0, -34.0, 28.0, -64.0, -64.0, 27.0, -57.0, -52.0, -64.0, 40.0, -24.0, -64.0, -4.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, -52.0, -20.0, 13.0, -49.0, -64.0, 41.0, -47.0, -64.0, -18.0, -64.0, -64.0, 1.0, -64.0, 17.0, -14.0, -36.0, 36.0, -40.0, -64.0, -64.0, -16.0, -64.0, -51.0, 7.0, -64.0, -41.0, -64.0, -64.0, 40.0, -64.0, -22.0, -12.0, -39.0, -64.0, -44.0, -64.0, 17.0, -64.0, -64.0, 44.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, 28.0, -19.0, -50.0, -17.0, -3.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.370522098618879, "mean_inference_ms": 18.80463247027365, "mean_action_processing_ms": 0.8228743651615565, "mean_env_wait_ms": 0.4823972273088309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.530048131942749, "StateBufferConnector_ms": 0.006712436676025391, "ViewRequirementAgentConnector_ms": 0.25521278381347656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2359988276056497, "num_agent_steps_trained_throughput_per_sec": 3.2359988276056497, "timesteps_total": 76800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 158645.578, "sample_time_ms": 11670.963, "load_time_ms": 0.393, "load_throughput": 1303955.096, "learn_time_ms": 146973.642, "learn_throughput": 3.484, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "episodes_total": 4800, "training_iteration": 150, "trial_id": "6f959_00019", "date": "2024-02-28_21-46-00", "timestamp": 1709153160, "time_this_iter_s": 158.2309217453003, "time_total_s": 23856.046782255173, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23856.046782255173, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 57.041777777777774, "ram_util_percent": 17.746222222222226}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -36.56, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.214375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.214375, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9619055539369583, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.753559374809265, "policy_loss": 0.025217050810654958, "vf_loss": 9.601929012934367, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 90.152410252889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 77312, "num_env_steps_trained": 77312, "num_agent_steps_sampled": 77312, "num_agent_steps_trained": 77312}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -36.56, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.214375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.214375, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, 27.0, -57.0, -52.0, -64.0, 40.0, -24.0, -64.0, -4.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, -52.0, -20.0, 13.0, -49.0, -64.0, 41.0, -47.0, -64.0, -18.0, -64.0, -64.0, 1.0, -64.0, 17.0, -14.0, -36.0, 36.0, -40.0, -64.0, -64.0, -16.0, -64.0, -51.0, 7.0, -64.0, -41.0, -64.0, -64.0, 40.0, -64.0, -22.0, -12.0, -39.0, -64.0, -44.0, -64.0, 17.0, -64.0, -64.0, 44.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, 28.0, -19.0, -50.0, -17.0, -3.0, -64.0, -64.0, -20.0, -64.0, -64.0, 12.0, -64.0, -34.0, -64.0, -27.0, 34.0, -29.0, 36.0, -32.0, -64.0, -64.0, 14.0, -35.0, -45.0, -44.0, -45.0, -64.0, -27.0, -54.0, -39.0, -44.0, -64.0, -56.0, -19.0, -64.0, -64.0, -26.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3699387305186677, "mean_inference_ms": 18.801301547403497, "mean_action_processing_ms": 0.8227354708597809, "mean_env_wait_ms": 0.48230656686025974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5437812805175781, "StateBufferConnector_ms": 0.0068476200103759766, "ViewRequirementAgentConnector_ms": 0.26038312911987305}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, 27.0, -57.0, -52.0, -64.0, 40.0, -24.0, -64.0, -4.0, -64.0, -64.0, -64.0, -64.0, -40.0, -64.0, -52.0, -20.0, 13.0, -49.0, -64.0, 41.0, -47.0, -64.0, -18.0, -64.0, -64.0, 1.0, -64.0, 17.0, -14.0, -36.0, 36.0, -40.0, -64.0, -64.0, -16.0, -64.0, -51.0, 7.0, -64.0, -41.0, -64.0, -64.0, 40.0, -64.0, -22.0, -12.0, -39.0, -64.0, -44.0, -64.0, 17.0, -64.0, -64.0, 44.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, 28.0, -19.0, -50.0, -17.0, -3.0, -64.0, -64.0, -20.0, -64.0, -64.0, 12.0, -64.0, -34.0, -64.0, -27.0, 34.0, -29.0, 36.0, -32.0, -64.0, -64.0, 14.0, -35.0, -45.0, -44.0, -45.0, -64.0, -27.0, -54.0, -39.0, -44.0, -64.0, -56.0, -19.0, -64.0, -64.0, -26.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3699387305186677, "mean_inference_ms": 18.801301547403497, "mean_action_processing_ms": 0.8227354708597809, "mean_env_wait_ms": 0.48230656686025974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5437812805175781, "StateBufferConnector_ms": 0.0068476200103759766, "ViewRequirementAgentConnector_ms": 0.26038312911987305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77312, "num_agent_steps_trained": 77312, "num_env_steps_sampled": 77312, "num_env_steps_trained": 77312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2231076040738453, "num_agent_steps_trained_throughput_per_sec": 3.2231076040738453, "timesteps_total": 77312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 77312, "timers": {"training_iteration_time_ms": 158739.452, "sample_time_ms": 11396.886, "load_time_ms": 0.393, "load_throughput": 1303163.813, "learn_time_ms": 147341.597, "learn_throughput": 3.475, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 77312, "num_env_steps_trained": 77312, "num_agent_steps_sampled": 77312, "num_agent_steps_trained": 77312}, "done": false, "episodes_total": 4832, "training_iteration": 151, "trial_id": "6f959_00019", "date": "2024-02-28_21-48-39", "timestamp": 1709153319, "time_this_iter_s": 158.86331462860107, "time_total_s": 24014.910096883774, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24014.910096883774, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 56.53451327433628, "ram_util_percent": 17.87433628318584}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.97, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.203359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.203359375, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 5.905826848745346, "policy_loss": 0.2354023590994378, "vf_loss": 6.237955844402313, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 90.43068313598633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "sampler_results": {"episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.97, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.97, "reward_total_min": -64, "reward_total_max": 44, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.203359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.84375, "reward_score_mean": 0.203359375, "reward_score_min": 0.0, "reward_score_max": 0.84375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [36.0, -40.0, -64.0, -64.0, -16.0, -64.0, -51.0, 7.0, -64.0, -41.0, -64.0, -64.0, 40.0, -64.0, -22.0, -12.0, -39.0, -64.0, -44.0, -64.0, 17.0, -64.0, -64.0, 44.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, 28.0, -19.0, -50.0, -17.0, -3.0, -64.0, -64.0, -20.0, -64.0, -64.0, 12.0, -64.0, -34.0, -64.0, -27.0, 34.0, -29.0, 36.0, -32.0, -64.0, -64.0, 14.0, -35.0, -45.0, -44.0, -45.0, -64.0, -27.0, -54.0, -39.0, -44.0, -64.0, -56.0, -19.0, -64.0, -64.0, -26.0, -64.0, -64.0, -64.0, -64.0, -48.0, -16.0, -64.0, -64.0, -64.0, -2.0, 23.0, -11.0, -21.0, -64.0, -42.0, -64.0, 23.0, -24.0, -31.0, -32.0, -64.0, -14.0, -64.0, -48.0, -64.0, -47.0, -64.0, -10.0, -23.0, -64.0, -28.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3698830803727393, "mean_inference_ms": 18.800579373653818, "mean_action_processing_ms": 0.8227234459392052, "mean_env_wait_ms": 0.48230328761191243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5633482933044434, "StateBufferConnector_ms": 0.007066488265991211, "ViewRequirementAgentConnector_ms": 0.2682967185974121}}, "episode_reward_max": 44.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.97, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.0, -40.0, -64.0, -64.0, -16.0, -64.0, -51.0, 7.0, -64.0, -41.0, -64.0, -64.0, 40.0, -64.0, -22.0, -12.0, -39.0, -64.0, -44.0, -64.0, 17.0, -64.0, -64.0, 44.0, -64.0, -64.0, -64.0, 32.0, -64.0, -64.0, 28.0, -19.0, -50.0, -17.0, -3.0, -64.0, -64.0, -20.0, -64.0, -64.0, 12.0, -64.0, -34.0, -64.0, -27.0, 34.0, -29.0, 36.0, -32.0, -64.0, -64.0, 14.0, -35.0, -45.0, -44.0, -45.0, -64.0, -27.0, -54.0, -39.0, -44.0, -64.0, -56.0, -19.0, -64.0, -64.0, -26.0, -64.0, -64.0, -64.0, -64.0, -48.0, -16.0, -64.0, -64.0, -64.0, -2.0, 23.0, -11.0, -21.0, -64.0, -42.0, -64.0, 23.0, -24.0, -31.0, -32.0, -64.0, -14.0, -64.0, -48.0, -64.0, -47.0, -64.0, -10.0, -23.0, -64.0, -28.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3698830803727393, "mean_inference_ms": 18.800579373653818, "mean_action_processing_ms": 0.8227234459392052, "mean_env_wait_ms": 0.48230328761191243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5633482933044434, "StateBufferConnector_ms": 0.007066488265991211, "ViewRequirementAgentConnector_ms": 0.2682967185974121}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.130081238943833, "num_agent_steps_trained_throughput_per_sec": 3.130081238943833, "timesteps_total": 77824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 157747.579, "sample_time_ms": 11481.641, "load_time_ms": 0.416, "load_throughput": 1229522.299, "learn_time_ms": 146264.944, "learn_throughput": 3.5, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "episodes_total": 4864, "training_iteration": 152, "trial_id": "6f959_00019", "date": "2024-02-28_21-51-23", "timestamp": 1709153483, "time_this_iter_s": 163.58477091789246, "time_total_s": 24178.494867801666, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24178.494867801666, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 57.28879310344828, "ram_util_percent": 17.89525862068966}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -38.64, "reward_total_min": -64, "reward_total_max": 36, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.198125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.78125, "reward_score_mean": 0.198125, "reward_score_min": 0.0, "reward_score_max": 0.78125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.312411987781525, "policy_loss": -0.06197400509069363, "vf_loss": 7.012374190489451, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 88.93613522847494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 78336, "num_env_steps_trained": 78336, "num_agent_steps_sampled": 78336, "num_agent_steps_trained": 78336}, "sampler_results": {"episode_reward_max": 36.0, "episode_reward_min": -64.0, "episode_reward_mean": -38.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -38.64, "reward_total_min": -64, "reward_total_max": 36, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.198125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.78125, "reward_score_mean": 0.198125, "reward_score_min": 0.0, "reward_score_max": 0.78125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -17.0, -3.0, -64.0, -64.0, -20.0, -64.0, -64.0, 12.0, -64.0, -34.0, -64.0, -27.0, 34.0, -29.0, 36.0, -32.0, -64.0, -64.0, 14.0, -35.0, -45.0, -44.0, -45.0, -64.0, -27.0, -54.0, -39.0, -44.0, -64.0, -56.0, -19.0, -64.0, -64.0, -26.0, -64.0, -64.0, -64.0, -64.0, -48.0, -16.0, -64.0, -64.0, -64.0, -2.0, 23.0, -11.0, -21.0, -64.0, -42.0, -64.0, 23.0, -24.0, -31.0, -32.0, -64.0, -14.0, -64.0, -48.0, -64.0, -47.0, -64.0, -10.0, -23.0, -64.0, -28.0, -64.0, -64.0, -22.0, 19.0, -64.0, -14.0, -3.0, -64.0, -36.0, -44.0, -44.0, -37.0, -15.0, -42.0, -44.0, -64.0, -64.0, -13.0, -25.0, -64.0, -35.0, 25.0, -39.0, -64.0, -23.0, -64.0, -34.0, 10.0, -64.0, -64.0, -64.0, -42.0, -64.0, -9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3698695753225896, "mean_inference_ms": 18.80045452280143, "mean_action_processing_ms": 0.8227566358209017, "mean_env_wait_ms": 0.4823161634502809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5674567222595215, "StateBufferConnector_ms": 0.007135868072509766, "ViewRequirementAgentConnector_ms": 0.2699012756347656}}, "episode_reward_max": 36.0, "episode_reward_min": -64.0, "episode_reward_mean": -38.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -17.0, -3.0, -64.0, -64.0, -20.0, -64.0, -64.0, 12.0, -64.0, -34.0, -64.0, -27.0, 34.0, -29.0, 36.0, -32.0, -64.0, -64.0, 14.0, -35.0, -45.0, -44.0, -45.0, -64.0, -27.0, -54.0, -39.0, -44.0, -64.0, -56.0, -19.0, -64.0, -64.0, -26.0, -64.0, -64.0, -64.0, -64.0, -48.0, -16.0, -64.0, -64.0, -64.0, -2.0, 23.0, -11.0, -21.0, -64.0, -42.0, -64.0, 23.0, -24.0, -31.0, -32.0, -64.0, -14.0, -64.0, -48.0, -64.0, -47.0, -64.0, -10.0, -23.0, -64.0, -28.0, -64.0, -64.0, -22.0, 19.0, -64.0, -14.0, -3.0, -64.0, -36.0, -44.0, -44.0, -37.0, -15.0, -42.0, -44.0, -64.0, -64.0, -13.0, -25.0, -64.0, -35.0, 25.0, -39.0, -64.0, -23.0, -64.0, -34.0, 10.0, -64.0, -64.0, -64.0, -42.0, -64.0, -9.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3698695753225896, "mean_inference_ms": 18.80045452280143, "mean_action_processing_ms": 0.8227566358209017, "mean_env_wait_ms": 0.4823161634502809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5674567222595215, "StateBufferConnector_ms": 0.007135868072509766, "ViewRequirementAgentConnector_ms": 0.2699012756347656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78336, "num_agent_steps_trained": 78336, "num_env_steps_sampled": 78336, "num_env_steps_trained": 78336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1648741270162484, "num_agent_steps_trained_throughput_per_sec": 3.1648741270162484, "timesteps_total": 78336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 78336, "timers": {"training_iteration_time_ms": 157772.292, "sample_time_ms": 11471.236, "load_time_ms": 0.381, "load_throughput": 1344698.59, "learn_time_ms": 146300.103, "learn_throughput": 3.5, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 78336, "num_env_steps_trained": 78336, "num_agent_steps_sampled": 78336, "num_agent_steps_trained": 78336}, "done": false, "episodes_total": 4896, "training_iteration": 153, "trial_id": "6f959_00019", "date": "2024-02-28_21-54-04", "timestamp": 1709153644, "time_this_iter_s": 161.78610467910767, "time_total_s": 24340.280972480774, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24340.280972480774, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 56.669565217391295, "ram_util_percent": 17.943478260869565}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.52, "reward_total_min": -64, "reward_total_max": 25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6953125, "reward_score_mean": 0.19125, "reward_score_min": 0.0, "reward_score_max": 0.6953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 5.621633839607239, "policy_loss": -0.06768625633170207, "vf_loss": 6.25874267021815, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 88.50216598510742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.52, "reward_total_min": -64, "reward_total_max": 25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6953125, "reward_score_mean": 0.19125, "reward_score_min": 0.0, "reward_score_max": 0.6953125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -26.0, -64.0, -64.0, -64.0, -64.0, -48.0, -16.0, -64.0, -64.0, -64.0, -2.0, 23.0, -11.0, -21.0, -64.0, -42.0, -64.0, 23.0, -24.0, -31.0, -32.0, -64.0, -14.0, -64.0, -48.0, -64.0, -47.0, -64.0, -10.0, -23.0, -64.0, -28.0, -64.0, -64.0, -22.0, 19.0, -64.0, -14.0, -3.0, -64.0, -36.0, -44.0, -44.0, -37.0, -15.0, -42.0, -44.0, -64.0, -64.0, -13.0, -25.0, -64.0, -35.0, 25.0, -39.0, -64.0, -23.0, -64.0, -34.0, 10.0, -64.0, -64.0, -64.0, -42.0, -64.0, -9.0, -20.0, -25.0, -8.0, -64.0, -5.0, -64.0, -38.0, -28.0, -64.0, -64.0, -45.0, -47.0, -11.0, -6.0, -5.0, -26.0, -64.0, -64.0, -10.0, -14.0, -2.0, -64.0, -37.0, -64.0, -13.0, -64.0, -64.0, -16.0, -64.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3697296786026536, "mean_inference_ms": 18.799155505162595, "mean_action_processing_ms": 0.8227395100559677, "mean_env_wait_ms": 0.48229733290236654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5592813491821289, "StateBufferConnector_ms": 0.007071971893310547, "ViewRequirementAgentConnector_ms": 0.2690310478210449}}, "episode_reward_max": 25.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -26.0, -64.0, -64.0, -64.0, -64.0, -48.0, -16.0, -64.0, -64.0, -64.0, -2.0, 23.0, -11.0, -21.0, -64.0, -42.0, -64.0, 23.0, -24.0, -31.0, -32.0, -64.0, -14.0, -64.0, -48.0, -64.0, -47.0, -64.0, -10.0, -23.0, -64.0, -28.0, -64.0, -64.0, -22.0, 19.0, -64.0, -14.0, -3.0, -64.0, -36.0, -44.0, -44.0, -37.0, -15.0, -42.0, -44.0, -64.0, -64.0, -13.0, -25.0, -64.0, -35.0, 25.0, -39.0, -64.0, -23.0, -64.0, -34.0, 10.0, -64.0, -64.0, -64.0, -42.0, -64.0, -9.0, -20.0, -25.0, -8.0, -64.0, -5.0, -64.0, -38.0, -28.0, -64.0, -64.0, -45.0, -47.0, -11.0, -6.0, -5.0, -26.0, -64.0, -64.0, -10.0, -14.0, -2.0, -64.0, -37.0, -64.0, -13.0, -64.0, -64.0, -16.0, -64.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3697296786026536, "mean_inference_ms": 18.799155505162595, "mean_action_processing_ms": 0.8227395100559677, "mean_env_wait_ms": 0.48229733290236654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5592813491821289, "StateBufferConnector_ms": 0.007071971893310547, "ViewRequirementAgentConnector_ms": 0.2690310478210449}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.202920329105933, "num_agent_steps_trained_throughput_per_sec": 3.202920329105933, "timesteps_total": 78848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 157065.868, "sample_time_ms": 11522.399, "load_time_ms": 0.387, "load_throughput": 1323075.379, "learn_time_ms": 145542.507, "learn_throughput": 3.518, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "done": false, "episodes_total": 4928, "training_iteration": 154, "trial_id": "6f959_00019", "date": "2024-02-28_21-56-44", "timestamp": 1709153804, "time_this_iter_s": 159.86526036262512, "time_total_s": 24500.1462328434, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24500.1462328434, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 56.95947136563876, "ram_util_percent": 17.944052863436124}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.26, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.19328125, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 5.559840434789658, "policy_loss": -0.058226463447014494, "vf_loss": 6.1803579211235045, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 88.73237196604411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360}, "sampler_results": {"episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.26, "reward_total_min": -64, "reward_total_max": 27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.7109375, "reward_score_mean": 0.19328125, "reward_score_min": 0.0, "reward_score_max": 0.7109375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -28.0, -64.0, -64.0, -22.0, 19.0, -64.0, -14.0, -3.0, -64.0, -36.0, -44.0, -44.0, -37.0, -15.0, -42.0, -44.0, -64.0, -64.0, -13.0, -25.0, -64.0, -35.0, 25.0, -39.0, -64.0, -23.0, -64.0, -34.0, 10.0, -64.0, -64.0, -64.0, -42.0, -64.0, -9.0, -20.0, -25.0, -8.0, -64.0, -5.0, -64.0, -38.0, -28.0, -64.0, -64.0, -45.0, -47.0, -11.0, -6.0, -5.0, -26.0, -64.0, -64.0, -10.0, -14.0, -2.0, -64.0, -37.0, -64.0, -13.0, -64.0, -64.0, -16.0, -64.0, -64.0, -64.0, -64.0, -7.0, -64.0, -64.0, -64.0, -1.0, -64.0, -58.0, -64.0, -64.0, -41.0, 26.0, -21.0, 8.0, 27.0, -48.0, -64.0, -41.0, -56.0, -33.0, -47.0, -64.0, -37.0, -64.0, -40.0, -64.0, -12.0, -64.0, -55.0, 23.0, -64.0, -38.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3694860811122735, "mean_inference_ms": 18.797598610839092, "mean_action_processing_ms": 0.8227427924815811, "mean_env_wait_ms": 0.4822757160964295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5632436275482178, "StateBufferConnector_ms": 0.007086753845214844, "ViewRequirementAgentConnector_ms": 0.2709183692932129}}, "episode_reward_max": 27.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -28.0, -64.0, -64.0, -22.0, 19.0, -64.0, -14.0, -3.0, -64.0, -36.0, -44.0, -44.0, -37.0, -15.0, -42.0, -44.0, -64.0, -64.0, -13.0, -25.0, -64.0, -35.0, 25.0, -39.0, -64.0, -23.0, -64.0, -34.0, 10.0, -64.0, -64.0, -64.0, -42.0, -64.0, -9.0, -20.0, -25.0, -8.0, -64.0, -5.0, -64.0, -38.0, -28.0, -64.0, -64.0, -45.0, -47.0, -11.0, -6.0, -5.0, -26.0, -64.0, -64.0, -10.0, -14.0, -2.0, -64.0, -37.0, -64.0, -13.0, -64.0, -64.0, -16.0, -64.0, -64.0, -64.0, -64.0, -7.0, -64.0, -64.0, -64.0, -1.0, -64.0, -58.0, -64.0, -64.0, -41.0, 26.0, -21.0, 8.0, 27.0, -48.0, -64.0, -41.0, -56.0, -33.0, -47.0, -64.0, -37.0, -64.0, -40.0, -64.0, -12.0, -64.0, -55.0, 23.0, -64.0, -38.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3694860811122735, "mean_inference_ms": 18.797598610839092, "mean_action_processing_ms": 0.8227427924815811, "mean_env_wait_ms": 0.4822757160964295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5632436275482178, "StateBufferConnector_ms": 0.007086753845214844, "ViewRequirementAgentConnector_ms": 0.2709183692932129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360, "num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.155175156742986, "num_agent_steps_trained_throughput_per_sec": 3.155175156742986, "timesteps_total": 79360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 79360, "timers": {"training_iteration_time_ms": 157775.292, "sample_time_ms": 11377.373, "load_time_ms": 0.385, "load_throughput": 1329628.907, "learn_time_ms": 146396.959, "learn_throughput": 3.497, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360}, "done": false, "episodes_total": 4960, "training_iteration": 155, "trial_id": "6f959_00019", "date": "2024-02-28_21-59-27", "timestamp": 1709153967, "time_this_iter_s": 162.2836492061615, "time_total_s": 24662.42988204956, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24662.42988204956, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 57.195670995671, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.99, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.187578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.187578125, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.09822602669398, "policy_loss": -0.05760677593449751, "vf_loss": 6.771946847438812, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 90.90213661193847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "sampler_results": {"episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.99, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.187578125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.187578125, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -42.0, -64.0, -9.0, -20.0, -25.0, -8.0, -64.0, -5.0, -64.0, -38.0, -28.0, -64.0, -64.0, -45.0, -47.0, -11.0, -6.0, -5.0, -26.0, -64.0, -64.0, -10.0, -14.0, -2.0, -64.0, -37.0, -64.0, -13.0, -64.0, -64.0, -16.0, -64.0, -64.0, -64.0, -64.0, -7.0, -64.0, -64.0, -64.0, -1.0, -64.0, -58.0, -64.0, -64.0, -41.0, 26.0, -21.0, 8.0, 27.0, -48.0, -64.0, -41.0, -56.0, -33.0, -47.0, -64.0, -37.0, -64.0, -40.0, -64.0, -12.0, -64.0, -55.0, 23.0, -64.0, -38.0, -64.0, -64.0, -41.0, -64.0, -3.0, -64.0, -44.0, -42.0, -64.0, -64.0, -64.0, -64.0, -47.0, -49.0, -13.0, -42.0, -64.0, -9.0, -26.0, -31.0, -17.0, 34.0, -46.0, -64.0, -49.0, -34.0, -30.0, -31.0, -10.0, -64.0, -8.0, -47.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.370032473752529, "mean_inference_ms": 18.801188024803437, "mean_action_processing_ms": 0.8229847344371973, "mean_env_wait_ms": 0.48239633890165906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5902442932128906, "StateBufferConnector_ms": 0.007216691970825195, "ViewRequirementAgentConnector_ms": 0.27687740325927734}}, "episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -42.0, -64.0, -9.0, -20.0, -25.0, -8.0, -64.0, -5.0, -64.0, -38.0, -28.0, -64.0, -64.0, -45.0, -47.0, -11.0, -6.0, -5.0, -26.0, -64.0, -64.0, -10.0, -14.0, -2.0, -64.0, -37.0, -64.0, -13.0, -64.0, -64.0, -16.0, -64.0, -64.0, -64.0, -64.0, -7.0, -64.0, -64.0, -64.0, -1.0, -64.0, -58.0, -64.0, -64.0, -41.0, 26.0, -21.0, 8.0, 27.0, -48.0, -64.0, -41.0, -56.0, -33.0, -47.0, -64.0, -37.0, -64.0, -40.0, -64.0, -12.0, -64.0, -55.0, 23.0, -64.0, -38.0, -64.0, -64.0, -41.0, -64.0, -3.0, -64.0, -44.0, -42.0, -64.0, -64.0, -64.0, -64.0, -47.0, -49.0, -13.0, -42.0, -64.0, -9.0, -26.0, -31.0, -17.0, 34.0, -46.0, -64.0, -49.0, -34.0, -30.0, -31.0, -10.0, -64.0, -8.0, -47.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.370032473752529, "mean_inference_ms": 18.801188024803437, "mean_action_processing_ms": 0.8229847344371973, "mean_env_wait_ms": 0.48239633890165906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5902442932128906, "StateBufferConnector_ms": 0.007216691970825195, "ViewRequirementAgentConnector_ms": 0.27687740325927734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.148221131346294, "num_agent_steps_trained_throughput_per_sec": 3.148221131346294, "timesteps_total": 79872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 158660.093, "sample_time_ms": 11499.654, "load_time_ms": 0.387, "load_throughput": 1323156.9, "learn_time_ms": 147159.47, "learn_throughput": 3.479, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "done": false, "episodes_total": 4992, "training_iteration": 156, "trial_id": "6f959_00019", "date": "2024-02-28_22-02-09", "timestamp": 1709154129, "time_this_iter_s": 162.64199829101562, "time_total_s": 24825.071880340576, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24825.071880340576, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 57.13246753246754, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -41.74, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.17390625, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 5.12306350072225, "policy_loss": -0.05802388872640828, "vf_loss": 5.699642815192541, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 89.78134415944417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 80384, "num_env_steps_trained": 80384, "num_agent_steps_sampled": 80384, "num_agent_steps_trained": 80384}, "sampler_results": {"episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -41.74, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.17390625, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, -64.0, -7.0, -64.0, -64.0, -64.0, -1.0, -64.0, -58.0, -64.0, -64.0, -41.0, 26.0, -21.0, 8.0, 27.0, -48.0, -64.0, -41.0, -56.0, -33.0, -47.0, -64.0, -37.0, -64.0, -40.0, -64.0, -12.0, -64.0, -55.0, 23.0, -64.0, -38.0, -64.0, -64.0, -41.0, -64.0, -3.0, -64.0, -44.0, -42.0, -64.0, -64.0, -64.0, -64.0, -47.0, -49.0, -13.0, -42.0, -64.0, -9.0, -26.0, -31.0, -17.0, 34.0, -46.0, -64.0, -49.0, -34.0, -30.0, -31.0, -10.0, -64.0, -8.0, -47.0, -60.0, -64.0, -19.0, -64.0, -47.0, -52.0, -24.0, -64.0, 0.0, -64.0, -64.0, -64.0, -17.0, -64.0, -8.0, -22.0, -64.0, -64.0, -64.0, -47.0, -64.0, -59.0, -64.0, -64.0, -64.0, -64.0, -9.0, -19.0, 26.0, -39.0, -14.0, -41.0, 1.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3723428034237055, "mean_inference_ms": 18.8176241071283, "mean_action_processing_ms": 0.8238410741664939, "mean_env_wait_ms": 0.4828753604779139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6833226680755615, "StateBufferConnector_ms": 0.007857799530029297, "ViewRequirementAgentConnector_ms": 0.3010096549987793}}, "episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -41.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, -64.0, -7.0, -64.0, -64.0, -64.0, -1.0, -64.0, -58.0, -64.0, -64.0, -41.0, 26.0, -21.0, 8.0, 27.0, -48.0, -64.0, -41.0, -56.0, -33.0, -47.0, -64.0, -37.0, -64.0, -40.0, -64.0, -12.0, -64.0, -55.0, 23.0, -64.0, -38.0, -64.0, -64.0, -41.0, -64.0, -3.0, -64.0, -44.0, -42.0, -64.0, -64.0, -64.0, -64.0, -47.0, -49.0, -13.0, -42.0, -64.0, -9.0, -26.0, -31.0, -17.0, 34.0, -46.0, -64.0, -49.0, -34.0, -30.0, -31.0, -10.0, -64.0, -8.0, -47.0, -60.0, -64.0, -19.0, -64.0, -47.0, -52.0, -24.0, -64.0, 0.0, -64.0, -64.0, -64.0, -17.0, -64.0, -8.0, -22.0, -64.0, -64.0, -64.0, -47.0, -64.0, -59.0, -64.0, -64.0, -64.0, -64.0, -9.0, -19.0, 26.0, -39.0, -14.0, -41.0, 1.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3723428034237055, "mean_inference_ms": 18.8176241071283, "mean_action_processing_ms": 0.8238410741664939, "mean_env_wait_ms": 0.4828753604779139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6833226680755615, "StateBufferConnector_ms": 0.007857799530029297, "ViewRequirementAgentConnector_ms": 0.3010096549987793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80384, "num_agent_steps_trained": 80384, "num_env_steps_sampled": 80384, "num_env_steps_trained": 80384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0688989143716365, "num_agent_steps_trained_throughput_per_sec": 3.0688989143716365, "timesteps_total": 80384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 80384, "timers": {"training_iteration_time_ms": 159871.872, "sample_time_ms": 11895.396, "load_time_ms": 0.415, "load_throughput": 1234540.758, "learn_time_ms": 147975.468, "learn_throughput": 3.46, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 80384, "num_env_steps_trained": 80384, "num_agent_steps_sampled": 80384, "num_agent_steps_trained": 80384}, "done": false, "episodes_total": 5024, "training_iteration": 157, "trial_id": "6f959_00019", "date": "2024-02-28_22-04-56", "timestamp": 1709154296, "time_this_iter_s": 166.8454611301422, "time_total_s": 24991.91734147072, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24991.91734147072, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 57.05805084745762, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.11, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.186640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.186640625, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9521581831077734, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.876289562384288, "policy_loss": 0.046774845710024236, "vf_loss": 9.713227434953053, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 91.58745155334472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "sampler_results": {"episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.11, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.11, "reward_total_min": -64, "reward_total_max": 34, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.186640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.765625, "reward_score_mean": 0.186640625, "reward_score_min": 0.0, "reward_score_max": 0.765625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [23.0, -64.0, -38.0, -64.0, -64.0, -41.0, -64.0, -3.0, -64.0, -44.0, -42.0, -64.0, -64.0, -64.0, -64.0, -47.0, -49.0, -13.0, -42.0, -64.0, -9.0, -26.0, -31.0, -17.0, 34.0, -46.0, -64.0, -49.0, -34.0, -30.0, -31.0, -10.0, -64.0, -8.0, -47.0, -60.0, -64.0, -19.0, -64.0, -47.0, -52.0, -24.0, -64.0, 0.0, -64.0, -64.0, -64.0, -17.0, -64.0, -8.0, -22.0, -64.0, -64.0, -64.0, -47.0, -64.0, -59.0, -64.0, -64.0, -64.0, -64.0, -9.0, -19.0, 26.0, -39.0, -14.0, -41.0, 1.0, 19.0, -17.0, -54.0, -64.0, -44.0, -44.0, 15.0, -7.0, -46.0, -64.0, -64.0, -64.0, -37.0, -64.0, -13.0, -64.0, -14.0, -56.0, -56.0, -64.0, -64.0, -21.0, -15.0, -43.0, -64.0, -39.0, -64.0, -17.0, -64.0, -9.0, -32.0, 1.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3745658339998488, "mean_inference_ms": 18.833176274125844, "mean_action_processing_ms": 0.82461552334158, "mean_env_wait_ms": 0.4833303895927775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6792054176330566, "StateBufferConnector_ms": 0.007835149765014648, "ViewRequirementAgentConnector_ms": 0.29833197593688965}}, "episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.11, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.0, -64.0, -38.0, -64.0, -64.0, -41.0, -64.0, -3.0, -64.0, -44.0, -42.0, -64.0, -64.0, -64.0, -64.0, -47.0, -49.0, -13.0, -42.0, -64.0, -9.0, -26.0, -31.0, -17.0, 34.0, -46.0, -64.0, -49.0, -34.0, -30.0, -31.0, -10.0, -64.0, -8.0, -47.0, -60.0, -64.0, -19.0, -64.0, -47.0, -52.0, -24.0, -64.0, 0.0, -64.0, -64.0, -64.0, -17.0, -64.0, -8.0, -22.0, -64.0, -64.0, -64.0, -47.0, -64.0, -59.0, -64.0, -64.0, -64.0, -64.0, -9.0, -19.0, 26.0, -39.0, -14.0, -41.0, 1.0, 19.0, -17.0, -54.0, -64.0, -44.0, -44.0, 15.0, -7.0, -46.0, -64.0, -64.0, -64.0, -37.0, -64.0, -13.0, -64.0, -14.0, -56.0, -56.0, -64.0, -64.0, -21.0, -15.0, -43.0, -64.0, -39.0, -64.0, -17.0, -64.0, -9.0, -32.0, 1.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3745658339998488, "mean_inference_ms": 18.833176274125844, "mean_action_processing_ms": 0.82461552334158, "mean_env_wait_ms": 0.4833303895927775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6792054176330566, "StateBufferConnector_ms": 0.007835149765014648, "ViewRequirementAgentConnector_ms": 0.29833197593688965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0673948824693884, "num_agent_steps_trained_throughput_per_sec": 3.0673948824693884, "timesteps_total": 80896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 161247.844, "sample_time_ms": 11907.478, "load_time_ms": 0.427, "load_throughput": 1198907.798, "learn_time_ms": 149339.33, "learn_throughput": 3.428, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "done": false, "episodes_total": 5056, "training_iteration": 158, "trial_id": "6f959_00019", "date": "2024-02-28_22-07-43", "timestamp": 1709154463, "time_this_iter_s": 166.93223786354065, "time_total_s": 25158.84957933426, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25158.84957933426, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 56.89747899159664, "ram_util_percent": 17.90126050420168}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -40.95, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.180078125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.180078125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8279814023214082, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.04607146581014, "policy_loss": 0.079702272436892, "vf_loss": 9.863779310385386, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 97.64636033376058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 81408, "num_env_steps_trained": 81408, "num_agent_steps_sampled": 81408, "num_agent_steps_trained": 81408}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.95, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -40.95, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.180078125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.180078125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -8.0, -47.0, -60.0, -64.0, -19.0, -64.0, -47.0, -52.0, -24.0, -64.0, 0.0, -64.0, -64.0, -64.0, -17.0, -64.0, -8.0, -22.0, -64.0, -64.0, -64.0, -47.0, -64.0, -59.0, -64.0, -64.0, -64.0, -64.0, -9.0, -19.0, 26.0, -39.0, -14.0, -41.0, 1.0, 19.0, -17.0, -54.0, -64.0, -44.0, -44.0, 15.0, -7.0, -46.0, -64.0, -64.0, -64.0, -37.0, -64.0, -13.0, -64.0, -14.0, -56.0, -56.0, -64.0, -64.0, -21.0, -15.0, -43.0, -64.0, -39.0, -64.0, -17.0, -64.0, -9.0, -32.0, 1.0, -64.0, -64.0, -38.0, -64.0, -64.0, -35.0, -64.0, -33.0, -42.0, -14.0, 39.0, -64.0, -43.0, -64.0, -64.0, -64.0, 64.0, -54.0, 49.0, -6.0, -64.0, -46.0, -64.0, -24.0, -36.0, -32.0, -64.0, -58.0, -64.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3762363157455026, "mean_inference_ms": 18.845462943618806, "mean_action_processing_ms": 0.8252237834944153, "mean_env_wait_ms": 0.4837050367590865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6562798023223877, "StateBufferConnector_ms": 0.0077168941497802734, "ViewRequirementAgentConnector_ms": 0.2929368019104004}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -40.95, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -8.0, -47.0, -60.0, -64.0, -19.0, -64.0, -47.0, -52.0, -24.0, -64.0, 0.0, -64.0, -64.0, -64.0, -17.0, -64.0, -8.0, -22.0, -64.0, -64.0, -64.0, -47.0, -64.0, -59.0, -64.0, -64.0, -64.0, -64.0, -9.0, -19.0, 26.0, -39.0, -14.0, -41.0, 1.0, 19.0, -17.0, -54.0, -64.0, -44.0, -44.0, 15.0, -7.0, -46.0, -64.0, -64.0, -64.0, -37.0, -64.0, -13.0, -64.0, -14.0, -56.0, -56.0, -64.0, -64.0, -21.0, -15.0, -43.0, -64.0, -39.0, -64.0, -17.0, -64.0, -9.0, -32.0, 1.0, -64.0, -64.0, -38.0, -64.0, -64.0, -35.0, -64.0, -33.0, -42.0, -14.0, 39.0, -64.0, -43.0, -64.0, -64.0, -64.0, 64.0, -54.0, 49.0, -6.0, -64.0, -46.0, -64.0, -24.0, -36.0, -32.0, -64.0, -58.0, -64.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3762363157455026, "mean_inference_ms": 18.845462943618806, "mean_action_processing_ms": 0.8252237834944153, "mean_env_wait_ms": 0.4837050367590865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6562798023223877, "StateBufferConnector_ms": 0.0077168941497802734, "ViewRequirementAgentConnector_ms": 0.2929368019104004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81408, "num_agent_steps_trained": 81408, "num_env_steps_sampled": 81408, "num_env_steps_trained": 81408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2970928933679136, "num_agent_steps_trained_throughput_per_sec": 3.2970928933679136, "timesteps_total": 81408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81408, "timers": {"training_iteration_time_ms": 161622.138, "sample_time_ms": 11956.952, "load_time_ms": 0.428, "load_throughput": 1196369.72, "learn_time_ms": 149664.157, "learn_throughput": 3.421, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 81408, "num_env_steps_trained": 81408, "num_agent_steps_sampled": 81408, "num_agent_steps_trained": 81408}, "done": false, "episodes_total": 5088, "training_iteration": 159, "trial_id": "6f959_00019", "date": "2024-02-28_22-10-19", "timestamp": 1709154619, "time_this_iter_s": 155.2987334728241, "time_total_s": 25314.148312807083, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25314.148312807083, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 57.32318181818182, "ram_util_percent": 17.71181818181818}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -35.26, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9167380892361204, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 9.005706695715586, "policy_loss": 0.10380700177823504, "vf_loss": 9.792857122421264, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 98.85586331685384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -35.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -35.26, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22453125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22453125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-39.0, -14.0, -41.0, 1.0, 19.0, -17.0, -54.0, -64.0, -44.0, -44.0, 15.0, -7.0, -46.0, -64.0, -64.0, -64.0, -37.0, -64.0, -13.0, -64.0, -14.0, -56.0, -56.0, -64.0, -64.0, -21.0, -15.0, -43.0, -64.0, -39.0, -64.0, -17.0, -64.0, -9.0, -32.0, 1.0, -64.0, -64.0, -38.0, -64.0, -64.0, -35.0, -64.0, -33.0, -42.0, -14.0, 39.0, -64.0, -43.0, -64.0, -64.0, -64.0, 64.0, -54.0, 49.0, -6.0, -64.0, -46.0, -64.0, -24.0, -36.0, -32.0, -64.0, -58.0, -64.0, -64.0, -64.0, -64.0, -2.0, 53.0, -51.0, -47.0, -50.0, 40.0, 54.0, 46.0, -21.0, -19.0, -47.0, 47.0, -62.0, -53.0, -62.0, -64.0, -64.0, -63.0, -28.0, -64.0, -20.0, -64.0, -61.0, -56.0, -63.0, 59.0, -64.0, -64.0, -32.0, 42.0, -24.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3757810318010595, "mean_inference_ms": 18.84254356067912, "mean_action_processing_ms": 0.8250555319347319, "mean_env_wait_ms": 0.4836434663442875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5604417324066162, "StateBufferConnector_ms": 0.007042407989501953, "ViewRequirementAgentConnector_ms": 0.2651989459991455}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -35.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.0, -14.0, -41.0, 1.0, 19.0, -17.0, -54.0, -64.0, -44.0, -44.0, 15.0, -7.0, -46.0, -64.0, -64.0, -64.0, -37.0, -64.0, -13.0, -64.0, -14.0, -56.0, -56.0, -64.0, -64.0, -21.0, -15.0, -43.0, -64.0, -39.0, -64.0, -17.0, -64.0, -9.0, -32.0, 1.0, -64.0, -64.0, -38.0, -64.0, -64.0, -35.0, -64.0, -33.0, -42.0, -14.0, 39.0, -64.0, -43.0, -64.0, -64.0, -64.0, 64.0, -54.0, 49.0, -6.0, -64.0, -46.0, -64.0, -24.0, -36.0, -32.0, -64.0, -58.0, -64.0, -64.0, -64.0, -64.0, -2.0, 53.0, -51.0, -47.0, -50.0, 40.0, 54.0, 46.0, -21.0, -19.0, -47.0, 47.0, -62.0, -53.0, -62.0, -64.0, -64.0, -63.0, -28.0, -64.0, -20.0, -64.0, -61.0, -56.0, -63.0, 59.0, -64.0, -64.0, -32.0, 42.0, -24.0, -63.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3757810318010595, "mean_inference_ms": 18.84254356067912, "mean_action_processing_ms": 0.8250555319347319, "mean_env_wait_ms": 0.4836434663442875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5604417324066162, "StateBufferConnector_ms": 0.007042407989501953, "ViewRequirementAgentConnector_ms": 0.2651989459991455}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3947683235639774, "num_agent_steps_trained_throughput_per_sec": 3.3947683235639774, "timesteps_total": 81920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 160882.161, "sample_time_ms": 11907.583, "load_time_ms": 0.428, "load_throughput": 1196303.074, "learn_time_ms": 148973.552, "learn_throughput": 3.437, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "episodes_total": 5120, "training_iteration": 160, "trial_id": "6f959_00019", "date": "2024-02-28_22-12-50", "timestamp": 1709154770, "time_this_iter_s": 150.83089637756348, "time_total_s": 25464.979209184647, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25464.979209184647, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 57.4646511627907, "ram_util_percent": 18.053488372093017}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -35.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.222421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.222421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8793533285148442, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.66583201289177, "policy_loss": 0.11650687612127512, "vf_loss": 9.404994787772496, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 105.01848265329997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 82432, "num_env_steps_trained": 82432, "num_agent_steps_sampled": 82432, "num_agent_steps_trained": 82432}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -35.53, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -35.53, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.222421875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.222421875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -9.0, -32.0, 1.0, -64.0, -64.0, -38.0, -64.0, -64.0, -35.0, -64.0, -33.0, -42.0, -14.0, 39.0, -64.0, -43.0, -64.0, -64.0, -64.0, 64.0, -54.0, 49.0, -6.0, -64.0, -46.0, -64.0, -24.0, -36.0, -32.0, -64.0, -58.0, -64.0, -64.0, -64.0, -64.0, -2.0, 53.0, -51.0, -47.0, -50.0, 40.0, 54.0, 46.0, -21.0, -19.0, -47.0, 47.0, -62.0, -53.0, -62.0, -64.0, -64.0, -63.0, -28.0, -64.0, -20.0, -64.0, -61.0, -56.0, -63.0, 59.0, -64.0, -64.0, -32.0, 42.0, -24.0, -63.0, -57.0, -35.0, -51.0, -62.0, -48.0, -64.0, -63.0, -64.0, 46.0, -63.0, 64.0, -64.0, 59.0, -51.0, -10.0, -60.0, -64.0, -52.0, -64.0, -64.0, -62.0, -25.0, -64.0, -20.0, -64.0, -58.0, -64.0, -64.0, 4.0, -52.0, -57.0, 44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3744978105700283, "mean_inference_ms": 18.834684268146972, "mean_action_processing_ms": 0.8245835581269748, "mean_env_wait_ms": 0.4834148635258545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5227518081665039, "StateBufferConnector_ms": 0.006749629974365234, "ViewRequirementAgentConnector_ms": 0.25178050994873047}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -35.53, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -9.0, -32.0, 1.0, -64.0, -64.0, -38.0, -64.0, -64.0, -35.0, -64.0, -33.0, -42.0, -14.0, 39.0, -64.0, -43.0, -64.0, -64.0, -64.0, 64.0, -54.0, 49.0, -6.0, -64.0, -46.0, -64.0, -24.0, -36.0, -32.0, -64.0, -58.0, -64.0, -64.0, -64.0, -64.0, -2.0, 53.0, -51.0, -47.0, -50.0, 40.0, 54.0, 46.0, -21.0, -19.0, -47.0, 47.0, -62.0, -53.0, -62.0, -64.0, -64.0, -63.0, -28.0, -64.0, -20.0, -64.0, -61.0, -56.0, -63.0, 59.0, -64.0, -64.0, -32.0, 42.0, -24.0, -63.0, -57.0, -35.0, -51.0, -62.0, -48.0, -64.0, -63.0, -64.0, 46.0, -63.0, 64.0, -64.0, 59.0, -51.0, -10.0, -60.0, -64.0, -52.0, -64.0, -64.0, -62.0, -25.0, -64.0, -20.0, -64.0, -58.0, -64.0, -64.0, 4.0, -52.0, -57.0, 44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3744978105700283, "mean_inference_ms": 18.834684268146972, "mean_action_processing_ms": 0.8245835581269748, "mean_env_wait_ms": 0.4834148635258545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5227518081665039, "StateBufferConnector_ms": 0.006749629974365234, "ViewRequirementAgentConnector_ms": 0.25178050994873047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82432, "num_agent_steps_trained": 82432, "num_env_steps_sampled": 82432, "num_env_steps_trained": 82432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.288485750729611, "num_agent_steps_trained_throughput_per_sec": 3.288485750729611, "timesteps_total": 82432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 82432, "timers": {"training_iteration_time_ms": 160566.346, "sample_time_ms": 11759.316, "load_time_ms": 0.426, "load_throughput": 1201456.668, "learn_time_ms": 148806.0, "learn_throughput": 3.441, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 82432, "num_env_steps_trained": 82432, "num_agent_steps_sampled": 82432, "num_agent_steps_trained": 82432}, "done": false, "episodes_total": 5152, "training_iteration": 161, "trial_id": "6f959_00019", "date": "2024-02-28_22-15-25", "timestamp": 1709154925, "time_this_iter_s": 155.70523929595947, "time_total_s": 25620.684448480606, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25620.684448480606, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 57.46877828054298, "ram_util_percent": 17.727601809954752}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -34.93, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.227109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.227109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 6.328763707478841, "policy_loss": 0.14298187020855646, "vf_loss": 6.804893334706624, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 107.68769830067953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -34.93, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -34.93, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.227109375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.227109375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, -64.0, -2.0, 53.0, -51.0, -47.0, -50.0, 40.0, 54.0, 46.0, -21.0, -19.0, -47.0, 47.0, -62.0, -53.0, -62.0, -64.0, -64.0, -63.0, -28.0, -64.0, -20.0, -64.0, -61.0, -56.0, -63.0, 59.0, -64.0, -64.0, -32.0, 42.0, -24.0, -63.0, -57.0, -35.0, -51.0, -62.0, -48.0, -64.0, -63.0, -64.0, 46.0, -63.0, 64.0, -64.0, 59.0, -51.0, -10.0, -60.0, -64.0, -52.0, -64.0, -64.0, -62.0, -25.0, -64.0, -20.0, -64.0, -58.0, -64.0, -64.0, 4.0, -52.0, -57.0, 44.0, -27.0, -64.0, -64.0, 23.0, -15.0, -62.0, -38.0, -63.0, -49.0, -64.0, 48.0, -60.0, -25.0, -31.0, 49.0, -61.0, -64.0, -23.0, -58.0, -63.0, 4.0, -13.0, 40.0, -64.0, -47.0, -64.0, -53.0, 38.0, -64.0, -61.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37316664225175, "mean_inference_ms": 18.825480472937784, "mean_action_processing_ms": 0.8240348302472884, "mean_env_wait_ms": 0.48313216426003097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5111720561981201, "StateBufferConnector_ms": 0.006606340408325195, "ViewRequirementAgentConnector_ms": 0.24655842781066895}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -34.93, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, -64.0, -2.0, 53.0, -51.0, -47.0, -50.0, 40.0, 54.0, 46.0, -21.0, -19.0, -47.0, 47.0, -62.0, -53.0, -62.0, -64.0, -64.0, -63.0, -28.0, -64.0, -20.0, -64.0, -61.0, -56.0, -63.0, 59.0, -64.0, -64.0, -32.0, 42.0, -24.0, -63.0, -57.0, -35.0, -51.0, -62.0, -48.0, -64.0, -63.0, -64.0, 46.0, -63.0, 64.0, -64.0, 59.0, -51.0, -10.0, -60.0, -64.0, -52.0, -64.0, -64.0, -62.0, -25.0, -64.0, -20.0, -64.0, -58.0, -64.0, -64.0, 4.0, -52.0, -57.0, 44.0, -27.0, -64.0, -64.0, 23.0, -15.0, -62.0, -38.0, -63.0, -49.0, -64.0, 48.0, -60.0, -25.0, -31.0, 49.0, -61.0, -64.0, -23.0, -58.0, -63.0, 4.0, -13.0, 40.0, -64.0, -47.0, -64.0, -53.0, 38.0, -64.0, -61.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37316664225175, "mean_inference_ms": 18.825480472937784, "mean_action_processing_ms": 0.8240348302472884, "mean_env_wait_ms": 0.48313216426003097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5111720561981201, "StateBufferConnector_ms": 0.006606340408325195, "ViewRequirementAgentConnector_ms": 0.24655842781066895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.236897488979094, "num_agent_steps_trained_throughput_per_sec": 3.236897488979094, "timesteps_total": 82944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 160026.559, "sample_time_ms": 11682.464, "load_time_ms": 0.427, "load_throughput": 1198773.947, "learn_time_ms": 148343.063, "learn_throughput": 3.451, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "done": false, "episodes_total": 5184, "training_iteration": 162, "trial_id": "6f959_00019", "date": "2024-02-28_22-18-04", "timestamp": 1709155084, "time_this_iter_s": 158.18644952774048, "time_total_s": 25778.870898008347, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25778.870898008347, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 56.51377777777778, "ram_util_percent": 17.82488888888889}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -32.77, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.243984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.243984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9645690752814213, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.857921600341797, "policy_loss": 0.007538751078148683, "vf_loss": 9.736184140046438, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 102.25000133514405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 83456, "num_env_steps_trained": 83456, "num_agent_steps_sampled": 83456, "num_agent_steps_trained": 83456}, "sampler_results": {"episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -32.77, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -32.77, "reward_total_min": -64, "reward_total_max": 64, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.243984375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.243984375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-32.0, 42.0, -24.0, -63.0, -57.0, -35.0, -51.0, -62.0, -48.0, -64.0, -63.0, -64.0, 46.0, -63.0, 64.0, -64.0, 59.0, -51.0, -10.0, -60.0, -64.0, -52.0, -64.0, -64.0, -62.0, -25.0, -64.0, -20.0, -64.0, -58.0, -64.0, -64.0, 4.0, -52.0, -57.0, 44.0, -27.0, -64.0, -64.0, 23.0, -15.0, -62.0, -38.0, -63.0, -49.0, -64.0, 48.0, -60.0, -25.0, -31.0, 49.0, -61.0, -64.0, -23.0, -58.0, -63.0, 4.0, -13.0, 40.0, -64.0, -47.0, -64.0, -53.0, 38.0, -64.0, -61.0, -62.0, -64.0, -63.0, -63.0, -1.0, 28.0, -17.0, 13.0, -21.0, -23.0, -36.0, -64.0, 38.0, 10.0, -54.0, 53.0, -62.0, -27.0, -61.0, -53.0, -62.0, -60.0, -30.0, -22.0, 21.0, -64.0, -16.0, -63.0, 39.0, -4.0, -53.0, -48.0, -63.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.372999619541905, "mean_inference_ms": 18.82418190635517, "mean_action_processing_ms": 0.8238965284172983, "mean_env_wait_ms": 0.48308642703616195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.564079761505127, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.2609584331512451}}, "episode_reward_max": 64.0, "episode_reward_min": -64.0, "episode_reward_mean": -32.77, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.0, 42.0, -24.0, -63.0, -57.0, -35.0, -51.0, -62.0, -48.0, -64.0, -63.0, -64.0, 46.0, -63.0, 64.0, -64.0, 59.0, -51.0, -10.0, -60.0, -64.0, -52.0, -64.0, -64.0, -62.0, -25.0, -64.0, -20.0, -64.0, -58.0, -64.0, -64.0, 4.0, -52.0, -57.0, 44.0, -27.0, -64.0, -64.0, 23.0, -15.0, -62.0, -38.0, -63.0, -49.0, -64.0, 48.0, -60.0, -25.0, -31.0, 49.0, -61.0, -64.0, -23.0, -58.0, -63.0, 4.0, -13.0, 40.0, -64.0, -47.0, -64.0, -53.0, 38.0, -64.0, -61.0, -62.0, -64.0, -63.0, -63.0, -1.0, 28.0, -17.0, 13.0, -21.0, -23.0, -36.0, -64.0, 38.0, 10.0, -54.0, 53.0, -62.0, -27.0, -61.0, -53.0, -62.0, -60.0, -30.0, -22.0, 21.0, -64.0, -16.0, -63.0, 39.0, -4.0, -53.0, -48.0, -63.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.372999619541905, "mean_inference_ms": 18.82418190635517, "mean_action_processing_ms": 0.8238965284172983, "mean_env_wait_ms": 0.48308642703616195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.564079761505127, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.2609584331512451}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83456, "num_agent_steps_trained": 83456, "num_env_steps_sampled": 83456, "num_env_steps_trained": 83456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.067292935857457, "num_agent_steps_trained_throughput_per_sec": 3.067292935857457, "timesteps_total": 83456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 83456, "timers": {"training_iteration_time_ms": 160541.221, "sample_time_ms": 11880.02, "load_time_ms": 0.437, "load_throughput": 1171184.363, "learn_time_ms": 148660.15, "learn_throughput": 3.444, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 83456, "num_env_steps_trained": 83456, "num_agent_steps_sampled": 83456, "num_agent_steps_trained": 83456}, "done": false, "episodes_total": 5216, "training_iteration": 163, "trial_id": "6f959_00019", "date": "2024-02-28_22-20-51", "timestamp": 1709155251, "time_this_iter_s": 166.93311667442322, "time_total_s": 25945.80401468277, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25945.80401468277, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 56.79789029535864, "ram_util_percent": 18.099999999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -29.51, "reward_total_min": -64, "reward_total_max": 53, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.269453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9140625, "reward_score_mean": 0.269453125, "reward_score_min": 0.0, "reward_score_max": 0.9140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9305074696506684, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.456113537152609, "policy_loss": 0.169430728831018, "vf_loss": 9.116065514087676, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 102.31956799825032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "sampler_results": {"episode_reward_max": 53.0, "episode_reward_min": -64.0, "episode_reward_mean": -29.51, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -29.51, "reward_total_min": -64, "reward_total_max": 53, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.269453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9140625, "reward_score_mean": 0.269453125, "reward_score_min": 0.0, "reward_score_max": 0.9140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [4.0, -52.0, -57.0, 44.0, -27.0, -64.0, -64.0, 23.0, -15.0, -62.0, -38.0, -63.0, -49.0, -64.0, 48.0, -60.0, -25.0, -31.0, 49.0, -61.0, -64.0, -23.0, -58.0, -63.0, 4.0, -13.0, 40.0, -64.0, -47.0, -64.0, -53.0, 38.0, -64.0, -61.0, -62.0, -64.0, -63.0, -63.0, -1.0, 28.0, -17.0, 13.0, -21.0, -23.0, -36.0, -64.0, 38.0, 10.0, -54.0, 53.0, -62.0, -27.0, -61.0, -53.0, -62.0, -60.0, -30.0, -22.0, 21.0, -64.0, -16.0, -63.0, 39.0, -4.0, -53.0, -48.0, -63.0, -2.0, -22.0, -57.0, 49.0, -58.0, -36.0, 25.0, -51.0, -58.0, -61.0, -37.0, -17.0, -52.0, -64.0, -25.0, -64.0, -63.0, -41.0, 29.0, -57.0, -35.0, -48.0, -64.0, 44.0, -64.0, -64.0, -63.0, 39.0, -30.0, 30.0, 4.0, 22.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37303695206099, "mean_inference_ms": 18.823810776863336, "mean_action_processing_ms": 0.8238543463307866, "mean_env_wait_ms": 0.48308953298180085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5718841552734375, "StateBufferConnector_ms": 0.007059335708618164, "ViewRequirementAgentConnector_ms": 0.2653181552886963}}, "episode_reward_max": 53.0, "episode_reward_min": -64.0, "episode_reward_mean": -29.51, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.0, -52.0, -57.0, 44.0, -27.0, -64.0, -64.0, 23.0, -15.0, -62.0, -38.0, -63.0, -49.0, -64.0, 48.0, -60.0, -25.0, -31.0, 49.0, -61.0, -64.0, -23.0, -58.0, -63.0, 4.0, -13.0, 40.0, -64.0, -47.0, -64.0, -53.0, 38.0, -64.0, -61.0, -62.0, -64.0, -63.0, -63.0, -1.0, 28.0, -17.0, 13.0, -21.0, -23.0, -36.0, -64.0, 38.0, 10.0, -54.0, 53.0, -62.0, -27.0, -61.0, -53.0, -62.0, -60.0, -30.0, -22.0, 21.0, -64.0, -16.0, -63.0, 39.0, -4.0, -53.0, -48.0, -63.0, -2.0, -22.0, -57.0, 49.0, -58.0, -36.0, 25.0, -51.0, -58.0, -61.0, -37.0, -17.0, -52.0, -64.0, -25.0, -64.0, -63.0, -41.0, 29.0, -57.0, -35.0, -48.0, -64.0, 44.0, -64.0, -64.0, -63.0, 39.0, -30.0, 30.0, 4.0, 22.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37303695206099, "mean_inference_ms": 18.823810776863336, "mean_action_processing_ms": 0.8238543463307866, "mean_env_wait_ms": 0.48308953298180085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5718841552734375, "StateBufferConnector_ms": 0.007059335708618164, "ViewRequirementAgentConnector_ms": 0.2653181552886963}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1138943253322178, "num_agent_steps_trained_throughput_per_sec": 3.1138943253322178, "timesteps_total": 83968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 160998.245, "sample_time_ms": 11808.951, "load_time_ms": 0.432, "load_throughput": 1186520.608, "learn_time_ms": 149188.268, "learn_throughput": 3.432, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "episodes_total": 5248, "training_iteration": 164, "trial_id": "6f959_00019", "date": "2024-02-28_22-23-35", "timestamp": 1709155415, "time_this_iter_s": 164.43531465530396, "time_total_s": 26110.239329338074, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26110.239329338074, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 56.70213675213676, "ram_util_percent": 17.860683760683767}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -31.15, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.256640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.256640625, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9458296984434128, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.97724408308665, "policy_loss": 0.045010233173767726, "vf_loss": 9.826227323214214, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 107.35433088938395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -31.15, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -31.15, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.256640625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.256640625, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -61.0, -62.0, -64.0, -63.0, -63.0, -1.0, 28.0, -17.0, 13.0, -21.0, -23.0, -36.0, -64.0, 38.0, 10.0, -54.0, 53.0, -62.0, -27.0, -61.0, -53.0, -62.0, -60.0, -30.0, -22.0, 21.0, -64.0, -16.0, -63.0, 39.0, -4.0, -53.0, -48.0, -63.0, -2.0, -22.0, -57.0, 49.0, -58.0, -36.0, 25.0, -51.0, -58.0, -61.0, -37.0, -17.0, -52.0, -64.0, -25.0, -64.0, -63.0, -41.0, 29.0, -57.0, -35.0, -48.0, -64.0, 44.0, -64.0, -64.0, -63.0, 39.0, -30.0, 30.0, 4.0, 22.0, -50.0, -39.0, -51.0, -64.0, 40.0, -64.0, -50.0, -49.0, -55.0, -64.0, -64.0, -64.0, -64.0, -64.0, 23.0, 48.0, 34.0, -54.0, 54.0, -63.0, -42.0, -27.0, -30.0, -53.0, -13.0, 43.0, -64.0, -46.0, -51.0, -32.0, -64.0, -60.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3732529906528415, "mean_inference_ms": 18.825195706877146, "mean_action_processing_ms": 0.8239359192232315, "mean_env_wait_ms": 0.4831523509480447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5772416591644287, "StateBufferConnector_ms": 0.007132053375244141, "ViewRequirementAgentConnector_ms": 0.268892765045166}}, "episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -31.15, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -61.0, -62.0, -64.0, -63.0, -63.0, -1.0, 28.0, -17.0, 13.0, -21.0, -23.0, -36.0, -64.0, 38.0, 10.0, -54.0, 53.0, -62.0, -27.0, -61.0, -53.0, -62.0, -60.0, -30.0, -22.0, 21.0, -64.0, -16.0, -63.0, 39.0, -4.0, -53.0, -48.0, -63.0, -2.0, -22.0, -57.0, 49.0, -58.0, -36.0, 25.0, -51.0, -58.0, -61.0, -37.0, -17.0, -52.0, -64.0, -25.0, -64.0, -63.0, -41.0, 29.0, -57.0, -35.0, -48.0, -64.0, 44.0, -64.0, -64.0, -63.0, 39.0, -30.0, 30.0, 4.0, 22.0, -50.0, -39.0, -51.0, -64.0, 40.0, -64.0, -50.0, -49.0, -55.0, -64.0, -64.0, -64.0, -64.0, -64.0, 23.0, 48.0, 34.0, -54.0, 54.0, -63.0, -42.0, -27.0, -30.0, -53.0, -13.0, 43.0, -64.0, -46.0, -51.0, -32.0, -64.0, -60.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3732529906528415, "mean_inference_ms": 18.825195706877146, "mean_action_processing_ms": 0.8239359192232315, "mean_env_wait_ms": 0.4831523509480447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5772416591644287, "StateBufferConnector_ms": 0.007132053375244141, "ViewRequirementAgentConnector_ms": 0.268892765045166}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480, "num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2683229170974686, "num_agent_steps_trained_throughput_per_sec": 3.2683229170974686, "timesteps_total": 84480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 84480, "timers": {"training_iteration_time_ms": 160436.467, "sample_time_ms": 11786.545, "load_time_ms": 0.454, "load_throughput": 1128413.456, "learn_time_ms": 148648.873, "learn_throughput": 3.444, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480}, "done": false, "episodes_total": 5280, "training_iteration": 165, "trial_id": "6f959_00019", "date": "2024-02-28_22-26-12", "timestamp": 1709155572, "time_this_iter_s": 156.67049312591553, "time_total_s": 26266.90982246399, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26266.90982246399, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 56.0009009009009, "ram_util_percent": 18.057657657657654}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -36.14, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.21765625, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8387390021622801, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.45351657072703, "policy_loss": 0.10686605536999802, "vf_loss": 9.18203521768252, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 109.68391043345133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -36.14, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.21765625, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-53.0, -48.0, -63.0, -2.0, -22.0, -57.0, 49.0, -58.0, -36.0, 25.0, -51.0, -58.0, -61.0, -37.0, -17.0, -52.0, -64.0, -25.0, -64.0, -63.0, -41.0, 29.0, -57.0, -35.0, -48.0, -64.0, 44.0, -64.0, -64.0, -63.0, 39.0, -30.0, 30.0, 4.0, 22.0, -50.0, -39.0, -51.0, -64.0, 40.0, -64.0, -50.0, -49.0, -55.0, -64.0, -64.0, -64.0, -64.0, -64.0, 23.0, 48.0, 34.0, -54.0, 54.0, -63.0, -42.0, -27.0, -30.0, -53.0, -13.0, 43.0, -64.0, -46.0, -51.0, -32.0, -64.0, -60.0, -46.0, -64.0, -31.0, -64.0, -62.0, -27.0, -42.0, -64.0, -64.0, -64.0, -64.0, -63.0, -64.0, 14.0, -55.0, -64.0, -47.0, 39.0, -64.0, 39.0, -64.0, -62.0, -47.0, -43.0, -37.0, -33.0, -64.0, 5.0, -2.0, -64.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.373395003711507, "mean_inference_ms": 18.826092734989793, "mean_action_processing_ms": 0.8240196821172264, "mean_env_wait_ms": 0.483202373235798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5728878974914551, "StateBufferConnector_ms": 0.007090091705322266, "ViewRequirementAgentConnector_ms": 0.27012181282043457}}, "episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -36.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.0, -48.0, -63.0, -2.0, -22.0, -57.0, 49.0, -58.0, -36.0, 25.0, -51.0, -58.0, -61.0, -37.0, -17.0, -52.0, -64.0, -25.0, -64.0, -63.0, -41.0, 29.0, -57.0, -35.0, -48.0, -64.0, 44.0, -64.0, -64.0, -63.0, 39.0, -30.0, 30.0, 4.0, 22.0, -50.0, -39.0, -51.0, -64.0, 40.0, -64.0, -50.0, -49.0, -55.0, -64.0, -64.0, -64.0, -64.0, -64.0, 23.0, 48.0, 34.0, -54.0, 54.0, -63.0, -42.0, -27.0, -30.0, -53.0, -13.0, 43.0, -64.0, -46.0, -51.0, -32.0, -64.0, -60.0, -46.0, -64.0, -31.0, -64.0, -62.0, -27.0, -42.0, -64.0, -64.0, -64.0, -64.0, -63.0, -64.0, 14.0, -55.0, -64.0, -47.0, 39.0, -64.0, 39.0, -64.0, -62.0, -47.0, -43.0, -37.0, -33.0, -64.0, 5.0, -2.0, -64.0, -64.0, -64.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.373395003711507, "mean_inference_ms": 18.826092734989793, "mean_action_processing_ms": 0.8240196821172264, "mean_env_wait_ms": 0.483202373235798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5728878974914551, "StateBufferConnector_ms": 0.007090091705322266, "ViewRequirementAgentConnector_ms": 0.27012181282043457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0885485144919906, "num_agent_steps_trained_throughput_per_sec": 3.0885485144919906, "timesteps_total": 84992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 160750.68, "sample_time_ms": 11780.007, "load_time_ms": 0.452, "load_throughput": 1132878.059, "learn_time_ms": 148969.63, "learn_throughput": 3.437, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "done": false, "episodes_total": 5312, "training_iteration": 166, "trial_id": "6f959_00019", "date": "2024-02-28_22-28-58", "timestamp": 1709155738, "time_this_iter_s": 165.78447461128235, "time_total_s": 26432.69429707527, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26432.69429707527, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 57.007203389830515, "ram_util_percent": 17.92627118644068}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.23, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209140625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.209140625, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9015279927296459, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.47901179989179, "policy_loss": 0.15470944638364018, "vf_loss": 9.157450290520986, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 104.74504852294922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 85504, "num_env_steps_trained": 85504, "num_agent_steps_sampled": 85504, "num_agent_steps_trained": 85504}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.23, "reward_total_min": -64, "reward_total_max": 54, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209140625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.921875, "reward_score_mean": 0.209140625, "reward_score_min": 0.0, "reward_score_max": 0.921875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [30.0, 4.0, 22.0, -50.0, -39.0, -51.0, -64.0, 40.0, -64.0, -50.0, -49.0, -55.0, -64.0, -64.0, -64.0, -64.0, -64.0, 23.0, 48.0, 34.0, -54.0, 54.0, -63.0, -42.0, -27.0, -30.0, -53.0, -13.0, 43.0, -64.0, -46.0, -51.0, -32.0, -64.0, -60.0, -46.0, -64.0, -31.0, -64.0, -62.0, -27.0, -42.0, -64.0, -64.0, -64.0, -64.0, -63.0, -64.0, 14.0, -55.0, -64.0, -47.0, 39.0, -64.0, 39.0, -64.0, -62.0, -47.0, -43.0, -37.0, -33.0, -64.0, 5.0, -2.0, -64.0, -64.0, -64.0, -64.0, -63.0, -48.0, -49.0, -40.0, -58.0, -28.0, -51.0, -59.0, -45.0, -64.0, 48.0, -59.0, 49.0, -44.0, -63.0, 34.0, -59.0, -43.0, 15.0, 29.0, -13.0, -27.0, -64.0, -37.0, -64.0, -59.0, -51.0, -56.0, -64.0, -62.0, -61.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.374037888359778, "mean_inference_ms": 18.830595584218702, "mean_action_processing_ms": 0.8243225847855773, "mean_env_wait_ms": 0.4833554915635581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6077713966369629, "StateBufferConnector_ms": 0.007355451583862305, "ViewRequirementAgentConnector_ms": 0.28229522705078125}}, "episode_reward_max": 54.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.0, 4.0, 22.0, -50.0, -39.0, -51.0, -64.0, 40.0, -64.0, -50.0, -49.0, -55.0, -64.0, -64.0, -64.0, -64.0, -64.0, 23.0, 48.0, 34.0, -54.0, 54.0, -63.0, -42.0, -27.0, -30.0, -53.0, -13.0, 43.0, -64.0, -46.0, -51.0, -32.0, -64.0, -60.0, -46.0, -64.0, -31.0, -64.0, -62.0, -27.0, -42.0, -64.0, -64.0, -64.0, -64.0, -63.0, -64.0, 14.0, -55.0, -64.0, -47.0, 39.0, -64.0, 39.0, -64.0, -62.0, -47.0, -43.0, -37.0, -33.0, -64.0, 5.0, -2.0, -64.0, -64.0, -64.0, -64.0, -63.0, -48.0, -49.0, -40.0, -58.0, -28.0, -51.0, -59.0, -45.0, -64.0, 48.0, -59.0, 49.0, -44.0, -63.0, 34.0, -59.0, -43.0, 15.0, 29.0, -13.0, -27.0, -64.0, -37.0, -64.0, -59.0, -51.0, -56.0, -64.0, -62.0, -61.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.374037888359778, "mean_inference_ms": 18.830595584218702, "mean_action_processing_ms": 0.8243225847855773, "mean_env_wait_ms": 0.4833554915635581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6077713966369629, "StateBufferConnector_ms": 0.007355451583862305, "ViewRequirementAgentConnector_ms": 0.28229522705078125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85504, "num_agent_steps_trained": 85504, "num_env_steps_sampled": 85504, "num_env_steps_trained": 85504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0706557769292564, "num_agent_steps_trained_throughput_per_sec": 3.0706557769292564, "timesteps_total": 85504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 85504, "timers": {"training_iteration_time_ms": 160741.134, "sample_time_ms": 11467.698, "load_time_ms": 0.429, "load_throughput": 1194041.506, "learn_time_ms": 149272.414, "learn_throughput": 3.43, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 85504, "num_env_steps_trained": 85504, "num_agent_steps_sampled": 85504, "num_agent_steps_trained": 85504}, "done": false, "episodes_total": 5344, "training_iteration": 167, "trial_id": "6f959_00019", "date": "2024-02-28_22-31-45", "timestamp": 1709155905, "time_this_iter_s": 166.75012230873108, "time_total_s": 26599.444419384003, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26599.444419384003, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 56.4126582278481, "ram_util_percent": 17.937974683544304}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -39.18, "reward_total_min": -64, "reward_total_max": 49, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8828125, "reward_score_mean": 0.19390625, "reward_score_min": 0.0, "reward_score_max": 0.8828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8711449561640621, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.968258210023244, "policy_loss": 0.0884905024121205, "vf_loss": 9.768510214487712, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 133.33614018758138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -39.18, "reward_total_min": -64, "reward_total_max": 49, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19390625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8828125, "reward_score_mean": 0.19390625, "reward_score_min": 0.0, "reward_score_max": 0.8828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-32.0, -64.0, -60.0, -46.0, -64.0, -31.0, -64.0, -62.0, -27.0, -42.0, -64.0, -64.0, -64.0, -64.0, -63.0, -64.0, 14.0, -55.0, -64.0, -47.0, 39.0, -64.0, 39.0, -64.0, -62.0, -47.0, -43.0, -37.0, -33.0, -64.0, 5.0, -2.0, -64.0, -64.0, -64.0, -64.0, -63.0, -48.0, -49.0, -40.0, -58.0, -28.0, -51.0, -59.0, -45.0, -64.0, 48.0, -59.0, 49.0, -44.0, -63.0, 34.0, -59.0, -43.0, 15.0, 29.0, -13.0, -27.0, -64.0, -37.0, -64.0, -59.0, -51.0, -56.0, -64.0, -62.0, -61.0, -64.0, -64.0, 22.0, 31.0, -37.0, -64.0, -8.0, -18.0, 18.0, -23.0, -64.0, -16.0, -45.0, -55.0, -41.0, -54.0, -64.0, -53.0, -64.0, -59.0, 34.0, -23.0, -55.0, -43.0, -64.0, -43.0, -39.0, -26.0, 0.0, -21.0, -64.0, -36.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37513283301933, "mean_inference_ms": 18.838393705445714, "mean_action_processing_ms": 0.8247769286241732, "mean_env_wait_ms": 0.4836018208327973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6426091194152832, "StateBufferConnector_ms": 0.007607460021972656, "ViewRequirementAgentConnector_ms": 0.2935142517089844}}, "episode_reward_max": 49.0, "episode_reward_min": -64.0, "episode_reward_mean": -39.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.0, -64.0, -60.0, -46.0, -64.0, -31.0, -64.0, -62.0, -27.0, -42.0, -64.0, -64.0, -64.0, -64.0, -63.0, -64.0, 14.0, -55.0, -64.0, -47.0, 39.0, -64.0, 39.0, -64.0, -62.0, -47.0, -43.0, -37.0, -33.0, -64.0, 5.0, -2.0, -64.0, -64.0, -64.0, -64.0, -63.0, -48.0, -49.0, -40.0, -58.0, -28.0, -51.0, -59.0, -45.0, -64.0, 48.0, -59.0, 49.0, -44.0, -63.0, 34.0, -59.0, -43.0, 15.0, 29.0, -13.0, -27.0, -64.0, -37.0, -64.0, -59.0, -51.0, -56.0, -64.0, -62.0, -61.0, -64.0, -64.0, 22.0, 31.0, -37.0, -64.0, -8.0, -18.0, 18.0, -23.0, -64.0, -16.0, -45.0, -55.0, -41.0, -54.0, -64.0, -53.0, -64.0, -59.0, 34.0, -23.0, -55.0, -43.0, -64.0, -43.0, -39.0, -26.0, 0.0, -21.0, -64.0, -36.0, -44.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37513283301933, "mean_inference_ms": 18.838393705445714, "mean_action_processing_ms": 0.8247769286241732, "mean_env_wait_ms": 0.4836018208327973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6426091194152832, "StateBufferConnector_ms": 0.007607460021972656, "ViewRequirementAgentConnector_ms": 0.2935142517089844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1118179154374266, "num_agent_steps_trained_throughput_per_sec": 3.1118179154374266, "timesteps_total": 86016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 160502.852, "sample_time_ms": 11570.844, "load_time_ms": 0.452, "load_throughput": 1132221.041, "learn_time_ms": 148930.972, "learn_throughput": 3.438, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "episodes_total": 5376, "training_iteration": 168, "trial_id": "6f959_00019", "date": "2024-02-28_22-34-29", "timestamp": 1709156069, "time_this_iter_s": 164.5554554462433, "time_total_s": 26763.999874830246, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26763.999874830246, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 57.11837606837607, "ram_util_percent": 17.708119658119656}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -37.62, "reward_total_min": -64, "reward_total_max": 49, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.20609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8828125, "reward_score_mean": 0.20609375, "reward_score_min": 0.0, "reward_score_max": 0.8828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8877950602521499, "cur_kl_coeff": 0.0, "cur_lr": 0.002854373242694753, "total_loss": 8.487040710449218, "policy_loss": 0.08066598094689349, "vf_loss": 9.247737018267314, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0, "entropy": 120.23431415557862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 86528, "num_env_steps_trained": 86528, "num_agent_steps_sampled": 86528, "num_agent_steps_trained": 86528}, "sampler_results": {"episode_reward_max": 49.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -37.62, "reward_total_min": -64, "reward_total_max": 49, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.20609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8828125, "reward_score_mean": 0.20609375, "reward_score_min": 0.0, "reward_score_max": 0.8828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, -64.0, -63.0, -48.0, -49.0, -40.0, -58.0, -28.0, -51.0, -59.0, -45.0, -64.0, 48.0, -59.0, 49.0, -44.0, -63.0, 34.0, -59.0, -43.0, 15.0, 29.0, -13.0, -27.0, -64.0, -37.0, -64.0, -59.0, -51.0, -56.0, -64.0, -62.0, -61.0, -64.0, -64.0, 22.0, 31.0, -37.0, -64.0, -8.0, -18.0, 18.0, -23.0, -64.0, -16.0, -45.0, -55.0, -41.0, -54.0, -64.0, -53.0, -64.0, -59.0, 34.0, -23.0, -55.0, -43.0, -64.0, -43.0, -39.0, -26.0, 0.0, -21.0, -64.0, -36.0, -44.0, -37.0, -41.0, -60.0, -60.0, -36.0, -58.0, -64.0, 33.0, -59.0, -63.0, 37.0, 44.0, -56.0, -64.0, -55.0, -51.0, -64.0, -63.0, -62.0, -57.0, -52.0, -62.0, -19.0, -31.0, -46.0, -22.0, -18.0, 37.0, 8.0, -64.0, -61.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.375599272116606, "mean_inference_ms": 18.84184397463907, "mean_action_processing_ms": 0.8249972826256444, "mean_env_wait_ms": 0.48372600156222484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.587658166885376, "StateBufferConnector_ms": 0.00719904899597168, "ViewRequirementAgentConnector_ms": 0.2763049602508545}}, "episode_reward_max": 49.0, "episode_reward_min": -64.0, "episode_reward_mean": -37.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -64.0, -64.0, -64.0, -63.0, -48.0, -49.0, -40.0, -58.0, -28.0, -51.0, -59.0, -45.0, -64.0, 48.0, -59.0, 49.0, -44.0, -63.0, 34.0, -59.0, -43.0, 15.0, 29.0, -13.0, -27.0, -64.0, -37.0, -64.0, -59.0, -51.0, -56.0, -64.0, -62.0, -61.0, -64.0, -64.0, 22.0, 31.0, -37.0, -64.0, -8.0, -18.0, 18.0, -23.0, -64.0, -16.0, -45.0, -55.0, -41.0, -54.0, -64.0, -53.0, -64.0, -59.0, 34.0, -23.0, -55.0, -43.0, -64.0, -43.0, -39.0, -26.0, 0.0, -21.0, -64.0, -36.0, -44.0, -37.0, -41.0, -60.0, -60.0, -36.0, -58.0, -64.0, 33.0, -59.0, -63.0, 37.0, 44.0, -56.0, -64.0, -55.0, -51.0, -64.0, -63.0, -62.0, -57.0, -52.0, -62.0, -19.0, -31.0, -46.0, -22.0, -18.0, 37.0, 8.0, -64.0, -61.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.375599272116606, "mean_inference_ms": 18.84184397463907, "mean_action_processing_ms": 0.8249972826256444, "mean_env_wait_ms": 0.48372600156222484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.587658166885376, "StateBufferConnector_ms": 0.00719904899597168, "ViewRequirementAgentConnector_ms": 0.2763049602508545}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86528, "num_agent_steps_trained": 86528, "num_env_steps_sampled": 86528, "num_env_steps_trained": 86528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.053366543958123, "num_agent_steps_trained_throughput_per_sec": 3.053366543958123, "timesteps_total": 86528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 86528, "timers": {"training_iteration_time_ms": 161742.397, "sample_time_ms": 11519.644, "load_time_ms": 0.454, "load_throughput": 1127524.755, "learn_time_ms": 150221.705, "learn_throughput": 3.408, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 86528, "num_env_steps_trained": 86528, "num_agent_steps_sampled": 86528, "num_agent_steps_trained": 86528}, "done": false, "episodes_total": 5408, "training_iteration": 169, "trial_id": "6f959_00019", "date": "2024-02-28_22-37-23", "timestamp": 1709156243, "time_this_iter_s": 167.6992118358612, "time_total_s": 26931.699086666107, "pid": 20302, "hostname": "arton02", "node_ip": "129.132.190.143", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f1f57bea200>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.002854373242694752, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 2, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 8, "n_hidden_mlp": 1, "hidden_mlp_size": 16}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f1f59b2f010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.02932525606462634, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.9090196291862637, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9244264549824522, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26931.699086666107, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 56.418292682926825, "ram_util_percent": 17.817073170731714}, "checkpoint_dir_name": null}
