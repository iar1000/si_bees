{"custom_metrics": {"reward_total_mean": -15.6875, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.009765625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 6.042919719219208, "policy_loss": 0.33983797443409763, "vf_loss": 7.076963206132253, "vf_explained_var": 0.24956512004137038, "kl": 0.0, "entropy": 78.27828693389893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6875, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.6875, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.009765625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0983344407109488, "mean_inference_ms": 7.569015607034486, "mean_action_processing_ms": 0.44170550667983977, "mean_env_wait_ms": 0.27834974069576746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26178210973739624, "StateBufferConnector_ms": 0.005171447992324829, "ViewRequirementAgentConnector_ms": 0.16341432929039001}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6875, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0983344407109488, "mean_inference_ms": 7.569015607034486, "mean_action_processing_ms": 0.44170550667983977, "mean_env_wait_ms": 0.27834974069576746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26178210973739624, "StateBufferConnector_ms": 0.005171447992324829, "ViewRequirementAgentConnector_ms": 0.16341432929039001}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.633927201107257, "num_agent_steps_trained_throughput_per_sec": 7.633927201107257, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 67068.969, "sample_time_ms": 4835.967, "load_time_ms": 0.751, "load_throughput": 681308.264, "learn_time_ms": 62231.539, "learn_throughput": 8.227, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "1316e_00162", "date": "2024-02-26_23-37-27", "timestamp": 1708987047, "time_this_iter_s": 67.07139825820923, "time_total_s": 67.07139825820923, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 67.07139825820923, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.603157894736846, "ram_util_percent": 21.824210526315802}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"reward_total_mean": -15.78125, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0068359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0068359375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 4.751332185665766, "policy_loss": 0.2054029050593575, "vf_loss": 5.641050879160563, "vf_explained_var": 0.6530710270007452, "kl": 0.0, "entropy": 79.0982437133789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.78125, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.78125, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0068359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0068359375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.104266847222257, "mean_inference_ms": 7.577645284090199, "mean_action_processing_ms": 0.43874070153893624, "mean_env_wait_ms": 0.276027832562656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2548646181821823, "StateBufferConnector_ms": 0.005143508315086365, "ViewRequirementAgentConnector_ms": 0.17669647932052612}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.78125, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.104266847222257, "mean_inference_ms": 7.577645284090199, "mean_action_processing_ms": 0.43874070153893624, "mean_env_wait_ms": 0.276027832562656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2548646181821823, "StateBufferConnector_ms": 0.005143508315086365, "ViewRequirementAgentConnector_ms": 0.17669647932052612}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.384202362341749, "num_agent_steps_trained_throughput_per_sec": 7.384202362341749, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 68203.074, "sample_time_ms": 4842.432, "load_time_ms": 0.52, "load_throughput": 984181.324, "learn_time_ms": 63359.266, "learn_throughput": 8.081, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 64, "training_iteration": 2, "trial_id": "1316e_00162", "date": "2024-02-26_23-38-41", "timestamp": 1708987121, "time_this_iter_s": 69.34067559242249, "time_total_s": 136.4120738506317, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 136.4120738506317, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.01809523809524, "ram_util_percent": 21.922857142857143}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.791666666666666, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.006510416666666667, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.006510416666666667, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.542971247434616, "policy_loss": 0.16243848586454987, "vf_loss": 4.1949084003766375, "vf_explained_var": 0.801104920109113, "kl": 0.0, "entropy": 78.96552518208821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.791666666666666, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.791666666666666, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.006510416666666667, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.006510416666666667, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.112510896165396, "mean_inference_ms": 7.592882720356331, "mean_action_processing_ms": 0.4373285635131601, "mean_env_wait_ms": 0.2751521049837244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25787924726804096, "StateBufferConnector_ms": 0.0049625833829243975, "ViewRequirementAgentConnector_ms": 0.18577426671981812}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.791666666666666, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.112510896165396, "mean_inference_ms": 7.592882720356331, "mean_action_processing_ms": 0.4373285635131601, "mean_env_wait_ms": 0.2751521049837244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25787924726804096, "StateBufferConnector_ms": 0.0049625833829243975, "ViewRequirementAgentConnector_ms": 0.18577426671981812}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.349162293496806, "num_agent_steps_trained_throughput_per_sec": 7.349162293496806, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 68691.305, "sample_time_ms": 4869.416, "load_time_ms": 0.45, "load_throughput": 1136836.235, "learn_time_ms": 63820.603, "learn_throughput": 8.022, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "1316e_00162", "date": "2024-02-26_23-39-51", "timestamp": 1708987191, "time_this_iter_s": 69.67265820503235, "time_total_s": 206.08473205566406, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 206.08473205566406, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 58.99696969696969, "ram_util_percent": 22.093939393939387}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.6596036652723947, "policy_loss": 0.09682197691872715, "vf_loss": 4.421061410506566, "vf_explained_var": 0.751424458126227, "kl": 0.0, "entropy": 79.85864868164063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1215680173838316, "mean_inference_ms": 7.611594234036736, "mean_action_processing_ms": 0.4350092105682755, "mean_env_wait_ms": 0.2736463909870929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2572503089904785, "StateBufferConnector_ms": 0.0047914981842041016, "ViewRequirementAgentConnector_ms": 0.19553327560424805}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1215680173838316, "mean_inference_ms": 7.611594234036736, "mean_action_processing_ms": 0.4350092105682755, "mean_env_wait_ms": 0.2736463909870929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2572503089904785, "StateBufferConnector_ms": 0.0047914981842041016, "ViewRequirementAgentConnector_ms": 0.19553327560424805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.364211388459845, "num_agent_steps_trained_throughput_per_sec": 7.364211388459845, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 68899.826, "sample_time_ms": 4871.77, "load_time_ms": 0.414, "load_throughput": 1237921.111, "learn_time_ms": 64026.734, "learn_throughput": 7.997, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "1316e_00162", "date": "2024-02-26_23-41-00", "timestamp": 1708987260, "time_this_iter_s": 69.53074264526367, "time_total_s": 275.61547470092773, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 275.61547470092773, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 59.08888888888889, "ram_util_percent": 22.126262626262616}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.3055156220992408, "policy_loss": 0.15885249512890975, "vf_loss": 3.904699178536733, "vf_explained_var": 0.790067107975483, "kl": 0.0, "entropy": 82.15751927693685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1314198468800376, "mean_inference_ms": 7.640706462702875, "mean_action_processing_ms": 0.43484528636423514, "mean_env_wait_ms": 0.2738159818934864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2594733238220215, "StateBufferConnector_ms": 0.004689931869506836, "ViewRequirementAgentConnector_ms": 0.20332050323486328}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1314198468800376, "mean_inference_ms": 7.640706462702875, "mean_action_processing_ms": 0.43484528636423514, "mean_env_wait_ms": 0.2738159818934864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2594733238220215, "StateBufferConnector_ms": 0.004689931869506836, "ViewRequirementAgentConnector_ms": 0.20332050323486328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.360491323032015, "num_agent_steps_trained_throughput_per_sec": 7.360491323032015, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 69031.968, "sample_time_ms": 4902.147, "load_time_ms": 0.39, "load_throughput": 1312642.817, "learn_time_ms": 64128.537, "learn_throughput": 7.984, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 160, "training_iteration": 5, "trial_id": "1316e_00162", "date": "2024-02-26_23-42-10", "timestamp": 1708987330, "time_this_iter_s": 69.56566739082336, "time_total_s": 345.1811420917511, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 345.1811420917511, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 58.318367346938786, "ram_util_percent": 21.989795918367346}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.23234602411588, "policy_loss": 0.33620636935035386, "vf_loss": 3.5938242197036745, "vf_explained_var": 0.8257374927401543, "kl": 0.0, "entropy": 86.38382193247477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134417638399099, "mean_inference_ms": 7.654725776312622, "mean_action_processing_ms": 0.4347699285735222, "mean_env_wait_ms": 0.2739055307318275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25581979751586914, "StateBufferConnector_ms": 0.00480198860168457, "ViewRequirementAgentConnector_ms": 0.20061230659484863}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134417638399099, "mean_inference_ms": 7.654725776312622, "mean_action_processing_ms": 0.4347699285735222, "mean_env_wait_ms": 0.2739055307318275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25581979751586914, "StateBufferConnector_ms": 0.00480198860168457, "ViewRequirementAgentConnector_ms": 0.20061230659484863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.475637973974939, "num_agent_steps_trained_throughput_per_sec": 7.475637973974939, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 68941.491, "sample_time_ms": 4892.275, "load_time_ms": 0.372, "load_throughput": 1375122.934, "learn_time_ms": 64047.956, "learn_throughput": 7.994, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 192, "training_iteration": 6, "trial_id": "1316e_00162", "date": "2024-02-26_23-43-18", "timestamp": 1708987398, "time_this_iter_s": 68.49429726600647, "time_total_s": 413.67543935775757, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 413.67543935775757, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.60721649484537, "ram_util_percent": 21.771134020618558}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.598343227307002, "policy_loss": -0.02840694415693482, "vf_loss": 3.259538421034813, "vf_explained_var": 0.8347925186157227, "kl": 0.0, "entropy": 88.56286875406902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1335835522701658, "mean_inference_ms": 7.6498406298832515, "mean_action_processing_ms": 0.4334265215867992, "mean_env_wait_ms": 0.2728652387784957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24827241897583008, "StateBufferConnector_ms": 0.004629373550415039, "ViewRequirementAgentConnector_ms": 0.18981170654296875}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1335835522701658, "mean_inference_ms": 7.6498406298832515, "mean_action_processing_ms": 0.4334265215867992, "mean_env_wait_ms": 0.2728652387784957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24827241897583008, "StateBufferConnector_ms": 0.004629373550415039, "ViewRequirementAgentConnector_ms": 0.18981170654296875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.47491365242931, "num_agent_steps_trained_throughput_per_sec": 7.47491365242931, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 68877.809, "sample_time_ms": 4857.442, "load_time_ms": 0.357, "load_throughput": 1432610.839, "learn_time_ms": 64019.097, "learn_throughput": 7.998, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 224, "training_iteration": 7, "trial_id": "1316e_00162", "date": "2024-02-26_23-44-27", "timestamp": 1708987467, "time_this_iter_s": 68.50119042396545, "time_total_s": 482.176629781723, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 482.176629781723, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 57.967346938775506, "ram_util_percent": 21.872448979591837}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.78, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.006875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.006875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.835096283753713, "policy_loss": 0.06608396961043278, "vf_loss": 3.4360716958840687, "vf_explained_var": 0.8351333479086558, "kl": 0.0, "entropy": 88.16210810343425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.78, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.006875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.006875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1320410842004522, "mean_inference_ms": 7.641717382319709, "mean_action_processing_ms": 0.43226356649523623, "mean_env_wait_ms": 0.2720438266773156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2503507137298584, "StateBufferConnector_ms": 0.004630088806152344, "ViewRequirementAgentConnector_ms": 0.19329428672790527}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1320410842004522, "mean_inference_ms": 7.641717382319709, "mean_action_processing_ms": 0.43226356649523623, "mean_env_wait_ms": 0.2720438266773156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2503507137298584, "StateBufferConnector_ms": 0.004630088806152344, "ViewRequirementAgentConnector_ms": 0.19329428672790527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.393769752490098, "num_agent_steps_trained_throughput_per_sec": 7.393769752490098, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 68924.016, "sample_time_ms": 4878.911, "load_time_ms": 0.35, "load_throughput": 1461121.72, "learn_time_ms": 64043.852, "learn_throughput": 7.995, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 256, "training_iteration": 8, "trial_id": "1316e_00162", "date": "2024-02-26_23-45-36", "timestamp": 1708987536, "time_this_iter_s": 69.25248861312866, "time_total_s": 551.4291183948517, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 551.4291183948517, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.3938775510204, "ram_util_percent": 21.840816326530618}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.4182355433702467, "policy_loss": 0.2265183535714944, "vf_loss": 2.7197052935759225, "vf_explained_var": 0.861898145576318, "kl": 0.0, "entropy": 86.15920836130778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1320760064795117, "mean_inference_ms": 7.6404203591960735, "mean_action_processing_ms": 0.43183600613085993, "mean_env_wait_ms": 0.271722982285732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25249552726745605, "StateBufferConnector_ms": 0.004502773284912109, "ViewRequirementAgentConnector_ms": 0.1998884677886963}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1320760064795117, "mean_inference_ms": 7.6404203591960735, "mean_action_processing_ms": 0.43183600613085993, "mean_env_wait_ms": 0.271722982285732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25249552726745605, "StateBufferConnector_ms": 0.004502773284912109, "ViewRequirementAgentConnector_ms": 0.1998884677886963}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.4376655603192, "num_agent_steps_trained_throughput_per_sec": 7.4376655603192, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 68914.544, "sample_time_ms": 4889.674, "load_time_ms": 0.34, "load_throughput": 1506536.194, "learn_time_ms": 64023.668, "learn_throughput": 7.997, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 288, "training_iteration": 9, "trial_id": "1316e_00162", "date": "2024-02-26_23-46-45", "timestamp": 1708987605, "time_this_iter_s": 68.84373474121094, "time_total_s": 620.2728531360626, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 620.2728531360626, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.568041237113405, "ram_util_percent": 21.900000000000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.1227533171574273, "policy_loss": 0.2639609162695706, "vf_loss": 3.5474799424409866, "vf_explained_var": 0.8719092766443889, "kl": 0.0, "entropy": 84.2191073735555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1337676619782502, "mean_inference_ms": 7.647669804135117, "mean_action_processing_ms": 0.43227180055640446, "mean_env_wait_ms": 0.2720651844290899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25470423698425293, "StateBufferConnector_ms": 0.004568815231323242, "ViewRequirementAgentConnector_ms": 0.2038421630859375}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1337676619782502, "mean_inference_ms": 7.647669804135117, "mean_action_processing_ms": 0.43227180055640446, "mean_env_wait_ms": 0.2720651844290899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25470423698425293, "StateBufferConnector_ms": 0.004568815231323242, "ViewRequirementAgentConnector_ms": 0.2038421630859375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.489063496934679, "num_agent_steps_trained_throughput_per_sec": 7.489063496934679, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 68859.723, "sample_time_ms": 4877.069, "load_time_ms": 0.334, "load_throughput": 1531619.462, "learn_time_ms": 63981.469, "learn_throughput": 8.002, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 320, "training_iteration": 10, "trial_id": "1316e_00162", "date": "2024-02-26_23-47-53", "timestamp": 1708987673, "time_this_iter_s": 68.37140679359436, "time_total_s": 688.644259929657, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 688.644259929657, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.38659793814432, "ram_util_percent": 21.9}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.8153126358985903, "policy_loss": 0.10134565417344371, "vf_loss": 3.3677658716837566, "vf_explained_var": 0.8926012555758158, "kl": 0.0, "entropy": 86.63022314707437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1333172731884176, "mean_inference_ms": 7.646018652351816, "mean_action_processing_ms": 0.43203380015544574, "mean_env_wait_ms": 0.27178951962971665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25133180618286133, "StateBufferConnector_ms": 0.0044896602630615234, "ViewRequirementAgentConnector_ms": 0.19431376457214355}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1333172731884176, "mean_inference_ms": 7.646018652351816, "mean_action_processing_ms": 0.43203380015544574, "mean_env_wait_ms": 0.27178951962971665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25133180618286133, "StateBufferConnector_ms": 0.0044896602630615234, "ViewRequirementAgentConnector_ms": 0.19431376457214355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.533696060202334, "num_agent_steps_trained_throughput_per_sec": 7.533696060202334, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 68948.955, "sample_time_ms": 4875.084, "load_time_ms": 0.286, "load_throughput": 1787186.791, "learn_time_ms": 64072.736, "learn_throughput": 7.991, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 352, "training_iteration": 11, "trial_id": "1316e_00162", "date": "2024-02-26_23-49-01", "timestamp": 1708987741, "time_this_iter_s": 67.96633696556091, "time_total_s": 756.6105968952179, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 756.6105968952179, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 56.31237113402062, "ram_util_percent": 21.747422680412377}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.1880523229638738, "policy_loss": 0.1987143639785548, "vf_loss": 2.468572574853897, "vf_explained_var": 0.8725646043817202, "kl": 0.0, "entropy": 84.27448088328043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1308842651644313, "mean_inference_ms": 7.635576908600229, "mean_action_processing_ms": 0.4310371737687983, "mean_env_wait_ms": 0.2709665209988482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24642682075500488, "StateBufferConnector_ms": 0.004429340362548828, "ViewRequirementAgentConnector_ms": 0.18320631980895996}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1308842651644313, "mean_inference_ms": 7.635576908600229, "mean_action_processing_ms": 0.4310371737687983, "mean_env_wait_ms": 0.2709665209988482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24642682075500488, "StateBufferConnector_ms": 0.004429340362548828, "ViewRequirementAgentConnector_ms": 0.18320631980895996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.495357626339438, "num_agent_steps_trained_throughput_per_sec": 7.495357626339438, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 68846.129, "sample_time_ms": 4868.552, "load_time_ms": 0.287, "load_throughput": 1785403.765, "learn_time_ms": 63976.469, "learn_throughput": 8.003, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "1316e_00162", "date": "2024-02-26_23-50-10", "timestamp": 1708987810, "time_this_iter_s": 68.31433200836182, "time_total_s": 824.9249289035797, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 824.9249289035797, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.30824742268041, "ram_util_percent": 21.425773195876285}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 4.419929827253024, "policy_loss": 0.047069739053646725, "vf_loss": 5.426288971304894, "vf_explained_var": 0.8212934578458468, "kl": 0.0, "entropy": 82.05416692097982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.128736101376493, "mean_inference_ms": 7.62651210548453, "mean_action_processing_ms": 0.43025929759020165, "mean_env_wait_ms": 0.27025904324600797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24661898612976074, "StateBufferConnector_ms": 0.004426717758178711, "ViewRequirementAgentConnector_ms": 0.18397021293640137}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.128736101376493, "mean_inference_ms": 7.62651210548453, "mean_action_processing_ms": 0.43025929759020165, "mean_env_wait_ms": 0.27025904324600797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24661898612976074, "StateBufferConnector_ms": 0.004426717758178711, "ViewRequirementAgentConnector_ms": 0.18397021293640137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.45533643349702, "num_agent_steps_trained_throughput_per_sec": 7.45533643349702, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 68746.913, "sample_time_ms": 4854.318, "load_time_ms": 0.281, "load_throughput": 1822836.472, "learn_time_ms": 63891.492, "learn_throughput": 8.014, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 416, "training_iteration": 13, "trial_id": "1316e_00162", "date": "2024-02-26_23-51-18", "timestamp": 1708987878, "time_this_iter_s": 68.68072581291199, "time_total_s": 893.6056547164917, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 893.6056547164917, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 56.63367346938776, "ram_util_percent": 21.411224489795917}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.5361445690194766, "policy_loss": 0.174392593310525, "vf_loss": 4.171603328982989, "vf_explained_var": 0.8467836300532023, "kl": 0.0, "entropy": 80.1800573348999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1265562788838188, "mean_inference_ms": 7.617216205299784, "mean_action_processing_ms": 0.42942838430788755, "mean_env_wait_ms": 0.26958780210279387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24526047706604004, "StateBufferConnector_ms": 0.004422426223754883, "ViewRequirementAgentConnector_ms": 0.18495512008666992}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1265562788838188, "mean_inference_ms": 7.617216205299784, "mean_action_processing_ms": 0.42942838430788755, "mean_env_wait_ms": 0.26958780210279387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24526047706604004, "StateBufferConnector_ms": 0.004422426223754883, "ViewRequirementAgentConnector_ms": 0.18495512008666992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.38766895194321, "num_agent_steps_trained_throughput_per_sec": 7.38766895194321, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 68724.838, "sample_time_ms": 4842.638, "load_time_ms": 0.276, "load_throughput": 1856881.667, "learn_time_ms": 63881.1, "learn_throughput": 8.015, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 448, "training_iteration": 14, "trial_id": "1316e_00162", "date": "2024-02-26_23-52-28", "timestamp": 1708987948, "time_this_iter_s": 69.30988812446594, "time_total_s": 962.9155428409576, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 962.9155428409576, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 56.82551020408163, "ram_util_percent": 21.378571428571426}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.0943842882911363, "policy_loss": 0.06175174160550038, "vf_loss": 1.2813953141371408, "vf_explained_var": 0.865576358139515, "kl": 0.0, "entropy": 81.61349964141846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1264437855265375, "mean_inference_ms": 7.6157257949742165, "mean_action_processing_ms": 0.42934452395673534, "mean_env_wait_ms": 0.2695594797947631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25100207328796387, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.19701576232910156}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1264437855265375, "mean_inference_ms": 7.6157257949742165, "mean_action_processing_ms": 0.42934452395673534, "mean_env_wait_ms": 0.2695594797947631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25100207328796387, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.19701576232910156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.33862178779073, "num_agent_steps_trained_throughput_per_sec": 7.33862178779073, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 68745.567, "sample_time_ms": 4842.156, "load_time_ms": 0.275, "load_throughput": 1863003.078, "learn_time_ms": 63902.28, "learn_throughput": 8.012, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 480, "training_iteration": 15, "trial_id": "1316e_00162", "date": "2024-02-26_23-53-38", "timestamp": 1708988018, "time_this_iter_s": 69.77323269844055, "time_total_s": 1032.6887755393982, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1032.6887755393982, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 56.729292929292924, "ram_util_percent": 21.5030303030303}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.3702171524365743, "policy_loss": 0.20741792026286324, "vf_loss": 2.683820946017901, "vf_explained_var": 0.8326137940088908, "kl": 0.0, "entropy": 83.42788340250651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1279248896634828, "mean_inference_ms": 7.619704599316392, "mean_action_processing_ms": 0.4296034201258447, "mean_env_wait_ms": 0.26997849886248143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25598859786987305, "StateBufferConnector_ms": 0.004576683044433594, "ViewRequirementAgentConnector_ms": 0.20575404167175293}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1279248896634828, "mean_inference_ms": 7.619704599316392, "mean_action_processing_ms": 0.4296034201258447, "mean_env_wait_ms": 0.26997849886248143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25598859786987305, "StateBufferConnector_ms": 0.004576683044433594, "ViewRequirementAgentConnector_ms": 0.20575404167175293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.366536965461055, "num_agent_steps_trained_throughput_per_sec": 7.366536965461055, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 68847.001, "sample_time_ms": 4854.245, "load_time_ms": 0.279, "load_throughput": 1833888.683, "learn_time_ms": 63991.611, "learn_throughput": 8.001, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 512, "training_iteration": 16, "trial_id": "1316e_00162", "date": "2024-02-26_23-54-47", "timestamp": 1708988087, "time_this_iter_s": 69.50861597061157, "time_total_s": 1102.1973915100098, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1102.1973915100098, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 56.42959183673469, "ram_util_percent": 21.483673469387757}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.78, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.006875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.006875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.4909321946402392, "policy_loss": 0.05577578420440356, "vf_loss": 1.7808878168463707, "vf_explained_var": 0.8169429078698158, "kl": 0.0, "entropy": 84.70979226430258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.78, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.006875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.006875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1302221453064853, "mean_inference_ms": 7.627330795437676, "mean_action_processing_ms": 0.43016601264469156, "mean_env_wait_ms": 0.2706546675806429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25918054580688477, "StateBufferConnector_ms": 0.004629373550415039, "ViewRequirementAgentConnector_ms": 0.21271395683288574}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1302221453064853, "mean_inference_ms": 7.627330795437676, "mean_action_processing_ms": 0.43016601264469156, "mean_env_wait_ms": 0.2706546675806429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25918054580688477, "StateBufferConnector_ms": 0.004629373550415039, "ViewRequirementAgentConnector_ms": 0.21271395683288574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.437444933699479, "num_agent_steps_trained_throughput_per_sec": 7.437444933699479, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 68881.511, "sample_time_ms": 4878.617, "load_time_ms": 0.277, "load_throughput": 1847774.607, "learn_time_ms": 64001.794, "learn_throughput": 8.0, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 544, "training_iteration": 17, "trial_id": "1316e_00162", "date": "2024-02-26_23-55-56", "timestamp": 1708988156, "time_this_iter_s": 68.84586668014526, "time_total_s": 1171.043258190155, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1171.043258190155, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.566326530612244, "ram_util_percent": 21.376530612244903}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.223697484532992, "policy_loss": -0.02590583674609661, "vf_loss": 2.7915362382928532, "vf_explained_var": 0.8699026356140772, "kl": 0.0, "entropy": 83.87855555216471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1316129023537311, "mean_inference_ms": 7.6335325336055595, "mean_action_processing_ms": 0.43052434821688534, "mean_env_wait_ms": 0.2710938432204832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25736451148986816, "StateBufferConnector_ms": 0.004602670669555664, "ViewRequirementAgentConnector_ms": 0.20770525932312012}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1316129023537311, "mean_inference_ms": 7.6335325336055595, "mean_action_processing_ms": 0.43052434821688534, "mean_env_wait_ms": 0.2710938432204832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25736451148986816, "StateBufferConnector_ms": 0.004602670669555664, "ViewRequirementAgentConnector_ms": 0.20770525932312012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.4033793224416335, "num_agent_steps_trained_throughput_per_sec": 7.4033793224416335, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 68872.522, "sample_time_ms": 4870.576, "load_time_ms": 0.273, "load_throughput": 1875531.57, "learn_time_ms": 64000.858, "learn_throughput": 8.0, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "episodes_total": 576, "training_iteration": 18, "trial_id": "1316e_00162", "date": "2024-02-26_23-57-05", "timestamp": 1708988225, "time_this_iter_s": 69.16273546218872, "time_total_s": 1240.2059936523438, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1240.2059936523438, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.480612244897955, "ram_util_percent": 21.416326530612245}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.1186719705661137, "policy_loss": -0.02827114916096131, "vf_loss": 2.6641450439890226, "vf_explained_var": 0.8272919401526451, "kl": 0.0, "entropy": 83.60682169596355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1329671397596652, "mean_inference_ms": 7.64540200537918, "mean_action_processing_ms": 0.4309630210791315, "mean_env_wait_ms": 0.27156443550797643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25847792625427246, "StateBufferConnector_ms": 0.0046215057373046875, "ViewRequirementAgentConnector_ms": 0.20731163024902344}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1329671397596652, "mean_inference_ms": 7.64540200537918, "mean_action_processing_ms": 0.4309630210791315, "mean_env_wait_ms": 0.27156443550797643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25847792625427246, "StateBufferConnector_ms": 0.0046215057373046875, "ViewRequirementAgentConnector_ms": 0.20731163024902344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.300956453996736, "num_agent_steps_trained_throughput_per_sec": 7.300956453996736, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 69001.422, "sample_time_ms": 4891.16, "load_time_ms": 0.28, "load_throughput": 1828423.711, "learn_time_ms": 64109.105, "learn_throughput": 7.986, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "done": false, "episodes_total": 608, "training_iteration": 19, "trial_id": "1316e_00162", "date": "2024-02-26_23-58-15", "timestamp": 1708988295, "time_this_iter_s": 70.13303995132446, "time_total_s": 1310.3390336036682, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1310.3390336036682, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 56.551000000000016, "ram_util_percent": 21.448999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.9872564946611722, "policy_loss": -0.046483084994057816, "vf_loss": 2.5236706083019573, "vf_explained_var": 0.7792844285567602, "kl": 0.0, "entropy": 83.43523248036702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1342070055303308, "mean_inference_ms": 7.656060915270851, "mean_action_processing_ms": 0.43138232981468133, "mean_env_wait_ms": 0.2719935686177021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.258514404296875, "StateBufferConnector_ms": 0.004607200622558594, "ViewRequirementAgentConnector_ms": 0.2036881446838379}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1342070055303308, "mean_inference_ms": 7.656060915270851, "mean_action_processing_ms": 0.43138232981468133, "mean_env_wait_ms": 0.2719935686177021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.258514404296875, "StateBufferConnector_ms": 0.004607200622558594, "ViewRequirementAgentConnector_ms": 0.2036881446838379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.3092329800644364, "num_agent_steps_trained_throughput_per_sec": 7.3092329800644364, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 69169.623, "sample_time_ms": 4903.562, "load_time_ms": 0.283, "load_throughput": 1811458.159, "learn_time_ms": 64264.844, "learn_throughput": 7.967, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 640, "training_iteration": 20, "trial_id": "1316e_00162", "date": "2024-02-26_23-59-25", "timestamp": 1708988365, "time_this_iter_s": 70.0536298751831, "time_total_s": 1380.3926634788513, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1380.3926634788513, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.0979797979798, "ram_util_percent": 21.345454545454547}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.9063149775067965, "policy_loss": -0.04743228383983175, "vf_loss": 2.424407989780108, "vf_explained_var": 0.789725968738397, "kl": 0.0, "entropy": 83.98748900095622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1351013775102077, "mean_inference_ms": 7.662475860831436, "mean_action_processing_ms": 0.43153724633455964, "mean_env_wait_ms": 0.27227565492926925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25566625595092773, "StateBufferConnector_ms": 0.004577159881591797, "ViewRequirementAgentConnector_ms": 0.20001554489135742}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1351013775102077, "mean_inference_ms": 7.662475860831436, "mean_action_processing_ms": 0.43153724633455964, "mean_env_wait_ms": 0.27227565492926925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25566625595092773, "StateBufferConnector_ms": 0.004577159881591797, "ViewRequirementAgentConnector_ms": 0.20001554489135742}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.387480227202713, "num_agent_steps_trained_throughput_per_sec": 7.387480227202713, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 69304.134, "sample_time_ms": 4902.551, "load_time_ms": 0.285, "load_throughput": 1796456.122, "learn_time_ms": 64400.331, "learn_throughput": 7.95, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 672, "training_iteration": 21, "trial_id": "1316e_00162", "date": "2024-02-27_00-00-35", "timestamp": 1708988435, "time_this_iter_s": 69.31169199943542, "time_total_s": 1449.7043554782867, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1449.7043554782867, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.47551020408164, "ram_util_percent": 21.528571428571425}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.9412697598338127, "policy_loss": -0.049109961558133366, "vf_loss": 2.469865295290947, "vf_explained_var": 0.6915773332118988, "kl": 0.0, "entropy": 83.7298370997111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1360558734521071, "mean_inference_ms": 7.663213347679002, "mean_action_processing_ms": 0.4316984305558303, "mean_env_wait_ms": 0.27250919277658886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2566719055175781, "StateBufferConnector_ms": 0.004589080810546875, "ViewRequirementAgentConnector_ms": 0.2046680450439453}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1360558734521071, "mean_inference_ms": 7.663213347679002, "mean_action_processing_ms": 0.4316984305558303, "mean_env_wait_ms": 0.27250919277658886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2566719055175781, "StateBufferConnector_ms": 0.004589080810546875, "ViewRequirementAgentConnector_ms": 0.2046680450439453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.202642977895194, "num_agent_steps_trained_throughput_per_sec": 7.202642977895194, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 69581.739, "sample_time_ms": 4925.132, "load_time_ms": 0.284, "load_throughput": 1802941.523, "learn_time_ms": 64655.312, "learn_throughput": 7.919, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "episodes_total": 704, "training_iteration": 22, "trial_id": "1316e_00162", "date": "2024-02-27_00-01-46", "timestamp": 1708988506, "time_this_iter_s": 71.09030342102051, "time_total_s": 1520.7946588993073, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1520.7946588993073, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 55.9, "ram_util_percent": 21.48217821782178}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.8967550814151763, "policy_loss": -0.04227453153580427, "vf_loss": 2.4061449001232784, "vf_explained_var": 0.6427647133668264, "kl": 0.0, "entropy": 83.60145015716553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1376189207856393, "mean_inference_ms": 7.667049436691648, "mean_action_processing_ms": 0.43200489573625817, "mean_env_wait_ms": 0.2728695017555464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2617485523223877, "StateBufferConnector_ms": 0.004679203033447266, "ViewRequirementAgentConnector_ms": 0.21158456802368164}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1376189207856393, "mean_inference_ms": 7.667049436691648, "mean_action_processing_ms": 0.43200489573625817, "mean_env_wait_ms": 0.2728695017555464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2617485523223877, "StateBufferConnector_ms": 0.004679203033447266, "ViewRequirementAgentConnector_ms": 0.21158456802368164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.336177261538962, "num_agent_steps_trained_throughput_per_sec": 7.336177261538962, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 69693.286, "sample_time_ms": 4955.219, "load_time_ms": 0.287, "load_throughput": 1782439.947, "learn_time_ms": 64736.774, "learn_throughput": 7.909, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "done": false, "episodes_total": 736, "training_iteration": 23, "trial_id": "1316e_00162", "date": "2024-02-27_00-02-56", "timestamp": 1708988576, "time_this_iter_s": 69.79631066322327, "time_total_s": 1590.5909695625305, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1590.5909695625305, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 54.73939393939395, "ram_util_percent": 21.517171717171717}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.64, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.754764743645986, "policy_loss": -0.0436788324577113, "vf_loss": 2.2316914151112237, "vf_explained_var": 0.6991105283300082, "kl": 0.0, "entropy": 83.93185380299886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.64, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1400477105870614, "mean_inference_ms": 7.676552052165932, "mean_action_processing_ms": 0.43271041784172765, "mean_env_wait_ms": 0.2735803941331048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26843762397766113, "StateBufferConnector_ms": 0.0047609806060791016, "ViewRequirementAgentConnector_ms": 0.22171974182128906}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -10.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1400477105870614, "mean_inference_ms": 7.676552052165932, "mean_action_processing_ms": 0.43271041784172765, "mean_env_wait_ms": 0.2735803941331048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26843762397766113, "StateBufferConnector_ms": 0.0047609806060791016, "ViewRequirementAgentConnector_ms": 0.22171974182128906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.28563396695558, "num_agent_steps_trained_throughput_per_sec": 7.28563396695558, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 69790.346, "sample_time_ms": 4988.742, "load_time_ms": 0.289, "load_throughput": 1770536.44, "learn_time_ms": 64800.237, "learn_throughput": 7.901, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 768, "training_iteration": 24, "trial_id": "1316e_00162", "date": "2024-02-27_00-04-06", "timestamp": 1708988646, "time_this_iter_s": 70.28123116493225, "time_total_s": 1660.8722007274628, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1660.8722007274628, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.245454545454535, "ram_util_percent": 21.67171717171718}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.66, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.010625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.010625, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.83832927942276, "policy_loss": -0.00977802537381649, "vf_loss": 2.2933192014694215, "vf_explained_var": 0.6574253608783086, "kl": 0.0, "entropy": 84.60569095611572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.66, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.010625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.010625, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -10.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1414669708891185, "mean_inference_ms": 7.686203355789075, "mean_action_processing_ms": 0.4330625987317322, "mean_env_wait_ms": 0.27404444564024133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2658252716064453, "StateBufferConnector_ms": 0.004712343215942383, "ViewRequirementAgentConnector_ms": 0.21231913566589355}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -10.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1414669708891185, "mean_inference_ms": 7.686203355789075, "mean_action_processing_ms": 0.4330625987317322, "mean_env_wait_ms": 0.27404444564024133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2658252716064453, "StateBufferConnector_ms": 0.004712343215942383, "ViewRequirementAgentConnector_ms": 0.21231913566589355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.410795226621963, "num_agent_steps_trained_throughput_per_sec": 7.410795226621963, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 69722.399, "sample_time_ms": 4982.57, "load_time_ms": 0.29, "load_throughput": 1767330.794, "learn_time_ms": 64738.479, "learn_throughput": 7.909, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 800, "training_iteration": 25, "trial_id": "1316e_00162", "date": "2024-02-27_00-05-15", "timestamp": 1708988715, "time_this_iter_s": 69.09368634223938, "time_total_s": 1729.9658870697021, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1729.9658870697021, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 54.094897959183676, "ram_util_percent": 21.640816326530608}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.66, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.010625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.010625, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.8204621483882268, "policy_loss": -0.024869894764075678, "vf_loss": 2.2898753941059113, "vf_explained_var": 0.5722611164053281, "kl": 0.0, "entropy": 84.00453929901123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.66, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.010625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.010625, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1430745479988187, "mean_inference_ms": 7.6952396850711375, "mean_action_processing_ms": 0.4334387000051082, "mean_env_wait_ms": 0.2744898182005898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26473522186279297, "StateBufferConnector_ms": 0.004885435104370117, "ViewRequirementAgentConnector_ms": 0.21568036079406738}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1430745479988187, "mean_inference_ms": 7.6952396850711375, "mean_action_processing_ms": 0.4334387000051082, "mean_env_wait_ms": 0.2744898182005898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26473522186279297, "StateBufferConnector_ms": 0.004885435104370117, "ViewRequirementAgentConnector_ms": 0.21568036079406738}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.300662776721533, "num_agent_steps_trained_throughput_per_sec": 7.300662776721533, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 69785.112, "sample_time_ms": 4996.212, "load_time_ms": 0.288, "load_throughput": 1778601.663, "learn_time_ms": 64787.528, "learn_throughput": 7.903, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "episodes_total": 832, "training_iteration": 26, "trial_id": "1316e_00162", "date": "2024-02-27_00-06-25", "timestamp": 1708988785, "time_this_iter_s": 70.13582062721252, "time_total_s": 1800.1017076969147, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1800.1017076969147, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 54.11199999999999, "ram_util_percent": 21.496}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.7338562190532685, "policy_loss": 0.003907976516832908, "vf_loss": 2.1466954842209818, "vf_explained_var": 0.7130750690897306, "kl": 0.0, "entropy": 84.0195114771525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144286541164939, "mean_inference_ms": 7.701592640692388, "mean_action_processing_ms": 0.43365464355048533, "mean_env_wait_ms": 0.27471043883811197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26155710220336914, "StateBufferConnector_ms": 0.0048635005950927734, "ViewRequirementAgentConnector_ms": 0.2119758129119873}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144286541164939, "mean_inference_ms": 7.701592640692388, "mean_action_processing_ms": 0.43365464355048533, "mean_env_wait_ms": 0.27471043883811197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26155710220336914, "StateBufferConnector_ms": 0.0048635005950927734, "ViewRequirementAgentConnector_ms": 0.2119758129119873}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.34918191090246, "num_agent_steps_trained_throughput_per_sec": 7.34918191090246, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 69867.79, "sample_time_ms": 5005.938, "load_time_ms": 0.292, "load_throughput": 1751332.285, "learn_time_ms": 64860.413, "learn_throughput": 7.894, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "done": false, "episodes_total": 864, "training_iteration": 27, "trial_id": "1316e_00162", "date": "2024-02-27_00-07-35", "timestamp": 1708988855, "time_this_iter_s": 69.67277097702026, "time_total_s": 1869.774478673935, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1869.774478673935, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 53.00909090909091, "ram_util_percent": 21.63131313131313}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.6098792945345244, "policy_loss": -0.0484610083202521, "vf_loss": 2.057837063074112, "vf_explained_var": 0.696055555343628, "kl": 0.0, "entropy": 84.1140344619751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.146402176208856, "mean_inference_ms": 7.708595331403085, "mean_action_processing_ms": 0.4341879802310963, "mean_env_wait_ms": 0.2751482319129338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2642025947570801, "StateBufferConnector_ms": 0.004899501800537109, "ViewRequirementAgentConnector_ms": 0.22062158584594727}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.146402176208856, "mean_inference_ms": 7.708595331403085, "mean_action_processing_ms": 0.4341879802310963, "mean_env_wait_ms": 0.2751482319129338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2642025947570801, "StateBufferConnector_ms": 0.004899501800537109, "ViewRequirementAgentConnector_ms": 0.22062158584594727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.356522140080141, "num_agent_steps_trained_throughput_per_sec": 7.356522140080141, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 69911.839, "sample_time_ms": 5020.388, "load_time_ms": 0.294, "load_throughput": 1742097.548, "learn_time_ms": 64890.009, "learn_throughput": 7.89, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "episodes_total": 896, "training_iteration": 28, "trial_id": "1316e_00162", "date": "2024-02-27_00-08-45", "timestamp": 1708988925, "time_this_iter_s": 69.6031014919281, "time_total_s": 1939.377580165863, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1939.377580165863, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 54.09285714285715, "ram_util_percent": 21.614285714285707}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.5622989386320114, "policy_loss": -0.035249790425101915, "vf_loss": 1.9824006954828899, "vf_explained_var": 0.629683970908324, "kl": 0.0, "entropy": 84.95451469421387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1475311176643108, "mean_inference_ms": 7.712834849681538, "mean_action_processing_ms": 0.4345167445859427, "mean_env_wait_ms": 0.2753989413215178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2611417770385742, "StateBufferConnector_ms": 0.004683971405029297, "ViewRequirementAgentConnector_ms": 0.21275568008422852}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1475311176643108, "mean_inference_ms": 7.712834849681538, "mean_action_processing_ms": 0.4345167445859427, "mean_env_wait_ms": 0.2753989413215178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2611417770385742, "StateBufferConnector_ms": 0.004683971405029297, "ViewRequirementAgentConnector_ms": 0.21275568008422852}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.339965832788474, "num_agent_steps_trained_throughput_per_sec": 7.339965832788474, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 69874.568, "sample_time_ms": 4994.544, "load_time_ms": 0.292, "load_throughput": 1751760.868, "learn_time_ms": 64878.6, "learn_throughput": 7.892, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "done": false, "episodes_total": 928, "training_iteration": 29, "trial_id": "1316e_00162", "date": "2024-02-27_00-09-55", "timestamp": 1708988995, "time_this_iter_s": 69.7603907585144, "time_total_s": 2009.1379709243774, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2009.1379709243774, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 53.97575757575758, "ram_util_percent": 21.660606060606067}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.76, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0075, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0075, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.687536775569121, "policy_loss": -0.00864385993530353, "vf_loss": 2.1047931681076686, "vf_explained_var": 0.5224476009607315, "kl": 0.0, "entropy": 84.31441733042399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.76, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0075, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0075, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1487560773822743, "mean_inference_ms": 7.717403371261659, "mean_action_processing_ms": 0.4348620373586247, "mean_env_wait_ms": 0.2756670916011493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26111555099487305, "StateBufferConnector_ms": 0.005043983459472656, "ViewRequirementAgentConnector_ms": 0.21615338325500488}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1487560773822743, "mean_inference_ms": 7.717403371261659, "mean_action_processing_ms": 0.4348620373586247, "mean_env_wait_ms": 0.2756670916011493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26111555099487305, "StateBufferConnector_ms": 0.005043983459472656, "ViewRequirementAgentConnector_ms": 0.21615338325500488}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.412470425139602, "num_agent_steps_trained_throughput_per_sec": 7.412470425139602, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 69777.01, "sample_time_ms": 5010.362, "load_time_ms": 0.291, "load_throughput": 1760376.792, "learn_time_ms": 64765.262, "learn_throughput": 7.905, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 960, "training_iteration": 30, "trial_id": "1316e_00162", "date": "2024-02-27_00-11-04", "timestamp": 1708989064, "time_this_iter_s": 69.07793951034546, "time_total_s": 2078.215910434723, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2078.215910434723, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 54.64489795918366, "ram_util_percent": 21.679591836734698}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.5359533237914245, "policy_loss": 0.052077716464797655, "vf_loss": 1.8413435265421867, "vf_explained_var": 0.6824261243144671, "kl": 0.0, "entropy": 84.49592946370443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1497129080754604, "mean_inference_ms": 7.721237797280066, "mean_action_processing_ms": 0.4351437214447044, "mean_env_wait_ms": 0.27589438667984045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2615625858306885, "StateBufferConnector_ms": 0.005045413970947266, "ViewRequirementAgentConnector_ms": 0.21487641334533691}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1497129080754604, "mean_inference_ms": 7.721237797280066, "mean_action_processing_ms": 0.4351437214447044, "mean_env_wait_ms": 0.27589438667984045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2615625858306885, "StateBufferConnector_ms": 0.005045413970947266, "ViewRequirementAgentConnector_ms": 0.21487641334533691}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.347977118659573, "num_agent_steps_trained_throughput_per_sec": 7.347977118659573, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 69814.27, "sample_time_ms": 5035.095, "load_time_ms": 0.291, "load_throughput": 1757207.796, "learn_time_ms": 64777.806, "learn_throughput": 7.904, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "done": false, "episodes_total": 992, "training_iteration": 31, "trial_id": "1316e_00162", "date": "2024-02-27_00-12-13", "timestamp": 1708989133, "time_this_iter_s": 69.6841197013855, "time_total_s": 2147.9000301361084, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2147.9000301361084, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 54.49797979797979, "ram_util_percent": 21.647474747474742}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.4347540785868962, "policy_loss": -0.03773749138539036, "vf_loss": 1.8272170489033064, "vf_explained_var": 0.6507537012298902, "kl": 0.0, "entropy": 84.6415267308553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.7, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.009375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.009375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.15105016104012, "mean_inference_ms": 7.7259626941031, "mean_action_processing_ms": 0.43556683864558565, "mean_env_wait_ms": 0.27624463909309116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26579713821411133, "StateBufferConnector_ms": 0.0050961971282958984, "ViewRequirementAgentConnector_ms": 0.2235865592956543}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.15105016104012, "mean_inference_ms": 7.7259626941031, "mean_action_processing_ms": 0.43556683864558565, "mean_env_wait_ms": 0.27624463909309116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26579713821411133, "StateBufferConnector_ms": 0.0050961971282958984, "ViewRequirementAgentConnector_ms": 0.2235865592956543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.389095957956532, "num_agent_steps_trained_throughput_per_sec": 7.389095957956532, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 69634.898, "sample_time_ms": 5037.73, "load_time_ms": 0.289, "load_throughput": 1772143.628, "learn_time_ms": 64595.811, "learn_throughput": 7.926, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 1024, "training_iteration": 32, "trial_id": "1316e_00162", "date": "2024-02-27_00-13-23", "timestamp": 1708989203, "time_this_iter_s": 69.296701669693, "time_total_s": 2217.1967318058014, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2217.1967318058014, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 54.23469387755101, "ram_util_percent": 21.72040816326531}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.580757602552573, "policy_loss": -0.011077008148034414, "vf_loss": 1.9753100261092187, "vf_explained_var": 0.5281219720840454, "kl": 0.0, "entropy": 84.84492435455323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.74, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.008125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.008125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1520485814264243, "mean_inference_ms": 7.729897971732942, "mean_action_processing_ms": 0.43595153164911976, "mean_env_wait_ms": 0.2765772235567328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2651996612548828, "StateBufferConnector_ms": 0.004721164703369141, "ViewRequirementAgentConnector_ms": 0.22022628784179688}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1520485814264243, "mean_inference_ms": 7.729897971732942, "mean_action_processing_ms": 0.43595153164911976, "mean_env_wait_ms": 0.2765772235567328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2651996612548828, "StateBufferConnector_ms": 0.004721164703369141, "ViewRequirementAgentConnector_ms": 0.22022628784179688}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.344755936861022, "num_agent_steps_trained_throughput_per_sec": 7.344755936861022, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 69626.747, "sample_time_ms": 5028.328, "load_time_ms": 0.287, "load_throughput": 1786294.833, "learn_time_ms": 64597.035, "learn_throughput": 7.926, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "done": false, "episodes_total": 1056, "training_iteration": 33, "trial_id": "1316e_00162", "date": "2024-02-27_00-14-33", "timestamp": 1708989273, "time_this_iter_s": 69.71489429473877, "time_total_s": 2286.91162610054, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2286.91162610054, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 54.792929292929294, "ram_util_percent": 21.791919191919202}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.694639111061891, "policy_loss": 0.2562645350582898, "vf_loss": 1.7848812202612558, "vf_explained_var": 0.5157335788011551, "kl": 0.0, "entropy": 84.58043677012125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1523338556382823, "mean_inference_ms": 7.730738838767743, "mean_action_processing_ms": 0.4361073751804009, "mean_env_wait_ms": 0.27669564616027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25989484786987305, "StateBufferConnector_ms": 0.004690885543823242, "ViewRequirementAgentConnector_ms": 0.2141566276550293}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1523338556382823, "mean_inference_ms": 7.730738838767743, "mean_action_processing_ms": 0.4361073751804009, "mean_env_wait_ms": 0.27669564616027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25989484786987305, "StateBufferConnector_ms": 0.004690885543823242, "ViewRequirementAgentConnector_ms": 0.2141566276550293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.415277873243853, "num_agent_steps_trained_throughput_per_sec": 7.415277873243853, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 69503.884, "sample_time_ms": 5002.457, "load_time_ms": 0.286, "load_throughput": 1790166.429, "learn_time_ms": 64500.13, "learn_throughput": 7.938, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "episodes_total": 1088, "training_iteration": 34, "trial_id": "1316e_00162", "date": "2024-02-27_00-15-42", "timestamp": 1708989342, "time_this_iter_s": 69.05165719985962, "time_total_s": 2355.9632833004, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2355.9632833004, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 53.95612244897959, "ram_util_percent": 21.825510204081638}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.6, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.094921745856603, "policy_loss": 0.2960009246133268, "vf_loss": 2.2322836498419445, "vf_explained_var": 0.7235433662931124, "kl": 0.0, "entropy": 90.77090034484863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.6, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.0125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1527106603808863, "mean_inference_ms": 7.733679070953701, "mean_action_processing_ms": 0.4362219360879747, "mean_env_wait_ms": 0.27685530682392867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2611994743347168, "StateBufferConnector_ms": 0.004679679870605469, "ViewRequirementAgentConnector_ms": 0.21498870849609375}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1527106603808863, "mean_inference_ms": 7.733679070953701, "mean_action_processing_ms": 0.4362219360879747, "mean_env_wait_ms": 0.27685530682392867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2611994743347168, "StateBufferConnector_ms": 0.004679679870605469, "ViewRequirementAgentConnector_ms": 0.21498870849609375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.422005517749275, "num_agent_steps_trained_throughput_per_sec": 7.422005517749275, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 69493.45, "sample_time_ms": 5024.092, "load_time_ms": 0.287, "load_throughput": 1786443.431, "learn_time_ms": 64468.054, "learn_throughput": 7.942, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 1120, "training_iteration": 35, "trial_id": "1316e_00162", "date": "2024-02-27_00-16-51", "timestamp": 1708989411, "time_this_iter_s": 68.98934698104858, "time_total_s": 2424.9526302814484, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2424.9526302814484, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 54.080612244897964, "ram_util_percent": 21.812244897959182}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.44, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0175, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.0175, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.4265089283386865, "policy_loss": 0.2918561898171902, "vf_loss": 2.6488939424355826, "vf_explained_var": 0.5978664661447207, "kl": 0.0, "entropy": 99.39454987843831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "sampler_results": {"episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.44, "reward_total_min": -16, "reward_total_max": -8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0175, "reward_percentile_min": 0.0, "reward_percentile_max": 0.25, "reward_score_mean": 0.0175, "reward_score_min": 0.0, "reward_score_max": 0.25, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1523768669592709, "mean_inference_ms": 7.733458806547069, "mean_action_processing_ms": 0.4360637945162935, "mean_env_wait_ms": 0.2767846772235669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2532978057861328, "StateBufferConnector_ms": 0.004556417465209961, "ViewRequirementAgentConnector_ms": 0.20159196853637695}}, "episode_reward_max": -8.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1523768669592709, "mean_inference_ms": 7.733458806547069, "mean_action_processing_ms": 0.4360637945162935, "mean_env_wait_ms": 0.2767846772235669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2532978057861328, "StateBufferConnector_ms": 0.004556417465209961, "ViewRequirementAgentConnector_ms": 0.20159196853637695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.481964862481362, "num_agent_steps_trained_throughput_per_sec": 7.481964862481362, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 69323.511, "sample_time_ms": 4989.047, "load_time_ms": 0.283, "load_throughput": 1808864.259, "learn_time_ms": 64333.2, "learn_throughput": 7.959, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "episodes_total": 1152, "training_iteration": 36, "trial_id": "1316e_00162", "date": "2024-02-27_00-17-59", "timestamp": 1708989479, "time_this_iter_s": 68.43633270263672, "time_total_s": 2493.388962984085, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2493.388962984085, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 54.2082474226804, "ram_util_percent": 21.709278350515465}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.54, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.045625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.045625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.123773664732774, "policy_loss": 0.26968170071486386, "vf_loss": 2.3007456563413142, "vf_explained_var": 0.1364330381155014, "kl": 0.0, "entropy": 105.29059391021728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.54, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.045625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.045625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.15259584351559, "mean_inference_ms": 7.735591929553331, "mean_action_processing_ms": 0.4361240739357025, "mean_env_wait_ms": 0.27686728948821154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25858521461486816, "StateBufferConnector_ms": 0.00458073616027832, "ViewRequirementAgentConnector_ms": 0.2081305980682373}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.15259584351559, "mean_inference_ms": 7.735591929553331, "mean_action_processing_ms": 0.4361240739357025, "mean_env_wait_ms": 0.27686728948821154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25858521461486816, "StateBufferConnector_ms": 0.00458073616027832, "ViewRequirementAgentConnector_ms": 0.2081305980682373}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.49559002198167, "num_agent_steps_trained_throughput_per_sec": 7.49559002198167, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 69187.432, "sample_time_ms": 4994.644, "load_time_ms": 0.28, "load_throughput": 1826868.267, "learn_time_ms": 64191.577, "learn_throughput": 7.976, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "done": false, "episodes_total": 1184, "training_iteration": 37, "trial_id": "1316e_00162", "date": "2024-02-27_00-19-08", "timestamp": 1708989548, "time_this_iter_s": 68.31184124946594, "time_total_s": 2561.700804233551, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2561.700804233551, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 54.135714285714286, "ram_util_percent": 21.743877551020404}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.26, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.054375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.054375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.359822529554367, "policy_loss": 0.2181143796692292, "vf_loss": 1.4167474475999673, "vf_explained_var": 0.6100563829143842, "kl": 0.0, "entropy": 103.28026803334554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.26, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.054375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.054375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1520355518345893, "mean_inference_ms": 7.732946640403152, "mean_action_processing_ms": 0.43596875483629416, "mean_env_wait_ms": 0.27671584725438486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2521853446960449, "StateBufferConnector_ms": 0.0047283172607421875, "ViewRequirementAgentConnector_ms": 0.19546103477478027}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1520355518345893, "mean_inference_ms": 7.732946640403152, "mean_action_processing_ms": 0.43596875483629416, "mean_env_wait_ms": 0.27671584725438486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2521853446960449, "StateBufferConnector_ms": 0.0047283172607421875, "ViewRequirementAgentConnector_ms": 0.19546103477478027}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.545253102831094, "num_agent_steps_trained_throughput_per_sec": 7.545253102831094, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 69013.345, "sample_time_ms": 4963.597, "load_time_ms": 0.284, "load_throughput": 1804153.279, "learn_time_ms": 64048.541, "learn_throughput": 7.994, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "episodes_total": 1216, "training_iteration": 38, "trial_id": "1316e_00162", "date": "2024-02-27_00-20-16", "timestamp": 1708989616, "time_this_iter_s": 67.86226415634155, "time_total_s": 2629.5630683898926, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2629.5630683898926, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 53.99793814432991, "ram_util_percent": 21.701030927835053}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.66, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.073125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.073125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.5888055672248202, "policy_loss": 0.30287332348525525, "vf_loss": 2.836616945266724, "vf_explained_var": 0.38077584803104403, "kl": 0.0, "entropy": 101.68165423075358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.66, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.073125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.073125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -2.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1514316224145735, "mean_inference_ms": 7.730389131652573, "mean_action_processing_ms": 0.43583622826791185, "mean_env_wait_ms": 0.2765740851315159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25153017044067383, "StateBufferConnector_ms": 0.004698991775512695, "ViewRequirementAgentConnector_ms": 0.19512271881103516}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -2.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1514316224145735, "mean_inference_ms": 7.730389131652573, "mean_action_processing_ms": 0.43583622826791185, "mean_env_wait_ms": 0.2765740851315159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25153017044067383, "StateBufferConnector_ms": 0.004698991775512695, "ViewRequirementAgentConnector_ms": 0.19512271881103516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.544584302447983, "num_agent_steps_trained_throughput_per_sec": 7.544584302447983, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 68824.16, "sample_time_ms": 4950.335, "load_time_ms": 0.278, "load_throughput": 1844600.282, "learn_time_ms": 63872.671, "learn_throughput": 8.016, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 1248, "training_iteration": 39, "trial_id": "1316e_00162", "date": "2024-02-27_00-21-24", "timestamp": 1708989684, "time_this_iter_s": 67.86824440956116, "time_total_s": 2697.4313127994537, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2697.4313127994537, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 54.125, "ram_util_percent": 21.657291666666666}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.18, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.088125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.088125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.070189509789149, "policy_loss": 0.29290503794327377, "vf_loss": 3.4463366438945133, "vf_explained_var": 0.08766110142072042, "kl": 0.0, "entropy": 107.14987055460612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.18, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.088125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.088125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1506019535237073, "mean_inference_ms": 7.727140143060898, "mean_action_processing_ms": 0.43561050738802876, "mean_env_wait_ms": 0.2763687756071158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2499861717224121, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.19051051139831543}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1506019535237073, "mean_inference_ms": 7.727140143060898, "mean_action_processing_ms": 0.43561050738802876, "mean_env_wait_ms": 0.2763687756071158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2499861717224121, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.19051051139831543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.525042684749913, "num_agent_steps_trained_throughput_per_sec": 7.525042684749913, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 68720.829, "sample_time_ms": 4939.615, "load_time_ms": 0.277, "load_throughput": 1850640.855, "learn_time_ms": 63779.991, "learn_throughput": 8.028, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 1280, "training_iteration": 40, "trial_id": "1316e_00162", "date": "2024-02-27_00-22-32", "timestamp": 1708989752, "time_this_iter_s": 68.04520320892334, "time_total_s": 2765.476516008377, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2765.476516008377, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 54.339175257731966, "ram_util_percent": 21.644329896907212}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.72, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.13375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.2824199885129928, "policy_loss": -0.021353738832597932, "vf_loss": 4.099658077955246, "vf_explained_var": 0.18877336581548054, "kl": 0.0, "entropy": 109.40111808776855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.72, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.13375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 4.0, -16.0, -16.0, 8.0, 8.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 12.0, -16.0, -16.0, -16.0, -16.0, 6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1499577695487018, "mean_inference_ms": 7.724643952158242, "mean_action_processing_ms": 0.43545116405558515, "mean_env_wait_ms": 0.27623476777959205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2524220943450928, "StateBufferConnector_ms": 0.004524946212768555, "ViewRequirementAgentConnector_ms": 0.19221854209899902}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 4.0, -16.0, -16.0, 8.0, 8.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 12.0, -16.0, -16.0, -16.0, -16.0, 6.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1499577695487018, "mean_inference_ms": 7.724643952158242, "mean_action_processing_ms": 0.43545116405558515, "mean_env_wait_ms": 0.27623476777959205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2524220943450928, "StateBufferConnector_ms": 0.004524946212768555, "ViewRequirementAgentConnector_ms": 0.19221854209899902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.530136864602038, "num_agent_steps_trained_throughput_per_sec": 7.530136864602038, "timesteps_total": 20992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 68552.27, "sample_time_ms": 4921.313, "load_time_ms": 0.275, "load_throughput": 1864135.111, "learn_time_ms": 63629.731, "learn_throughput": 8.047, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "done": false, "episodes_total": 1312, "training_iteration": 41, "trial_id": "1316e_00162", "date": "2024-02-27_00-23-40", "timestamp": 1708989820, "time_this_iter_s": 67.99850225448608, "time_total_s": 2833.475018262863, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2833.475018262863, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 53.978350515463916, "ram_util_percent": 21.762886597938145}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.36, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.17625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.362805100282033, "policy_loss": 0.3093738480936736, "vf_loss": 3.789007677634557, "vf_explained_var": 0.0014915411671002706, "kl": 0.0, "entropy": 113.6179656346639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.36, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.17625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 4.0, -16.0, -16.0, 8.0, 8.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 12.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 4.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1494369617312958, "mean_inference_ms": 7.722391670971676, "mean_action_processing_ms": 0.43530229527160286, "mean_env_wait_ms": 0.27611355167783386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25406336784362793, "StateBufferConnector_ms": 0.004546165466308594, "ViewRequirementAgentConnector_ms": 0.19522500038146973}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 4.0, -16.0, -16.0, 8.0, 8.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 12.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 4.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1494369617312958, "mean_inference_ms": 7.722391670971676, "mean_action_processing_ms": 0.43530229527160286, "mean_env_wait_ms": 0.27611355167783386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25406336784362793, "StateBufferConnector_ms": 0.004546165466308594, "ViewRequirementAgentConnector_ms": 0.19522500038146973}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.560993548805557, "num_agent_steps_trained_throughput_per_sec": 7.560993548805557, "timesteps_total": 21504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 68394.739, "sample_time_ms": 4897.705, "load_time_ms": 0.274, "load_throughput": 1867701.903, "learn_time_ms": 63495.84, "learn_throughput": 8.064, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 1344, "training_iteration": 42, "trial_id": "1316e_00162", "date": "2024-02-27_00-24-48", "timestamp": 1708989888, "time_this_iter_s": 67.72090816497803, "time_total_s": 2901.195926427841, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2901.195926427841, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 54.05520833333333, "ram_util_percent": 21.714583333333337}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.72, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.165, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.165, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.2700449297825496, "policy_loss": 0.226059952378273, "vf_loss": 2.5363841392099857, "vf_explained_var": 0.149117145438989, "kl": 0.0, "entropy": 114.40589014689128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.72, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.165, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.165, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 4.0, -16.0, -16.0, 8.0, 8.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 12.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 4.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 2.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1486574976990176, "mean_inference_ms": 7.720242119915768, "mean_action_processing_ms": 0.4350632842234608, "mean_env_wait_ms": 0.2759135771360446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2490537166595459, "StateBufferConnector_ms": 0.004495859146118164, "ViewRequirementAgentConnector_ms": 0.19061541557312012}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, 4.0, -16.0, -16.0, 8.0, 8.0, -16.0, 4.0, -16.0, -16.0, -16.0, 0.0, 12.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 4.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 2.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1486574976990176, "mean_inference_ms": 7.720242119915768, "mean_action_processing_ms": 0.4350632842234608, "mean_env_wait_ms": 0.2759135771360446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2490537166595459, "StateBufferConnector_ms": 0.004495859146118164, "ViewRequirementAgentConnector_ms": 0.19061541557312012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.528116653597207, "num_agent_steps_trained_throughput_per_sec": 7.528116653597207, "timesteps_total": 22016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 68224.947, "sample_time_ms": 4887.835, "load_time_ms": 0.273, "load_throughput": 1877335.124, "learn_time_ms": 63335.955, "learn_throughput": 8.084, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "done": false, "episodes_total": 1376, "training_iteration": 43, "trial_id": "1316e_00162", "date": "2024-02-27_00-25-56", "timestamp": 1708989956, "time_this_iter_s": 68.01687216758728, "time_total_s": 2969.2127985954285, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2969.2127985954285, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 53.89895833333333, "ram_util_percent": 21.728125000000006}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.18, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.119375, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.739070391903321, "policy_loss": 0.258444091056784, "vf_loss": 1.8373115301132201, "vf_explained_var": 0.2899162585536639, "kl": 0.0, "entropy": 107.16953989664714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.18, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.119375, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 4.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 2.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1477266486124447, "mean_inference_ms": 7.717584508387772, "mean_action_processing_ms": 0.4347680364176082, "mean_env_wait_ms": 0.27566152453012294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24660468101501465, "StateBufferConnector_ms": 0.004419088363647461, "ViewRequirementAgentConnector_ms": 0.18890714645385742}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 10.0, -16.0, 6.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, 4.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 2.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1477266486124447, "mean_inference_ms": 7.717584508387772, "mean_action_processing_ms": 0.4347680364176082, "mean_env_wait_ms": 0.27566152453012294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24660468101501465, "StateBufferConnector_ms": 0.004419088363647461, "ViewRequirementAgentConnector_ms": 0.18890714645385742}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.537707208498198, "num_agent_steps_trained_throughput_per_sec": 7.537707208498198, "timesteps_total": 22528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 68112.8, "sample_time_ms": 4885.438, "load_time_ms": 0.272, "load_throughput": 1878977.73, "learn_time_ms": 63226.259, "learn_throughput": 8.098, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "episodes_total": 1408, "training_iteration": 44, "trial_id": "1316e_00162", "date": "2024-02-27_00-27-04", "timestamp": 1708990024, "time_this_iter_s": 67.93031978607178, "time_total_s": 3037.1431183815002, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3037.1431183815002, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 54.23505154639175, "ram_util_percent": 21.650515463917525}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.62, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.105625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.105625, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.271645932396253, "policy_loss": 0.3261813240746657, "vf_loss": 3.6550317207972207, "vf_explained_var": 0.0698103999098142, "kl": 0.0, "entropy": 115.02398300170898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.62, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.105625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.105625, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [10.0, -16.0, -16.0, 2.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1472818350093983, "mean_inference_ms": 7.717092551680659, "mean_action_processing_ms": 0.43463422820566455, "mean_env_wait_ms": 0.2755561766942013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24915122985839844, "StateBufferConnector_ms": 0.004465579986572266, "ViewRequirementAgentConnector_ms": 0.19655823707580566}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -16.0, -16.0, 2.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1472818350093983, "mean_inference_ms": 7.717092551680659, "mean_action_processing_ms": 0.43463422820566455, "mean_env_wait_ms": 0.2755561766942013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24915122985839844, "StateBufferConnector_ms": 0.004465579986572266, "ViewRequirementAgentConnector_ms": 0.19655823707580566}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.517930954985413, "num_agent_steps_trained_throughput_per_sec": 7.517930954985413, "timesteps_total": 23040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 68024.779, "sample_time_ms": 4868.913, "load_time_ms": 0.273, "load_throughput": 1878813.34, "learn_time_ms": 63154.826, "learn_throughput": 8.107, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 1440, "training_iteration": 45, "trial_id": "1316e_00162", "date": "2024-02-27_00-28-12", "timestamp": 1708990092, "time_this_iter_s": 68.1088638305664, "time_total_s": 3105.2519822120667, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3105.2519822120667, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 54.134375, "ram_util_percent": 21.584375000000005}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.86, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.098125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.3116661973297594, "policy_loss": 0.26993084360534947, "vf_loss": 2.5335925654818614, "vf_explained_var": 0.19284817228714626, "kl": 0.0, "entropy": 104.68693612416585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.86, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.098125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 8.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1469463019550894, "mean_inference_ms": 7.715772301165615, "mean_action_processing_ms": 0.4345184478150458, "mean_env_wait_ms": 0.2754835081214499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2499394416809082, "StateBufferConnector_ms": 0.0044765472412109375, "ViewRequirementAgentConnector_ms": 0.1994915008544922}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 8.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1469463019550894, "mean_inference_ms": 7.715772301165615, "mean_action_processing_ms": 0.4345184478150458, "mean_env_wait_ms": 0.2754835081214499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2499394416809082, "StateBufferConnector_ms": 0.0044765472412109375, "ViewRequirementAgentConnector_ms": 0.1994915008544922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.5307677971677185, "num_agent_steps_trained_throughput_per_sec": 7.5307677971677185, "timesteps_total": 23552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 67980.433, "sample_time_ms": 4876.426, "load_time_ms": 0.274, "load_throughput": 1865268.521, "learn_time_ms": 63102.997, "learn_throughput": 8.114, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "episodes_total": 1472, "training_iteration": 46, "trial_id": "1316e_00162", "date": "2024-02-27_00-29-21", "timestamp": 1708990161, "time_this_iter_s": 67.99295449256897, "time_total_s": 3173.2449367046356, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3173.2449367046356, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 54.25102040816325, "ram_util_percent": 21.58877551020408}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.18, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.119375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.3591518233219784, "policy_loss": 0.30511175158123177, "vf_loss": 2.548861566185951, "vf_explained_var": 0.05869588851928711, "kl": 0.0, "entropy": 110.08151435852051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.18, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.18, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.119375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 8.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1467049095839883, "mean_inference_ms": 7.714991622745413, "mean_action_processing_ms": 0.4344291053887291, "mean_env_wait_ms": 0.27543150246926673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25084805488586426, "StateBufferConnector_ms": 0.0045108795166015625, "ViewRequirementAgentConnector_ms": 0.20022130012512207}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.18, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, 8.0, 8.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 8.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1467049095839883, "mean_inference_ms": 7.714991622745413, "mean_action_processing_ms": 0.4344291053887291, "mean_env_wait_ms": 0.27543150246926673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25084805488586426, "StateBufferConnector_ms": 0.0045108795166015625, "ViewRequirementAgentConnector_ms": 0.20022130012512207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.528214008333857, "num_agent_steps_trained_throughput_per_sec": 7.528214008333857, "timesteps_total": 24064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 67950.832, "sample_time_ms": 4858.473, "load_time_ms": 0.277, "load_throughput": 1848251.698, "learn_time_ms": 63091.377, "learn_throughput": 8.115, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "done": false, "episodes_total": 1504, "training_iteration": 47, "trial_id": "1316e_00162", "date": "2024-02-27_00-30-29", "timestamp": 1708990229, "time_this_iter_s": 68.01581144332886, "time_total_s": 3241.2607481479645, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3241.2607481479645, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 53.96875, "ram_util_percent": 21.55520833333333}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.82, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.099375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.549536031484604, "policy_loss": 0.26526609029388054, "vf_loss": 4.075455741087596, "vf_explained_var": 0.031113057831923165, "kl": 0.0, "entropy": 111.21653118133545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.82, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.099375, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 8.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, 0.0, -16.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1462465466234049, "mean_inference_ms": 7.712154226047129, "mean_action_processing_ms": 0.43418492363824, "mean_env_wait_ms": 0.2752398252936266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24731707572937012, "StateBufferConnector_ms": 0.004462242126464844, "ViewRequirementAgentConnector_ms": 0.20272541046142578}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 8.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, 0.0, -16.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1462465466234049, "mean_inference_ms": 7.712154226047129, "mean_action_processing_ms": 0.43418492363824, "mean_env_wait_ms": 0.2752398252936266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24731707572937012, "StateBufferConnector_ms": 0.004462242126464844, "ViewRequirementAgentConnector_ms": 0.20272541046142578}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.459976929441847, "num_agent_steps_trained_throughput_per_sec": 7.459976929441847, "timesteps_total": 24576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 68028.4, "sample_time_ms": 4858.897, "load_time_ms": 0.277, "load_throughput": 1848092.64, "learn_time_ms": 63168.533, "learn_throughput": 8.105, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 1536, "training_iteration": 48, "trial_id": "1316e_00162", "date": "2024-02-27_00-31-38", "timestamp": 1708990298, "time_this_iter_s": 68.63818073272705, "time_total_s": 3309.8989288806915, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3309.8989288806915, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 54.53092783505155, "ram_util_percent": 21.436082474226804}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.78, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.100625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.100625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.4582385649283727, "policy_loss": 0.06152573321014643, "vf_loss": 4.214986291527748, "vf_explained_var": 0.1011001984278361, "kl": 0.0, "entropy": 109.67659015655518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.78, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.100625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.100625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, 0.0, -16.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145556820104406, "mean_inference_ms": 7.7079122146414605, "mean_action_processing_ms": 0.4338170899565403, "mean_env_wait_ms": 0.27492200191414196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24366497993469238, "StateBufferConnector_ms": 0.0043926239013671875, "ViewRequirementAgentConnector_ms": 0.19406366348266602}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, 0.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, 0.0, -16.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145556820104406, "mean_inference_ms": 7.7079122146414605, "mean_action_processing_ms": 0.4338170899565403, "mean_env_wait_ms": 0.27492200191414196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24366497993469238, "StateBufferConnector_ms": 0.0043926239013671875, "ViewRequirementAgentConnector_ms": 0.19406366348266602}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.520346458398328, "num_agent_steps_trained_throughput_per_sec": 7.520346458398328, "timesteps_total": 25088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 68050.272, "sample_time_ms": 4848.391, "load_time_ms": 0.278, "load_throughput": 1838756.441, "learn_time_ms": 63200.918, "learn_throughput": 8.101, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "done": false, "episodes_total": 1568, "training_iteration": 49, "trial_id": "1316e_00162", "date": "2024-02-27_00-32-46", "timestamp": 1708990366, "time_this_iter_s": 68.08719158172607, "time_total_s": 3377.9861204624176, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3377.9861204624176, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 54.57938144329897, "ram_util_percent": 21.38556701030928}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.4, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.3782650123039883, "policy_loss": 0.16645169036928564, "vf_loss": 3.9855441885689893, "vf_explained_var": -0.03303600152333577, "kl": 0.0, "entropy": 109.6093910853068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.4, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.1125, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [0.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, 0.0, -16.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1449980759896332, "mean_inference_ms": 7.703927703551402, "mean_action_processing_ms": 0.43348631196224807, "mean_env_wait_ms": 0.27461397797996884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24375319480895996, "StateBufferConnector_ms": 0.00439143180847168, "ViewRequirementAgentConnector_ms": 0.19613337516784668}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, 0.0, -16.0, -4.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1449980759896332, "mean_inference_ms": 7.703927703551402, "mean_action_processing_ms": 0.43348631196224807, "mean_env_wait_ms": 0.27461397797996884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24375319480895996, "StateBufferConnector_ms": 0.00439143180847168, "ViewRequirementAgentConnector_ms": 0.19613337516784668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.557256473799297, "num_agent_steps_trained_throughput_per_sec": 7.557256473799297, "timesteps_total": 25600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 68021.27, "sample_time_ms": 4842.814, "load_time_ms": 0.282, "load_throughput": 1818052.53, "learn_time_ms": 63177.594, "learn_throughput": 8.104, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 1600, "training_iteration": 50, "trial_id": "1316e_00162", "date": "2024-02-27_00-33-54", "timestamp": 1708990434, "time_this_iter_s": 67.75453591346741, "time_total_s": 3445.740656375885, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3445.740656375885, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 53.822916666666664, "ram_util_percent": 21.447916666666668}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.98, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.125625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.125625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.1257967442274093, "policy_loss": 0.31260615891466537, "vf_loss": 3.4908926748981077, "vf_explained_var": -0.24489896943171818, "kl": 0.0, "entropy": 123.02716306050618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.98, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.125625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.125625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -2.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 14.0, 12.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 0.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1445947000797332, "mean_inference_ms": 7.70177821407045, "mean_action_processing_ms": 0.4333093569909977, "mean_env_wait_ms": 0.27441351032931605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24837064743041992, "StateBufferConnector_ms": 0.0044481754302978516, "ViewRequirementAgentConnector_ms": 0.19288086891174316}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -2.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 14.0, 12.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 0.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1445947000797332, "mean_inference_ms": 7.70177821407045, "mean_action_processing_ms": 0.4333093569909977, "mean_env_wait_ms": 0.27441351032931605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24837064743041992, "StateBufferConnector_ms": 0.0044481754302978516, "ViewRequirementAgentConnector_ms": 0.19288086891174316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.538637780422786, "num_agent_steps_trained_throughput_per_sec": 7.538637780422786, "timesteps_total": 26112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26112, "timers": {"training_iteration_time_ms": 68013.603, "sample_time_ms": 4852.368, "load_time_ms": 0.281, "load_throughput": 1820981.64, "learn_time_ms": 63160.375, "learn_throughput": 8.106, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "done": false, "episodes_total": 1632, "training_iteration": 51, "trial_id": "1316e_00162", "date": "2024-02-27_00-35-02", "timestamp": 1708990502, "time_this_iter_s": 67.92202162742615, "time_total_s": 3513.662678003311, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3513.662678003311, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 54.91546391752578, "ram_util_percent": 21.59072164948453}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.26, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.148125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.148125, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.765105812251568, "policy_loss": 0.0988294490457823, "vf_loss": 2.0676850147545336, "vf_explained_var": -0.04210943480332693, "kl": 0.0, "entropy": 123.96572043100993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.26, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.148125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.148125, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 0.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 14.0, 12.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 0.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1442661607027143, "mean_inference_ms": 7.700695264005884, "mean_action_processing_ms": 0.43322816640189643, "mean_env_wait_ms": 0.2742825576620756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25073671340942383, "StateBufferConnector_ms": 0.004504203796386719, "ViewRequirementAgentConnector_ms": 0.19713616371154785}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 0.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 14.0, 12.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 0.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1442661607027143, "mean_inference_ms": 7.700695264005884, "mean_action_processing_ms": 0.43322816640189643, "mean_env_wait_ms": 0.2742825576620756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25073671340942383, "StateBufferConnector_ms": 0.004504203796386719, "ViewRequirementAgentConnector_ms": 0.19713616371154785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.622731230736972, "num_agent_steps_trained_throughput_per_sec": 7.622731230736972, "timesteps_total": 26624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 67958.757, "sample_time_ms": 4851.471, "load_time_ms": 0.286, "load_throughput": 1789420.588, "learn_time_ms": 63106.39, "learn_throughput": 8.113, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "episodes_total": 1664, "training_iteration": 52, "trial_id": "1316e_00162", "date": "2024-02-27_00-36-09", "timestamp": 1708990569, "time_this_iter_s": 67.17278528213501, "time_total_s": 3580.835463285446, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3580.835463285446, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 54.098947368421065, "ram_util_percent": 21.730526315789476}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.168125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.168125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.0305525918801623, "policy_loss": -0.042308183806017044, "vf_loss": 2.5722162504990895, "vf_explained_var": 0.09064726531505585, "kl": 0.0, "entropy": 124.96006317138672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.168125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.168125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 14.0, 12.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 0.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1436356364336164, "mean_inference_ms": 7.698444422772069, "mean_action_processing_ms": 0.43306116862541116, "mean_env_wait_ms": 0.2741108646974506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24730682373046875, "StateBufferConnector_ms": 0.004416942596435547, "ViewRequirementAgentConnector_ms": 0.19029498100280762}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 14.0, 12.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, 0.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1436356364336164, "mean_inference_ms": 7.698444422772069, "mean_action_processing_ms": 0.43306116862541116, "mean_env_wait_ms": 0.2741108646974506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24730682373046875, "StateBufferConnector_ms": 0.004416942596435547, "ViewRequirementAgentConnector_ms": 0.19029498100280762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.6195093410910735, "num_agent_steps_trained_throughput_per_sec": 7.6195093410910735, "timesteps_total": 27136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27136, "timers": {"training_iteration_time_ms": 67877.181, "sample_time_ms": 4833.968, "load_time_ms": 0.287, "load_throughput": 1784068.828, "learn_time_ms": 63042.332, "learn_throughput": 8.122, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "done": false, "episodes_total": 1696, "training_iteration": 53, "trial_id": "1316e_00162", "date": "2024-02-27_00-37-16", "timestamp": 1708990636, "time_this_iter_s": 67.20094752311707, "time_total_s": 3648.0364108085632, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3648.0364108085632, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.14526315789474, "ram_util_percent": 21.8}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.215, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.215, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.725515167415142, "policy_loss": 0.06157728595038255, "vf_loss": 3.305684768036008, "vf_explained_var": 0.05472378234068553, "kl": 0.0, "entropy": 126.49413986206055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.215, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.215, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [6.0, -16.0, -16.0, 0.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 8.0, -16.0, -16.0, 8.0, 14.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1422968249134526, "mean_inference_ms": 7.693187220009154, "mean_action_processing_ms": 0.4326301967390934, "mean_env_wait_ms": 0.27372401183338324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2392587661743164, "StateBufferConnector_ms": 0.004279136657714844, "ViewRequirementAgentConnector_ms": 0.1766948699951172}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.0, -16.0, -16.0, 0.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 12.0, -16.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 8.0, -16.0, -16.0, 8.0, 14.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1422968249134526, "mean_inference_ms": 7.693187220009154, "mean_action_processing_ms": 0.4326301967390934, "mean_env_wait_ms": 0.27372401183338324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2392587661743164, "StateBufferConnector_ms": 0.004279136657714844, "ViewRequirementAgentConnector_ms": 0.1766948699951172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.650490417804461, "num_agent_steps_trained_throughput_per_sec": 7.650490417804461, "timesteps_total": 27648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 67777.047, "sample_time_ms": 4810.985, "load_time_ms": 0.287, "load_throughput": 1787038.069, "learn_time_ms": 62965.168, "learn_throughput": 8.131, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "episodes_total": 1728, "training_iteration": 54, "trial_id": "1316e_00162", "date": "2024-02-27_00-38-23", "timestamp": 1708990703, "time_this_iter_s": 66.92882370948792, "time_total_s": 3714.965234518051, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3714.965234518051, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 52.82315789473684, "ram_util_percent": 21.77157894736843}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.78, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.194375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.194375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.186519469320774, "policy_loss": 0.24295637610678872, "vf_loss": 2.411770507444938, "vf_explained_var": 0.245855014026165, "kl": 0.0, "entropy": 125.10603796641031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.78, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.78, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.194375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.194375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 8.0, -16.0, -16.0, 8.0, 14.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1409113379789475, "mean_inference_ms": 7.687641944576091, "mean_action_processing_ms": 0.432195952845815, "mean_env_wait_ms": 0.2733566218804556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2367861270904541, "StateBufferConnector_ms": 0.004237651824951172, "ViewRequirementAgentConnector_ms": 0.1719975471496582}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.78, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 8.0, -16.0, -16.0, 8.0, 14.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1409113379789475, "mean_inference_ms": 7.687641944576091, "mean_action_processing_ms": 0.432195952845815, "mean_env_wait_ms": 0.2733566218804556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2367861270904541, "StateBufferConnector_ms": 0.004237651824951172, "ViewRequirementAgentConnector_ms": 0.1719975471496582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.529995973499037, "num_agent_steps_trained_throughput_per_sec": 7.529995973499037, "timesteps_total": 28160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 67766.135, "sample_time_ms": 4786.755, "load_time_ms": 0.283, "load_throughput": 1811152.609, "learn_time_ms": 62978.46, "learn_throughput": 8.13, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 1760, "training_iteration": 55, "trial_id": "1316e_00162", "date": "2024-02-27_00-39-31", "timestamp": 1708990771, "time_this_iter_s": 67.99974346160889, "time_total_s": 3782.96497797966, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3782.96497797966, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 52.52268041237112, "ram_util_percent": 21.98041237113402}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.66, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.198125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.198125, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.864422806104024, "policy_loss": 0.24509967326497037, "vf_loss": 3.2503222038348514, "vf_explained_var": 0.16855320632457732, "kl": 0.0, "entropy": 124.77526079813639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.66, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.198125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.198125, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, 8.0, -16.0, -16.0, 8.0, 14.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1396769633630737, "mean_inference_ms": 7.682563725535115, "mean_action_processing_ms": 0.4318178937054236, "mean_env_wait_ms": 0.2730397221233037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23822832107543945, "StateBufferConnector_ms": 0.004274129867553711, "ViewRequirementAgentConnector_ms": 0.17476129531860352}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, 8.0, -16.0, -16.0, 8.0, 14.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1396769633630737, "mean_inference_ms": 7.682563725535115, "mean_action_processing_ms": 0.4318178937054236, "mean_env_wait_ms": 0.2730397221233037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23822832107543945, "StateBufferConnector_ms": 0.004274129867553711, "ViewRequirementAgentConnector_ms": 0.17476129531860352}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.58042723514376, "num_agent_steps_trained_throughput_per_sec": 7.58042723514376, "timesteps_total": 28672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 67721.596, "sample_time_ms": 4780.959, "load_time_ms": 0.279, "load_throughput": 1836240.828, "learn_time_ms": 62939.701, "learn_throughput": 8.135, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 1792, "training_iteration": 56, "trial_id": "1316e_00162", "date": "2024-02-27_00-40-39", "timestamp": 1708990839, "time_this_iter_s": 67.54739999771118, "time_total_s": 3850.512377977371, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3850.512377977371, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 52.74375, "ram_util_percent": 21.67083333333333}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.94, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.158125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.158125, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.40125402957201, "policy_loss": 0.19916361408929031, "vf_loss": 2.732577464232842, "vf_explained_var": 0.08830170979102453, "kl": 0.0, "entropy": 128.81905988057454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.94, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.158125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.158125, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 12.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 4.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1388490947975758, "mean_inference_ms": 7.678946423267418, "mean_action_processing_ms": 0.43160383616691816, "mean_env_wait_ms": 0.27287401427376934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24506115913391113, "StateBufferConnector_ms": 0.004378080368041992, "ViewRequirementAgentConnector_ms": 0.18355417251586914}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 12.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 4.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1388490947975758, "mean_inference_ms": 7.678946423267418, "mean_action_processing_ms": 0.43160383616691816, "mean_env_wait_ms": 0.27287401427376934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24506115913391113, "StateBufferConnector_ms": 0.004378080368041992, "ViewRequirementAgentConnector_ms": 0.18355417251586914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.547630304924864, "num_agent_steps_trained_throughput_per_sec": 7.547630304924864, "timesteps_total": 29184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29184, "timers": {"training_iteration_time_ms": 67704.101, "sample_time_ms": 4771.789, "load_time_ms": 0.275, "load_throughput": 1865106.521, "learn_time_ms": 62931.366, "learn_throughput": 8.136, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "done": false, "episodes_total": 1824, "training_iteration": 57, "trial_id": "1316e_00162", "date": "2024-02-27_00-41-46", "timestamp": 1708990906, "time_this_iter_s": 67.84108328819275, "time_total_s": 3918.353461265564, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3918.353461265564, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 53.70416666666667, "ram_util_percent": 21.7375}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.4, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.20625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.20625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.1580105304718016, "policy_loss": 0.34000870352610946, "vf_loss": 3.496862953901291, "vf_explained_var": 0.4315143808722496, "kl": 0.0, "entropy": 140.8705224355062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.4, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.20625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.20625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 12.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 4.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1380973035816282, "mean_inference_ms": 7.6755400352443255, "mean_action_processing_ms": 0.4313925229236897, "mean_env_wait_ms": 0.27270332043138024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24620485305786133, "StateBufferConnector_ms": 0.004364728927612305, "ViewRequirementAgentConnector_ms": 0.18346357345581055}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, -16.0, 8.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 12.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 4.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1380973035816282, "mean_inference_ms": 7.6755400352443255, "mean_action_processing_ms": 0.4313925229236897, "mean_env_wait_ms": 0.27270332043138024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24620485305786133, "StateBufferConnector_ms": 0.004364728927612305, "ViewRequirementAgentConnector_ms": 0.18346357345581055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.484408796523483, "num_agent_steps_trained_throughput_per_sec": 7.484408796523483, "timesteps_total": 29696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 67681.698, "sample_time_ms": 4768.396, "load_time_ms": 0.273, "load_throughput": 1875531.57, "learn_time_ms": 62912.335, "learn_throughput": 8.138, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "episodes_total": 1856, "training_iteration": 58, "trial_id": "1316e_00162", "date": "2024-02-27_00-42-55", "timestamp": 1708990975, "time_this_iter_s": 68.41397881507874, "time_total_s": 3986.7674400806427, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3986.7674400806427, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 53.554639175257726, "ram_util_percent": 21.6340206185567}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.195625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.195625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.7039560067156951, "policy_loss": 0.2124805035069585, "vf_loss": 1.8507743232573073, "vf_explained_var": 0.41129661401112877, "kl": 0.0, "entropy": 156.3892800649007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.195625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.195625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 12.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 4.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1373765325142617, "mean_inference_ms": 7.672472962889312, "mean_action_processing_ms": 0.43120146900831213, "mean_env_wait_ms": 0.2725353142865655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.245985746383667, "StateBufferConnector_ms": 0.004366397857666016, "ViewRequirementAgentConnector_ms": 0.18209338188171387}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 10.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 12.0, 8.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 6.0, -16.0, 4.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1373765325142617, "mean_inference_ms": 7.672472962889312, "mean_action_processing_ms": 0.43120146900831213, "mean_env_wait_ms": 0.2725353142865655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.245985746383667, "StateBufferConnector_ms": 0.004366397857666016, "ViewRequirementAgentConnector_ms": 0.18209338188171387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.584756566788313, "num_agent_steps_trained_throughput_per_sec": 7.584756566788313, "timesteps_total": 30208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30208, "timers": {"training_iteration_time_ms": 67623.882, "sample_time_ms": 4778.707, "load_time_ms": 0.272, "load_throughput": 1879142.149, "learn_time_ms": 62844.184, "learn_throughput": 8.147, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "done": false, "episodes_total": 1888, "training_iteration": 59, "trial_id": "1316e_00162", "date": "2024-02-27_00-44-02", "timestamp": 1708991042, "time_this_iter_s": 67.50893020629883, "time_total_s": 4054.2763702869415, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4054.2763702869415, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 52.932291666666664, "ram_util_percent": 21.680208333333336}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.4, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.175, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.175, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.5331449240446091, "policy_loss": 0.20280881432505946, "vf_loss": 1.6508161510030428, "vf_explained_var": 0.4607491319378217, "kl": 0.0, "entropy": 160.57148920694988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.4, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.175, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.175, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [6.0, -16.0, 4.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1363405322553972, "mean_inference_ms": 7.668121486857928, "mean_action_processing_ms": 0.43088005423809167, "mean_env_wait_ms": 0.27225346268895334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24053168296813965, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.17363595962524414}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.0, -16.0, 4.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1363405322553972, "mean_inference_ms": 7.668121486857928, "mean_action_processing_ms": 0.43088005423809167, "mean_env_wait_ms": 0.27225346268895334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24053168296813965, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.17363595962524414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.586370239342, "num_agent_steps_trained_throughput_per_sec": 7.586370239342, "timesteps_total": 30720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 67597.882, "sample_time_ms": 4748.447, "load_time_ms": 0.267, "load_throughput": 1915685.681, "learn_time_ms": 62848.407, "learn_throughput": 8.147, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 1920, "training_iteration": 60, "trial_id": "1316e_00162", "date": "2024-02-27_00-45-10", "timestamp": 1708991110, "time_this_iter_s": 67.49465584754944, "time_total_s": 4121.771026134491, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4121.771026134491, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 53.166666666666664, "ram_util_percent": 21.537499999999994}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.1, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.153125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.497011301914851, "policy_loss": 0.1478464770829305, "vf_loss": 2.9150823295116424, "vf_explained_var": 0.6719969953099887, "kl": 0.0, "entropy": 168.10254147847493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.1, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.153125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.153125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.13539280213921, "mean_inference_ms": 7.66421144416187, "mean_action_processing_ms": 0.430580787482528, "mean_env_wait_ms": 0.2720110237907958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24126100540161133, "StateBufferConnector_ms": 0.004313945770263672, "ViewRequirementAgentConnector_ms": 0.17650103569030762}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.13539280213921, "mean_inference_ms": 7.66421144416187, "mean_action_processing_ms": 0.430580787482528, "mean_env_wait_ms": 0.2720110237907958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24126100540161133, "StateBufferConnector_ms": 0.004313945770263672, "ViewRequirementAgentConnector_ms": 0.17650103569030762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.507143544564229, "num_agent_steps_trained_throughput_per_sec": 7.507143544564229, "timesteps_total": 31232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31232, "timers": {"training_iteration_time_ms": 67626.374, "sample_time_ms": 4731.545, "load_time_ms": 0.265, "load_throughput": 1932406.774, "learn_time_ms": 62893.821, "learn_throughput": 8.141, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "done": false, "episodes_total": 1952, "training_iteration": 61, "trial_id": "1316e_00162", "date": "2024-02-27_00-46-18", "timestamp": 1708991178, "time_this_iter_s": 68.20673775672913, "time_total_s": 4189.97776389122, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4189.97776389122, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 53.21752577319588, "ram_util_percent": 21.495876288659797}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.164375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.164375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.5480043108264605, "policy_loss": -0.017419780666629473, "vf_loss": 1.942537213365237, "vf_explained_var": 0.3019932026664416, "kl": 0.0, "entropy": 165.92560895284018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.164375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.164375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1347112793830652, "mean_inference_ms": 7.661359466260867, "mean_action_processing_ms": 0.4303574970187829, "mean_env_wait_ms": 0.27184662711577884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24446368217468262, "StateBufferConnector_ms": 0.004351377487182617, "ViewRequirementAgentConnector_ms": 0.18189454078674316}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1347112793830652, "mean_inference_ms": 7.661359466260867, "mean_action_processing_ms": 0.4303574970187829, "mean_env_wait_ms": 0.27184662711577884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24446368217468262, "StateBufferConnector_ms": 0.004351377487182617, "ViewRequirementAgentConnector_ms": 0.18189454078674316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.405390639899799, "num_agent_steps_trained_throughput_per_sec": 7.405390639899799, "timesteps_total": 31744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 67823.506, "sample_time_ms": 4744.311, "load_time_ms": 0.26, "load_throughput": 1971615.542, "learn_time_ms": 63078.207, "learn_throughput": 8.117, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "episodes_total": 1984, "training_iteration": 62, "trial_id": "1316e_00162", "date": "2024-02-27_00-47-27", "timestamp": 1708991247, "time_this_iter_s": 69.14401054382324, "time_total_s": 4259.121774435043, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4259.121774435043, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 53.208163265306126, "ram_util_percent": 21.640816326530615}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.26, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.210625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.210625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.4162653997540473, "policy_loss": 0.27175240678091844, "vf_loss": 2.661129595587651, "vf_explained_var": 0.44739598284165066, "kl": 0.0, "entropy": 170.0664264678955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.26, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.210625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.210625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, 12.0, 16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1344923729987573, "mean_inference_ms": 7.6602872273407066, "mean_action_processing_ms": 0.4302683021110603, "mean_env_wait_ms": 0.2717946258727707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24947357177734375, "StateBufferConnector_ms": 0.004473209381103516, "ViewRequirementAgentConnector_ms": 0.19197821617126465}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, 12.0, 16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1344923729987573, "mean_inference_ms": 7.6602872273407066, "mean_action_processing_ms": 0.4302683021110603, "mean_env_wait_ms": 0.2717946258727707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24947357177734375, "StateBufferConnector_ms": 0.004473209381103516, "ViewRequirementAgentConnector_ms": 0.19197821617126465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.403603803214898, "num_agent_steps_trained_throughput_per_sec": 7.403603803214898, "timesteps_total": 32256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 68019.464, "sample_time_ms": 4756.925, "load_time_ms": 0.265, "load_throughput": 1933798.873, "learn_time_ms": 63261.514, "learn_throughput": 8.093, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 2016, "training_iteration": 63, "trial_id": "1316e_00162", "date": "2024-02-27_00-48-37", "timestamp": 1708991317, "time_this_iter_s": 69.1605224609375, "time_total_s": 4328.282296895981, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4328.282296895981, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 52.920408163265314, "ram_util_percent": 21.872448979591837}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.1, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.215625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.215625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.294686395923297, "policy_loss": 0.028370482730679214, "vf_loss": 2.8122750242551167, "vf_explained_var": 0.7793733075261116, "kl": 0.0, "entropy": 172.81155370076496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.1, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.215625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.215625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, 12.0, 16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1342492428773112, "mean_inference_ms": 7.659209694365803, "mean_action_processing_ms": 0.4301810311280333, "mean_env_wait_ms": 0.27173313486219114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24883460998535156, "StateBufferConnector_ms": 0.004441022872924805, "ViewRequirementAgentConnector_ms": 0.1905674934387207}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, 12.0, 16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1342492428773112, "mean_inference_ms": 7.659209694365803, "mean_action_processing_ms": 0.4301810311280333, "mean_env_wait_ms": 0.27173313486219114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24883460998535156, "StateBufferConnector_ms": 0.004441022872924805, "ViewRequirementAgentConnector_ms": 0.1905674934387207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.556202558298086, "num_agent_steps_trained_throughput_per_sec": 7.556202558298086, "timesteps_total": 32768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 68102.971, "sample_time_ms": 4774.219, "load_time_ms": 0.275, "load_throughput": 1863811.533, "learn_time_ms": 63327.686, "learn_throughput": 8.085, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 2048, "training_iteration": 64, "trial_id": "1316e_00162", "date": "2024-02-27_00-49-44", "timestamp": 1708991384, "time_this_iter_s": 67.76401233673096, "time_total_s": 4396.046309232712, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4396.046309232712, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 53.052083333333336, "ram_util_percent": 21.801041666666666}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.8344444890817004, "policy_loss": 0.13624985197093337, "vf_loss": 3.3481940040985743, "vf_explained_var": 0.6001108234127362, "kl": 0.0, "entropy": 174.36681620279947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, 14.0, -16.0, -16.0, 12.0, 16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 8.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1342281768933613, "mean_inference_ms": 7.658782090623779, "mean_action_processing_ms": 0.4301654916007426, "mean_env_wait_ms": 0.27171529636668634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2528102397918701, "StateBufferConnector_ms": 0.0045049190521240234, "ViewRequirementAgentConnector_ms": 0.1965932846069336}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, 14.0, -16.0, -16.0, 12.0, 16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 8.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1342281768933613, "mean_inference_ms": 7.658782090623779, "mean_action_processing_ms": 0.4301654916007426, "mean_env_wait_ms": 0.27171529636668634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2528102397918701, "StateBufferConnector_ms": 0.0045049190521240234, "ViewRequirementAgentConnector_ms": 0.1965932846069336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.484611845004432, "num_agent_steps_trained_throughput_per_sec": 7.484611845004432, "timesteps_total": 33280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 68144.201, "sample_time_ms": 4798.222, "load_time_ms": 0.277, "load_throughput": 1849206.62, "learn_time_ms": 63344.905, "learn_throughput": 8.083, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 2080, "training_iteration": 65, "trial_id": "1316e_00162", "date": "2024-02-27_00-50-53", "timestamp": 1708991453, "time_this_iter_s": 68.41205310821533, "time_total_s": 4464.458362340927, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4464.458362340927, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 52.82371134020618, "ram_util_percent": 21.94329896907217}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.382477441926797, "policy_loss": 0.010223825854094077, "vf_loss": 2.943733220299085, "vf_explained_var": 0.5901000335812568, "kl": 0.0, "entropy": 174.4898868560791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 8.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134197333940451, "mean_inference_ms": 7.658438663508557, "mean_action_processing_ms": 0.4301782821778282, "mean_env_wait_ms": 0.2717162629977964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25287365913391113, "StateBufferConnector_ms": 0.004496574401855469, "ViewRequirementAgentConnector_ms": 0.1963191032409668}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, 14.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 8.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134197333940451, "mean_inference_ms": 7.658438663508557, "mean_action_processing_ms": 0.4301782821778282, "mean_env_wait_ms": 0.2717162629977964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25287365913391113, "StateBufferConnector_ms": 0.004496574401855469, "ViewRequirementAgentConnector_ms": 0.1963191032409668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.481669788605143, "num_agent_steps_trained_throughput_per_sec": 7.481669788605143, "timesteps_total": 33792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 68233.356, "sample_time_ms": 4807.582, "load_time_ms": 0.277, "load_throughput": 1850800.352, "learn_time_ms": 63424.693, "learn_throughput": 8.073, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "episodes_total": 2112, "training_iteration": 66, "trial_id": "1316e_00162", "date": "2024-02-27_00-52-01", "timestamp": 1708991521, "time_this_iter_s": 68.43899464607239, "time_total_s": 4532.8973569869995, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4532.8973569869995, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 53.68144329896908, "ram_util_percent": 21.68762886597938}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.84, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.815643013517062, "policy_loss": 0.13701568431376168, "vf_loss": 3.3239128986994424, "vf_explained_var": 0.8611489077409108, "kl": 0.0, "entropy": 179.38233757019043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.84, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 8.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1344854722622446, "mean_inference_ms": 7.659414491667681, "mean_action_processing_ms": 0.4302971818264341, "mean_env_wait_ms": 0.2718105308300962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25649237632751465, "StateBufferConnector_ms": 0.004564523696899414, "ViewRequirementAgentConnector_ms": 0.2062513828277588}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 8.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1344854722622446, "mean_inference_ms": 7.659414491667681, "mean_action_processing_ms": 0.4302971818264341, "mean_env_wait_ms": 0.2718105308300962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25649237632751465, "StateBufferConnector_ms": 0.004564523696899414, "ViewRequirementAgentConnector_ms": 0.2062513828277588}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.499432616021489, "num_agent_steps_trained_throughput_per_sec": 7.499432616021489, "timesteps_total": 34304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34304, "timers": {"training_iteration_time_ms": 68276.952, "sample_time_ms": 4826.302, "load_time_ms": 0.277, "load_throughput": 1847297.762, "learn_time_ms": 63449.525, "learn_throughput": 8.069, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "done": false, "episodes_total": 2144, "training_iteration": 67, "trial_id": "1316e_00162", "date": "2024-02-27_00-53-10", "timestamp": 1708991590, "time_this_iter_s": 68.27695488929749, "time_total_s": 4601.174311876297, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4601.174311876297, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 53.28041237113402, "ram_util_percent": 21.595876288659795}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.2587532815833886, "policy_loss": 0.0006319520529359579, "vf_loss": 1.56120475679636, "vf_explained_var": 0.6407005498806636, "kl": 0.0, "entropy": 192.28193270365398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134151572014202, "mean_inference_ms": 7.657959539388989, "mean_action_processing_ms": 0.4301988778298255, "mean_env_wait_ms": 0.27172487974405024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2463397979736328, "StateBufferConnector_ms": 0.004357576370239258, "ViewRequirementAgentConnector_ms": 0.1898195743560791}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134151572014202, "mean_inference_ms": 7.657959539388989, "mean_action_processing_ms": 0.4301988778298255, "mean_env_wait_ms": 0.27172487974405024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2463397979736328, "StateBufferConnector_ms": 0.004357576370239258, "ViewRequirementAgentConnector_ms": 0.1898195743560791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.547628103168099, "num_agent_steps_trained_throughput_per_sec": 7.547628103168099, "timesteps_total": 34816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 68219.653, "sample_time_ms": 4810.97, "load_time_ms": 0.275, "load_throughput": 1864944.549, "learn_time_ms": 63407.547, "learn_throughput": 8.075, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "episodes_total": 2176, "training_iteration": 68, "trial_id": "1316e_00162", "date": "2024-02-27_00-54-18", "timestamp": 1708991658, "time_this_iter_s": 67.84084987640381, "time_total_s": 4669.015161752701, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4669.015161752701, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 53.06145833333333, "ram_util_percent": 21.552083333333332}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.218125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.218125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.832710223396619, "policy_loss": 0.17712994230290255, "vf_loss": 3.295313740770022, "vf_explained_var": 0.8548357764879863, "kl": 0.0, "entropy": 199.4018892923991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.218125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.218125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1336572268894367, "mean_inference_ms": 7.655842829947028, "mean_action_processing_ms": 0.43003581170824234, "mean_env_wait_ms": 0.2715906657976525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2442007064819336, "StateBufferConnector_ms": 0.004304647445678711, "ViewRequirementAgentConnector_ms": 0.18733429908752441}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, -16.0, 14.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1336572268894367, "mean_inference_ms": 7.655842829947028, "mean_action_processing_ms": 0.43003581170824234, "mean_env_wait_ms": 0.2715906657976525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2442007064819336, "StateBufferConnector_ms": 0.004304647445678711, "ViewRequirementAgentConnector_ms": 0.18733429908752441}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.51166306240512, "num_agent_steps_trained_throughput_per_sec": 7.51166306240512, "timesteps_total": 35328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35328, "timers": {"training_iteration_time_ms": 68285.339, "sample_time_ms": 4809.2, "load_time_ms": 0.274, "load_throughput": 1868839.655, "learn_time_ms": 63475.008, "learn_throughput": 8.066, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "done": false, "episodes_total": 2208, "training_iteration": 69, "trial_id": "1316e_00162", "date": "2024-02-27_00-55-26", "timestamp": 1708991726, "time_this_iter_s": 68.16570854187012, "time_total_s": 4737.180870294571, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4737.180870294571, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 53.02371134020618, "ram_util_percent": 21.56082474226804}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.189375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.189375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.375802455842495, "policy_loss": 0.04532890332241853, "vf_loss": 4.132789842908581, "vf_explained_var": 0.4822407945990562, "kl": 0.0, "entropy": 200.07074635823568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.189375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.189375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132876650460451, "mean_inference_ms": 7.653644566944644, "mean_action_processing_ms": 0.4297770427319831, "mean_env_wait_ms": 0.27137648273088194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24030256271362305, "StateBufferConnector_ms": 0.0042722225189208984, "ViewRequirementAgentConnector_ms": 0.1768798828125}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132876650460451, "mean_inference_ms": 7.653644566944644, "mean_action_processing_ms": 0.4297770427319831, "mean_env_wait_ms": 0.27137648273088194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24030256271362305, "StateBufferConnector_ms": 0.0042722225189208984, "ViewRequirementAgentConnector_ms": 0.1768798828125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.515934069549326, "num_agent_steps_trained_throughput_per_sec": 7.515934069549326, "timesteps_total": 35840, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 68348.587, "sample_time_ms": 4839.531, "load_time_ms": 0.281, "load_throughput": 1819747.181, "learn_time_ms": 63507.939, "learn_throughput": 8.062, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "episodes_total": 2240, "training_iteration": 70, "trial_id": "1316e_00162", "date": "2024-02-27_00-56-34", "timestamp": 1708991794, "time_this_iter_s": 68.12698316574097, "time_total_s": 4805.307853460312, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4805.307853460312, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 53.041237113402055, "ram_util_percent": 21.72680412371134}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.189375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.189375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.300275543828805, "policy_loss": 0.09329617700229088, "vf_loss": 2.7386441846688587, "vf_explained_var": 0.8966290667653084, "kl": 0.0, "entropy": 207.40414212544758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.189375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.189375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132231924366936, "mean_inference_ms": 7.6518103738912915, "mean_action_processing_ms": 0.42955681404516627, "mean_env_wait_ms": 0.27120093175013205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24166512489318848, "StateBufferConnector_ms": 0.004297733306884766, "ViewRequirementAgentConnector_ms": 0.17854857444763184}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132231924366936, "mean_inference_ms": 7.6518103738912915, "mean_action_processing_ms": 0.42955681404516627, "mean_env_wait_ms": 0.27120093175013205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24166512489318848, "StateBufferConnector_ms": 0.004297733306884766, "ViewRequirementAgentConnector_ms": 0.17854857444763184}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.452300913258235, "num_agent_steps_trained_throughput_per_sec": 7.452300913258235, "timesteps_total": 36352, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36352, "timers": {"training_iteration_time_ms": 68398.777, "sample_time_ms": 4829.401, "load_time_ms": 0.281, "load_throughput": 1820364.201, "learn_time_ms": 63568.264, "learn_throughput": 8.054, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "done": false, "episodes_total": 2272, "training_iteration": 71, "trial_id": "1316e_00162", "date": "2024-02-27_00-57-43", "timestamp": 1708991863, "time_this_iter_s": 68.70870018005371, "time_total_s": 4874.016553640366, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4874.016553640366, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 53.315463917525776, "ram_util_percent": 21.71237113402062}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.52, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.7093539498746395, "policy_loss": 0.09913062578998506, "vf_loss": 3.239030255439381, "vf_explained_var": 0.594523278872172, "kl": 0.0, "entropy": 207.2120272318522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.52, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1312340888015588, "mean_inference_ms": 7.648755898059894, "mean_action_processing_ms": 0.42921296785393276, "mean_env_wait_ms": 0.2709106588784184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23665690422058105, "StateBufferConnector_ms": 0.004172086715698242, "ViewRequirementAgentConnector_ms": 0.16821002960205078}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1312340888015588, "mean_inference_ms": 7.648755898059894, "mean_action_processing_ms": 0.42921296785393276, "mean_env_wait_ms": 0.2709106588784184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23665690422058105, "StateBufferConnector_ms": 0.004172086715698242, "ViewRequirementAgentConnector_ms": 0.16821002960205078}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.528362248885709, "num_agent_steps_trained_throughput_per_sec": 7.528362248885709, "timesteps_total": 36864, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 68285.844, "sample_time_ms": 4790.121, "load_time_ms": 0.282, "load_throughput": 1818206.458, "learn_time_ms": 63494.627, "learn_throughput": 8.064, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 2304, "training_iteration": 72, "trial_id": "1316e_00162", "date": "2024-02-27_00-58-51", "timestamp": 1708991931, "time_this_iter_s": 68.0143871307373, "time_total_s": 4942.030940771103, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4942.030940771103, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 52.9659793814433, "ram_util_percent": 21.745360824742274}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.164375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.164375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.151297427465518, "policy_loss": 0.07507440933647255, "vf_loss": 2.57638841252774, "vf_explained_var": 0.6589662184317907, "kl": 0.0, "entropy": 210.42913424173992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.164375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.164375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1303100137910882, "mean_inference_ms": 7.64484941008365, "mean_action_processing_ms": 0.4288792450195926, "mean_env_wait_ms": 0.2706189838983595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23744916915893555, "StateBufferConnector_ms": 0.004151344299316406, "ViewRequirementAgentConnector_ms": 0.17072391510009766}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, 16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1303100137910882, "mean_inference_ms": 7.64484941008365, "mean_action_processing_ms": 0.4288792450195926, "mean_env_wait_ms": 0.2706189838983595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23744916915893555, "StateBufferConnector_ms": 0.004151344299316406, "ViewRequirementAgentConnector_ms": 0.17072391510009766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.566358439474589, "num_agent_steps_trained_throughput_per_sec": 7.566358439474589, "timesteps_total": 37376, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37376, "timers": {"training_iteration_time_ms": 68137.088, "sample_time_ms": 4783.215, "load_time_ms": 0.277, "load_throughput": 1846503.567, "learn_time_ms": 63352.823, "learn_throughput": 8.082, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "done": false, "episodes_total": 2336, "training_iteration": 73, "trial_id": "1316e_00162", "date": "2024-02-27_00-59-59", "timestamp": 1708991999, "time_this_iter_s": 67.67318105697632, "time_total_s": 5009.704121828079, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5009.704121828079, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 52.90937499999999, "ram_util_percent": 21.754166666666666}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.32, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.14625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.7791449934244157, "policy_loss": 0.12205638412075738, "vf_loss": 3.2971854209899902, "vf_explained_var": 0.906878603498141, "kl": 0.0, "entropy": 212.86392415364583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.32, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.14625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.14625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.129828116127321, "mean_inference_ms": 7.642679173527367, "mean_action_processing_ms": 0.4286852085282061, "mean_env_wait_ms": 0.270437131525681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24258756637573242, "StateBufferConnector_ms": 0.004280567169189453, "ViewRequirementAgentConnector_ms": 0.18657612800598145}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.129828116127321, "mean_inference_ms": 7.642679173527367, "mean_action_processing_ms": 0.4286852085282061, "mean_env_wait_ms": 0.270437131525681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24258756637573242, "StateBufferConnector_ms": 0.004280567169189453, "ViewRequirementAgentConnector_ms": 0.18657612800598145}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.454655374350875, "num_agent_steps_trained_throughput_per_sec": 7.454655374350875, "timesteps_total": 37888, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 68229.39, "sample_time_ms": 4806.866, "load_time_ms": 0.266, "load_throughput": 1922717.923, "learn_time_ms": 63421.538, "learn_throughput": 8.073, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "episodes_total": 2368, "training_iteration": 74, "trial_id": "1316e_00162", "date": "2024-02-27_01-01-07", "timestamp": 1708992067, "time_this_iter_s": 68.68690323829651, "time_total_s": 5078.391025066376, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5078.391025066376, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 53.82551020408164, "ram_util_percent": 21.566326530612244}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.36, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.3528803676366805, "policy_loss": 0.08023392541023593, "vf_loss": 2.8201305637756984, "vf_explained_var": 0.9089556957284609, "kl": 0.0, "entropy": 209.6664653778076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.36, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.129854273695718, "mean_inference_ms": 7.642353581243251, "mean_action_processing_ms": 0.42865209817276395, "mean_env_wait_ms": 0.27039695857019597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24961495399475098, "StateBufferConnector_ms": 0.004495859146118164, "ViewRequirementAgentConnector_ms": 0.20450401306152344}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.129854273695718, "mean_inference_ms": 7.642353581243251, "mean_action_processing_ms": 0.42865209817276395, "mean_env_wait_ms": 0.27039695857019597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24961495399475098, "StateBufferConnector_ms": 0.004495859146118164, "ViewRequirementAgentConnector_ms": 0.20450401306152344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.441108257684724, "num_agent_steps_trained_throughput_per_sec": 7.441108257684724, "timesteps_total": 38400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 68269.383, "sample_time_ms": 4791.372, "load_time_ms": 0.264, "load_throughput": 1941842.525, "learn_time_ms": 63477.058, "learn_throughput": 8.066, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 2400, "training_iteration": 75, "trial_id": "1316e_00162", "date": "2024-02-27_01-02-16", "timestamp": 1708992136, "time_this_iter_s": 68.81199908256531, "time_total_s": 5147.203024148941, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5147.203024148941, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.365979381443296, "ram_util_percent": 21.59793814432989}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.717434998353322, "policy_loss": 0.11185059611064692, "vf_loss": 3.2332738266636927, "vf_explained_var": 0.45855955878893534, "kl": 0.0, "entropy": 207.9370527903239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1302388554901206, "mean_inference_ms": 7.643294300222744, "mean_action_processing_ms": 0.4287191428835993, "mean_env_wait_ms": 0.2704517059423559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25336694717407227, "StateBufferConnector_ms": 0.00462651252746582, "ViewRequirementAgentConnector_ms": 0.2189493179321289}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1302388554901206, "mean_inference_ms": 7.643294300222744, "mean_action_processing_ms": 0.4287191428835993, "mean_env_wait_ms": 0.2704517059423559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25336694717407227, "StateBufferConnector_ms": 0.00462651252746582, "ViewRequirementAgentConnector_ms": 0.2189493179321289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.480292294499026, "num_agent_steps_trained_throughput_per_sec": 7.480292294499026, "timesteps_total": 38912, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 68270.643, "sample_time_ms": 4801.115, "load_time_ms": 0.266, "load_throughput": 1927723.203, "learn_time_ms": 63468.576, "learn_throughput": 8.067, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "episodes_total": 2432, "training_iteration": 76, "trial_id": "1316e_00162", "date": "2024-02-27_01-03-25", "timestamp": 1708992205, "time_this_iter_s": 68.4516053199768, "time_total_s": 5215.654629468918, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5215.654629468918, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 52.686734693877554, "ram_util_percent": 21.589795918367347}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1975, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1975, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.5764152107139429, "policy_loss": 0.09583996475363771, "vf_loss": 1.8372481536741059, "vf_explained_var": 0.44736689180135725, "kl": 0.0, "entropy": 208.63152389526368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1975, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1975, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.130401122705564, "mean_inference_ms": 7.6445387378388405, "mean_action_processing_ms": 0.4287295894264462, "mean_env_wait_ms": 0.27045719369233967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2507026195526123, "StateBufferConnector_ms": 0.004616737365722656, "ViewRequirementAgentConnector_ms": 0.2087993621826172}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.130401122705564, "mean_inference_ms": 7.6445387378388405, "mean_action_processing_ms": 0.4287295894264462, "mean_env_wait_ms": 0.27045719369233967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2507026195526123, "StateBufferConnector_ms": 0.004616737365722656, "ViewRequirementAgentConnector_ms": 0.2087993621826172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.456725697473491, "num_agent_steps_trained_throughput_per_sec": 7.456725697473491, "timesteps_total": 39424, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39424, "timers": {"training_iteration_time_ms": 68309.744, "sample_time_ms": 4801.943, "load_time_ms": 0.293, "load_throughput": 1749335.002, "learn_time_ms": 63506.857, "learn_throughput": 8.062, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "done": false, "episodes_total": 2464, "training_iteration": 77, "trial_id": "1316e_00162", "date": "2024-02-27_01-04-33", "timestamp": 1708992273, "time_this_iter_s": 68.66806745529175, "time_total_s": 5284.32269692421, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5284.32269692421, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 53.090721649484536, "ram_util_percent": 21.7639175257732}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.34, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.208125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.208125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.2532156884670256, "policy_loss": 0.12377164966116348, "vf_loss": 2.642430463929971, "vf_explained_var": 0.9242013335227967, "kl": 0.0, "entropy": 203.56309038798014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.34, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.208125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.208125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1306441789154595, "mean_inference_ms": 7.645647544598933, "mean_action_processing_ms": 0.4287365650006407, "mean_env_wait_ms": 0.27046242150671373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.251415491104126, "StateBufferConnector_ms": 0.004538059234619141, "ViewRequirementAgentConnector_ms": 0.20794463157653809}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1306441789154595, "mean_inference_ms": 7.645647544598933, "mean_action_processing_ms": 0.4287365650006407, "mean_env_wait_ms": 0.27046242150671373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.251415491104126, "StateBufferConnector_ms": 0.004538059234619141, "ViewRequirementAgentConnector_ms": 0.20794463157653809}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.383126657788855, "num_agent_steps_trained_throughput_per_sec": 7.383126657788855, "timesteps_total": 39936, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 68460.886, "sample_time_ms": 4828.509, "load_time_ms": 0.296, "load_throughput": 1728357.061, "learn_time_ms": 63631.43, "learn_throughput": 8.046, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "episodes_total": 2496, "training_iteration": 78, "trial_id": "1316e_00162", "date": "2024-02-27_01-05-43", "timestamp": 1708992343, "time_this_iter_s": 69.35235214233398, "time_total_s": 5353.675049066544, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5353.675049066544, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 53.25353535353535, "ram_util_percent": 21.790909090909103}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.44, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2675, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2675, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.9607431878646215, "policy_loss": -0.0073864260843644535, "vf_loss": 2.442255156735579, "vf_explained_var": 0.8990006263057391, "kl": 0.0, "entropy": 203.17843704223634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.44, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2675, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2675, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 14.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.13088752306142, "mean_inference_ms": 7.646760343585911, "mean_action_processing_ms": 0.42876085776598755, "mean_env_wait_ms": 0.27048850165008836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2504312992095947, "StateBufferConnector_ms": 0.004500150680541992, "ViewRequirementAgentConnector_ms": 0.20035552978515625}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 14.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.13088752306142, "mean_inference_ms": 7.646760343585911, "mean_action_processing_ms": 0.42876085776598755, "mean_env_wait_ms": 0.27048850165008836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2504312992095947, "StateBufferConnector_ms": 0.004500150680541992, "ViewRequirementAgentConnector_ms": 0.20035552978515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.465434472752831, "num_agent_steps_trained_throughput_per_sec": 7.465434472752831, "timesteps_total": 40448, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40448, "timers": {"training_iteration_time_ms": 68503.093, "sample_time_ms": 4846.891, "load_time_ms": 0.298, "load_throughput": 1717025.384, "learn_time_ms": 63655.234, "learn_throughput": 8.043, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "done": false, "episodes_total": 2528, "training_iteration": 79, "trial_id": "1316e_00162", "date": "2024-02-27_01-06-51", "timestamp": 1708992411, "time_this_iter_s": 68.58773851394653, "time_total_s": 5422.26278758049, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5422.26278758049, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 52.77319587628866, "ram_util_percent": 21.796907216494848}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -5.86, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.316875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.316875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.6641215264797211, "policy_loss": -0.011191826779395342, "vf_loss": 2.078898957371712, "vf_explained_var": 0.9259913603464762, "kl": 0.0, "entropy": 203.00317306518554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -5.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -5.86, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.316875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.316875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 14.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1309863697483786, "mean_inference_ms": 7.646358319394626, "mean_action_processing_ms": 0.4287333204085926, "mean_env_wait_ms": 0.27048488250178787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2504873275756836, "StateBufferConnector_ms": 0.0044596195220947266, "ViewRequirementAgentConnector_ms": 0.19655156135559082}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -5.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 14.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1309863697483786, "mean_inference_ms": 7.646358319394626, "mean_action_processing_ms": 0.4287333204085926, "mean_env_wait_ms": 0.27048488250178787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2504873275756836, "StateBufferConnector_ms": 0.0044596195220947266, "ViewRequirementAgentConnector_ms": 0.19655156135559082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.553777308383595, "num_agent_steps_trained_throughput_per_sec": 7.553777308383595, "timesteps_total": 40960, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 68468.965, "sample_time_ms": 4833.5, "load_time_ms": 0.297, "load_throughput": 1725718.136, "learn_time_ms": 63634.516, "learn_throughput": 8.046, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 2560, "training_iteration": 80, "trial_id": "1316e_00162", "date": "2024-02-27_01-07-59", "timestamp": 1708992479, "time_this_iter_s": 67.78560519218445, "time_total_s": 5490.048392772675, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5490.048392772675, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 52.95208333333333, "ram_util_percent": 21.79375}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -6.16, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3075, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.3075, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8659140857992831, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 6.485957155625026, "policy_loss": 0.13722458916405836, "vf_loss": 7.878152368962764, "vf_explained_var": 0.8800543487071991, "kl": 0.0, "entropy": 215.6809289296468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -6.16, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.3075, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.3075, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 14.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1309773820467413, "mean_inference_ms": 7.645866939026073, "mean_action_processing_ms": 0.42870891808809297, "mean_env_wait_ms": 0.2704931092878992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25118422508239746, "StateBufferConnector_ms": 0.004491567611694336, "ViewRequirementAgentConnector_ms": 0.19607925415039062}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 14.0, 16.0, 16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1309773820467413, "mean_inference_ms": 7.645866939026073, "mean_action_processing_ms": 0.42870891808809297, "mean_env_wait_ms": 0.2704931092878992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25118422508239746, "StateBufferConnector_ms": 0.004491567611694336, "ViewRequirementAgentConnector_ms": 0.19607925415039062}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.495812882086918, "num_agent_steps_trained_throughput_per_sec": 7.495812882086918, "timesteps_total": 41472, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41472, "timers": {"training_iteration_time_ms": 68429.084, "sample_time_ms": 4849.348, "load_time_ms": 0.306, "load_throughput": 1674451.188, "learn_time_ms": 63578.729, "learn_throughput": 8.053, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "done": false, "episodes_total": 2592, "training_iteration": 81, "trial_id": "1316e_00162", "date": "2024-02-27_01-09-08", "timestamp": 1708992548, "time_this_iter_s": 68.31002068519592, "time_total_s": 5558.3584134578705, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5558.3584134578705, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 52.82164948453608, "ram_util_percent": 21.62989690721649}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.06, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.248125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.248125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.626882979273796, "policy_loss": -0.008878796827048063, "vf_loss": 3.270720919966698, "vf_explained_var": 0.9119011009732882, "kl": 0.0, "entropy": 226.74986673990887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.06, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.248125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.248125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1309558775661817, "mean_inference_ms": 7.645616348028074, "mean_action_processing_ms": 0.42869627562970486, "mean_env_wait_ms": 0.2705025097673083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25299835205078125, "StateBufferConnector_ms": 0.004547119140625, "ViewRequirementAgentConnector_ms": 0.196502685546875}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1309558775661817, "mean_inference_ms": 7.645616348028074, "mean_action_processing_ms": 0.42869627562970486, "mean_env_wait_ms": 0.2705025097673083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25299835205078125, "StateBufferConnector_ms": 0.004547119140625, "ViewRequirementAgentConnector_ms": 0.196502685546875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.487866375418118, "num_agent_steps_trained_throughput_per_sec": 7.487866375418118, "timesteps_total": 41984, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 68465.864, "sample_time_ms": 4894.58, "load_time_ms": 0.306, "load_throughput": 1671844.023, "learn_time_ms": 63570.235, "learn_throughput": 8.054, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "episodes_total": 2624, "training_iteration": 82, "trial_id": "1316e_00162", "date": "2024-02-27_01-10-16", "timestamp": 1708992616, "time_this_iter_s": 68.3827714920044, "time_total_s": 5626.741184949875, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5626.741184949875, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 52.91546391752578, "ram_util_percent": 21.67938144329897}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.3, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.209375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.354124260445436, "policy_loss": -0.01630758265964687, "vf_loss": 2.9414725537101427, "vf_explained_var": 0.5836436455448468, "kl": 0.0, "entropy": 227.51650250752766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.3, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.209375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1312969352516808, "mean_inference_ms": 7.646840094306239, "mean_action_processing_ms": 0.42882303201696076, "mean_env_wait_ms": 0.27061025533686944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2589912414550781, "StateBufferConnector_ms": 0.004604339599609375, "ViewRequirementAgentConnector_ms": 0.21054410934448242}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1312969352516808, "mean_inference_ms": 7.646840094306239, "mean_action_processing_ms": 0.42882303201696076, "mean_env_wait_ms": 0.27061025533686944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2589912414550781, "StateBufferConnector_ms": 0.004604339599609375, "ViewRequirementAgentConnector_ms": 0.21054410934448242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.453050993253891, "num_agent_steps_trained_throughput_per_sec": 7.453050993253891, "timesteps_total": 42496, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42496, "timers": {"training_iteration_time_ms": 68568.738, "sample_time_ms": 4922.509, "load_time_ms": 0.308, "load_throughput": 1663168.872, "learn_time_ms": 63645.15, "learn_throughput": 8.045, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "done": false, "episodes_total": 2656, "training_iteration": 83, "trial_id": "1316e_00162", "date": "2024-02-27_01-11-25", "timestamp": 1708992685, "time_this_iter_s": 68.70178842544556, "time_total_s": 5695.44297337532, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5695.44297337532, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 53.43775510204081, "ram_util_percent": 21.686734693877547}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.229375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.229375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.3650251274307568, "policy_loss": -0.01823997184013327, "vf_loss": 2.9573973899086314, "vf_explained_var": 0.9119787981112798, "kl": 0.0, "entropy": 228.8277135213216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.229375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.229375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1317383375193513, "mean_inference_ms": 7.648478210997366, "mean_action_processing_ms": 0.4289881622811501, "mean_env_wait_ms": 0.27074273064137855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2605719566345215, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.21261286735534668}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1317383375193513, "mean_inference_ms": 7.648478210997366, "mean_action_processing_ms": 0.4289881622811501, "mean_env_wait_ms": 0.27074273064137855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2605719566345215, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.21261286735534668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.482354280929286, "num_agent_steps_trained_throughput_per_sec": 7.482354280929286, "timesteps_total": 43008, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 68543.313, "sample_time_ms": 4915.246, "load_time_ms": 0.312, "load_throughput": 1641305.142, "learn_time_ms": 63626.944, "learn_throughput": 8.047, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 2688, "training_iteration": 84, "trial_id": "1316e_00162", "date": "2024-02-27_01-12-33", "timestamp": 1708992753, "time_this_iter_s": 68.43266701698303, "time_total_s": 5763.8756403923035, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5763.8756403923035, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 53.62474226804123, "ram_util_percent": 21.531958762886596}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.249375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.249375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.0728925560911495, "policy_loss": 0.00033624856732785704, "vf_loss": 2.5718383779128393, "vf_explained_var": 0.9218753303090731, "kl": 0.0, "entropy": 228.0164936065674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.249375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.249375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1320078642767024, "mean_inference_ms": 7.649483083343888, "mean_action_processing_ms": 0.4290968779649502, "mean_env_wait_ms": 0.2708282704898094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2567415237426758, "StateBufferConnector_ms": 0.004583120346069336, "ViewRequirementAgentConnector_ms": 0.20473051071166992}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1320078642767024, "mean_inference_ms": 7.649483083343888, "mean_action_processing_ms": 0.4290968779649502, "mean_env_wait_ms": 0.2708282704898094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2567415237426758, "StateBufferConnector_ms": 0.004583120346069336, "ViewRequirementAgentConnector_ms": 0.20473051071166992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.387382361490127, "num_agent_steps_trained_throughput_per_sec": 7.387382361490127, "timesteps_total": 43520, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43520, "timers": {"training_iteration_time_ms": 68593.354, "sample_time_ms": 4914.504, "load_time_ms": 0.312, "load_throughput": 1643566.239, "learn_time_ms": 63677.664, "learn_throughput": 8.04, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "done": false, "episodes_total": 2720, "training_iteration": 85, "trial_id": "1316e_00162", "date": "2024-02-27_01-13-43", "timestamp": 1708992823, "time_this_iter_s": 69.3127167224884, "time_total_s": 5833.188357114792, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5833.188357114792, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 52.83775510204081, "ram_util_percent": 21.523469387755103}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.98, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.219375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.219375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.7247162652512391, "policy_loss": -0.007935048794994752, "vf_loss": 2.1500497174759707, "vf_explained_var": 0.6710100928942363, "kl": 0.0, "entropy": 227.46749051411948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.98, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.219375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.219375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132278244614545, "mean_inference_ms": 7.650582622191468, "mean_action_processing_ms": 0.4291948133250938, "mean_env_wait_ms": 0.27091261776501957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25661730766296387, "StateBufferConnector_ms": 0.004610300064086914, "ViewRequirementAgentConnector_ms": 0.20377612113952637}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132278244614545, "mean_inference_ms": 7.650582622191468, "mean_action_processing_ms": 0.4291948133250938, "mean_env_wait_ms": 0.27091261776501957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25661730766296387, "StateBufferConnector_ms": 0.004610300064086914, "ViewRequirementAgentConnector_ms": 0.20377612113952637}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.313114027010268, "num_agent_steps_trained_throughput_per_sec": 7.313114027010268, "timesteps_total": 44032, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 68749.823, "sample_time_ms": 4924.828, "load_time_ms": 0.314, "load_throughput": 1632943.235, "learn_time_ms": 63823.807, "learn_throughput": 8.022, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "episodes_total": 2752, "training_iteration": 86, "trial_id": "1316e_00162", "date": "2024-02-27_01-14-53", "timestamp": 1708992893, "time_this_iter_s": 70.01614713668823, "time_total_s": 5903.20450425148, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5903.20450425148, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 52.663999999999994, "ram_util_percent": 21.488999999999997}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.159375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.159375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.524111801882585, "policy_loss": -0.005122119747102261, "vf_loss": 1.8976287613312404, "vf_explained_var": 0.4409245327115059, "kl": 0.0, "entropy": 226.80746892293294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.159375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.159375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1324379843484953, "mean_inference_ms": 7.651076615636891, "mean_action_processing_ms": 0.42923315474680507, "mean_env_wait_ms": 0.2709564732926959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2555880546569824, "StateBufferConnector_ms": 0.004559755325317383, "ViewRequirementAgentConnector_ms": 0.20207548141479492}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1324379843484953, "mean_inference_ms": 7.651076615636891, "mean_action_processing_ms": 0.42923315474680507, "mean_env_wait_ms": 0.2709564732926959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2555880546569824, "StateBufferConnector_ms": 0.004559755325317383, "ViewRequirementAgentConnector_ms": 0.20207548141479492}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.3101082645659945, "num_agent_steps_trained_throughput_per_sec": 7.3101082645659945, "timesteps_total": 44544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44544, "timers": {"training_iteration_time_ms": 68887.54, "sample_time_ms": 4910.602, "load_time_ms": 0.293, "load_throughput": 1749905.189, "learn_time_ms": 63975.728, "learn_throughput": 8.003, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "done": false, "episodes_total": 2784, "training_iteration": 87, "trial_id": "1316e_00162", "date": "2024-02-27_01-16-03", "timestamp": 1708992963, "time_this_iter_s": 70.04497838020325, "time_total_s": 5973.249482631683, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5973.249482631683, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 53.163636363636364, "ram_util_percent": 21.573737373737366}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.09, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.4471778976420562, "policy_loss": -0.0063032784499228, "vf_loss": 1.8036270362635454, "vf_explained_var": 0.46847439954678216, "kl": 0.0, "entropy": 229.0322291056315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.09, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132691733484739, "mean_inference_ms": 7.651863530252283, "mean_action_processing_ms": 0.4293036574003803, "mean_env_wait_ms": 0.2710300626033385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25783801078796387, "StateBufferConnector_ms": 0.004599571228027344, "ViewRequirementAgentConnector_ms": 0.20705389976501465}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.132691733484739, "mean_inference_ms": 7.651863530252283, "mean_action_processing_ms": 0.4293036574003803, "mean_env_wait_ms": 0.2710300626033385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25783801078796387, "StateBufferConnector_ms": 0.004599571228027344, "ViewRequirementAgentConnector_ms": 0.20705389976501465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.365728732952135, "num_agent_steps_trained_throughput_per_sec": 7.365728732952135, "timesteps_total": 45056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 68903.921, "sample_time_ms": 4915.882, "load_time_ms": 0.289, "load_throughput": 1769369.406, "learn_time_ms": 63986.825, "learn_throughput": 8.002, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "episodes_total": 2816, "training_iteration": 88, "trial_id": "1316e_00162", "date": "2024-02-27_01-17-12", "timestamp": 1708993032, "time_this_iter_s": 69.51637554168701, "time_total_s": 6042.76585817337, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6042.76585817337, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 53.03030303030303, "ram_util_percent": 21.554545454545448}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.09, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.4703502481182416, "policy_loss": -0.001144560306177785, "vf_loss": 1.8259802043437958, "vf_explained_var": 0.4350574344396591, "kl": 0.0, "entropy": 227.95857404073078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.09, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1331126125956161, "mean_inference_ms": 7.6539899410974455, "mean_action_processing_ms": 0.4294016005249043, "mean_env_wait_ms": 0.27113687990279983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25995802879333496, "StateBufferConnector_ms": 0.004657745361328125, "ViewRequirementAgentConnector_ms": 0.21202993392944336}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1331126125956161, "mean_inference_ms": 7.6539899410974455, "mean_action_processing_ms": 0.4294016005249043, "mean_env_wait_ms": 0.27113687990279983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25995802879333496, "StateBufferConnector_ms": 0.004657745361328125, "ViewRequirementAgentConnector_ms": 0.21202993392944336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.2736516710601045, "num_agent_steps_trained_throughput_per_sec": 7.2736516710601045, "timesteps_total": 45568, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45568, "timers": {"training_iteration_time_ms": 69084.751, "sample_time_ms": 4947.066, "load_time_ms": 0.29, "load_throughput": 1764716.614, "learn_time_ms": 64136.458, "learn_throughput": 7.983, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "done": false, "episodes_total": 2848, "training_iteration": 89, "trial_id": "1316e_00162", "date": "2024-02-27_01-18-23", "timestamp": 1708993103, "time_this_iter_s": 70.39624977111816, "time_total_s": 6113.1621079444885, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6113.1621079444885, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 52.98383838383839, "ram_util_percent": 21.51111111111111}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.975464062889417, "policy_loss": 0.13489085246498386, "vf_loss": 3.5248717347780865, "vf_explained_var": 0.9312179679671924, "kl": 0.0, "entropy": 245.42521527608235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1338292079502177, "mean_inference_ms": 7.657685817664693, "mean_action_processing_ms": 0.4296243046876738, "mean_env_wait_ms": 0.27134204090518943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2666943073272705, "StateBufferConnector_ms": 0.004771709442138672, "ViewRequirementAgentConnector_ms": 0.2245776653289795}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1338292079502177, "mean_inference_ms": 7.657685817664693, "mean_action_processing_ms": 0.4296243046876738, "mean_env_wait_ms": 0.27134204090518943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2666943073272705, "StateBufferConnector_ms": 0.004771709442138672, "ViewRequirementAgentConnector_ms": 0.2245776653289795}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.340741947957466, "num_agent_steps_trained_throughput_per_sec": 7.340741947957466, "timesteps_total": 46080, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 69281.455, "sample_time_ms": 4988.7, "load_time_ms": 0.295, "load_throughput": 1737868.13, "learn_time_ms": 64291.444, "learn_throughput": 7.964, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "episodes_total": 2880, "training_iteration": 90, "trial_id": "1316e_00162", "date": "2024-02-27_01-19-33", "timestamp": 1708993173, "time_this_iter_s": 69.75321626663208, "time_total_s": 6182.915324211121, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6182.915324211121, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 52.918181818181814, "ram_util_percent": 21.662626262626258}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.582937424381574, "policy_loss": -0.007049879152327776, "vf_loss": 3.2139192814628283, "vf_explained_var": 0.8080144767959913, "kl": 0.0, "entropy": 247.4376501719157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1345773033961724, "mean_inference_ms": 7.661461873792985, "mean_action_processing_ms": 0.42984768447654814, "mean_env_wait_ms": 0.271543377669435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26735615730285645, "StateBufferConnector_ms": 0.004768848419189453, "ViewRequirementAgentConnector_ms": 0.22330141067504883}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1345773033961724, "mean_inference_ms": 7.661461873792985, "mean_action_processing_ms": 0.42984768447654814, "mean_env_wait_ms": 0.271543377669435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26735615730285645, "StateBufferConnector_ms": 0.004768848419189453, "ViewRequirementAgentConnector_ms": 0.22330141067504883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.347612421952066, "num_agent_steps_trained_throughput_per_sec": 7.347612421952066, "timesteps_total": 46592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46592, "timers": {"training_iteration_time_ms": 69419.224, "sample_time_ms": 4996.487, "load_time_ms": 0.291, "load_throughput": 1761531.989, "learn_time_ms": 64421.428, "learn_throughput": 7.948, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "done": false, "episodes_total": 2912, "training_iteration": 91, "trial_id": "1316e_00162", "date": "2024-02-27_01-20-42", "timestamp": 1708993242, "time_this_iter_s": 69.68779706954956, "time_total_s": 6252.60312128067, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6252.60312128067, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 52.98888888888889, "ram_util_percent": 21.640404040404043}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.4199923758705455, "policy_loss": 0.004118039458990097, "vf_loss": 2.9978622694810233, "vf_explained_var": 0.9255097145835559, "kl": 0.0, "entropy": 248.33820368448895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1352813258669738, "mean_inference_ms": 7.664371658766995, "mean_action_processing_ms": 0.43005764304029975, "mean_env_wait_ms": 0.27171976873515064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2656736373901367, "StateBufferConnector_ms": 0.004797220230102539, "ViewRequirementAgentConnector_ms": 0.2187206745147705}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1352813258669738, "mean_inference_ms": 7.664371658766995, "mean_action_processing_ms": 0.43005764304029975, "mean_env_wait_ms": 0.27171976873515064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2656736373901367, "StateBufferConnector_ms": 0.004797220230102539, "ViewRequirementAgentConnector_ms": 0.2187206745147705}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.259576930472946, "num_agent_steps_trained_throughput_per_sec": 7.259576930472946, "timesteps_total": 47104, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 69634.247, "sample_time_ms": 5008.82, "load_time_ms": 0.296, "load_throughput": 1726967.148, "learn_time_ms": 64624.121, "learn_throughput": 7.923, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "episodes_total": 2944, "training_iteration": 92, "trial_id": "1316e_00162", "date": "2024-02-27_01-21-53", "timestamp": 1708993313, "time_this_iter_s": 70.53273367881775, "time_total_s": 6323.135854959488, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6323.135854959488, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 53.778999999999996, "ram_util_percent": 21.852000000000007}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.32, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.24, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.24, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.6322108859817186, "policy_loss": 0.05096338858517508, "vf_loss": 1.9621725037693978, "vf_explained_var": 0.9598878502845765, "kl": 0.0, "entropy": 249.2296106974284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.32, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.24, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.24, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1359336107593314, "mean_inference_ms": 7.666706581733236, "mean_action_processing_ms": 0.43022652820612267, "mean_env_wait_ms": 0.2719002516819548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2637927532196045, "StateBufferConnector_ms": 0.004775524139404297, "ViewRequirementAgentConnector_ms": 0.21414709091186523}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1359336107593314, "mean_inference_ms": 7.666706581733236, "mean_action_processing_ms": 0.43022652820612267, "mean_env_wait_ms": 0.2719002516819548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2637927532196045, "StateBufferConnector_ms": 0.004775524139404297, "ViewRequirementAgentConnector_ms": 0.21414709091186523}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.238391827349487, "num_agent_steps_trained_throughput_per_sec": 7.238391827349487, "timesteps_total": 47616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47616, "timers": {"training_iteration_time_ms": 69837.972, "sample_time_ms": 5013.137, "load_time_ms": 0.298, "load_throughput": 1718399.334, "learn_time_ms": 64823.505, "learn_throughput": 7.898, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "done": false, "episodes_total": 2976, "training_iteration": 93, "trial_id": "1316e_00162", "date": "2024-02-27_01-23-04", "timestamp": 1708993384, "time_this_iter_s": 70.73908734321594, "time_total_s": 6393.874942302704, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6393.874942302704, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 52.81188118811882, "ram_util_percent": 21.933663366336635}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.0, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 2.658097873131434, "policy_loss": 0.09492604662664235, "vf_loss": 3.180643976231416, "vf_explained_var": 0.9330441539486249, "kl": 0.0, "entropy": 240.90457356770833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.0, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1365529249644417, "mean_inference_ms": 7.669008150294969, "mean_action_processing_ms": 0.43038785154458026, "mean_env_wait_ms": 0.2720692109215602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26315903663635254, "StateBufferConnector_ms": 0.004813671112060547, "ViewRequirementAgentConnector_ms": 0.21326136589050293}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1365529249644417, "mean_inference_ms": 7.669008150294969, "mean_action_processing_ms": 0.43038785154458026, "mean_env_wait_ms": 0.2720692109215602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26315903663635254, "StateBufferConnector_ms": 0.004813671112060547, "ViewRequirementAgentConnector_ms": 0.21326136589050293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.373181532555279, "num_agent_steps_trained_throughput_per_sec": 7.373181532555279, "timesteps_total": 48128, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 69939.29, "sample_time_ms": 5016.903, "load_time_ms": 0.295, "load_throughput": 1737868.13, "learn_time_ms": 64921.043, "learn_throughput": 7.887, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "episodes_total": 3008, "training_iteration": 94, "trial_id": "1316e_00162", "date": "2024-02-27_01-24-13", "timestamp": 1708993453, "time_this_iter_s": 69.44609689712524, "time_total_s": 6463.321039199829, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6463.321039199829, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 53.05102040816327, "ram_util_percent": 21.879591836734697}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.2020309656858443, "policy_loss": 0.033897744258865714, "vf_loss": 1.449538350229462, "vf_explained_var": 0.8731895779569944, "kl": 0.0, "entropy": 243.00572878519694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1369152212963487, "mean_inference_ms": 7.671129335186018, "mean_action_processing_ms": 0.4304600195196492, "mean_env_wait_ms": 0.2721721197266003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25861501693725586, "StateBufferConnector_ms": 0.00489354133605957, "ViewRequirementAgentConnector_ms": 0.20671987533569336}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1369152212963487, "mean_inference_ms": 7.671129335186018, "mean_action_processing_ms": 0.4304600195196492, "mean_env_wait_ms": 0.2721721197266003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25861501693725586, "StateBufferConnector_ms": 0.00489354133605957, "ViewRequirementAgentConnector_ms": 0.20671987533569336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.314569052947723, "num_agent_steps_trained_throughput_per_sec": 7.314569052947723, "timesteps_total": 48640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48640, "timers": {"training_iteration_time_ms": 70008.282, "sample_time_ms": 5032.464, "load_time_ms": 0.296, "load_throughput": 1731562.367, "learn_time_ms": 64974.465, "learn_throughput": 7.88, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "done": false, "episodes_total": 3040, "training_iteration": 95, "trial_id": "1316e_00162", "date": "2024-02-27_01-25-23", "timestamp": 1708993523, "time_this_iter_s": 70.00258660316467, "time_total_s": 6533.323625802994, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6533.323625802994, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 53.06666666666665, "ram_util_percent": 21.85757575757576}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.8735380347818136, "policy_loss": 0.00616295060220485, "vf_loss": 2.317228678489725, "vf_explained_var": 0.8185465946793556, "kl": 0.0, "entropy": 245.08598696390789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1372433008385943, "mean_inference_ms": 7.6727771533721185, "mean_action_processing_ms": 0.4304993163185249, "mean_env_wait_ms": 0.2722285916988784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25673747062683105, "StateBufferConnector_ms": 0.004793405532836914, "ViewRequirementAgentConnector_ms": 0.20481586456298828}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1372433008385943, "mean_inference_ms": 7.6727771533721185, "mean_action_processing_ms": 0.4304993163185249, "mean_env_wait_ms": 0.2722285916988784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25673747062683105, "StateBufferConnector_ms": 0.004793405532836914, "ViewRequirementAgentConnector_ms": 0.20481586456298828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.29205983138035, "num_agent_steps_trained_throughput_per_sec": 7.29205983138035, "timesteps_total": 49152, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 70028.497, "sample_time_ms": 5027.914, "load_time_ms": 0.297, "load_throughput": 1723225.524, "learn_time_ms": 64999.196, "learn_throughput": 7.877, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 3072, "training_iteration": 96, "trial_id": "1316e_00162", "date": "2024-02-27_01-26-34", "timestamp": 1708993594, "time_this_iter_s": 70.218674659729, "time_total_s": 6603.542300462723, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6603.542300462723, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 52.74, "ram_util_percent": 21.826000000000004}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.159375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.159375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 3.29650024274985, "policy_loss": -0.005756267385246853, "vf_loss": 4.097775342315435, "vf_explained_var": 0.8167782068252564, "kl": 0.0, "entropy": 246.5314592997233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.159375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.159375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137405007256554, "mean_inference_ms": 7.67369464588755, "mean_action_processing_ms": 0.43048663274592885, "mean_env_wait_ms": 0.272249166581692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2549021244049072, "StateBufferConnector_ms": 0.004760026931762695, "ViewRequirementAgentConnector_ms": 0.20524120330810547}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137405007256554, "mean_inference_ms": 7.67369464588755, "mean_action_processing_ms": 0.43048663274592885, "mean_env_wait_ms": 0.272249166581692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2549021244049072, "StateBufferConnector_ms": 0.004760026931762695, "ViewRequirementAgentConnector_ms": 0.20524120330810547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.305633677102842, "num_agent_steps_trained_throughput_per_sec": 7.305633677102842, "timesteps_total": 49664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49664, "timers": {"training_iteration_time_ms": 70032.787, "sample_time_ms": 5027.65, "load_time_ms": 0.294, "load_throughput": 1743936.696, "learn_time_ms": 65003.772, "learn_throughput": 7.876, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "done": false, "episodes_total": 3104, "training_iteration": 97, "trial_id": "1316e_00162", "date": "2024-02-27_01-27-44", "timestamp": 1708993664, "time_this_iter_s": 70.08791732788086, "time_total_s": 6673.630217790604, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6673.630217790604, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 53.317171717171725, "ram_util_percent": 21.596969696969698}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.7470900038878123, "policy_loss": 0.0018665899522602558, "vf_loss": 2.165650456150373, "vf_explained_var": 0.9445475687583288, "kl": 0.0, "entropy": 248.0066738128662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1375472778103244, "mean_inference_ms": 7.673643313766438, "mean_action_processing_ms": 0.43049044788163576, "mean_env_wait_ms": 0.27227888998262445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2538721561431885, "StateBufferConnector_ms": 0.004564523696899414, "ViewRequirementAgentConnector_ms": 0.20187854766845703}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1375472778103244, "mean_inference_ms": 7.673643313766438, "mean_action_processing_ms": 0.43049044788163576, "mean_env_wait_ms": 0.27227888998262445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2538721561431885, "StateBufferConnector_ms": 0.004564523696899414, "ViewRequirementAgentConnector_ms": 0.20187854766845703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.375239694539458, "num_agent_steps_trained_throughput_per_sec": 7.375239694539458, "timesteps_total": 50176, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 70023.823, "sample_time_ms": 5020.622, "load_time_ms": 0.301, "load_throughput": 1703000.514, "learn_time_ms": 65001.849, "learn_throughput": 7.877, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "episodes_total": 3136, "training_iteration": 98, "trial_id": "1316e_00162", "date": "2024-02-27_01-28-53", "timestamp": 1708993733, "time_this_iter_s": 69.42649602890015, "time_total_s": 6743.056713819504, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6743.056713819504, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 52.76666666666667, "ram_util_percent": 21.68888888888889}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.3, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.209375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.1022230652471383, "policy_loss": 0.09681151635013521, "vf_loss": 1.2476167564590772, "vf_explained_var": 0.748034442961216, "kl": 0.0, "entropy": 259.21937421162926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.3, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.209375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.209375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1375992507212802, "mean_inference_ms": 7.673560159833105, "mean_action_processing_ms": 0.4305281240434827, "mean_env_wait_ms": 0.27230488825612104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2554459571838379, "StateBufferConnector_ms": 0.004741191864013672, "ViewRequirementAgentConnector_ms": 0.202986478805542}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1375992507212802, "mean_inference_ms": 7.673560159833105, "mean_action_processing_ms": 0.4305281240434827, "mean_env_wait_ms": 0.27230488825612104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2554459571838379, "StateBufferConnector_ms": 0.004741191864013672, "ViewRequirementAgentConnector_ms": 0.202986478805542}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.380233544741031, "num_agent_steps_trained_throughput_per_sec": 7.380233544741031, "timesteps_total": 50688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50688, "timers": {"training_iteration_time_ms": 69922.169, "sample_time_ms": 4994.292, "load_time_ms": 0.31, "load_throughput": 1653946.124, "learn_time_ms": 64926.516, "learn_throughput": 7.886, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "done": false, "episodes_total": 3168, "training_iteration": 99, "trial_id": "1316e_00162", "date": "2024-02-27_01-30-03", "timestamp": 1708993803, "time_this_iter_s": 69.37952208518982, "time_total_s": 6812.436235904694, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6812.436235904694, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 53.5438775510204, "ram_util_percent": 21.741836734693884}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.206994212170442, "policy_loss": -0.0018256377118329207, "vf_loss": 1.5000264254709086, "vf_explained_var": 0.6978406324982643, "kl": 0.0, "entropy": 261.83153305053713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1379194763510798, "mean_inference_ms": 7.674667603378652, "mean_action_processing_ms": 0.4306709398227727, "mean_env_wait_ms": 0.2723940835280218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2605159282684326, "StateBufferConnector_ms": 0.004835367202758789, "ViewRequirementAgentConnector_ms": 0.21155476570129395}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1379194763510798, "mean_inference_ms": 7.674667603378652, "mean_action_processing_ms": 0.4306709398227727, "mean_env_wait_ms": 0.2723940835280218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2605159282684326, "StateBufferConnector_ms": 0.004835367202758789, "ViewRequirementAgentConnector_ms": 0.21155476570129395}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.359871547175223, "num_agent_steps_trained_throughput_per_sec": 7.359871547175223, "timesteps_total": 51200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 69904.042, "sample_time_ms": 4988.755, "load_time_ms": 0.305, "load_throughput": 1678639.606, "learn_time_ms": 64913.974, "learn_throughput": 7.887, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 3200, "training_iteration": 100, "trial_id": "1316e_00162", "date": "2024-02-27_01-31-12", "timestamp": 1708993872, "time_this_iter_s": 69.5714659690857, "time_total_s": 6882.007701873779, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6882.007701873779, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 52.851515151515144, "ram_util_percent": 21.91010101010101}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 0.9924485998849074, "policy_loss": -0.009543371107429265, "vf_loss": 1.243373384575049, "vf_explained_var": 0.7521715109546979, "kl": 0.0, "entropy": 261.1236307779948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.138277102481224, "mean_inference_ms": 7.675899121955065, "mean_action_processing_ms": 0.43081395063645883, "mean_env_wait_ms": 0.2724894169266841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2601475715637207, "StateBufferConnector_ms": 0.004812479019165039, "ViewRequirementAgentConnector_ms": 0.21205997467041016}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.138277102481224, "mean_inference_ms": 7.675899121955065, "mean_action_processing_ms": 0.43081395063645883, "mean_env_wait_ms": 0.2724894169266841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2601475715637207, "StateBufferConnector_ms": 0.004812479019165039, "ViewRequirementAgentConnector_ms": 0.21205997467041016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.379983696692876, "num_agent_steps_trained_throughput_per_sec": 7.379983696692876, "timesteps_total": 51712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51712, "timers": {"training_iteration_time_ms": 69873.478, "sample_time_ms": 4982.933, "load_time_ms": 0.301, "load_throughput": 1703135.576, "learn_time_ms": 64889.267, "learn_throughput": 7.89, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "done": false, "episodes_total": 3232, "training_iteration": 101, "trial_id": "1316e_00162", "date": "2024-02-27_01-32-22", "timestamp": 1708993942, "time_this_iter_s": 69.38184189796448, "time_total_s": 6951.389543771744, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6951.389543771744, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 52.99489795918367, "ram_util_percent": 22.060204081632648}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.5757544055581092, "policy_loss": 0.027755610489596922, "vf_loss": 1.9209140952676536, "vf_explained_var": 0.6616834332545598, "kl": 0.0, "entropy": 264.18166224161786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.138591979174043, "mean_inference_ms": 7.676934505978145, "mean_action_processing_ms": 0.4309251664251995, "mean_env_wait_ms": 0.2725721113205505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2586934566497803, "StateBufferConnector_ms": 0.004672527313232422, "ViewRequirementAgentConnector_ms": 0.21223068237304688}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.138591979174043, "mean_inference_ms": 7.676934505978145, "mean_action_processing_ms": 0.4309251664251995, "mean_env_wait_ms": 0.2725721113205505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2586934566497803, "StateBufferConnector_ms": 0.004672527313232422, "ViewRequirementAgentConnector_ms": 0.21223068237304688}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.498891946908125, "num_agent_steps_trained_throughput_per_sec": 7.498891946908125, "timesteps_total": 52224, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 69648.4, "sample_time_ms": 4967.041, "load_time_ms": 0.295, "load_throughput": 1734499.352, "learn_time_ms": 64680.086, "learn_throughput": 7.916, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "episodes_total": 3264, "training_iteration": 102, "trial_id": "1316e_00162", "date": "2024-02-27_01-33-30", "timestamp": 1708994010, "time_this_iter_s": 68.28200078010559, "time_total_s": 7019.671544551849, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7019.671544551849, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 52.75360824742268, "ram_util_percent": 22.092783505154635}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.8746132609744868, "policy_loss": 0.021049658760117988, "vf_loss": 2.3000899655123552, "vf_explained_var": 0.9347539668281873, "kl": 0.0, "entropy": 264.4282758076986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1386765803308294, "mean_inference_ms": 7.677784912668785, "mean_action_processing_ms": 0.43095585754503446, "mean_env_wait_ms": 0.2726023105204426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25533199310302734, "StateBufferConnector_ms": 0.0046236515045166016, "ViewRequirementAgentConnector_ms": 0.20212697982788086}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1386765803308294, "mean_inference_ms": 7.677784912668785, "mean_action_processing_ms": 0.43095585754503446, "mean_env_wait_ms": 0.2726023105204426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.25533199310302734, "StateBufferConnector_ms": 0.0046236515045166016, "ViewRequirementAgentConnector_ms": 0.20212697982788086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.354618229751385, "num_agent_steps_trained_throughput_per_sec": 7.354618229751385, "timesteps_total": 52736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52736, "timers": {"training_iteration_time_ms": 69536.616, "sample_time_ms": 4958.94, "load_time_ms": 0.308, "load_throughput": 1663813.162, "learn_time_ms": 64576.407, "learn_throughput": 7.929, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "done": false, "episodes_total": 3296, "training_iteration": 103, "trial_id": "1316e_00162", "date": "2024-02-27_01-34-40", "timestamp": 1708994080, "time_this_iter_s": 69.62135314941406, "time_total_s": 7089.292897701263, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7089.292897701263, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 53.57676767676767, "ram_util_percent": 22.064646464646465}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 0.9846319635709126, "policy_loss": 0.005074775358662009, "vf_loss": 1.2155340482791266, "vf_explained_var": 0.7305932387709617, "kl": 0.0, "entropy": 266.2913619995117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.62, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.199375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.199375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1387043895792384, "mean_inference_ms": 7.678598300283036, "mean_action_processing_ms": 0.4309922583072451, "mean_env_wait_ms": 0.2726424995103825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2567446231842041, "StateBufferConnector_ms": 0.004637002944946289, "ViewRequirementAgentConnector_ms": 0.20024633407592773}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1387043895792384, "mean_inference_ms": 7.678598300283036, "mean_action_processing_ms": 0.4309922583072451, "mean_env_wait_ms": 0.2726424995103825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2567446231842041, "StateBufferConnector_ms": 0.004637002944946289, "ViewRequirementAgentConnector_ms": 0.20024633407592773}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.3820353304666755, "num_agent_steps_trained_throughput_per_sec": 7.3820353304666755, "timesteps_total": 53248, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 69528.288, "sample_time_ms": 4952.238, "load_time_ms": 0.31, "load_throughput": 1650133.432, "learn_time_ms": 64574.814, "learn_throughput": 7.929, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "episodes_total": 3328, "training_iteration": 104, "trial_id": "1316e_00162", "date": "2024-02-27_01-35-49", "timestamp": 1708994149, "time_this_iter_s": 69.36243176460266, "time_total_s": 7158.655329465866, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7158.655329465866, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 53.227551020408164, "ram_util_percent": 22.0469387755102}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.189375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.189375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0016082054854702694, "total_loss": 1.857354581107696, "policy_loss": 0.01036419381077091, "vf_loss": 2.2919332707921662, "vf_explained_var": 0.9636549547314643, "kl": 0.0, "entropy": 268.51772028605143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.189375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.189375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1382802817597315, "mean_inference_ms": 7.677634190123809, "mean_action_processing_ms": 0.4308719125182716, "mean_env_wait_ms": 0.2725426201074255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24422383308410645, "StateBufferConnector_ms": 0.004546165466308594, "ViewRequirementAgentConnector_ms": 0.1790919303894043}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1382802817597315, "mean_inference_ms": 7.677634190123809, "mean_action_processing_ms": 0.4308719125182716, "mean_env_wait_ms": 0.2725426201074255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24422383308410645, "StateBufferConnector_ms": 0.004546165466308594, "ViewRequirementAgentConnector_ms": 0.1790919303894043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.489410426610947, "num_agent_steps_trained_throughput_per_sec": 7.489410426610947, "timesteps_total": 53760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 69364.879, "sample_time_ms": 4902.812, "load_time_ms": 0.308, "load_throughput": 1662782.538, "learn_time_ms": 64460.859, "learn_throughput": 7.943, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 3360, "training_iteration": 105, "trial_id": "1316e_00162", "date": "2024-02-27_01-36-58", "timestamp": 1708994218, "time_this_iter_s": 68.36836266517639, "time_total_s": 7227.0236921310425, "pid": 25392, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7f3c33a65870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0016082054854702687, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "GINEConv", "rounds": 1, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "critic_config": {"model": "GINEConv", "rounds": 6, "n_hidden_mlp": 0, "hidden_mlp_size": 32}, "encoding_config": {"type": "encoding_small", "encoding_size": 8}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_GINE_1.yaml", "critic_config": "model_GINE_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f3c359e3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.029942092509640892, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8058656786017164, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9381373395429968, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7227.0236921310425, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 53.128865979381445, "ram_util_percent": 22.092783505154635}, "checkpoint_dir_name": null}
