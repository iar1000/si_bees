{"custom_metrics": {"collisions_mean": 41.2, "collisions_min": 14, "collisions_max": 94, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9993344684270606, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 3.9480753804316167, "policy_loss": 0.0065950184942078615, "vf_loss": 4.460667620273842, "vf_explained_var": 0.035897331744775, "kl": 0.018243726046793377, "entropy": 2.6429305231434177, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500}, "sampler_results": {"episode_reward_max": -390.7452370280582, "episode_reward_min": -716.9251755275047, "episode_reward_mean": -499.4216038733708, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 41.2, "collisions_min": 14, "collisions_max": 94, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6398015188150814, "mean_inference_ms": 10.141103375391788, "mean_action_processing_ms": 0.45051635717783195, "mean_env_wait_ms": 1.0178072935864717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8461546897888184, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.26352405548095703}}, "episode_reward_max": -390.7452370280582, "episode_reward_min": -716.9251755275047, "episode_reward_mean": -499.4216038733708, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6398015188150814, "mean_inference_ms": 10.141103375391788, "mean_action_processing_ms": 0.45051635717783195, "mean_env_wait_ms": 1.0178072935864717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8461546897888184, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.26352405548095703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500, "num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.108903499018858, "num_agent_steps_trained_throughput_per_sec": 5.108903499018858, "timesteps_total": 7500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 7500, "timers": {"training_iteration_time_ms": 1468025.34, "sample_time_ms": 33216.703, "load_time_ms": 0.698, "load_throughput": 3583650.034, "learn_time_ms": 1434805.58, "learn_throughput": 1.742, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "b165f_00229", "date": "2024-03-15_16-45-57", "timestamp": 1710517557, "time_this_iter_s": 1468.0259811878204, "time_total_s": 1468.0259811878204, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1468.0259811878204, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.045651129264776, "ram_util_percent": 13.688947621335895}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"collisions_mean": 41.4, "collisions_min": 10, "collisions_max": 94, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 3.1065482874978976, "policy_loss": 0.0003388228210695516, "vf_loss": 3.5220478806687496, "vf_explained_var": 0.22245866796751132, "kl": 0.016944698818247422, "entropy": 2.727524493480551, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "sampler_results": {"episode_reward_max": -327.0242840241113, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -503.83853913188875, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 41.4, "collisions_min": 10, "collisions_max": 94, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.652697762018737, "mean_inference_ms": 10.182901662807378, "mean_action_processing_ms": 0.45019364117291294, "mean_env_wait_ms": 1.0198555430991552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.824439525604248, "StateBufferConnector_ms": 0.006310939788818359, "ViewRequirementAgentConnector_ms": 0.27666568756103516}}, "episode_reward_max": -327.0242840241113, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -503.83853913188875, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.652697762018737, "mean_inference_ms": 10.182901662807378, "mean_action_processing_ms": 0.45019364117291294, "mean_env_wait_ms": 1.0198555430991552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.824439525604248, "StateBufferConnector_ms": 0.006310939788818359, "ViewRequirementAgentConnector_ms": 0.27666568756103516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.116087209174694, "num_agent_steps_trained_throughput_per_sec": 5.116087209174694, "timesteps_total": 15000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 1466994.687, "sample_time_ms": 33498.402, "load_time_ms": 0.861, "load_throughput": 2902230.833, "learn_time_ms": 1433493.176, "learn_throughput": 1.744, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "b165f_00229", "date": "2024-03-15_17-10-28", "timestamp": 1710519028, "time_this_iter_s": 1465.9648382663727, "time_total_s": 2933.990819454193, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2933.990819454193, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.85136690647482, "ram_util_percent": 14.20935251798561}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"collisions_mean": 42.46666666666667, "collisions_min": 10, "collisions_max": 94, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 3.3379641596709604, "policy_loss": -0.016180991778289366, "vf_loss": 3.8010398670174608, "vf_explained_var": 0.3370737223104499, "kl": 0.017543818174938983, "entropy": 2.740366229928773, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4350.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500}, "sampler_results": {"episode_reward_max": -327.0242840241113, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -494.1483460525355, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 42.46666666666667, "collisions_min": 10, "collisions_max": 94, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.665556629939143, "mean_inference_ms": 10.227407724992485, "mean_action_processing_ms": 0.4514760702293161, "mean_env_wait_ms": 1.0233512898210653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8336742719014486, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.29067834218343097}}, "episode_reward_max": -327.0242840241113, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -494.1483460525355, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.665556629939143, "mean_inference_ms": 10.227407724992485, "mean_action_processing_ms": 0.4514760702293161, "mean_env_wait_ms": 1.0233512898210653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8336742719014486, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.29067834218343097}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.107837883841844, "num_agent_steps_trained_throughput_per_sec": 5.107837883841844, "timesteps_total": 22500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 22500, "timers": {"training_iteration_time_ms": 1467440.327, "sample_time_ms": 33825.273, "load_time_ms": 0.832, "load_throughput": 3005376.899, "learn_time_ms": 1433612.009, "learn_throughput": 1.744, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "b165f_00229", "date": "2024-03-15_17-34-57", "timestamp": 1710520497, "time_this_iter_s": 1468.3327975273132, "time_total_s": 4402.323616981506, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4402.323616981506, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.31353816610658, "ram_util_percent": 13.913826212193955}, "checkpoint_dir_name": "checkpoint_000002"}
{"custom_metrics": {"collisions_mean": 50.9, "collisions_min": 10, "collisions_max": 132, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 3.404628164931428, "policy_loss": -0.024477266124717293, "vf_loss": 3.885122249626565, "vf_explained_var": 0.2771279078447956, "kl": 0.019290128797587094, "entropy": 2.7517894162528815, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6090.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": -294.9084755516451, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -482.0461369452796, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 50.9, "collisions_min": 10, "collisions_max": 132, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6743132787488961, "mean_inference_ms": 10.251272050636587, "mean_action_processing_ms": 0.45199308583762204, "mean_env_wait_ms": 1.0256432804430695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8355337381362915, "StateBufferConnector_ms": 0.006358623504638672, "ViewRequirementAgentConnector_ms": 0.29515504837036133}}, "episode_reward_max": -294.9084755516451, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -482.0461369452796, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6743132787488961, "mean_inference_ms": 10.251272050636587, "mean_action_processing_ms": 0.45199308583762204, "mean_env_wait_ms": 1.0256432804430695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8355337381362915, "StateBufferConnector_ms": 0.006358623504638672, "ViewRequirementAgentConnector_ms": 0.29515504837036133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.108634221780951, "num_agent_steps_trained_throughput_per_sec": 5.108634221780951, "timesteps_total": 30000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 1467605.927, "sample_time_ms": 33869.093, "load_time_ms": 0.862, "load_throughput": 2900825.783, "learn_time_ms": 1433733.764, "learn_throughput": 1.744, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "b165f_00229", "date": "2024-03-15_17-59-26", "timestamp": 1710521966, "time_this_iter_s": 1468.1038880348206, "time_total_s": 5870.427505016327, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5870.427505016327, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.09702066314272, "ram_util_percent": 13.681787602114365}, "checkpoint_dir_name": "checkpoint_000003"}
{"custom_metrics": {"collisions_mean": 60.12, "collisions_min": 10, "collisions_max": 136, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 3.191664581223466, "policy_loss": -0.03157235826552985, "vf_loss": 3.6536711555787886, "vf_explained_var": 0.20669608023659936, "kl": 0.019669726093088265, "entropy": 2.7768332301885232, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7830.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500}, "sampler_results": {"episode_reward_max": -294.9084755516451, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -470.0207796122553, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 60.12, "collisions_min": 10, "collisions_max": 136, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.679665410210671, "mean_inference_ms": 10.266418848994865, "mean_action_processing_ms": 0.45242751498415623, "mean_env_wait_ms": 1.0269993491677791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8283820152282715, "StateBufferConnector_ms": 0.006343841552734375, "ViewRequirementAgentConnector_ms": 0.29624509811401367}}, "episode_reward_max": -294.9084755516451, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -470.0207796122553, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.679665410210671, "mean_inference_ms": 10.266418848994865, "mean_action_processing_ms": 0.45242751498415623, "mean_env_wait_ms": 1.0269993491677791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8283820152282715, "StateBufferConnector_ms": 0.006343841552734375, "ViewRequirementAgentConnector_ms": 0.29624509811401367}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500, "num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.154842844649558, "num_agent_steps_trained_throughput_per_sec": 5.154842844649558, "timesteps_total": 37500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 37500, "timers": {"training_iteration_time_ms": 1465073.237, "sample_time_ms": 33881.978, "load_time_ms": 0.922, "load_throughput": 2712302.121, "learn_time_ms": 1431188.189, "learn_throughput": 1.747, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "b165f_00229", "date": "2024-03-15_18-23-42", "timestamp": 1710523422, "time_this_iter_s": 1454.9437143802643, "time_total_s": 7325.371219396591, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7325.371219396591, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.16910411622276, "ram_util_percent": 13.698837772397093}, "checkpoint_dir_name": "checkpoint_000004"}
{"custom_metrics": {"collisions_mean": 70.56666666666666, "collisions_min": 10, "collisions_max": 208, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 2.9865959893722067, "policy_loss": -0.01142373314801732, "vf_loss": 3.3993349219533218, "vf_explained_var": 0.23380842503459975, "kl": 0.022422542427291817, "entropy": 2.750375200140065, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9570.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "sampler_results": {"episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -459.33880945703214, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 70.56666666666666, "collisions_min": 10, "collisions_max": 208, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.683039183674869, "mean_inference_ms": 10.275057089146022, "mean_action_processing_ms": 0.45259918437234703, "mean_env_wait_ms": 1.0277245549837901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8317414919535319, "StateBufferConnector_ms": 0.006407896677652995, "ViewRequirementAgentConnector_ms": 0.2989375591278076}}, "episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -459.33880945703214, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.683039183674869, "mean_inference_ms": 10.275057089146022, "mean_action_processing_ms": 0.45259918437234703, "mean_env_wait_ms": 1.0277245549837901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8317414919535319, "StateBufferConnector_ms": 0.006407896677652995, "ViewRequirementAgentConnector_ms": 0.2989375591278076}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.165721380391135, "num_agent_steps_trained_throughput_per_sec": 5.165721380391135, "timesteps_total": 45000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 1462874.114, "sample_time_ms": 33852.299, "load_time_ms": 0.896, "load_throughput": 2790497.649, "learn_time_ms": 1429018.818, "learn_throughput": 1.749, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "b165f_00229", "date": "2024-03-15_18-47-55", "timestamp": 1710524875, "time_this_iter_s": 1451.8799149990082, "time_total_s": 8777.2511343956, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8777.2511343956, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.18563803978651, "ram_util_percent": 13.85861232411451}, "checkpoint_dir_name": "checkpoint_000005"}
{"custom_metrics": {"collisions_mean": 75.4, "collisions_min": 10, "collisions_max": 208, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 2.6710033995104716, "policy_loss": -0.010252893676756528, "vf_loss": 3.0422895018054152, "vf_explained_var": 0.2527950296456786, "kl": 0.02287893035615013, "entropy": 2.704694046508307, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11310.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500}, "sampler_results": {"episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -448.0705100270045, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 75.4, "collisions_min": 10, "collisions_max": 208, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6854132224989535, "mean_inference_ms": 10.281071275359164, "mean_action_processing_ms": 0.4527087741615841, "mean_env_wait_ms": 1.0280992676388168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8284762927464077, "StateBufferConnector_ms": 0.006369522639683315, "ViewRequirementAgentConnector_ms": 0.29873030526297434}}, "episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -448.0705100270045, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6854132224989535, "mean_inference_ms": 10.281071275359164, "mean_action_processing_ms": 0.4527087741615841, "mean_env_wait_ms": 1.0280992676388168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8284762927464077, "StateBufferConnector_ms": 0.006369522639683315, "ViewRequirementAgentConnector_ms": 0.29873030526297434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500, "num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.170837961112256, "num_agent_steps_trained_throughput_per_sec": 5.170837961112256, "timesteps_total": 52500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 52500, "timers": {"training_iteration_time_ms": 1461098.078, "sample_time_ms": 33845.821, "load_time_ms": 0.951, "load_throughput": 2629139.623, "learn_time_ms": 1427249.223, "learn_throughput": 1.752, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "b165f_00229", "date": "2024-03-15_19-12-06", "timestamp": 1710526326, "time_this_iter_s": 1450.4435589313507, "time_total_s": 10227.69469332695, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10227.69469332695, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.208693540553675, "ram_util_percent": 13.75891209324915}, "checkpoint_dir_name": "checkpoint_000006"}
{"custom_metrics": {"collisions_mean": 82.275, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005767892284902428, "total_loss": 2.5453913846695473, "policy_loss": -0.020224707295593603, "vf_loss": 2.9116448161930872, "vf_explained_var": 0.28191155705643794, "kl": 0.030398473054994882, "entropy": 2.8085209936246103, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13050.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -439.29650652748313, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 82.275, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6875152546783074, "mean_inference_ms": 10.287002577593194, "mean_action_processing_ms": 0.45298416179932055, "mean_env_wait_ms": 1.0285579164938117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8280351758003235, "StateBufferConnector_ms": 0.006369054317474365, "ViewRequirementAgentConnector_ms": 0.30050963163375854}}, "episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -439.29650652748313, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6875152546783074, "mean_inference_ms": 10.287002577593194, "mean_action_processing_ms": 0.45298416179932055, "mean_env_wait_ms": 1.0285579164938117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8280351758003235, "StateBufferConnector_ms": 0.006369054317474365, "ViewRequirementAgentConnector_ms": 0.30050963163375854}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.18443049471104, "num_agent_steps_trained_throughput_per_sec": 5.18443049471104, "timesteps_total": 60000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 1459290.705, "sample_time_ms": 33888.361, "load_time_ms": 0.93, "load_throughput": 2686934.017, "learn_time_ms": 1425399.353, "learn_throughput": 1.754, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "b165f_00229", "date": "2024-03-15_19-36-14", "timestamp": 1710527774, "time_this_iter_s": 1446.6409087181091, "time_total_s": 11674.33560204506, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11674.33560204506, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.15187347931874, "ram_util_percent": 13.680048661800484}, "checkpoint_dir_name": "checkpoint_000007"}
{"custom_metrics": {"collisions_mean": 89.71111111111111, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005767892284902428, "total_loss": 2.7634636328737625, "policy_loss": -0.03865287199324725, "vf_loss": 3.1780601601833585, "vf_explained_var": 0.3069954967361757, "kl": 0.023381712797483238, "entropy": 2.928684490028469, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14790.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500}, "sampler_results": {"episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -436.5274212877973, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 89.71111111111111, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6891652986237182, "mean_inference_ms": 10.291498028960092, "mean_action_processing_ms": 0.45324712075036483, "mean_env_wait_ms": 1.0288934793084268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8283551534016927, "StateBufferConnector_ms": 0.006361272599962022, "ViewRequirementAgentConnector_ms": 0.30148135291205513}}, "episode_reward_max": -267.90434778586825, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -436.5274212877973, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6891652986237182, "mean_inference_ms": 10.291498028960092, "mean_action_processing_ms": 0.45324712075036483, "mean_env_wait_ms": 1.0288934793084268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8283551534016927, "StateBufferConnector_ms": 0.006361272599962022, "ViewRequirementAgentConnector_ms": 0.30148135291205513}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500, "num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.214636633681796, "num_agent_steps_trained_throughput_per_sec": 5.214636633681796, "timesteps_total": 67500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 67500, "timers": {"training_iteration_time_ms": 1456953.884, "sample_time_ms": 33886.653, "load_time_ms": 0.914, "load_throughput": 2736367.432, "learn_time_ms": 1423064.26, "learn_throughput": 1.757, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "b165f_00229", "date": "2024-03-15_20-00-13", "timestamp": 1710529213, "time_this_iter_s": 1438.2614228725433, "time_total_s": 13112.597024917603, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13112.597024917603, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.143535749265425, "ram_util_percent": 13.623555337904014}, "checkpoint_dir_name": "checkpoint_000008"}
{"custom_metrics": {"collisions_mean": 90.56, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005767892284902428, "total_loss": 2.5716773434445774, "policy_loss": -0.031897416319591046, "vf_loss": 2.9503796105754785, "vf_explained_var": 0.3487580262381455, "kl": 0.03068501547824634, "entropy": 2.7676528009875065, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16530.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000}, "sampler_results": {"episode_reward_max": -262.53283132514775, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -428.11366501635865, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 90.56, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6905223180412383, "mean_inference_ms": 10.29491865477617, "mean_action_processing_ms": 0.453424385173722, "mean_env_wait_ms": 1.029181152825779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8266265392303467, "StateBufferConnector_ms": 0.006340742111206055, "ViewRequirementAgentConnector_ms": 0.30097126960754395}}, "episode_reward_max": -262.53283132514775, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -428.11366501635865, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-397.48263423474907, -716.3689928943057, -453.46629653061274, -407.84492160320826, -470.6268165486532, -394.22771322889764, -716.9251755275047, -390.7452370280582, -514.4842177419538, -532.0440333957644, -353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6905223180412383, "mean_inference_ms": 10.29491865477617, "mean_action_processing_ms": 0.453424385173722, "mean_env_wait_ms": 1.029181152825779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8266265392303467, "StateBufferConnector_ms": 0.006340742111206055, "ViewRequirementAgentConnector_ms": 0.30097126960754395}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.114351411131966, "num_agent_steps_trained_throughput_per_sec": 5.114351411131966, "timesteps_total": 75000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 1457904.653, "sample_time_ms": 33882.72, "load_time_ms": 0.941, "load_throughput": 2656909.745, "learn_time_ms": 1424018.936, "learn_throughput": 1.756, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "b165f_00229", "date": "2024-03-15_20-24-40", "timestamp": 1710530680, "time_this_iter_s": 1466.4637236595154, "time_total_s": 14579.060748577118, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14579.060748577118, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.81254204709275, "ram_util_percent": 13.514800576645845}, "checkpoint_dir_name": "checkpoint_000009"}
{"custom_metrics": {"collisions_mean": 93.94, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005767892284902428, "total_loss": 2.251348605134856, "policy_loss": -0.013295784455606308, "vf_loss": 2.5636351252424308, "vf_explained_var": 0.36770646483048625, "kl": 0.027424306880639886, "entropy": 2.603681914559726, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18270.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500}, "sampler_results": {"episode_reward_max": -240.30760590946164, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -409.71149660603174, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 93.94, "collisions_min": 10, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6966134565166826, "mean_inference_ms": 10.312031503699256, "mean_action_processing_ms": 0.4538094640150288, "mean_env_wait_ms": 1.0304453243470786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.825606107711792, "StateBufferConnector_ms": 0.0063130855560302734, "ViewRequirementAgentConnector_ms": 0.3041977882385254}}, "episode_reward_max": -240.30760590946164, "episode_reward_min": -921.2657392720381, "episode_reward_mean": -409.71149660603174, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-353.7357056801717, -466.6876324103225, -515.7030861200919, -921.2657392720381, -508.2769118973914, -458.5523561019471, -621.6942532858453, -411.4278083322458, -498.1869667799021, -327.0242840241113, -334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6966134565166826, "mean_inference_ms": 10.312031503699256, "mean_action_processing_ms": 0.4538094640150288, "mean_env_wait_ms": 1.0304453243470786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.825606107711792, "StateBufferConnector_ms": 0.0063130855560302734, "ViewRequirementAgentConnector_ms": 0.3041977882385254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500, "num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.168035125965655, "num_agent_steps_trained_throughput_per_sec": 5.168035125965655, "timesteps_total": 82500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 82500, "timers": {"training_iteration_time_ms": 1456224.968, "sample_time_ms": 33901.112, "load_time_ms": 0.95, "load_throughput": 2631769.696, "learn_time_ms": 1422320.867, "learn_throughput": 1.758, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500}, "done": false, "episodes_total": 110, "training_iteration": 11, "trial_id": "b165f_00229", "date": "2024-03-15_20-48-52", "timestamp": 1710532132, "time_this_iter_s": 1451.2307522296906, "time_total_s": 16030.291500806808, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16030.291500806808, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.64254492472074, "ram_util_percent": 13.74273919378339}, "checkpoint_dir_name": "checkpoint_000010"}
{"custom_metrics": {"collisions_mean": 98.0, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.2851839254599535, "policy_loss": -0.009026484123174229, "vf_loss": 2.5946775967876117, "vf_explained_var": 0.3230798348270614, "kl": 0.02230509795039764, "entropy": 2.677371454238892, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20010.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": -234.45552098826238, "episode_reward_min": -676.6894519725472, "episode_reward_mean": -391.54738950582424, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 98.0, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7002601720652428, "mean_inference_ms": 10.320937932462964, "mean_action_processing_ms": 0.4543236795712855, "mean_env_wait_ms": 1.0312868557663872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8266439437866211, "StateBufferConnector_ms": 0.0063323974609375, "ViewRequirementAgentConnector_ms": 0.30587053298950195}}, "episode_reward_max": -234.45552098826238, "episode_reward_min": -676.6894519725472, "episode_reward_mean": -391.54738950582424, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-334.38160716067705, -339.0208227536654, -330.7099393879146, -621.3757434403478, -443.5955437067565, -456.18681870912445, -583.2651440378639, -630.8825300715363, -409.3870491600993, -598.8744005103074, -390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7002601720652428, "mean_inference_ms": 10.320937932462964, "mean_action_processing_ms": 0.4543236795712855, "mean_env_wait_ms": 1.0312868557663872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8266439437866211, "StateBufferConnector_ms": 0.0063323974609375, "ViewRequirementAgentConnector_ms": 0.30587053298950195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.17105827104744, "num_agent_steps_trained_throughput_per_sec": 5.17105827104744, "timesteps_total": 90000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 1454666.571, "sample_time_ms": 33917.664, "load_time_ms": 0.927, "load_throughput": 2695498.83, "learn_time_ms": 1420745.956, "learn_throughput": 1.76, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "b165f_00229", "date": "2024-03-15_21-13-04", "timestamp": 1710533584, "time_this_iter_s": 1450.3822884559631, "time_total_s": 17480.67378926277, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17480.67378926277, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.55126336248785, "ram_util_percent": 13.718853255587948}, "checkpoint_dir_name": "checkpoint_000011"}
{"custom_metrics": {"collisions_mean": 101.06, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.3047115002309195, "policy_loss": -0.01988293174533816, "vf_loss": 2.6284903704006783, "vf_explained_var": 0.23642252478106268, "kl": 0.023865304569628133, "entropy": 2.749273509540777, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21750.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500}, "sampler_results": {"episode_reward_max": -234.45552098826238, "episode_reward_min": -676.6894519725472, "episode_reward_mean": -373.96877008120003, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 101.06, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7012706396537478, "mean_inference_ms": 10.320074544853753, "mean_action_processing_ms": 0.4544210598923819, "mean_env_wait_ms": 1.031219187737575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8242373466491699, "StateBufferConnector_ms": 0.00632476806640625, "ViewRequirementAgentConnector_ms": 0.3045809268951416}}, "episode_reward_max": -234.45552098826238, "episode_reward_min": -676.6894519725472, "episode_reward_mean": -373.96877008120003, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-390.2371594639288, -446.9884072544555, -516.2664538835832, -377.5308913200432, -676.6894519725472, -324.47341399942025, -447.5027147816828, -563.7736545435899, -294.9084755516451, -419.0244734642192, -484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7012706396537478, "mean_inference_ms": 10.320074544853753, "mean_action_processing_ms": 0.4544210598923819, "mean_env_wait_ms": 1.031219187737575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8242373466491699, "StateBufferConnector_ms": 0.00632476806640625, "ViewRequirementAgentConnector_ms": 0.3045809268951416}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500, "num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.160683441554709, "num_agent_steps_trained_throughput_per_sec": 5.160683441554709, "timesteps_total": 97500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 97500, "timers": {"training_iteration_time_ms": 1453162.995, "sample_time_ms": 33830.862, "load_time_ms": 1.011, "load_throughput": 2473931.816, "learn_time_ms": 1419329.089, "learn_throughput": 1.761, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500}, "done": false, "episodes_total": 130, "training_iteration": 13, "trial_id": "b165f_00229", "date": "2024-03-15_21-37-17", "timestamp": 1710535037, "time_this_iter_s": 1453.2980217933655, "time_total_s": 18933.971811056137, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18933.971811056137, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.70998545807077, "ram_util_percent": 13.622055259331068}, "checkpoint_dir_name": "checkpoint_000012"}
{"custom_metrics": {"collisions_mean": 101.78, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.2111573777793123, "policy_loss": -0.010761076340119986, "vf_loss": 2.5153564509817925, "vf_explained_var": 0.3714418259845383, "kl": 0.02092024954972553, "entropy": 2.7637020820858833, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23490.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "sampler_results": {"episode_reward_max": -234.45552098826238, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -360.1844314936022, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 101.78, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7013402425439006, "mean_inference_ms": 10.317870712173344, "mean_action_processing_ms": 0.45454504951151664, "mean_env_wait_ms": 1.0308607834974017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8211820125579834, "StateBufferConnector_ms": 0.006304740905761719, "ViewRequirementAgentConnector_ms": 0.30266809463500977}}, "episode_reward_max": -234.45552098826238, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -360.1844314936022, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-484.96357262738616, -448.7926805608061, -447.1475500834954, -404.7172021486633, -422.1779473678594, -348.0173087607946, -450.46792953104233, -436.7275242701849, -381.86760768483435, -394.3141797665141, -508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7013402425439006, "mean_inference_ms": 10.317870712173344, "mean_action_processing_ms": 0.45454504951151664, "mean_env_wait_ms": 1.0308607834974017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8211820125579834, "StateBufferConnector_ms": 0.006304740905761719, "ViewRequirementAgentConnector_ms": 0.30266809463500977}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.203203819133819, "num_agent_steps_trained_throughput_per_sec": 5.203203819133819, "timesteps_total": 105000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 105000, "timers": {"training_iteration_time_ms": 1450494.679, "sample_time_ms": 33785.74, "load_time_ms": 0.99, "load_throughput": 2524863.954, "learn_time_ms": 1416705.947, "learn_throughput": 1.765, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "b165f_00229", "date": "2024-03-15_22-01-19", "timestamp": 1710536479, "time_this_iter_s": 1441.4217474460602, "time_total_s": 20375.393558502197, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20375.393558502197, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.30029339853301, "ram_util_percent": 13.593398533007331}, "checkpoint_dir_name": "checkpoint_000013"}
{"custom_metrics": {"collisions_mean": 100.36, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.0006659763870527, "policy_loss": -0.009963511428046416, "vf_loss": 2.2753250309276853, "vf_explained_var": 0.40356935749108763, "kl": 0.022456513906978927, "entropy": 2.6643509838087804, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25230.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500}, "sampler_results": {"episode_reward_max": -221.76524480571334, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -348.05272421341726, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 100.36, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7013207134946862, "mean_inference_ms": 10.314776053006959, "mean_action_processing_ms": 0.454580424680859, "mean_env_wait_ms": 1.0304829888774776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8215763568878174, "StateBufferConnector_ms": 0.0063114166259765625, "ViewRequirementAgentConnector_ms": 0.3029303550720215}}, "episode_reward_max": -221.76524480571334, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -348.05272421341726, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-508.9371538862463, -498.559774294375, -404.83166048626805, -343.49839366979194, -433.6889656986196, -399.7286362826771, -267.90434778586825, -352.3397625623095, -356.7403879959472, -493.0605041470611, -307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7013207134946862, "mean_inference_ms": 10.314776053006959, "mean_action_processing_ms": 0.454580424680859, "mean_env_wait_ms": 1.0304829888774776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8215763568878174, "StateBufferConnector_ms": 0.0063114166259765625, "ViewRequirementAgentConnector_ms": 0.3029303550720215}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500, "num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.236842716348144, "num_agent_steps_trained_throughput_per_sec": 5.236842716348144, "timesteps_total": 112500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 112500, "timers": {"training_iteration_time_ms": 1448216.491, "sample_time_ms": 33751.967, "load_time_ms": 0.951, "load_throughput": 2628273.511, "learn_time_ms": 1414461.568, "learn_throughput": 1.767, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500}, "done": false, "episodes_total": 150, "training_iteration": 15, "trial_id": "b165f_00229", "date": "2024-03-15_22-25-13", "timestamp": 1710537913, "time_this_iter_s": 1432.162812948227, "time_total_s": 21807.556371450424, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21807.556371450424, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.33202164289228, "ram_util_percent": 13.467929168716184}, "checkpoint_dir_name": "checkpoint_000014"}
{"custom_metrics": {"collisions_mean": 95.38, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.343898370163515, "policy_loss": -0.019147671877684864, "vf_loss": 2.6696273321221615, "vf_explained_var": 0.2521713982710893, "kl": 0.024777021429811915, "entropy": 2.621555886803002, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26970.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -221.76524480571334, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -336.6090132218063, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 95.38, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7011516011967813, "mean_inference_ms": 10.310902492927427, "mean_action_processing_ms": 0.45457949640020573, "mean_env_wait_ms": 1.0301157339051725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8188297748565674, "StateBufferConnector_ms": 0.006236553192138672, "ViewRequirementAgentConnector_ms": 0.29930996894836426}}, "episode_reward_max": -221.76524480571334, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -336.6090132218063, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-307.4234121875796, -430.4099209631784, -412.54946161220386, -345.76810173259906, -428.7607014379973, -458.1512888412282, -293.33068050056477, -409.013856381652, -448.28156856473555, -270.918142246649, -322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7011516011967813, "mean_inference_ms": 10.310902492927427, "mean_action_processing_ms": 0.45457949640020573, "mean_env_wait_ms": 1.0301157339051725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8188297748565674, "StateBufferConnector_ms": 0.006236553192138672, "ViewRequirementAgentConnector_ms": 0.29930996894836426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.268033028827183, "num_agent_steps_trained_throughput_per_sec": 5.268033028827183, "timesteps_total": 120000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 1445396.766, "sample_time_ms": 33675.322, "load_time_ms": 0.951, "load_throughput": 2628141.761, "learn_time_ms": 1411718.479, "learn_throughput": 1.771, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "b165f_00229", "date": "2024-03-15_22-48-57", "timestamp": 1710539337, "time_this_iter_s": 1423.6833617687225, "time_total_s": 23231.239733219147, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23231.239733219147, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.34430693069307, "ram_util_percent": 13.655346534653463}, "checkpoint_dir_name": "checkpoint_000015"}
{"custom_metrics": {"collisions_mean": 91.74, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.2584224804507933, "policy_loss": -0.017804703226944583, "vf_loss": 2.574676151967597, "vf_explained_var": 0.3570460393511016, "kl": 0.023629416016615584, "entropy": 2.7875263975269493, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28710.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500}, "sampler_results": {"episode_reward_max": -217.2474204787957, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -328.4156005264578, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 91.74, "collisions_min": 14, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7008307059790053, "mean_inference_ms": 10.30620526593146, "mean_action_processing_ms": 0.45452699310100825, "mean_env_wait_ms": 1.029782031712275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8170995712280273, "StateBufferConnector_ms": 0.006221771240234375, "ViewRequirementAgentConnector_ms": 0.2978947162628174}}, "episode_reward_max": -217.2474204787957, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -328.4156005264578, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-322.72777754890535, -437.35932953708766, -399.60778651104874, -318.32041981223847, -339.4119097294559, -349.80174287584896, -381.99110477475773, -357.43781643616677, -420.8475387219808, -451.2793943608474, -401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7008307059790053, "mean_inference_ms": 10.30620526593146, "mean_action_processing_ms": 0.45452699310100825, "mean_env_wait_ms": 1.029782031712275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8170995712280273, "StateBufferConnector_ms": 0.006221771240234375, "ViewRequirementAgentConnector_ms": 0.2978947162628174}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500, "num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.2531602674177345, "num_agent_steps_trained_throughput_per_sec": 5.2531602674177345, "timesteps_total": 127500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 127500, "timers": {"training_iteration_time_ms": 1443123.778, "sample_time_ms": 33615.704, "load_time_ms": 0.901, "load_throughput": 2775185.264, "learn_time_ms": 1409505.153, "learn_throughput": 1.774, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500}, "done": false, "episodes_total": 170, "training_iteration": 17, "trial_id": "b165f_00229", "date": "2024-03-15_23-12-46", "timestamp": 1710540766, "time_this_iter_s": 1427.7140817642212, "time_total_s": 24658.953814983368, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24658.953814983368, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.32106561420818, "ram_util_percent": 13.544400592007891}, "checkpoint_dir_name": "checkpoint_000016"}
{"custom_metrics": {"collisions_mean": 86.82, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.3299672085459977, "policy_loss": -0.029702482241120234, "vf_loss": 2.6650018120634145, "vf_explained_var": 0.391583277062438, "kl": 0.02487176236289757, "entropy": 2.5545089935434278, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30450.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000}, "sampler_results": {"episode_reward_max": -205.35258983932212, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -319.15165669903564, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 86.82, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7000149039887673, "mean_inference_ms": 10.298768904408478, "mean_action_processing_ms": 0.45421304707443044, "mean_env_wait_ms": 1.0292051212088857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8162083625793457, "StateBufferConnector_ms": 0.006194591522216797, "ViewRequirementAgentConnector_ms": 0.2949070930480957}}, "episode_reward_max": -205.35258983932212, "episode_reward_min": -665.5531738864793, "episode_reward_mean": -319.15165669903564, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-401.92593552212924, -440.6630524184601, -400.6096035403123, -323.8908539651446, -371.8615965543033, -422.2792932355587, -402.775414172728, -360.7922185297747, -353.3962518782133, -665.5531738864793, -398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7000149039887673, "mean_inference_ms": 10.298768904408478, "mean_action_processing_ms": 0.45421304707443044, "mean_env_wait_ms": 1.0292051212088857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8162083625793457, "StateBufferConnector_ms": 0.006194591522216797, "ViewRequirementAgentConnector_ms": 0.2949070930480957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.23441155263447, "num_agent_steps_trained_throughput_per_sec": 5.23441155263447, "timesteps_total": 135000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 135000, "timers": {"training_iteration_time_ms": 1441742.446, "sample_time_ms": 33475.221, "load_time_ms": 0.896, "load_throughput": 2788765.957, "learn_time_ms": 1408264.325, "learn_throughput": 1.775, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "b165f_00229", "date": "2024-03-15_23-36-39", "timestamp": 1710542199, "time_this_iter_s": 1432.8278350830078, "time_total_s": 26091.781650066376, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26091.781650066376, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.250614854894245, "ram_util_percent": 13.619626168224297}, "checkpoint_dir_name": "checkpoint_000017"}
{"custom_metrics": {"collisions_mean": 80.46, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.2888918907783027, "policy_loss": -0.013868981004082436, "vf_loss": 2.6027396346645792, "vf_explained_var": 0.3492260469102311, "kl": 0.02305521724729574, "entropy": 2.589443087098242, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32190.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500}, "sampler_results": {"episode_reward_max": -205.35258983932212, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -307.34098224812385, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 80.46, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6991603407484805, "mean_inference_ms": 10.291117781793195, "mean_action_processing_ms": 0.453837122473421, "mean_env_wait_ms": 1.0286214560104305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8146653175354004, "StateBufferConnector_ms": 0.006181478500366211, "ViewRequirementAgentConnector_ms": 0.2937588691711426}}, "episode_reward_max": -205.35258983932212, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -307.34098224812385, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-398.80174045692456, -329.36578298124084, -379.11515071740007, -332.6330976854281, -262.53283132514775, -343.191861668313, -296.00670830810884, -418.4544373512275, -350.0931568871237, -413.7038183531999, -290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6991603407484805, "mean_inference_ms": 10.291117781793195, "mean_action_processing_ms": 0.453837122473421, "mean_env_wait_ms": 1.0286214560104305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8146653175354004, "StateBufferConnector_ms": 0.006181478500366211, "ViewRequirementAgentConnector_ms": 0.2937588691711426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500, "num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.243443158903874, "num_agent_steps_trained_throughput_per_sec": 5.243443158903874, "timesteps_total": 142500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 142500, "timers": {"training_iteration_time_ms": 1440952.294, "sample_time_ms": 33435.336, "load_time_ms": 0.938, "load_throughput": 2664742.058, "learn_time_ms": 1407514.042, "learn_throughput": 1.776, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500}, "done": false, "episodes_total": 190, "training_iteration": 19, "trial_id": "b165f_00229", "date": "2024-03-16_00-00-31", "timestamp": 1710543631, "time_this_iter_s": 1430.3598840236664, "time_total_s": 27522.141534090042, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 27522.141534090042, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.72827586206896, "ram_util_percent": 14.579310344827583}, "checkpoint_dir_name": "checkpoint_000018"}
{"custom_metrics": {"collisions_mean": 76.12, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 1.9697070301012618, "policy_loss": -0.019707587673783774, "vf_loss": 2.248627797908139, "vf_explained_var": 0.2888865173890673, "kl": 0.02365146145122875, "entropy": 2.4938749657965253, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33930.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": -205.35258983932212, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -296.36136380756403, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 76.12, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6980655768534527, "mean_inference_ms": 10.28238960006353, "mean_action_processing_ms": 0.4534387041432744, "mean_env_wait_ms": 1.0279593572824277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8133466243743896, "StateBufferConnector_ms": 0.0061969757080078125, "ViewRequirementAgentConnector_ms": 0.29311680793762207}}, "episode_reward_max": -205.35258983932212, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -296.36136380756403, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-290.483006966855, -344.19312773945506, -313.57939231041007, -264.3846891680958, -404.01109190997477, -344.99741770612536, -393.249419306739, -309.04852547944347, -240.30760590946164, -249.74492120445092, -234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6980655768534527, "mean_inference_ms": 10.28238960006353, "mean_action_processing_ms": 0.4534387041432744, "mean_env_wait_ms": 1.0279593572824277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8133466243743896, "StateBufferConnector_ms": 0.0061969757080078125, "ViewRequirementAgentConnector_ms": 0.29311680793762207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.360130498885772, "num_agent_steps_trained_throughput_per_sec": 5.360130498885772, "timesteps_total": 150000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 1434228.1, "sample_time_ms": 33336.076, "load_time_ms": 0.892, "load_throughput": 2802480.222, "learn_time_ms": 1400889.185, "learn_throughput": 1.785, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "b165f_00229", "date": "2024-03-16_00-23-51", "timestamp": 1710545031, "time_this_iter_s": 1399.2217364311218, "time_total_s": 28921.363270521164, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 28921.363270521164, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.33889168765743, "ram_util_percent": 15.605340050377832}, "checkpoint_dir_name": "checkpoint_000019"}
{"custom_metrics": {"collisions_mean": 74.72, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.0129610002343274, "policy_loss": -0.018980864496184406, "vf_loss": 2.2990476112855576, "vf_explained_var": 0.3957078724414453, "kl": 0.02147934234850965, "entropy": 2.575414591616598, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35670.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500}, "sampler_results": {"episode_reward_max": -191.00700956525262, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -290.2563787804946, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 74.72, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6969016924905127, "mean_inference_ms": 10.27331575979353, "mean_action_processing_ms": 0.45301714389031544, "mean_env_wait_ms": 1.0273349640935225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8121075630187988, "StateBufferConnector_ms": 0.006188631057739258, "ViewRequirementAgentConnector_ms": 0.2906527519226074}}, "episode_reward_max": -191.00700956525262, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -290.2563787804946, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234.45552098826238, -305.9953218187187, -402.73228061717657, -309.90742063739134, -358.53634139351396, -400.21477361529605, -347.3747189137577, -298.6531630997042, -299.3933643944514, -308.88112840504897, -246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6969016924905127, "mean_inference_ms": 10.27331575979353, "mean_action_processing_ms": 0.45301714389031544, "mean_env_wait_ms": 1.0273349640935225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8121075630187988, "StateBufferConnector_ms": 0.006188631057739258, "ViewRequirementAgentConnector_ms": 0.2906527519226074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500, "num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.312071767524807, "num_agent_steps_trained_throughput_per_sec": 5.312071767524807, "timesteps_total": 157500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 157500, "timers": {"training_iteration_time_ms": 1430293.099, "sample_time_ms": 33242.65, "load_time_ms": 0.921, "load_throughput": 2715111.341, "learn_time_ms": 1397047.613, "learn_throughput": 1.789, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500}, "done": false, "episodes_total": 210, "training_iteration": 21, "trial_id": "b165f_00229", "date": "2024-03-16_00-47-24", "timestamp": 1710546444, "time_this_iter_s": 1411.880610704422, "time_total_s": 30333.243881225586, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 30333.243881225586, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 41.3643391521197, "ram_util_percent": 15.620099750623439}, "checkpoint_dir_name": "checkpoint_000020"}
{"custom_metrics": {"collisions_mean": 72.38, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 1.7504411052939235, "policy_loss": -0.03128487562477032, "vf_loss": 2.0186042153801043, "vf_explained_var": 0.44126663752670947, "kl": 0.020778094269014124, "entropy": 2.6262517510474415, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37410.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "sampler_results": {"episode_reward_max": -191.00700956525262, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -282.2469420157102, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 72.38, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6955222270812846, "mean_inference_ms": 10.263514151431082, "mean_action_processing_ms": 0.4525287221345596, "mean_env_wait_ms": 1.026697057837809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8103578090667725, "StateBufferConnector_ms": 0.0061435699462890625, "ViewRequirementAgentConnector_ms": 0.28720545768737793}}, "episode_reward_max": -191.00700956525262, "episode_reward_min": -430.6813044941773, "episode_reward_mean": -282.2469420157102, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-246.3766057952131, -297.32415196869727, -285.4626319799083, -286.3774285156321, -430.6813044941773, -299.51387691822833, -302.0348642421397, -252.53932585086696, -265.4372527136353, -324.0702139973639, -358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6955222270812846, "mean_inference_ms": 10.263514151431082, "mean_action_processing_ms": 0.4525287221345596, "mean_env_wait_ms": 1.026697057837809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8103578090667725, "StateBufferConnector_ms": 0.0061435699462890625, "ViewRequirementAgentConnector_ms": 0.28720545768737793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.285916795433349, "num_agent_steps_trained_throughput_per_sec": 5.285916795433349, "timesteps_total": 165000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 165000, "timers": {"training_iteration_time_ms": 1427141.545, "sample_time_ms": 33165.533, "load_time_ms": 0.922, "load_throughput": 2712863.5, "learn_time_ms": 1393973.2, "learn_throughput": 1.793, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "b165f_00229", "date": "2024-03-16_01-11-03", "timestamp": 1710547863, "time_this_iter_s": 1418.8665630817413, "time_total_s": 31752.110444307327, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 31752.110444307327, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 41.34199801192843, "ram_util_percent": 15.707803180914512}, "checkpoint_dir_name": "checkpoint_000021"}
{"custom_metrics": {"collisions_mean": 71.66, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 1.8428205698070212, "policy_loss": -0.02006532294814871, "vf_loss": 2.1082954861309338, "vf_explained_var": 0.44004699368586486, "kl": 0.02315552487899817, "entropy": 2.641733041165889, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39150.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500}, "sampler_results": {"episode_reward_max": -191.00700956525262, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -277.72869788093516, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 71.66, "collisions_min": 14, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6940246452733771, "mean_inference_ms": 10.253213936228883, "mean_action_processing_ms": 0.4520023197704154, "mean_env_wait_ms": 1.0260504470641942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8095345497131348, "StateBufferConnector_ms": 0.006133317947387695, "ViewRequirementAgentConnector_ms": 0.28608202934265137}}, "episode_reward_max": -191.00700956525262, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -277.72869788093516, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-358.3983226686428, -275.2652158432828, -365.75663367055705, -243.67858570410067, -247.50523695850583, -291.5369856319067, -273.4399316897912, -371.4432760995434, -353.6208357744969, -298.31621343450945, -238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6940246452733771, "mean_inference_ms": 10.253213936228883, "mean_action_processing_ms": 0.4520023197704154, "mean_env_wait_ms": 1.0260504470641942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8095345497131348, "StateBufferConnector_ms": 0.006133317947387695, "ViewRequirementAgentConnector_ms": 0.28608202934265137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500, "num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.303341633721071, "num_agent_steps_trained_throughput_per_sec": 5.303341633721071, "timesteps_total": 172500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 172500, "timers": {"training_iteration_time_ms": 1423232.226, "sample_time_ms": 33076.986, "load_time_ms": 0.88, "load_throughput": 2839899.25, "learn_time_ms": 1390152.491, "learn_throughput": 1.798, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500}, "done": false, "episodes_total": 230, "training_iteration": 23, "trial_id": "b165f_00229", "date": "2024-03-16_01-34-38", "timestamp": 1710549278, "time_this_iter_s": 1414.2047777175903, "time_total_s": 33166.31522202492, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 33166.31522202492, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 41.40179372197309, "ram_util_percent": 15.865620328849033}, "checkpoint_dir_name": "checkpoint_000022"}
{"custom_metrics": {"collisions_mean": 68.56, "collisions_min": 2, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 1.754918595915125, "policy_loss": -0.019603919124648234, "vf_loss": 2.0072051825194523, "vf_explained_var": 0.3229125228078886, "kl": 0.023368590937970186, "entropy": 2.508407853184075, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40890.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -154.4666044160155, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -269.90900315030746, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 68.56, "collisions_min": 2, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.692548573358688, "mean_inference_ms": 10.243630333525196, "mean_action_processing_ms": 0.4515439010210537, "mean_env_wait_ms": 1.02549652900716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8108031749725342, "StateBufferConnector_ms": 0.006136417388916016, "ViewRequirementAgentConnector_ms": 0.28691864013671875}}, "episode_reward_max": -154.4666044160155, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -269.90900315030746, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-238.6960924937026, -243.1369048835434, -269.6126548271233, -221.76524480571334, -285.37800187320966, -362.0380365069792, -391.34810083845434, -376.7414614508284, -288.5728853097524, -328.733391793774, -224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.692548573358688, "mean_inference_ms": 10.243630333525196, "mean_action_processing_ms": 0.4515439010210537, "mean_env_wait_ms": 1.02549652900716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8108031749725342, "StateBufferConnector_ms": 0.006136417388916016, "ViewRequirementAgentConnector_ms": 0.28691864013671875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.275132541929276, "num_agent_steps_trained_throughput_per_sec": 5.275132541929276, "timesteps_total": 180000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 1421266.788, "sample_time_ms": 33077.955, "load_time_ms": 0.876, "load_throughput": 2853889.282, "learn_time_ms": 1388186.09, "learn_throughput": 1.801, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "b165f_00229", "date": "2024-03-16_01-58-21", "timestamp": 1710550701, "time_this_iter_s": 1421.7673127651215, "time_total_s": 34588.08253479004, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 34588.08253479004, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 41.38021814576103, "ram_util_percent": 15.725979176995539}, "checkpoint_dir_name": "checkpoint_000023"}
{"custom_metrics": {"collisions_mean": 66.6, "collisions_min": 2, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0005767892284902428, "total_loss": 2.1997213499366315, "policy_loss": -0.017910379194654526, "vf_loss": 2.5060665476082384, "vf_explained_var": 0.2549445213257581, "kl": 0.026066961651667952, "entropy": 2.7141699309321656, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42630.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500}, "sampler_results": {"episode_reward_max": -154.4666044160155, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -264.1255546366506, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 66.6, "collisions_min": 2, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6910459863674934, "mean_inference_ms": 10.234331922933755, "mean_action_processing_ms": 0.4511035608758401, "mean_env_wait_ms": 1.0249525107523971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.811610221862793, "StateBufferConnector_ms": 0.006136655807495117, "ViewRequirementAgentConnector_ms": 0.2863011360168457}}, "episode_reward_max": -154.4666044160155, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -264.1255546366506, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-224.15443685980256, -371.86856856762483, -322.3262684891124, -309.3135992769928, -316.3693721583194, -221.77778531180172, -294.66581708841846, -251.19326715417833, -315.00938650602296, -288.2399862357955, -297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6910459863674934, "mean_inference_ms": 10.234331922933755, "mean_action_processing_ms": 0.4511035608758401, "mean_env_wait_ms": 1.0249525107523971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.811610221862793, "StateBufferConnector_ms": 0.006136655807495117, "ViewRequirementAgentConnector_ms": 0.2863011360168457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500, "num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.2455859538738565, "num_agent_steps_trained_throughput_per_sec": 5.2455859538738565, "timesteps_total": 187500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 187500, "timers": {"training_iteration_time_ms": 1421028.079, "sample_time_ms": 33050.423, "load_time_ms": 0.939, "load_throughput": 2662103.633, "learn_time_ms": 1387974.867, "learn_throughput": 1.801, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500}, "done": false, "episodes_total": 250, "training_iteration": 25, "trial_id": "b165f_00229", "date": "2024-03-16_02-22-11", "timestamp": 1710552131, "time_this_iter_s": 1429.7756435871124, "time_total_s": 36017.85817837715, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 36017.85817837715, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 41.34647609659931, "ram_util_percent": 15.638294726466238}, "checkpoint_dir_name": "checkpoint_000024"}
{"custom_metrics": {"collisions_mean": 66.36, "collisions_min": 0, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 2.0720376580070448, "policy_loss": -0.017251642128511536, "vf_loss": 2.3545074733595053, "vf_explained_var": 0.30707181048119203, "kl": 0.021764769307979992, "entropy": 2.523298681330407, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44370.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -261.0250018632724, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 66.36, "collisions_min": 0, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6897335829435138, "mean_inference_ms": 10.22641239331963, "mean_action_processing_ms": 0.4507632272350827, "mean_env_wait_ms": 1.024474856288184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8134300708770752, "StateBufferConnector_ms": 0.006160259246826172, "ViewRequirementAgentConnector_ms": 0.2877483367919922}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -428.9316559083985, "episode_reward_mean": -261.0250018632724, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-297.4313859004026, -265.8077756583989, -217.2474204787957, -282.48823496877964, -247.155243545576, -285.10552371381016, -329.7195167225167, -305.7792487363632, -325.5998593005038, -428.9316559083985, -248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6897335829435138, "mean_inference_ms": 10.22641239331963, "mean_action_processing_ms": 0.4507632272350827, "mean_env_wait_ms": 1.024474856288184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8134300708770752, "StateBufferConnector_ms": 0.006160259246826172, "ViewRequirementAgentConnector_ms": 0.2877483367919922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.255508707129434, "num_agent_steps_trained_throughput_per_sec": 5.255508707129434, "timesteps_total": 195000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 195000, "timers": {"training_iteration_time_ms": 1421367.355, "sample_time_ms": 33080.695, "load_time_ms": 0.947, "load_throughput": 2640717.236, "learn_time_ms": 1388283.869, "learn_throughput": 1.801, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "b165f_00229", "date": "2024-03-16_02-45-59", "timestamp": 1710553559, "time_this_iter_s": 1427.0761020183563, "time_total_s": 37444.93428039551, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 37444.93428039551, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 41.38676543209876, "ram_util_percent": 15.596691358024689}, "checkpoint_dir_name": "checkpoint_000025"}
{"custom_metrics": {"collisions_mean": 66.08, "collisions_min": 0, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.9268321109882116, "policy_loss": -0.02037467339167093, "vf_loss": 2.1965954188814107, "vf_explained_var": 0.2906083051500649, "kl": 0.019637259039974334, "entropy": 2.482262411747856, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46110.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -415.1648186459306, "episode_reward_mean": -254.41895465681264, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 66.08, "collisions_min": 0, "collisions_max": 230, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6885032738551502, "mean_inference_ms": 10.218953870088896, "mean_action_processing_ms": 0.45046507251496903, "mean_env_wait_ms": 1.0240204713022847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8148641586303711, "StateBufferConnector_ms": 0.006366252899169922, "ViewRequirementAgentConnector_ms": 0.28786444664001465}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -415.1648186459306, "episode_reward_mean": -254.41895465681264, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-248.94232971476404, -235.95308040415668, -283.14679544888594, -205.35258983932212, -299.0477650160544, -269.93259343504417, -228.86457341591986, -350.26161933637206, -328.5287259878146, -402.3603649677948, -298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6885032738551502, "mean_inference_ms": 10.218953870088896, "mean_action_processing_ms": 0.45046507251496903, "mean_env_wait_ms": 1.0240204713022847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8148641586303711, "StateBufferConnector_ms": 0.006366252899169922, "ViewRequirementAgentConnector_ms": 0.28786444664001465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.304402592756566, "num_agent_steps_trained_throughput_per_sec": 5.304402592756566, "timesteps_total": 202500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 202500, "timers": {"training_iteration_time_ms": 1419988.135, "sample_time_ms": 33065.267, "load_time_ms": 0.976, "load_throughput": 2561375.739, "learn_time_ms": 1386920.057, "learn_throughput": 1.803, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500}, "done": false, "episodes_total": 270, "training_iteration": 27, "trial_id": "b165f_00229", "date": "2024-03-16_03-09-34", "timestamp": 1710554974, "time_this_iter_s": 1413.9219484329224, "time_total_s": 38858.85622882843, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 38858.85622882843, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 41.39237668161435, "ram_util_percent": 15.531539611360238}, "checkpoint_dir_name": "checkpoint_000026"}
{"custom_metrics": {"collisions_mean": 62.96, "collisions_min": 0, "collisions_max": 166, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.656142136524699, "policy_loss": -0.015432313948751952, "vf_loss": 1.8874435761707953, "vf_explained_var": 0.3022596340412381, "kl": 0.019364562555987, "entropy": 2.543107078472773, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47850.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -415.1648186459306, "episode_reward_mean": -247.21341866970445, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 62.96, "collisions_min": 0, "collisions_max": 166, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6874187765258895, "mean_inference_ms": 10.212598701090736, "mean_action_processing_ms": 0.4502537041185407, "mean_env_wait_ms": 1.0236246551798036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8153457641601562, "StateBufferConnector_ms": 0.006372213363647461, "ViewRequirementAgentConnector_ms": 0.28879356384277344}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -415.1648186459306, "episode_reward_mean": -247.21341866970445, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-298.07965686218466, -345.12626972576214, -224.1376191800589, -251.42725316796964, -415.1648186459306, -259.7893958043371, -340.5682120740068, -281.61309725282854, -270.52029787308965, -276.25332802574707, -247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6874187765258895, "mean_inference_ms": 10.212598701090736, "mean_action_processing_ms": 0.4502537041185407, "mean_env_wait_ms": 1.0236246551798036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8153457641601562, "StateBufferConnector_ms": 0.006372213363647461, "ViewRequirementAgentConnector_ms": 0.28879356384277344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.288693366223435, "num_agent_steps_trained_throughput_per_sec": 5.288693366223435, "timesteps_total": 210000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 1418517.519, "sample_time_ms": 33087.96, "load_time_ms": 0.98, "load_throughput": 2550411.052, "learn_time_ms": 1385426.705, "learn_throughput": 1.804, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "b165f_00229", "date": "2024-03-16_03-33-20", "timestamp": 1710556400, "time_this_iter_s": 1418.122052192688, "time_total_s": 40276.97828102112, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 40276.97828102112, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 41.36968348170129, "ram_util_percent": 15.503264094955489}, "checkpoint_dir_name": "checkpoint_000027"}
{"custom_metrics": {"collisions_mean": 60.42, "collisions_min": 0, "collisions_max": 166, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.9804956908923863, "policy_loss": -0.03153215393466854, "vf_loss": 2.269063245530786, "vf_explained_var": 0.40698650153889054, "kl": 0.02091548668017247, "entropy": 2.5698991408978387, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49590.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -241.08492508155908, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 60.42, "collisions_min": 0, "collisions_max": 166, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6862593784574544, "mean_inference_ms": 10.20611596042603, "mean_action_processing_ms": 0.45004331340081094, "mean_env_wait_ms": 1.0232190975941868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8143832683563232, "StateBufferConnector_ms": 0.0063800811767578125, "ViewRequirementAgentConnector_ms": 0.2873849868774414}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -241.08492508155908, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.72902697964295, -247.08262485468845, -230.47065037803617, -257.18393742840885, -242.41945137221506, -249.5746643436206, -238.34565967065248, -235.385924334149, -255.06536490793462, -222.67943740878212, -207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6862593784574544, "mean_inference_ms": 10.20611596042603, "mean_action_processing_ms": 0.45004331340081094, "mean_env_wait_ms": 1.0232190975941868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8143832683563232, "StateBufferConnector_ms": 0.0063800811767578125, "ViewRequirementAgentConnector_ms": 0.2873849868774414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500, "num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.2906445509572615, "num_agent_steps_trained_throughput_per_sec": 5.2906445509572615, "timesteps_total": 217500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 217500, "timers": {"training_iteration_time_ms": 1417241.401, "sample_time_ms": 33041.941, "load_time_ms": 0.995, "load_throughput": 2513365.292, "learn_time_ms": 1384196.601, "learn_throughput": 1.806, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500}, "done": false, "episodes_total": 290, "training_iteration": 29, "trial_id": "b165f_00229", "date": "2024-03-16_03-56-58", "timestamp": 1710557818, "time_this_iter_s": 1417.5986437797546, "time_total_s": 41694.57692480087, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 41694.57692480087, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 41.36837394331179, "ram_util_percent": 15.739134758826456}, "checkpoint_dir_name": "checkpoint_000028"}
{"custom_metrics": {"collisions_mean": 61.34, "collisions_min": 0, "collisions_max": 166, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.8119448627211454, "policy_loss": -0.018777086705654516, "vf_loss": 2.0675163238127343, "vf_explained_var": 0.37351015460217135, "kl": 0.01930456632245118, "entropy": 2.6256117110279784, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51330.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -238.80874766060361, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 61.34, "collisions_min": 0, "collisions_max": 166, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.685190033233669, "mean_inference_ms": 10.200322607033431, "mean_action_processing_ms": 0.4498586731949645, "mean_env_wait_ms": 1.0228243120158595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8142189979553223, "StateBufferConnector_ms": 0.00632786750793457, "ViewRequirementAgentConnector_ms": 0.28574323654174805}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -238.80874766060361, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207.4253949362361, -196.6808209214411, -282.75841813005917, -257.3147794456379, -291.362724108622, -279.3350226738137, -226.1153573907166, -410.1601725694431, -201.3409952528486, -191.00700956525262, -233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.685190033233669, "mean_inference_ms": 10.200322607033431, "mean_action_processing_ms": 0.4498586731949645, "mean_env_wait_ms": 1.0228243120158595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8142189979553223, "StateBufferConnector_ms": 0.00632786750793457, "ViewRequirementAgentConnector_ms": 0.28574323654174805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.287207966572163, "num_agent_steps_trained_throughput_per_sec": 5.287207966572163, "timesteps_total": 225000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 225000, "timers": {"training_iteration_time_ms": 1419171.24, "sample_time_ms": 33043.12, "load_time_ms": 0.991, "load_throughput": 2522495.129, "learn_time_ms": 1386125.205, "learn_throughput": 1.804, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "b165f_00229", "date": "2024-03-16_04-20-38", "timestamp": 1710559238, "time_this_iter_s": 1418.520256280899, "time_total_s": 43113.09718108177, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 43113.09718108177, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 41.41708892200696, "ram_util_percent": 15.759413810233482}, "checkpoint_dir_name": "checkpoint_000029"}
{"custom_metrics": {"collisions_mean": 60.44, "collisions_min": 0, "collisions_max": 160, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.7223165732647838, "policy_loss": -0.02721387570156534, "vf_loss": 1.9768509739089286, "vf_explained_var": 0.4080557225079372, "kl": 0.01854169111666751, "entropy": 2.60995803036909, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53070.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -234.2213220707828, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 60.44, "collisions_min": 0, "collisions_max": 160, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6843320330135112, "mean_inference_ms": 10.19569445550463, "mean_action_processing_ms": 0.44973743369997843, "mean_env_wait_ms": 1.022501207858667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8159635066986084, "StateBufferConnector_ms": 0.006323099136352539, "ViewRequirementAgentConnector_ms": 0.28737974166870117}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -234.2213220707828, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-233.68609782405827, -224.8903679120167, -274.6295459478079, -198.47940402171693, -239.8711852664662, -313.59399108250335, -237.65789280875157, -217.6582777148582, -260.95973923514134, -263.7738555915644, -330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6843320330135112, "mean_inference_ms": 10.19569445550463, "mean_action_processing_ms": 0.44973743369997843, "mean_env_wait_ms": 1.022501207858667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8159635066986084, "StateBufferConnector_ms": 0.006323099136352539, "ViewRequirementAgentConnector_ms": 0.28737974166870117}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500, "num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.294505165935774, "num_agent_steps_trained_throughput_per_sec": 5.294505165935774, "timesteps_total": 232500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 232500, "timers": {"training_iteration_time_ms": 1419639.686, "sample_time_ms": 33088.56, "load_time_ms": 0.988, "load_throughput": 2531202.626, "learn_time_ms": 1386548.192, "learn_throughput": 1.803, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "b165f_00229", "date": "2024-03-16_04-44-15", "timestamp": 1710560655, "time_this_iter_s": 1416.565007686615, "time_total_s": 44529.66218876839, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 44529.66218876839, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 41.46424664346097, "ram_util_percent": 15.668025857782197}, "checkpoint_dir_name": "checkpoint_000030"}
{"custom_metrics": {"collisions_mean": 58.56, "collisions_min": 0, "collisions_max": 160, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.6230567982955568, "policy_loss": -0.019146728084754497, "vf_loss": 1.849801395773545, "vf_explained_var": 0.33928119536788987, "kl": 0.023672938372822073, "entropy": 2.571104978076343, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54810.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -229.56272891548286, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 58.56, "collisions_min": 0, "collisions_max": 160, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6835237644834797, "mean_inference_ms": 10.191366507670407, "mean_action_processing_ms": 0.44961131384993935, "mean_env_wait_ms": 1.022190961638124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8184938430786133, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.28879308700561523}}, "episode_reward_max": -107.75740566137888, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -229.56272891548286, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-330.7035859048868, -223.2091192953344, -219.74133294792276, -322.2545593900633, -286.4045507310504, -235.81551910648363, -236.1265861549133, -253.9297442867293, -211.73249088292238, -218.07575429804928, -160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6835237644834797, "mean_inference_ms": 10.191366507670407, "mean_action_processing_ms": 0.44961131384993935, "mean_env_wait_ms": 1.022190961638124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8184938430786133, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.28879308700561523}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.290703779868675, "num_agent_steps_trained_throughput_per_sec": 5.290703779868675, "timesteps_total": 240000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 1419511.309, "sample_time_ms": 33085.059, "load_time_ms": 0.981, "load_throughput": 2547870.247, "learn_time_ms": 1386423.317, "learn_throughput": 1.803, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "b165f_00229", "date": "2024-03-16_05-07-53", "timestamp": 1710562073, "time_this_iter_s": 1417.5828573703766, "time_total_s": 45947.24504613876, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 45947.24504613876, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 41.43222277473893, "ram_util_percent": 15.6717553455992}, "checkpoint_dir_name": "checkpoint_000031"}
{"custom_metrics": {"collisions_mean": 55.92, "collisions_min": 0, "collisions_max": 160, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.5463336629086528, "policy_loss": -0.014087263792592647, "vf_loss": 1.7605157938753737, "vf_explained_var": 0.412372427596443, "kl": 0.021280377204851087, "entropy": 2.5721756905659863, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56550.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500}, "sampler_results": {"episode_reward_max": -106.59693424145897, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -223.45794886410044, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.92, "collisions_min": 0, "collisions_max": 160, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6828465203977025, "mean_inference_ms": 10.187861056356558, "mean_action_processing_ms": 0.44950404995804244, "mean_env_wait_ms": 1.0219306805365613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8172562122344971, "StateBufferConnector_ms": 0.006330013275146484, "ViewRequirementAgentConnector_ms": 0.28638195991516113}}, "episode_reward_max": -106.59693424145897, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -223.45794886410044, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160.52476437786947, -220.76821191446948, -274.22455119110833, -154.4666044160155, -219.15303854302238, -239.72606143719227, -362.7535244668203, -272.29917371314434, -200.3508537417236, -192.7249806112028, -276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6828465203977025, "mean_inference_ms": 10.187861056356558, "mean_action_processing_ms": 0.44950404995804244, "mean_env_wait_ms": 1.0219306805365613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8172562122344971, "StateBufferConnector_ms": 0.006330013275146484, "ViewRequirementAgentConnector_ms": 0.28638195991516113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.271483314466852, "num_agent_steps_trained_throughput_per_sec": 5.271483314466852, "timesteps_total": 247500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 247500, "timers": {"training_iteration_time_ms": 1420365.985, "sample_time_ms": 33120.844, "load_time_ms": 0.931, "load_throughput": 2685282.594, "learn_time_ms": 1387242.249, "learn_throughput": 1.802, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500}, "done": false, "episodes_total": 330, "training_iteration": 33, "trial_id": "b165f_00229", "date": "2024-03-16_05-31-37", "timestamp": 1710563497, "time_this_iter_s": 1422.7516050338745, "time_total_s": 47369.99665117264, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 47369.99665117264, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 41.45319465081724, "ram_util_percent": 15.655968301139175}, "checkpoint_dir_name": "checkpoint_000032"}
{"custom_metrics": {"collisions_mean": 55.52, "collisions_min": 0, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.7425389043462258, "policy_loss": -0.018613781050869915, "vf_loss": 1.9881158302398934, "vf_explained_var": 0.5201682649809739, "kl": 0.02103968031648225, "entropy": 2.70177996103791, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58290.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -106.59693424145897, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -223.5157038178585, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.52, "collisions_min": 0, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6821468318280437, "mean_inference_ms": 10.18468854738618, "mean_action_processing_ms": 0.44935677551764697, "mean_env_wait_ms": 1.0216369518859814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8186392784118652, "StateBufferConnector_ms": 0.006346225738525391, "ViewRequirementAgentConnector_ms": 0.2870175838470459}}, "episode_reward_max": -106.59693424145897, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -223.5157038178585, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276.0888338509253, -271.03555703979555, -213.17822624587686, -294.940630888652, -249.20847831561045, -279.0284401266798, -179.03546203534182, -203.1276556026216, -203.61343994767506, -258.42119936421454, -240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6821468318280437, "mean_inference_ms": 10.18468854738618, "mean_action_processing_ms": 0.44935677551764697, "mean_env_wait_ms": 1.0216369518859814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8186392784118652, "StateBufferConnector_ms": 0.006346225738525391, "ViewRequirementAgentConnector_ms": 0.2870175838470459}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.28522909522992, "num_agent_steps_trained_throughput_per_sec": 5.28522909522992, "timesteps_total": 255000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 1420094.38, "sample_time_ms": 33131.708, "load_time_ms": 0.966, "load_throughput": 2587990.226, "learn_time_ms": 1386959.749, "learn_throughput": 1.803, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "b165f_00229", "date": "2024-03-16_05-55-17", "timestamp": 1710564917, "time_this_iter_s": 1419.0513665676117, "time_total_s": 48789.04801774025, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 48789.04801774025, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 41.44947890818858, "ram_util_percent": 15.688635235732006}, "checkpoint_dir_name": "checkpoint_000033"}
{"custom_metrics": {"collisions_mean": 53.56, "collisions_min": 0, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.4760636913220815, "policy_loss": -0.024982884116256716, "vf_loss": 1.6941057954882752, "vf_explained_var": 0.2738535268553372, "kl": 0.021252528086422418, "entropy": 2.604837640674635, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60030.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -217.96154896139484, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.56, "collisions_min": 0, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6814271355591086, "mean_inference_ms": 10.181284006238862, "mean_action_processing_ms": 0.4491962282890988, "mean_env_wait_ms": 1.0213408700358024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8159933090209961, "StateBufferConnector_ms": 0.0062923431396484375, "ViewRequirementAgentConnector_ms": 0.2849850654602051}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -412.3541857316573, "episode_reward_mean": -217.96154896139484, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-240.81248908545248, -342.5825588319108, -297.45311986813385, -245.3940044425274, -107.75740566137888, -224.72187306145153, -412.3541857316573, -216.35042893082175, -279.603286017525, -237.8338586793868, -200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6814271355591086, "mean_inference_ms": 10.181284006238862, "mean_action_processing_ms": 0.4491962282890988, "mean_env_wait_ms": 1.0213408700358024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8159933090209961, "StateBufferConnector_ms": 0.0062923431396484375, "ViewRequirementAgentConnector_ms": 0.2849850654602051}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500, "num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.281812409166264, "num_agent_steps_trained_throughput_per_sec": 5.281812409166264, "timesteps_total": 262500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 262500, "timers": {"training_iteration_time_ms": 1419113.738, "sample_time_ms": 33090.091, "load_time_ms": 0.906, "load_throughput": 2760645.552, "learn_time_ms": 1386020.743, "learn_throughput": 1.804, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500}, "done": false, "episodes_total": 350, "training_iteration": 35, "trial_id": "b165f_00229", "date": "2024-03-16_06-18-58", "timestamp": 1710566338, "time_this_iter_s": 1419.9692523479462, "time_total_s": 50209.017270088196, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 50209.017270088196, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 41.45645481628599, "ram_util_percent": 15.747964250248263}, "checkpoint_dir_name": "checkpoint_000034"}
{"custom_metrics": {"collisions_mean": 52.94, "collisions_min": 0, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.7362159855960837, "policy_loss": -0.018186230943591772, "vf_loss": 1.9807129756344117, "vf_explained_var": 0.24389866926204198, "kl": 0.019607229367026996, "entropy": 2.5738888942647256, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61770.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -213.87563021408033, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 52.94, "collisions_min": 0, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6807404453301593, "mean_inference_ms": 10.177993934203347, "mean_action_processing_ms": 0.4490394440198391, "mean_env_wait_ms": 1.0210614947135728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.814490556716919, "StateBufferConnector_ms": 0.006262063980102539, "ViewRequirementAgentConnector_ms": 0.2833569049835205}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -213.87563021408033, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-200.50310650365446, -261.66510010500707, -187.8124934782507, -327.25347096046846, -258.72524805586227, -171.20522910446974, -218.69813518723697, -212.44615774682674, -260.5671118404106, -225.78509130538285, -242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6807404453301593, "mean_inference_ms": 10.177993934203347, "mean_action_processing_ms": 0.4490394440198391, "mean_env_wait_ms": 1.0210614947135728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.814490556716919, "StateBufferConnector_ms": 0.006262063980102539, "ViewRequirementAgentConnector_ms": 0.2833569049835205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.275664985212249, "num_agent_steps_trained_throughput_per_sec": 5.275664985212249, "timesteps_total": 270000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 1418568.507, "sample_time_ms": 33083.938, "load_time_ms": 0.932, "load_throughput": 2682123.034, "learn_time_ms": 1385481.618, "learn_throughput": 1.804, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "b165f_00229", "date": "2024-03-16_06-42-40", "timestamp": 1710567760, "time_this_iter_s": 1421.6238873004913, "time_total_s": 51630.64115738869, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 51630.64115738869, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 41.47347545860188, "ram_util_percent": 15.677788795240453}, "checkpoint_dir_name": "checkpoint_000035"}
{"custom_metrics": {"collisions_mean": 49.2, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.2204681637440005, "policy_loss": -0.02587534411176076, "vf_loss": 1.4037930348652532, "vf_explained_var": 0.34940188547660567, "kl": 0.022981021101532998, "entropy": 2.4496315623836957, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63510.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -208.0339524741052, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 49.2, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6801171248667626, "mean_inference_ms": 10.174836096939348, "mean_action_processing_ms": 0.44888123608207, "mean_env_wait_ms": 1.0207910350128997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8140511512756348, "StateBufferConnector_ms": 0.0060536861419677734, "ViewRequirementAgentConnector_ms": 0.28259730339050293}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -208.0339524741052, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.39740480057569, -157.59701645673815, -222.06200513680272, -194.20175735207437, -211.99461352492202, -187.8761518873006, -165.79534999918664, -227.4184538483267, -304.5123886832777, -217.98169716610093, -235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6801171248667626, "mean_inference_ms": 10.174836096939348, "mean_action_processing_ms": 0.44888123608207, "mean_env_wait_ms": 1.0207910350128997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8140511512756348, "StateBufferConnector_ms": 0.0060536861419677734, "ViewRequirementAgentConnector_ms": 0.28259730339050293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500, "num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.294121310457699, "num_agent_steps_trained_throughput_per_sec": 5.294121310457699, "timesteps_total": 277500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 277500, "timers": {"training_iteration_time_ms": 1418843.094, "sample_time_ms": 33076.244, "load_time_ms": 0.912, "load_throughput": 2740014.111, "learn_time_ms": 1385763.938, "learn_throughput": 1.804, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500}, "done": false, "episodes_total": 370, "training_iteration": 37, "trial_id": "b165f_00229", "date": "2024-03-16_07-06-18", "timestamp": 1710569178, "time_this_iter_s": 1416.6677272319794, "time_total_s": 53047.30888462067, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 53047.30888462067, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 41.4297364495276, "ram_util_percent": 15.691894579811036}, "checkpoint_dir_name": "checkpoint_000036"}
{"custom_metrics": {"collisions_mean": 48.64, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.5696773715750796, "policy_loss": -0.014762956821145597, "vf_loss": 1.7854728192476363, "vf_explained_var": 0.4062400460243225, "kl": 0.023099495250539018, "entropy": 2.57238850915569, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65250.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -206.58213700612131, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 48.64, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6794564594687307, "mean_inference_ms": 10.171443995571844, "mean_action_processing_ms": 0.44868825248966254, "mean_env_wait_ms": 1.020487587442646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8118071556091309, "StateBufferConnector_ms": 0.006020307540893555, "ViewRequirementAgentConnector_ms": 0.2808499336242676}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -206.58213700612131, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-235.35932409508194, -277.8492612650163, -150.69900165398874, -176.52986496407752, -263.3289063969798, -237.16122854079694, -295.7446840049291, -195.31316308606935, -239.06021768248547, -278.7849381079526, -182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6794564594687307, "mean_inference_ms": 10.171443995571844, "mean_action_processing_ms": 0.44868825248966254, "mean_env_wait_ms": 1.020487587442646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8118071556091309, "StateBufferConnector_ms": 0.006020307540893555, "ViewRequirementAgentConnector_ms": 0.2808499336242676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000, "num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.31430134567748, "num_agent_steps_trained_throughput_per_sec": 5.31430134567748, "timesteps_total": 285000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 285000, "timers": {"training_iteration_time_ms": 1418159.746, "sample_time_ms": 33016.616, "load_time_ms": 0.949, "load_throughput": 2634083.601, "learn_time_ms": 1385140.194, "learn_throughput": 1.805, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "b165f_00229", "date": "2024-03-16_07-29-50", "timestamp": 1710570590, "time_this_iter_s": 1411.2882826328278, "time_total_s": 54458.597167253494, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 54458.597167253494, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 41.41593406593407, "ram_util_percent": 15.633916083916079}, "checkpoint_dir_name": "checkpoint_000037"}
{"custom_metrics": {"collisions_mean": 46.32, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.3557495389995433, "policy_loss": -0.014504563088807139, "vf_loss": 1.5453363081247642, "vf_explained_var": 0.4000066648269522, "kl": 0.021636608736750124, "entropy": 2.501609652617882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66990.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -201.87726645316502, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 46.32, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6788427186539254, "mean_inference_ms": 10.168290258784518, "mean_action_processing_ms": 0.4484909537066635, "mean_env_wait_ms": 1.0201903966903876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8120996952056885, "StateBufferConnector_ms": 0.0060422420501708984, "ViewRequirementAgentConnector_ms": 0.28024864196777344}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -201.87726645316502, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182.13935375553498, -199.76542040097746, -266.5976973205504, -201.14784974297336, -240.42288637767444, -233.31075125465503, -214.0034779005452, -231.6577045304727, -223.61295628141113, -205.6609020178018, -232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6788427186539254, "mean_inference_ms": 10.168290258784518, "mean_action_processing_ms": 0.4484909537066635, "mean_env_wait_ms": 1.0201903966903876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8120996952056885, "StateBufferConnector_ms": 0.0060422420501708984, "ViewRequirementAgentConnector_ms": 0.28024864196777344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500, "num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.311125178165395, "num_agent_steps_trained_throughput_per_sec": 5.311125178165395, "timesteps_total": 292500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 292500, "timers": {"training_iteration_time_ms": 1417613.094, "sample_time_ms": 33018.181, "load_time_ms": 0.89, "load_throughput": 2810291.595, "learn_time_ms": 1384591.968, "learn_throughput": 1.806, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500}, "done": false, "episodes_total": 390, "training_iteration": 39, "trial_id": "b165f_00229", "date": "2024-03-16_07-53-23", "timestamp": 1710572003, "time_this_iter_s": 1412.1325478553772, "time_total_s": 55870.72971510887, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 55870.72971510887, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 41.42817955112219, "ram_util_percent": 15.766583541147133}, "checkpoint_dir_name": "checkpoint_000038"}
{"custom_metrics": {"collisions_mean": 43.98, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9999327798684438, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.3330452076825794, "policy_loss": -0.018550999211308, "vf_loss": 1.525002971831067, "vf_explained_var": 0.3088932327155409, "kl": 0.021299450030421902, "entropy": 2.526207823246375, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68730.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -198.15409919367113, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 43.98, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6781991207335347, "mean_inference_ms": 10.164923345841089, "mean_action_processing_ms": 0.44825753654588607, "mean_env_wait_ms": 1.0198659058300366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8126540184020996, "StateBufferConnector_ms": 0.0060672760009765625, "ViewRequirementAgentConnector_ms": 0.2807314395904541}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -198.15409919367113, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-232.78475950172538, -174.38208210671834, -202.7713500790895, -137.34778002698715, -231.7117528911473, -242.7737410845476, -197.9801968437573, -229.64990583968665, -187.29146501298902, -248.0651026253361, -234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6781991207335347, "mean_inference_ms": 10.164923345841089, "mean_action_processing_ms": 0.44825753654588607, "mean_env_wait_ms": 1.0198659058300366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8126540184020996, "StateBufferConnector_ms": 0.0060672760009765625, "ViewRequirementAgentConnector_ms": 0.2807314395904541}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.319309383366132, "num_agent_steps_trained_throughput_per_sec": 5.319309383366132, "timesteps_total": 300000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 1416757.035, "sample_time_ms": 32957.468, "load_time_ms": 0.899, "load_throughput": 2782180.477, "learn_time_ms": 1383796.658, "learn_throughput": 1.807, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "b165f_00229", "date": "2024-03-16_08-16-55", "timestamp": 1710573415, "time_this_iter_s": 1409.9594938755035, "time_total_s": 57280.689208984375, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 57280.689208984375, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 41.42418790604698, "ram_util_percent": 15.897201399300354}, "checkpoint_dir_name": "checkpoint_000039"}
{"custom_metrics": {"collisions_mean": 42.2, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.3698720851939856, "policy_loss": -0.018744642061887886, "vf_loss": 1.5679565264961157, "vf_explained_var": 0.3763707130804829, "kl": 0.020196888532125572, "entropy": 2.5298667112301136, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70470.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -196.00229250243075, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 42.2, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703, -133.0707661240471, -265.06325489014927, -103.22192017606305, -174.2360109909585, -308.9828957168483, -183.13079676137716, -208.8626338945945, -190.81749099205277, -193.56000348866033, -108.63169385320064], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6775174289551875, "mean_inference_ms": 10.16162102784816, "mean_action_processing_ms": 0.4479992394901886, "mean_env_wait_ms": 1.0195067006906542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8117806911468506, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.27919793128967285}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -196.00229250243075, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234.403211966755, -138.3385809629439, -140.33873437673319, -212.80772071425082, -276.4530878820209, -221.20794023413785, -176.80432700090873, -185.8032223731655, -229.24229791947903, -183.9419184444994, -187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703, -133.0707661240471, -265.06325489014927, -103.22192017606305, -174.2360109909585, -308.9828957168483, -183.13079676137716, -208.8626338945945, -190.81749099205277, -193.56000348866033, -108.63169385320064], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6775174289551875, "mean_inference_ms": 10.16162102784816, "mean_action_processing_ms": 0.4479992394901886, "mean_env_wait_ms": 1.0195067006906542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8117806911468506, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.27919793128967285}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500, "num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.318909440974626, "num_agent_steps_trained_throughput_per_sec": 5.318909440974626, "timesteps_total": 307500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 307500, "timers": {"training_iteration_time_ms": 1416107.086, "sample_time_ms": 32926.434, "load_time_ms": 0.88, "load_throughput": 2841053.43, "learn_time_ms": 1383177.759, "learn_throughput": 1.807, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500}, "done": false, "episodes_total": 410, "training_iteration": 41, "trial_id": "b165f_00229", "date": "2024-03-16_08-40-25", "timestamp": 1710574825, "time_this_iter_s": 1410.06560587883, "time_total_s": 58690.754814863205, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 58690.754814863205, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 41.393950000000004, "ram_util_percent": 15.800000000000004}, "checkpoint_dir_name": "checkpoint_000040"}
{"custom_metrics": {"collisions_mean": 40.62, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0005767892284902428, "total_loss": 1.3339519585193744, "policy_loss": -0.012755657571378625, "vf_loss": 1.5151896573560333, "vf_explained_var": 0.47558306620038787, "kl": 0.025187665051727117, "entropy": 2.53662523551919, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72210.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -193.56861203660975, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 40.62, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703, -133.0707661240471, -265.06325489014927, -103.22192017606305, -174.2360109909585, -308.9828957168483, -183.13079676137716, -208.8626338945945, -190.81749099205277, -193.56000348866033, -108.63169385320064, -206.92440283641707, -149.43504433836188, -153.99261173507372, -119.84538784457513, -146.78229670319945, -172.54880945333224, -235.72960532274783, -224.34116916576312, -225.18927630361992, -121.18439158969706], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6767867383590669, "mean_inference_ms": 10.158234553649697, "mean_action_processing_ms": 0.44772928659976297, "mean_env_wait_ms": 1.019132247251158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8084630966186523, "StateBufferConnector_ms": 0.006025791168212891, "ViewRequirementAgentConnector_ms": 0.27690649032592773}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -193.56861203660975, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187.03730560318508, -239.1267479842328, -236.19911790824258, -177.41399825323649, -123.15128332016774, -187.83342738474218, -106.59693424145897, -171.05415607437732, -240.33386810737474, -258.7683989830894, -255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703, -133.0707661240471, -265.06325489014927, -103.22192017606305, -174.2360109909585, -308.9828957168483, -183.13079676137716, -208.8626338945945, -190.81749099205277, -193.56000348866033, -108.63169385320064, -206.92440283641707, -149.43504433836188, -153.99261173507372, -119.84538784457513, -146.78229670319945, -172.54880945333224, -235.72960532274783, -224.34116916576312, -225.18927630361992, -121.18439158969706], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6767867383590669, "mean_inference_ms": 10.158234553649697, "mean_action_processing_ms": 0.44772928659976297, "mean_env_wait_ms": 1.019132247251158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8084630966186523, "StateBufferConnector_ms": 0.006025791168212891, "ViewRequirementAgentConnector_ms": 0.27690649032592773}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.327977713230847, "num_agent_steps_trained_throughput_per_sec": 5.327977713230847, "timesteps_total": 315000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 315000, "timers": {"training_iteration_time_ms": 1415115.362, "sample_time_ms": 32889.564, "load_time_ms": 0.923, "load_throughput": 2708658.814, "learn_time_ms": 1382222.846, "learn_throughput": 1.809, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "b165f_00229", "date": "2024-03-16_09-03-54", "timestamp": 1710576234, "time_this_iter_s": 1407.6656289100647, "time_total_s": 60098.42044377327, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 60098.42044377327, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 40.371050000000004, "ram_util_percent": 15.106149999999996}, "checkpoint_dir_name": "checkpoint_000041"}
{"custom_metrics": {"collisions_mean": 38.86, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0005767892284902428, "total_loss": 1.160085888179126, "policy_loss": -0.018258224038043242, "vf_loss": 1.3220076930848346, "vf_explained_var": 0.41025588711102806, "kl": 0.018234424586621938, "entropy": 2.423711660675619, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73950.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500}, "sampler_results": {"episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -190.71018223899665, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 38.86, "collisions_min": 0, "collisions_max": 112, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703, -133.0707661240471, -265.06325489014927, -103.22192017606305, -174.2360109909585, -308.9828957168483, -183.13079676137716, -208.8626338945945, -190.81749099205277, -193.56000348866033, -108.63169385320064, -206.92440283641707, -149.43504433836188, -153.99261173507372, -119.84538784457513, -146.78229670319945, -172.54880945333224, -235.72960532274783, -224.34116916576312, -225.18927630361992, -121.18439158969706, -100.75646896853056, -138.045538243381, -135.780269115007, -215.76797202027447, -168.3323636069255, -194.5527641823196, -174.08550386139038, -190.28649930116467, -158.65256695581385, -165.4123118439896], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.67601367701961, "mean_inference_ms": 10.154585289860352, "mean_action_processing_ms": 0.447438759189122, "mean_env_wait_ms": 1.0187259783851643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8077600002288818, "StateBufferConnector_ms": 0.006009578704833984, "ViewRequirementAgentConnector_ms": 0.2768542766571045}}, "episode_reward_max": -89.79684121280395, "episode_reward_min": -333.15707853321334, "episode_reward_mean": -190.71018223899665, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-255.13535845105065, -191.33999670930092, -239.19880317331246, -333.15707853321334, -253.07379701579924, -200.18387684691942, -182.28632080061502, -262.6501977798503, -210.48379182252972, -175.2580386557828, -241.15599021827342, -107.67901809616554, -119.09877227985602, -274.57106459912194, -182.45180576830523, -162.5875417086429, -188.13408541993525, -89.79684121280395, -245.47990001918038, -261.3074184487417, -225.36354588333, -179.92000931748768, -156.9330884891859, -231.48854939628154, -121.31370226437095, -221.10171245382878, -269.0456363149805, -220.04559262089407, -264.23198671418805, -306.8275121242519, -205.1704518116744, -175.66767506861757, -230.24871551217913, -161.02154795099017, -170.1871276978062, -198.06428971113374, -146.00025731375666, -155.88715514816008, -121.25889012575055, -176.98725994998642, -227.33124520038677, -161.45228580424026, -218.24196592603283, -218.75883460301313, -115.24297837591145, -146.0652305842272, -261.82859138612156, -230.40949129073618, -206.62984444864898, -200.69482443759549, -216.3368709062514, -178.52929528071542, -203.74197250348115, -160.62294091389003, -213.4579382931005, -166.72659526811626, -221.98315241375036, -199.81763341321786, -221.23823881733557, -96.8888966918948, -186.0042580279807, -186.4596705905915, -249.46067196148525, -117.05698711418961, -248.32072266924726, -123.92947231087362, -185.56493484038862, -192.16326059676518, -133.20346884813458, -203.83882667354703, -133.0707661240471, -265.06325489014927, -103.22192017606305, -174.2360109909585, -308.9828957168483, -183.13079676137716, -208.8626338945945, -190.81749099205277, -193.56000348866033, -108.63169385320064, -206.92440283641707, -149.43504433836188, -153.99261173507372, -119.84538784457513, -146.78229670319945, -172.54880945333224, -235.72960532274783, -224.34116916576312, -225.18927630361992, -121.18439158969706, -100.75646896853056, -138.045538243381, -135.780269115007, -215.76797202027447, -168.3323636069255, -194.5527641823196, -174.08550386139038, -190.28649930116467, -158.65256695581385, -165.4123118439896], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.67601367701961, "mean_inference_ms": 10.154585289860352, "mean_action_processing_ms": 0.447438759189122, "mean_env_wait_ms": 1.0187259783851643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8077600002288818, "StateBufferConnector_ms": 0.006009578704833984, "ViewRequirementAgentConnector_ms": 0.2768542766571045}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500, "num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.335881207020327, "num_agent_steps_trained_throughput_per_sec": 5.335881207020327, "timesteps_total": 322500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 322500, "timers": {"training_iteration_time_ms": 1413398.269, "sample_time_ms": 32829.427, "load_time_ms": 0.933, "load_throughput": 2678560.298, "learn_time_ms": 1380565.908, "learn_throughput": 1.811, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500}, "done": false, "episodes_total": 430, "training_iteration": 43, "trial_id": "b165f_00229", "date": "2024-03-16_09-27-20", "timestamp": 1710577640, "time_this_iter_s": 1405.5805871486664, "time_total_s": 61504.001030921936, "pid": 80511, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005767892284902429, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0.07080756261145292}, "critic_config": {"model": "TransformerConv", "rounds": 3, "dropout": 0.024287298365191258}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f865401b0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.012469039786048703, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8887147265875651, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9144201381184607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 61504.001030921936, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 40.36750250752256, "ram_util_percent": 15.064443329989968}, "checkpoint_dir_name": "checkpoint_000042"}
